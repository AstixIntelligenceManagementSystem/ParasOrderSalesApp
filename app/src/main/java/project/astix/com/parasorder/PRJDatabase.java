package project.astix.com.parasorder;

import android.content.ContentValues;
import android.content.Context;
import android.content.ContextWrapper;
import android.content.SharedPreferences;
import android.content.SharedPreferences.Editor;
import android.database.Cursor;
import android.database.SQLException;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteException;
import android.database.sqlite.SQLiteOpenHelper;
import android.os.Environment;
import android.text.TextUtils;
import android.util.Log;

import com.astix.Common.CommonInfo;

import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import java.io.BufferedWriter;
import java.io.File;
import java.io.FileWriter;
import java.io.IOException;
import java.math.BigInteger;
import java.text.DecimalFormat;
import java.text.NumberFormat;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.HashMap;
import java.util.Iterator;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Locale;
import java.util.Map.Entry;
import java.util.StringTokenizer;
import java.util.regex.Pattern;

import project.astix.com.parasorder.model.TblBankMaster;
import project.astix.com.parasorder.model.TblDistributorProductStock;
import project.astix.com.parasorder.model.TblGetPDAQuestGrpMapping;
import project.astix.com.parasorder.model.TblGetPDAQuestMstr;
import project.astix.com.parasorder.model.TblGetPDAQuestOptionMstr;
import project.astix.com.parasorder.model.TblInvoiceExecutionProductList;
import project.astix.com.parasorder.model.TblInvoiceLastVisitDetails;
import project.astix.com.parasorder.model.TblLastOutstanding;
import project.astix.com.parasorder.model.TblPDAGetExecutionSummary;
import project.astix.com.parasorder.model.TblPDAGetLODQty;
import project.astix.com.parasorder.model.TblPDAGetLastOrderDate;
import project.astix.com.parasorder.model.TblPDAGetLastOrderDetails;
import project.astix.com.parasorder.model.TblPDAGetLastOrderDetailsTotalValues;
import project.astix.com.parasorder.model.TblPDAGetLastVisitDate;
import project.astix.com.parasorder.model.TblPDAGetLastVisitDetails;
import project.astix.com.parasorder.model.TblPendingInvoices;
import project.astix.com.parasorder.model.TblPreAddedStores;
import project.astix.com.parasorder.model.TblPreAddedStoresDataDetails;
import project.astix.com.parasorder.model.TblProductListLastVisitStockOrOrderMstr;
import project.astix.com.parasorder.model.TblProductListMaster;
import project.astix.com.parasorder.model.TblProductSegementMap;
import project.astix.com.parasorder.model.TblProductWiseInvoice;
import project.astix.com.parasorder.model.TblStoreListMaster;
import project.astix.com.parasorder.model.TblStoreListWithPaymentAddress;
import project.astix.com.parasorder.model.TblStoreSomeProdQuotePriceMstr;

public class PRJDatabase
{
    public  static int   gblQuestIDForOutChannel=0;
    public static SharedPreferences sPref,sharedPrefReport;
    public static final String KEY_PHID = "phID";
    private static final String TAG = "PRJDatabase";


    private static final String TABLE_tblAllServicesCalledSuccessfull = "tblAllServicesCalledSuccessfull";
    private static final String DATABASE_CREATE_tblAllServicesCalledSuccessfull = "create table tblAllServicesCalledSuccessfull(flgAllServicesCalledOrNot int null);";


    private static final String DATABASE_TABLE_tblDAGetAddedOutletSummaryReport = "tblDAGetAddedOutletSummaryReport";
    private static final String DATABASE_CREATE_TABLE_tblDAGetAddedOutletSummaryReport = "create table tblDAGetAddedOutletSummaryReport (Header text null,Child text null,TotalStores text null,Validated text null,Pending text null,FlgNormalOverall int null);";


    private static final String TABLE_tblAppMasterFlags = "tblAppMasterFlags";
    private static final String DATABASE_CREATE_TABLE_tblAppMasterFlags = "create table tblAppMasterFlags(flgShowSalesTargetValue int not null,flgShowDistributorStock int not null,flgShowInvoice int not null,flgShowPOSM int not null,flgShowPaymentStageAtLastVisitPage int not null,flgShowDeliveryAddressButtonOnOrder int not null,flgShowManagerOnStoreList int not null,flgShowTragetVsAchived int not null,flgFilterProductOnCategoryOrSearchBasis int not null,flgNeedStock int not null,flgCalculateStock int not null,flgControlStock int not null,flgManageCollection int not null,flgControlCollection int not null,flgManageScheme int not null,flgManageSalesQuotation int not null,flgManageExecution int not null);";


    private static final String TABLE_tblCollectionReportCashChange = "tblCollectionReportCashChange";
    private static final String DATABASE_CREATE_TABLE_tblCollectionReportCashChange = "create table tblCollectionReportCashChange(StoreID text null,PreviousCashCollectionAmt real null,ModifiedCashCollectionAmt real null,Sstat text null);";
    private static final String DATABASE_TABLE_tblCollectionReportChequeChange="tblCollectionReportChequeChange";
    private static final String DATABASE_CREATE_TABLE_tblCollectionReportChequeChange="create table tblCollectionReportChequeChange (StoreID text not null, PaymentMode_Old text null,PaymentModeID_Old text null, Amount_Old text null, RefNoChequeNoTrnNo_Old text null, Date_Old text null, Bank_Old text null,PaymentMode_New text null,PaymentModeID_New text null, Amount_New text null, RefNoChequeNoTrnNo_New text null, Date_New text null, Bank_New text null,flgDeleteModifyNew text null,Sstat text null);";


    private static final String TABLE_tblStoreLastDeliveryNoteNumber = "tblStoreLastDeliveryNoteNumber";
    private static final String DATABASE_CREATE_TABLE_tblStoreLastDeliveryNoteNumber = "create table tblStoreLastDeliveryNoteNumber(LastDeliveryNoteNumber int null);";

    private static final String TABLE_tblWarehouseMstr = "tblWarehouseMstr";
    private static final String DATABASE_CREATE_TABLE_tblWarehouseMstr = "create table tblWarehouseMstr(NodeID int null,NodeType int null,Descr text null,latCode text null,LongCode text null,flgMapped int null,Address text null,State text null,City text null,PinCode text null,PhoneNo text null,TaxNumber text null);";

    private static final String TABLE_tblUOMMstr = "tblUOMMaster";
    private static final String DATABASE_CREATE_TABLE_tblUOMMstr = "create table tblUOMMaster(UOMId int not null,UOM text not null,flgBaseUnit int null);";

    private static final String TABLE_tblUOMMapping = "tblUOMMapping";
    private static final String DATABASE_CREATE_TABLE_tblUOMMapping = "create table tblUOMMapping(NodeId int not null,NodeType int not null,BaseUnitID int not null,PackUnitId int not null,BaseValue real not null,flgDefaultUOM int not null);";

    private static final String TABLE_tbl_StockRqst = "tblStockRqst";
    private static final String DATABASE_CREATE_TABLE_tblStockReq = "create table tblStockRqst(ProductID int null,ReqStock int null,dfltUOMId int null,SlctdUOMID int null);";


    private static final String DATABASE_TABLE_tblUserName = "tblUserName";
    private static final String DATABASE_TABLE_tblStoreCountDetails = "tblStoreCountDetails";
    private static final String DATABASE_TABLE_tblPreAddedStores = "tblPreAddedStores";
    private static final String DATABASE_TABLE_tblPreAddedStoresDataDetails = "tblPreAddedStoresDataDetails";
    private static final String DATABASE_TABLE_tblStoreCheckInPic = "tblStoreCheckInPic";
    private static final String DATABASE_CREATE_TABLE_tblStoreCheckInPic = "create table tblStoreCheckInPic (StoreID text null,imageName text null,picClkdPath text null,clkdDateTime,Sstat integer null);";
    private static final String DATABASE_CREATE_TABLE_tblUserName = "create table tblUserName (UserName text null);";
    private static final String DATABASE_CREATE_TABLE_tblStoreCountDetails = "create table tblStoreCountDetails (TotStoreAdded int not null,TodayStoreAdded int not null);";
    private static final String DATABASE_CREATE_TABLE_tblPreAddedStores = "create table tblPreAddedStores (StoreID text not null,StoreName text not null,LatCode text null,LongCode text null,DateAdded text null,DistanceNear int null,flgOldNewStore int null,flgReMap int not null,Sstat int not null,RouteID int null,RouteNodeType int null);";
    private static final String DATABASE_CREATE_TABLE_tblPreAddedStoresDataDetails = "create table tblPreAddedStoresDataDetails (StoreIDDB text not null,GrpQuestID text not null,QstId text not null,AnsControlTypeID text not null,AnsTextVal text null,flgPrvVal text null);";



    //actual visit stock
    private static final String DATABASE_TABLE_tblActualVisitStock = "tblActualVisitStock";
    private static final String DATABASE_CREATE_TABLE_tblActualVisitStock = "create table tblActualVisitStock (storeID text null,ProductID text null,Stock text null,Sstat integer null);";

    private static final String DATABASE_TABLE_tblProductListLastVisitStockOrOrderMstr= "tblProductListLastVisitStockOrOrderMstr";
    private static final String DATABASE_CREATE_TABLEtblProductListLastVisitStockOrOrderMstr = "create table tblProductListLastVisitStockOrOrderMstr (StoreID text not null,PrdID text not null);";

    private static final String TABLE_tblAttandanceDetails="tblAttandanceDetails";
    private static final String DATABASE_CREATE_TABLE_tblAttandanceDetails="create table tblAttandanceDetails(AttandanceTime text null," +
            "PersonNodeID text null, PersonNodeType text null," +
            "OptionID text null,OptionDesc text null,ReasonID text null,ReasonDesc text null,Comment text null, Address text null,PinCode text null, City text null, State text null," +
            "fnLati text null,fnLongi text null,fnAccuracy text null," +
            "flgLocNotFound text null,fnAccurateProvider text null,AllProvidersLocation text null,fnAddress text null," +
            "GpsLat text null, GpsLong text null, GpsAccuracy text null, GpsAddress text null, NetwLat text null, " +
            "NetwLong text null, NetwAccuracy text null, NetwAddress text null, FusedLat text null, FusedLong text null, " +
            "FusedAccuracy text null, FusedAddress text null,FusedLocationLatitudeWithFirstAttempt text null," +
            "FusedLocationLongitudeWithFirstAttempt text null,FusedLocationAccuracyWithFirstAttempt text null," +
            "Sstat int null,flgLocationServicesOnOff int null,flgGPSOnOff int null,flgNetworkOnOff int null," +
            "flgFusedOnOff int null,flgInternetOnOffWhileLocationTracking int null,flgRestart int null," +
            "MapAddress text null,MapCity text null,MapPinCode text null,MapState text null,CityId text null,StateId text null,DistributorId text null,DistributorNodeType text null,DistributorName text null);";

    private static final String DATABASE_TABLE_tblStoreOrderVisitDayActivity="tblStoreOrderVisitDayActivity";
    private static final String DATABASE_CREATE_tblStoreOrderVisitDayActivity="create table tblStoreOrderVisitDayActivity(IMEINumber text null,StoreVisitCode text null,StoreID text not null, TempStoreVisitCode text null, ForDate string not null, Sstat integer not null,VisitTimeStartAtStore text null,VisitTimeEndStore text null);";


    private static final String DATABASE_TABLE_INVOICE_DETAILS = "tblInvoiceDetails";//
    private static final String DATABASE_TABLE_MAIN32 = "tblTmpInvoiceHeader";//
    private static final String DATABASE_TABLE_MAIN210 = "tblTmpInvoiceDetails";//DATABASE_TABLE_TMPINVOICE_DETAILS

    private static final String  DATABASE_TABLE_INVOICE_HEADER = "tblInvoiceHeader";//DATABASE_TABLE_MAIN32,DATABASE_CREATE_TABLE_32
    private static final String DATABASE_CREATE_TABLE_INVOICE_HEADER = "create table tblInvoiceHeader (StoreVisitCode text not null,InvoiceNumber int not null,TmpInvoiceCodePDA text null, StoreID text not null, InvoiceDate string not null, TotalBeforeTaxDis real not null, TaxAmt real not null, TotalDis real not null, InvoiceVal real not null, FreeTotal integer not null, Sstat integer not null, InvAfterDis real not null, AddDis real not null,  NoCoupon int null, TotalCoupunAmount real null,TransDate string not null,FlgInvoiceType text not null,flgWholeSellApplicable int null,flgProcessedInvoice int not null,CycleID  int not null);";
    private static final String DATABASE_TABLE_STOREVISIT="tblStoreVisitMstr";
    private static final String DATABASE_CREATE_TABLE_STOREVISIT="create table tblStoreVisitMstr(IMEINumber text null,StoreVisitCode text null,StoreID text not null, Sstat integer not null, ForDate string not null, ActualLatitude text null, ActualLongitude text null,VisitTimeOutSideStore text null,VisitTimeInSideStore text null,VisitTimeCheckStore text null, VisitEndTS text null, LocProvider text null, Accuracy text null,BateryLeftStatus text null,StoreClose integer null,StoreNextDay integer null,ISNewStore int null,IsNewStoreDataCompleteSaved int null,flgFromWhereSubmitStatus int null,flgSubmitFromQuotation int null,flgLocationServicesOnOff int null,flgGPSOnOff int null,flgNetworkOnOff int null,flgFusedOnOff int null,flgInternetOnOffWhileLocationTracking int null,flgStoreOrder int null,flgRetailerCreditBalnce integer null,VisitTypeStatus text null,flgVisitCollectionMarkedStatus int null,SelfCreditNote real null);";
    private static final String  DATABASE_TABLE_DayCheckIn = "tblDayCheckIn";//DATABASE_TABLE_MAIN32,DATABASE_CREATE_TABLE_32
    private static final String DATABASE_CREATE_TABLE_DayCheckIn = "create table tblDayCheckIn (DateOfDayCheckIn text not null,flgDayDayCheckIn int not null);";
    private static final String DATABASE_TABLE_NewAddedStoreLocationDetails="tblNewAddedStoreLocationDetails";
    private static final String DATABASE_CREATE_TABLE_NewAddedStoreLocationDetails="create table tblNewAddedStoreLocationDetails(StoreID text not null, VisitEndTS text null, LocProvider text null, Accuracy text null, BateryLeftStatus text null,flgLocationServicesOnOff int null,flgGPSOnOff int null,flgNetworkOnOff int null,flgFusedOnOff int null,flgInternetOnOffWhileLocationTracking int null, Sstat integer not null);";
    //
    private static final String DATABASE_CREATE_TABLE_INVOICE_DETAILS = "create table tblInvoiceDetails (InvoiceNumber int not null,TmpInvoiceCodePDA text null,StoreID text not null,CatID text  null,ProdID text not null,ProductPrice real null, TaxRate real null,flgRuleTaxVal integer null,OrderQty integer not null,UOMId integer not null,LineValBfrTxAftrDscnt real not null,LineValAftrTxAftrDscnt real not null,FreeQty integer not null,DisVal real not null,Sstat integer not null,SampleQuantity int null,ProductShortName text null,TaxValue real null,OrderIDPDA text null,flgIsQuoteRateApplied int null,ServingDBRId text null,flgWholeSellApplicable int null,ProductExtraOrder int null);";
    private static final String DATABASE_CREATE_TABLE_210 = "create table tblTmpInvoiceDetails (TmpInvoiceCodePDA text null,StoreID text not null,CatID text  null,ProdID text not null,ProductPrice real null, TaxRate real null,flgRuleTaxVal integer null,OrderQty integer not null,UOMId integer not null,LineValBfrTxAftrDscnt real not null,LineValAftrTxAftrDscnt real not null,FreeQty integer not null,DisVal real not null,Sstat integer not null,SampleQuantity int null,ProductShortName text null,TaxValue real null,OrderIDPDA text null,flgIsQuoteRateApplied int null,ServingDBRId text null,flgWholeSellApplicable int null,ProductExtraOrder int null);";
    private static final String DATABASE_CREATE_TABLE_32 = "create table tblTmpInvoiceHeader (StoreVisitCode text not null,TmpInvoiceCodePDA text null, StoreID text not null, InvoiceDate string not null, TotalBeforeTaxDis real not null, TaxAmt real not null, TotalDis real not null, InvoiceVal real not null, FreeTotal integer not null, Sstat integer not null, InvAfterDis real not null, AddDis real not null,  NoCoupon int null, TotalCoupunAmount real null,TransDate string not null,FlgInvoiceType text not null,flgWholeSellApplicable int null,flgTransferStatus int not null);";
    private static final String DATABASE_TABLE_tblInvoiceCaption = "tblInvoiceCaption";
    private static final String DATABASE_CREATE_TABLE_tblInvoiceCaption = "create table tblInvoiceCaption(INVPrefix text null,VanIntialInvoiceIds int not null,INVSuffix int null);";
    private static final String DATABASE_TABLE_tblPriceApplyType = "tblPriceApplyType";
    private static final String DATABASE_CREATE_TABLE_tblPriceApplyType =  "create table tblPriceApplyType(DiscountLevelType int not null,cutoffvalue real not null);";
    private static final String DATABASE_TABLE_tblLastOutstanding = "tblLastOutstanding";
    private static final String DATABASE_CREATE_TABLE_tblLastOutstanding = "create table tblLastOutstanding(StoreID text not null,Outstanding real not null,AmtOverdue real not null);";
    private static final String DATABASE_TABLE_tblInvoiceLastVisitDetails = "tblInvoiceLastVisitDetails";
    private static final String DATABASE_CREATE_TABLE_tblInvoiceLastVisitDetails = "create table tblInvoiceLastVisitDetails(StoreID text not null,InvCode text null,InvDate text null,OutstandingAmt text not null,AmtOverdue text null);";
    //setock out flg by Sunil, we are using below table
    private static final String DATABASE_TABLE_tblStockUploadedStatus="tblStockUploadedStatus";
    private static final String DATABASE_CREATE_TABLE_tblStockUploadedStatus="create table tblStockUploadedStatus(flgStockTrans int null,VanLoadUnLoadCycID int null,CycleTime text null,StatusID int null,flgDayEnd int null);";
    private static final String DATABASE_TABLE_TMP_DISTRIBUTOR_STOCK = "tblTmpDistributorStock";
    private static final String DATABASE_CREATE_TABLE_TEMP_DISTRIBUTOR_STOCK="create table tblTMPDistributorStock(PrdctId text not null,StockQntty text not null,DistributorNodeIdNodeType text not null,SKUName text not null,OpeningStock text not null,TodaysAddedStock text not null,CycleAddedStock text not null,NetSalesQty text not null,TodaysUnloadStk text not null,CycleUnloadStk text not null,CategoryID text not null);";
    private static final String DATABASE_TABLE_tblStockConfirm="tblStockConfirm";
    private static final String DATABASE_CREATE_TABLE_tblStockConfirm="create table tblStockConfirm(UserId text null,confirmFlg text null);";
    //setock out flg not using below tavle
    private static final String DATABASE_TABLE_tblStockOut="tblDistributorStockOutFlg";
    private static final String DATABASE_CREATE_TABLE_tblStockOut="create table tblDistributorStockOutFlg(flgStockOutEntryDone int not null);";
    private static final String DATABASE_TABLE_tblBankMaster="tblBankMaster";
    private static final String DATABASE_TABLE_tblInstrumentMaster="tblInstrumentMaster";


    private static final String TABLE_tblStateCityMaster="tblStateCityMaster";
    private static final String DATABASE_CREATE_TABLE_tblStateCityMaster="create table tblStateCityMaster(StateID int not null, State text not null,CityID int not null,City text not null,CityDefault integer null);";


    //Amount Collction
    private static final String DATABASE_TABLE_tblAllCollectionData="tblAllCollectionData";
    //Amount Collection
    private static final String DATABASE_CREATE_TABLE_tblBankMaster="create table tblBankMaster (BankId int not null, BankName text not null);";
    private static final String DATABASE_CREATE_TABLE_tblInstrumentMaster="create table tblInstrumentMaster (InstrumentModeId text not null, InstrumentMode text not null, InstrumentType text not null);";
    private static final String DATABASE_CREATE_TABLE_tblAllCollectionData="create table tblAllCollectionData (StoreVisitCode text not null,StoreID text not null, PaymentMode text null,PaymentModeID text null, Amount text null, RefNoChequeNoTrnNo text null, Date text null, Bank text null,Sstat text null,TmpInvoiceCodePDA text null,CollectionCode text null);";
    //map distributor
    private static final String TABLE_tblSupplierMstrList = "tblSupplierMstrList";
    //private static final String DATABASE_CREATE_TABLE_tblAllCollectionData="create table tblAllCollectionData (StoreID text null, PaymentMode text null, Amount text null, RefNoChequeNoTrnNo text null, Date text null, Bank text null,Sstat text null,OrderPDAID text null);";
    private static final String DATABASE_CREATE_TABLE_tblSupplierMstrList =  "create table tblSupplierMstrList(NodeID int not null,NodeType int not null,Descr text not null,latCode real null,LongCode real null,flgMapped int not null,Address text null,State text null,City text null,PinCode text null,ContactNumber text null,TaxNumber text null,flgStockManage int not null,EmailID text null,flgDefault int not null);";
    private static final String TABLE_tblIsDBRStockSubmitted = "tblIsDBRStockSubmitted";
    private static final String DATABASE_CREATE_TABLE_tblIsDBRStockSubmitted = "create table tblIsDBRStockSubmitted (IsDBRStockSubmitted int null);";
    private static final String TABLE_tblSuplierMapping="tblSuplierMapping";
    private static final String DATABASE_CREATE_TABLE_tblSuplierMapping="create table tblSuplierMapping(" +
            "SuplierUniqueId text null, SuplierId text null,SuplierNodeType text null,flgGSTCapture text null," +
            "flgGSTCompliance text null,GSTNumber text null, Address text null,PinCode text null, City text null, State text null," +
            "fnLati text null,fnLongi text null,fnAccuracy text null," +
            "flgLocNotFound text null,fnAccurateProvider text null,AllProvidersLocation text null,fnAddress text null," +
            "GpsLat text null, GpsLong text null, GpsAccuracy text null, GpsAddress text null, NetwLat text null, " +
            "NetwLong text null, NetwAccuracy text null, NetwAddress text null, FusedLat text null, FusedLong text null, " +
            "FusedAccuracy text null, FusedAddress text null,FusedLocationLatitudeWithFirstAttempt text null," +
            "FusedLocationLongitudeWithFirstAttempt text null,FusedLocationAccuracyWithFirstAttempt text null,Sstat int null,flgLocationServicesOnOff int null,flgGPSOnOff int null,flgNetworkOnOff int null,flgFusedOnOff int null,flgInternetOnOffWhileLocationTracking int null,flgRestart int null);";
    private static final String DATABASE_TABLE_DISTRIBUTOR_ORDERPDAID = "tblDistributorOrderPdaId";
    private static final String DATABASE_TABLE_DISTRIBUTOR_STOCK = "tblDistributorProductStock";
    //
    private static final String DATABASE_TABLE_DISTRIBUTOR_LEFTPRODUCT = "tblDistributorIDOrderIDLeft";
    private static final String DATABASE_TABLE_DayAndSummary = "tblAllSummaryDay";
    private static final String DATABASE_CREATE_TABLE_DayAndSummary = "create table tblAllSummaryDay (AutoId int not null,Measures text null," +
            "TodaysSummary text null,MTDSummary text null,TableNo text not null,ColorCode text not null);";
    private static final String DATABASE_TABLE_Main271 = "tblLatLongDetails";
    private static final String DATABASE_CREATE_TABLE_271 = "create table tblLatLongDetails (StoreID text null,fnLati text null,fnLongi text null,fnAccuracy text null,flgLocNotFound text null,fnAccurateProvider text null,AllProvidersLocation text null,fnAddress text null,GpsLat text null, GpsLong text null, GpsAccuracy text null, GpsAddress text null, NetwLat text null, NetwLong text null, NetwAccuracy text null, NetwAddress text null, FusedLat text null, FusedLong text null, FusedAccuracy text null, FusedAddress text null,FusedLocationLatitudeWithFirstAttempt text null,FusedLocationLongitudeWithFirstAttempt text null,FusedLocationAccuracyWithFirstAttempt text null,Sstat integer null);";
    private static final String DATABASE_TABLE_tblSameLocationForStoreRestartDone = "tblsameLocationForStoreRestartDone";
    private static final String DATABASE_CREATE_TABLE_tblSameLocationForStoreRestartDone="create table tblsameLocationForStoreRestartDone(UniqueID INTEGER PRIMARY KEY AUTOINCREMENT,prvsStoreID text null,CrntStoreID text null,isSavedOrSubmittedStore text null,isMsgToRestartPopUpShown text null,isRestartDoneByDSR text null ,Sstat integer null,ActionTime text null);";
    private static final String DATABASE_TABLE_MAIN23 = "tblStoreWiseTarget";
    private static final String DATABASE_TABLE_MAIN235 = "tblTargetVsAchievedSummary";
    private static final String DATABASE_CREATE_TABLE_DISTRIBUTOR_ORDERPDAID="create table tblDistributorOrderPdaId(DistributorNodeIdNodeType text null,OrderPDAID text null,ProductId text null,OrderQntty text null,Sstat integer not null);";
    private static final String DATABASE_CREATE_TABLE_DISTRIBUTOR_STOCK="create table tblDistributorProductStock(PrdctId text not null,StockQntty text not null,DistributorNodeIdNodeType text not null,SKUName text not null,OpeningStock text not null,TodaysAddedStock text not null,CycleAddedStock text not null,NetSalesQty text not null,TodaysUnloadStk text not null,CycleUnloadStk text not null,CategoryID text not null);";
   private static final String DATABASE_TABLE_CYCLEID="tblCycleID";
    private static final String DATABASE_CREATE_TABLE_CYCLEID="create table tblCycleID(CycleID int not null,Sstat int not null,CycStartTime text not null,CycleTime text not null);";
    private static final String DATABASE_CREATE_TABLE_DISTRIBUTOR_LEFTPRODUCT="create table tblDistributorIDOrderIDLeft(DistributorNodeIdNodeType text not null,OrderId text not null,flgProcessedInvoice int not null);";
    private static final String DATABASE_CREATE_TABLE_23 = "create table tblStoreWiseTarget (StoreID text not null,TargetValue text null);";
    private static final String DATABASE_CREATE_TABLE_235 = "create table tblTargetVsAchievedSummary (AutoId int not null,Descr text null," +
            "TodayTarget text null,TodayAchieved text null,TodayBal text null,Todayflg text null,MonthTarget text null,MonthAchieved text null,MonthBal text null,Monthflg text null,ValTgtOrPrdctFlg int not null);";
    private static final String DATABASE_TABLE_MAIN236 = "tblTargetVsAchievedNote";
    private static final String DATABASE_CREATE_TABLE_236 = "create table tblTargetVsAchievedNote (MsgToDisplay text null);";
    // Tables Data Coming at Splash Screen Starts
    private static final String TABLE_tblUserAuthenticationMstr_Define = "tblUserAuthenticationMstr";
    private static final String TABLE_tblUserAuthenticationMstr_Definition = "create table tblUserAuthenticationMstr (flgUserAuthenticated text not null,PersonName  text not null,PersonNodeID integer not null,PersonNodeType integer not null,FlgRegistered text not null,flgPersonTodaysAtt text null,ContactNo text null,DOB text null,SelfieName text null,SelfieNameURL text null,SalesAreaName text null,CoverageNodeId int not null,CoverageNodeType int not null,WorkingType int nol null,flgToShowAllRoutesData int not null);";

   // private static final String TABLE_tblUserAuthenticationMstr_Definition = "create table tblUserAuthenticationMstr (flgUserAuthenticated text null,PersonName text null,FlgRegistered text null,PersonNodeID text null,PersonNodeType text null,flgPersonTodaysAtt text null);";
    private static final String TABLE_tblBloodGroup_Define = "tblBloodGroup";
    private static final String DATABASE_CREATE_TABLE_tblBloodGroup = "create table tblBloodGroup (BloddGroups text not null);";
    private static final String TABLE_tblEducationQuali = "tblEducationQuali";
    private static final String DATABASE_CREATE_TABLE_tblEducationQuali = "create table tblEducationQuali (Qualification text not null);";
    private static final String TABLE_tblDsrRegDetails = "tblDsrRegDetails";
    private static final String DATABASE_CREATE_TABLE_tblDsrRegDetails = "create table tblDsrRegDetails (IMEI text null,  ClickedDateTime text null,FirstName text null,LastName text null,ContactNo text null,DOB text null,Sex text null,MaritalStatus text null,MarriedDate text null,Qualification text null,SelfieName text null,SelfiePath text null,EmailID text null,BloodGroup text null,SignName text null,SignPath text null,Sstat integer null,PhotoName text null,  PersonNodeId text null, PersonNodeType text null);";
    private static final String TABLE_tblUserRegistarationStatus = "tblUserRegistarationStatus";
    private static final String DATABASE_CREATE_TABLE_tblUserRegistarationStatus = "create table tblUserRegistarationStatus (Flag text null,MsgToDisplay text null);";
    private static final String TABLE_tblAvailableVersionMstr_Define = "tblAvailableVersion";
    private static final String TABLE_tblAvailableVersionMstr_Definition = "create table tblAvailableVersion (VersionID text not null,VersionSerialNo text not null,VersionDownloadStatus text not null,ServerDate text not null);";

    private static final String TABLE_tblRouteListMaster_Define = "tblRouteListMaster";
    private static final String TABLE_tblRouteListMaster_Definition = "create table tblRouteListMaster(ID string not null,RouteType string not null, Descr string not null, Active integer null,flgTodayRoute integer null,RouteDate string null);";
    private static final String TABLE_tblPDANotificationMaster_Define = "tblPDANotificationMaster";
    private static final String TABLE_tblPDANotificationMaster_Definition = "create table tblPDANotificationMaster (SerialNo int not null,IMEI text not null, Noti_text text not null,Noti_DateTime text null,Noti_ReadStatus int null,Noti_NewOld int null,Noti_ReadDateTime text null,Sstat int null,MsgServerID int not null);";
    private static final String TABLE_tblDayStartAttendanceOptions_Define = "tblDayStartAttendanceOptions";
    private static final String TABLE_tblDayStartAttendanceOptions_Definition = "create table tblDayStartAttendanceOptions(AutoIdStore int not null,ReasonId text not null,ReasonDescr text not null,FlgToShowTextBox integer null,flgSOApplicable int null,flgDSRApplicable int null,flgNoVisitOption int null,SeqNo int null,flgDelayedReason int null);";

   // private static final String TABLE_tblDayStartAttendanceOptions_Definition = "create table tblDayStartAttendanceOptions(AutoIdStore integer null,ReasonId text null,ReasonDescr text null,FlgToShowTextBox integer null);";

    private static final String TABLE_tblNoVisitStoreDetails_Define = "tblNoVisitStoreDetails";
    private static final String TABLE_tblNoVisitStoreDetails_Definition = "create table tblNoVisitStoreDetails(IMEI text null,CurDate text null,ReasonId text null,ReasonDescr text null,flgHasVisit integer null,Sstat integer not null);";
    //new Store master data Start
    private static final String DATABASE_TABLE_NewStoreSalesQuotePaymentDetails="tblNewStoreSalesQuotePaymentDetails";
    private static final String DATABASE_NewStoreSalesQuotePaymentDetails = "create table tblNewStoreSalesQuotePaymentDetails (StoreId text null,PymtStageId text null,Sstat text null);";
    private static final String TABLE_QSTOUTCHANNEL = "tblQuestIDForOutChannel"; // show how many section we have to show
    private static final String DATABASE_CREATE_TABLE_QSTOUTCHANNEL = "create table tblQuestIDForOutChannel(GrpQstId int not null,QuestID int not null,OptID text not null,SectionCount int not null);";
    private static final String TABLE_QST_NAME = "tblQuestIDForName";
    private static final String DATABASE_CREATE_TABLE_QST_NAME = "create table tblQuestIDForName(ID int not null,GrpQstId int not null,QuestID int not null,QuestDesc text not null);";
    private static final String TABLE_QuestionMstr = "tblGetPDAQuestMstr";
    private static final String DATABASE_CREATE_TABLE_QUESTIONMstr = "create table tblGetPDAQuestMstr(QuestID int not null,QuestCode int null,QuestDesc text not null,QuestType int not null,AnsControlType int not null,AnsControlInputTypeID int not null,AnsControlInputTypeMinLength int null,AnsControlInputTypeMaxLength int null,AnsMustRequiredFlg int not null,QuestBundleFlg int null,ApplicationTypeID int not null,Sequence int not null,AnswerHint text null,flgQuestIDForOutChannel int  null);";
    private static final String TABLE_QuestGrpMappingMstr = "tblGetPDAQuestGrpMapping";
    private static final String DATABASE_CREATE_TABLE_QuestGrpMappingMstr = "create table tblGetPDAQuestGrpMapping(GrpQuestID int not null,QuestID int not null,GrpID int not null,GrpNodeID int not null,GrpDesc text not null,SectionNo int not null,GrpCopyID int null,QuestCopyID int null,Sequence int null);";
    private static final String TABLE_OptionMstr = "tblGetPDAQuestOptionMstr";
    private static final String DATABASE_CREATE_TABLE_OPTIONMstr = "create table tblGetPDAQuestOptionMstr(OptID text not null,QuestID int not null,OptionDescr text not null,Sequence int null );";
    private static final String TABLE_QuestOptionDependentMstr = "tblPDAQuestOptionDependentMstr";
    private static final String DATABASE_CREATE_TABLE_QUESTION_OPTION_DEPENDENTMstr = "create table tblPDAQuestOptionDependentMstr(QstID int not null,DepQstId int not null,GrpQuestID int not null,GrpDepQuestID int not null);";
    private static final String TABLE_QuestOptionValuesDependentMstr = "tblPDAQuestOptionValuesDependentMstr";
    private static final String DATABASE_CREATE_TABLE_QUESTION_OPTION_VAL_DEPENDENTMstr = "create table tblPDAQuestOptionValuesDependentMstr(DepQstId int not null,DepAnswValId text not null,QstId int not null,AnswValId text not null,OptDescr text not null,Sequence int null,GrpQuestID int not null,GrpDepQuestID int not null);";

    private static final String DATABASE_TABLE_tblLocationDetails = "tblLocationDetails";
    private static final String DATABASE_CREATE_TABLE_tblLocationDetails = "create table tblLocationDetails (Lattitude text null,Longitude text null,Accuracy text null,Address text null,City text null,Pincode text null,State text null,fnAccurateProvider  text null,GpsLat  text null,GpsLong  text null,GpsAccuracy  text null,NetwLat  text null,NetwLong  text null,NetwAccuracy  text null,FusedLat  text null,FusedLong  text null,FusedAccuracy  text null,AllProvidersLocation  text null,GpsAddress  text null,NetwAddress  text null,FusedAddress  text null,FusedLocationLatitudeWithFirstAttempt  text null,FusedLocationLongitudeWithFirstAttempt  text null,FusedLocationAccuracyWithFirstAttempt  text null);";

 private static final String TABLE_IMAGE = "tableImage";
    private static final String DATABASE_CREATE_TABLE_Image = "create table tableImage(StoreID text null,QstIdAnsCntrlTyp text null,imageName text null,imagePath text null,ImageClicktime text null,Sstat integer null);";


    private static final String TABLE_OutletQuestAnsMstr = "tblOutletQuestAnsMstr";
    private static final String DATABASE_CREATE_TABLE_tblOutletQuestAnsMstr = "create table tblOutletQuestAnsMstr (OutletID text not null,QuestID text not null,AnswerType text null, AnswerValue text null,QuestionGroupID integer null,sectionID integer null,Sstat integer not null);";
    // Surbhi Change for Incentive
    private static final String TABLE_tblIncentiveMaster = "tblIncentiveMaster";
    private static final String CREATE_TABLE_tblIncentiveMaster = "create table tblIncentiveMaster(IncId int null, OutputType int null, IncentiveName text null,flgAcheived text null,Earning text null);";


    // Tables Data Coming at Splash Screen Ends
    private static final String TABLE_tblIncentiveDetailsData = "tblIncentiveDetailsData";
    private static final String TABLE_tblIncentiveDetailsColumnsDesc = "tblIncentiveDetailsColumnsDesc";
    private static final String CREATE_TABLE_tblIncentiveDetailsColumnsDesc = "create table tblIncentiveDetailsColumnsDesc(IncId int null, ReportColumnName text null, DisplayColumnName text null);";
    private static final String TABLE_tblTotalEarning = "tblTotalEarning";
    private static final String CREATE_TABLE_tblTotalEarning = "create table tblTotalEarning(Total_Earning text null);";
    private static final String TABLE_tblIncentivePastDetailsData = "tblIncentivePastDetailsData";
    private static final String TABLE_tblIncentivePastDetailsColumnsDesc = "tblIncentivePastDetailsColumnsDesc";
    private static final String CREATE_TABLE_tblIncentivePastDetailsColumnsDesc = "create table tblIncentivePastDetailsColumnsDesc(IncId int null, ReportColumnName text null, DisplayColumnName text null, Ordr text null);";
    private static final String TABLE_tblIncentiveMsgToDisplay_Define = "tblIncentiveMsgToDisplay";
    private static final String CREATE_tblIncentiveMsgToDisplay_Definition = "create table tblIncentiveMsgToDisplay(MsgToDisplay text null);";
    private static final String DATABASE_TABLE_StoreSalesOrderPaymentDetails="tblStoreSalesOrderPaymentDetails";
    private static final String DATABASE_TABLE_StoreAddressMapDetailsMstr="tblStoreAddressMapDetailsMstr";
    private static final String DATABASE_TABLE_StoreOrderBillAddressDetails="tblStoreOrderBillAddressDetails";
    private static final String TABLE_XMLFILES = "tbl_XMLfiles";


    // End Surbhi Change for Incentive
    private static final String DATABASE_CREATE_TABLE_XMLfiles = "create table tbl_XMLfiles(XmlFileName text null,Sstat text null,filetype text null);";
    private static final String TABLE_RETURN_REASON = "tblGetReturnsReasonForPDAMstr";
    private static final String TABLE_OutletChannelBusinessSegmentMaster = "tblOutletChannelBusinessSegmentMaster";
    private static final String TABLE_OutletMstr = "tblOutletMstr";
    private static final String TABLE_ViewOutletQuestAnsMstr = "tblViewOutletQuestAnsMstr";


    // static final String TABLE_XMLFILES = "tbl_XMLfiles";
    //private static final String DATABASE_CREATE_TABLE_XMLfiles = "create table tbl_XMLfiles(XmlFileName text null,Sstat text null);";
    private static final String TABLE_ViewOutletNameAndId = "tblViewOutletNameAndId";
    // Dynamic Store Mapping Start
    private static final String TABLE_StoreProductPhotoDetail = "tblOutletPhotoDetail";
    private static final String TABLE_QuestionDependentMstr = "tblGetPDAQuestionDependentMstr";
    private static final String TABLE_StoreSomeProdQuotePriceMstr = "tblStoreSomeProdQuotePriceMstr";
    private static final String DATABASE_CREATE_TABLE_OutletPhotoDetail = "create table tblOutletPhotoDetail(OutletID text null,ClickedDateTime text null,PhotoName text null,PhotoComment text null,PDAPhotoPath text null,Sstat integer null);";
    private static final String DATABASE_CREATE_TABLE_OutletChannelBusinessSegmentMasterr = "create table tblOutletChannelBusinessSegmentMaster(OutChannelID int null,ChannelName text null,BusinessSegmentID int null,BusinessSegment text null);";
    private static final String DATABASE_CREATE_TABLE_tblOutletMstr = "create table tblOutletMstr (OutletID text not null,VisitStartTS text not null,VisitEndTS text null,AppVersion int null,ActualLatitude text null, ActualLongitude text null, LocProvider text null, Accuracy text null, BateryLeftStatus text null,StoreName text null,imei text null, ISNewStore int null,Sstat integer not null);";
    private static final String DATABASE_CREATE_TABLE_tblViewOutletQuestAnsMstr = "create table tblViewOutletQuestAnsMstr (OutletID text not null,QuestID text not null,AnswerType text null, AnswerValue text null);";
    private static final String DATABASE_CREATE_TABLE_ViewOutletNameAndId = "create table tblViewOutletNameAndId(OutletID text not null,OutletName text not null);";
    private static final String DATABASE_CREATE_TABLE_QUESTION_DEPENDENTMstr = "create table tblGetPDAQuestionDependentMstr(QuestionID int not null,OptionID int not null,DependentQuestionID int not null,GrpID int not null,GrpDepQuestID int not null);";
    private static final String DATABASE_StoreSalesOrderPaymentDetails = "create table tblStoreSalesOrderPaymentDetails (StoreId text null,OrderID text null,PymtStageId text null,Sstat text null,TmpInvoiceCodePDA text null);";
    private static final String DATABASE_StoreAddressMapDetailsMstr = "create table tblStoreAddressMapDetailsMstr (StoreID text not null,OutAddTypeID int not null,Address text not null,AddressDet text null,OutAddID int not null);";
    private static final String DATABASE_StoreOrderBillAddressDetails = "create table tblStoreOrderBillAddressDetails (StoreID text null,OrderID text null,BillToAddress text null,ShipToAddress int null,Sstat text null);";
    private static final String DATABASE_StoreSomeProdQuotePriceMstr = "create table tblStoreSomeProdQuotePriceMstr (PrdId text not null,StoreID text not null,QPBT text not null,QPAT text not null,QPTaxAmount text not null,MinDlvrQty int null,UOMID text null,Sstat text null);";
    private static final String TABLE_tblSalesQuoteSponsorMstr = "tblSalesQuoteSponsorMstr";
    private static final String TABLE_tblManufacturerMstrMain = "tblManufacturerMstrMain";
    private static final String TABLE_tblRateDistribution = "tblRateDistribution";
    //nitika
    private static final String DATABASE_CREATE_TABLE_tblSalesQuoteSponsorMstr = "create table tblSalesQuoteSponsorMstr(SalesQuoteSponsorID text null,SponsorDescr text null,Ordr text null);";
    private static final String DATABASE_CREATE_TABLE_tblManufacturerMstrMain = "create table tblManufacturerMstrMain(ManufacturerID text null,ManufacturerName text null,NodeType text null);";
    private static final String DATABASE_CREATE_TABLE_tblRateDistribution = "create table tblRateDistribution(SalesQuoteId text null,StoreId text null,SalesQuoteSponsorID  text null,ManufacturerID  text null,Percentage  text null,SponsorDescr  text null,ManufacturerName  text null,Sstat text null);";
    private static final String DATABASE_TABLE_Main214 = "tblAlrtVal";
    private static final String DATABASE_TABLE_Main215 = "tblProductMappedWithSchemeSlabApplied";
    // Tables for Launcher Screen
    private static final String DATABASE_TABLE_MAIN11 = "tblPdaDate";
    private static final String DATABASE_TABLE_MAIN12 = "tblDayStartEndDetails";

    //  private static final String TABLE_StoreSomeProdQuotePriceMstr = "tblStoreSomeProdQuotePriceMstr";
    // Dynamic Store Mapping End
    private static final String DATABASE_TABLE_MAIN13 = "tblStoreList";
    private static final String DATABASE_TABLE_MAIN14 = "tblProductListMaster";
    private static final String DATABASE_TABLE_MAINProductSegementMap = "tblProductSegementMap";
    private static final String DATABASE_TABLE_MAIN15 = "tblCategoryMaster";
    private static final String DATABASE_TABLE_MAIN19 = "tblPDAProductReturnMstr";
    private static final String DATABASE_TABLE_MAIN20 = "tblPDAProductReturnDetails";
    private static final String DATABASE_TABLE_MAIN21 = "tblNewStoreEntries";
    private static final String DATABASE_TABLE_MAIN22 = "tblTemp";
    private static final String DATABASE_TABLE_MAIN201 = "tblSchemeStoreMapping";
    private static final String DATABASE_TABLE_MAIN202 = "tblSchemeMstr";
    private static final String DATABASE_TABLE_MAIN203 = "tblSchemeSlabDetail";
    private static final String DATABASE_TABLE_MAIN204 = "tblSchemeSlabBucketDetails";
    private static final String DATABASE_TABLE_MAIN205 = "tblSchemeSlabBucketProductMapping";
    private static final String DATABASE_TABLE_MAIN206 = "tblSchemeSlabBenefitsBucketDetails";
    private static final String DATABASE_TABLE_MAIN207 = "tblSchemeSlabBenefitsProductMappingDetail";
    private static final String DATABASE_TABLE_MAIN208 = "tblSchemeSlabBenefitsValueDetail";
    private static final String DATABASE_TABLE_MAIN209 = "tblProductRelatedScheme";
    private static final String DATABASE_TABLE_Main211 = "tblStoreProductAppliedSchemesBenifitsRecords";
    private static final String DATABASE_TABLE_MAIN221 = "tblStoreTypeMstr";
    private static final String DATABASE_TABLE_MAIN222 = "tblStoreProductClassificationTypeListMstr";
    private static final String DATABASE_TABLE_MAIN223 = "tblTradeChannelMstr";
    private static final String DATABASE_TABLE_MAIN231 = "tblSKUWiseDaySummary";
    private static final String DATABASE_TABLE_MAIN232 = "tblStoreWiseDaySummary";
    private static final String DATABASE_TABLE_MAIN233 = "tblStoreSKUWiseDaySummary";
    private static final String DATABASE_TABLE_MAIN234 = "tblAllSummary";
    private static final String DATABASE_TABLE_MAIN251 = "tblMessageTextFileContainer";
    private static final String DATABASE_TABLE_MAIN51 = "tblSchemeList";
    private static final String DATABASE_TABLE_MAIN52 = "tblSchemeDetails";
    private static final String DATABASE_TABLE_MAIN53 = "tblschemeStoreTypeMap";
    private static final String DATABASE_TABLE_MAIN54 = "tblschemeProductMap";
    private static final String DATABASE_TABLE_MAIN55 = "tblspForPDASchemeApplicableList";
    private static final String DATABASE_TABLE_MAIN56 = "tblPDAIsSchemeApplicable";
    private static final String DATABASE_TABLE_MAIN61 = "tblLastTransactionDetails";
    private static final String DATABASE_TABLE_MAIN62 = "tblPDALastTranDateForSecondPage";
    private static final String DATABASE_TABLE_MAIN63 = "tblStorTypeMstr";
    private static final String DATABASE_TABLE_MAIN9 = "tblVisibilityMstr";
    private static final String DATABASE_TABLE_MAIN10 = "tblVisibilityDetails";

    private static final String DATABASE_TABLE_MAIN16 = "tblNewStoreListEntries";
    private static final String DATABASE_TABLE_MAIN17 = "tblPDALastInvoiceDet";
    private static final String DATABASE_TABLE_MAIN18 = "tblPDATargetQtyForSecondPage";
    private static final String DATABASE_TABLE_MAIN31 = "tblTransac";
    private static final String DATABASE_TABLE_MAIN71 = "tblSyncSummuryDetails";
    private static final String DATABASE_TABLE_MAIN72 = "tblSyncSummuryForProductDetails";
    private static final String DATABASE_TABLE_MAIN81 = "tblStrachApplicableOnScheme";
    private static final String DATABASE_TABLE_MAIN82 = "tblStrachOnSchemeDetails";
    private static final String DATABASE_TABLE_MAIN91 = "tblOutLetInfoOnQuadVolumeCategoryBasis";
    private static final String DATABASE_TABLE_MAINStoreProductMap = "tblStoreProductMap";
    private static final String DATABASE_TABLE_MAIN92 = "tblSelectedStoreIDinChangeRouteCase";
    private static final String DATABASE_TABLE_MAIN94 = "tblSysVisitID";
    private static final String DATABASE_TABLE_MAIN101 = "tblFirstOrderDetailsOnLastVisitDetailsActivity";
    private static final String DATABASE_TABLE_MAIN102 = "tblSecondVisitDetailsOnLastVisitDetailsActivity";
    private static final String DATABASE_TABLE_MAIN103 = "tblPDAGetLODQty";
    private static final String DATABASE_TABLE_MAIN111 = "tblPendingInvoices";
    private static final String DATABASE_TABLE_MAIN112 = "tblInvoiceExecutionProductList";
    private static final String DATABASE_TABLE_MAIN113 = "tblProductWiseInvoice";
    private static final String DATABASE_TABLE_MAIN114 = "tblInvoiceButtonTransac";
    private static final String DATABASE_TABLE_MAIN141 = "tblPDAGetLastVisitDate";
    private static final String DATABASE_TABLE_MAIN142 = "tblPDAGetLastOrderDate";
    private static final String DATABASE_TABLE_MAIN143 = "tblPDAGetLastVisitDetails";
    private static final String DATABASE_TABLE_MAIN144 = "tblPDAGetLastOrderDetails";
    private static final String DATABASE_TABLE_MAIN145 = "tblPDAGetLastOrderDetailsTotalValues";
    private static final String DATABASE_TABLE_MAIN146 = "tblPDAGetExecutionSummary";
    private static final String DATABASE_TABLE_MAIN151 = "tblProductListForAvailableStock";
    private static final String DATABASE_TABLE_MAIN152 = "tblCatagoryMstrForDailyTarget";
    //surbhi
    private static final String DATABASE_TABLE_UOMMstr="tblUOMMstr";
    private static final String DATABASE_TABLE_SalesQuotePrcsMstr="tblSalesQuotePrcsMstr";
    private static final String DATABASE_TABLE_SalesQuotePersonMeetMstr="tblSalesQuotePersonMeetMstr";
    private static final String DATABASE_TABLE_SalesQuoteProductsMstr="tblSalesQuoteProductsMstr";
    private static final String DATABASE_TABLE_tblSalesQuotePaymentModeMstr="tblSalesQuotePaymentModeMstr";
    private static final String DATABASE_TABLE_tblSalesQuotePaymentStageMstr="tblSalesQuotePaymentStageMstr";
    private static final String DATABASE_TABLE_tblSalesQuoteTypeMstr="tblSalesQuoteTypeMstr";
    private static final String DATABASE_TABLE_tblSalesQuotePaymentStageModeMapMstr="tblSalesQuotePaymentStageModeMapMstr";
    //surbhi
    private static final String DATABASE_CREATE_TABLE_UOMMstr = "create table tblUOMMstr (UOMID text null,UOM text null);";
    private static final String DATABASE_CREATE_TABLE_SalesQuotePrcsMstr = "create table tblSalesQuotePrcsMstr (SalesQuotePrcsId text null, SalesQuotePrcs text null);";
    private static final String DATABASE_SalesQuotePersonMeetMstr = "create table tblSalesQuotePersonMeetMstr (SalesQuoteId text null,SalesQuoteCode text null,SalesQuotePrcsId text null,SalesQuotePrcs text null,StoreName text null,Remarks text null,StoreId text null,CreditLimit text null,CreditDays text null,ExpectedBusinessValue text null,SalesQuoteValidFrom text null,SalesQuoteValidTo text null,SalesQuoteDate text null,SalesQuoteType text null,ContactPerson text null,ContactPersonEmail text null,ContactPersonPhone text null,PaymentModeId text null,Sstat text null,PymtStageId text null,ManufacturerID text null,ManufacturerName text null);";
    private static final String DATABASE_CREATE_SalesQuoteProductsMstr = "create table tblSalesQuoteProductsMstr (SalesQuoteId text null,Row_No text null,PrdId text null,StandardRate text null,StandardRateBeforeTax text null,RateOffer text null,InclusiveTax text null,ValidFrom text null,ValidTo text null,MinDlvryQty text null,UOMID text null,Remarks text null,LastTranscRate text null,Sstat text null,TaxRate text null);";
    private static final String DATABASE_CREATE_TABLE_tblSalesQuotePaymentModeMstr="create table tblSalesQuotePaymentModeMstr (PymtModeId text null,PymtMode text null);";
    private static final String DATABASE_CREATE_TABLE_tblSalesQuotePaymentStageMstr="create table tblSalesQuotePaymentStageMstr (PymtStageId text null,PymtStage text null,PymtModeId text null);";
    private static final String DATABASE_CREATE_TABLE_tblSalesQuoteTypeMstr="create table tblSalesQuoteTypeMstr (SalesQuotetypeId	text null, SalesQuoteType text null);";
    private static final String DATABASE_CREATE_TABLE_tblSalesQuotePaymentStageModeMapMstr="create table tblSalesQuotePaymentStageModeMapMstr (PymtStageId text null, PymtModeId text null);";
    //private static final String DATABASE_TABLE_Summarytable = "tblDaySummary";
    private static final String DATABASE_TABLE_SummaryDayTableSummaryNew = "tblDaySummaryNew";
    private static final String DATABASE_TABLE_Main212 = "tblStoreProductPhotoDetail";
    private static final String DATABASE_TABLE_Main213 = "tblStoreReturnDetail";
    private static final String DATABASE_TABLE_MAIN161 = "tblPOSMaterialMstr";
    private static final String DATABASE_TABLE_MAIN162 = "tblStoreIDAndMaterialIDMap";
    private static final String DATABASE_TABLE_Main163 = "tblStoreMaterialDetail";
    private static final String DATABASE_TABLE_Main164 = "tblStoreMaterialPhotoDetail";
    private static final String DATABASE_TABLE_Main165 = "tblStorePOSLastVisitDateDetail";
    private static final String DATABASE_TABLE_Main166 = "tblStorePOSLastVisitALLMaterialDetails";
    private static final String DATABASE_CREATE_TABLE_165 = "create table tblStorePOSLastVisitDateDetail (StoreID text null,LastVisitDate text null);";
    private static final String DATABASE_CREATE_TABLE_166 = "create table tblStorePOSLastVisitALLMaterialDetails (StoreID text null,POSMaterialID text null,POSMaterialDescr text null,CurrentStockQty text null,NewOrderQty text null,ReturnQty text null,DamageQty text null);";
    private static final String DATABASE_CREATE_TABLE_161 = "create table tblPOSMaterialMstr (POSMaterialID text null,POSMaterialDescr text null);";
    private static final String DATABASE_CREATE_TABLE_162 = "create table tblStoreIDAndMaterialIDMap (StoreID text null,VisitID text null,MaterialID text null,CurrentStockQty text null);";
    private static final String DATABASE_CREATE_TABLE_163 = "create table tblStoreMaterialDetail (RouteID text null,StoreID text null,MaterialID text null,ExistStock integer null,ReturntoDistributor integer null,FreshOrder integer null,DiscardDamage integer null,Sstat integer null);";
    private static final String DATABASE_CREATE_TABLE_164 = "create table tblStoreMaterialPhotoDetail (RouteID text null,StoreID text null,MaterialID text null,ClickedDateTime text null,PhotoName text null,PhotoValidation text null,PDAPhotoPath text null,Sstat integer null);";
    private static final String DATABASE_CREATE_TABLE_214 = "create table tblAlrtVal (StoreId text null,ProductID text null,SpinnerVal text null,SpinnerPosition text null,Product text null,schSlabId text null,schmAlrtId text null,OrderIDPDA text null,TmpInvoiceCodePDA text null);";
    private static final String DATABASE_CREATE_TABLE_215 = "create table tblProductMappedWithSchemeSlabApplied (StoreId text null,ProductID text null,schSlabId text null,schmIdMapped text null,Sstat int null,OrderIDPDA text null,TmpInvoiceCodePDA text null);";
    private static final String DATABASE_CREATE_TABLE_213 = "create table tblStoreReturnDetail (RouteID text null,StoreID text null,ReturnProductID text null, ProdReturnQty text null, ProdReturnReason text null, ProdReturnReasonIndex text null,ReturnDate text null,Sstat integer null,OrderIDPDA text null,TmpInvoiceCodePDA text null);";
    private static final String DATABASE_CREATE_TABLE_212 = "create table tblStoreProductPhotoDetail (StoreID text null,ProductID text null,ClickedDateTime text null,PhotoName text null,ReasonForReturn text null,PhotoValidation text null,PDAPhotoPath text null,Sstat integer null,OrderIDPDA text null,TmpInvoiceCodePDA text null);";
    private static final String DATABASE_CREATE_TABLE_221 = "create table tblStoreTypeMstr(AutoIdStore integer null,StoreTypeID integer null,StoreTypeDescr text null);";


    // ReasonId,ReasonDescr,FlgToShowTextBox
    private static final String DATABASE_CREATE_TABLE_222 = "create table tblStoreProductClassificationTypeListMstr(AutoIdStore integer null," +
            "CategoryNodeID integer null,CategoryNodeType integer null, Category text null,ProductTypeNodeID integer null,ProductTypeNodeType integer null,ProductType text null,IsCategorySeleted int null,IsSubCategorySeleted int null,SubCategoryValue text null);";
    private static final String DATABASE_CREATE_TABLE_223 = "create table tblTradeChannelMstr(AutoIdStore integer null,TradeChannelID integer null,TradeChannelName text null);";
    private static final String DATABASE_CREATE_TABLE_21 = "create table tblNewStoreEntries (RouteID text null,StoreID text not null,StoreName text null," +
            "RetailerName text  null,emailID text null,TinNo text null,RetailerContactNo text  null," +
            "StoreAddress text  null,StorePincode text  null,City text  null,KeyAccount text null,TradeChannelID integer null,StoreAttrHierID integer null,StoreProductClassificationID text null,ActualLatitude text null, ActualLongitude text null," +
            "LocProvider text null, Accuracy text null," +
            "VisitStartTS text null, VisitEndTS text null,Imei text null,BatteryStatus text null,Sstat integer null," +
            "CityId integer null,AppVersion text null);";
    private static final String DATABASE_CREATE_TABLE_22 = "create table tblTemp(RouteID text null,StoreID text not null," +
            "CategoryNodeID integer null,CategoryNodeType integer null,Category text null,ProductTypeNodeID integer null,ProductTypeNodeType integer null,ProductType text null,IsCategorySeleted int null,IsSubCategorySeleted int null,SubCategoryValue text null,Sstat integer null);";
    private static final String DATABASE_CREATE_TABLE_251 = "create table tblMessageTextFileContainer (FileName text null,FileFlag integer null);";
    private static final String DATABASE_CREATE_TABLE_201 = "create table tblSchemeStoreMapping (StoreID text null,SchemeID text null);";
    private static final String DATABASE_CREATE_TABLE_202 = "create table tblSchemeMstr (SchemeID text null,SchemeName text null,SchemeApplicationID text null,SchemeAppliedRule text null);";
    private static final String DATABASE_CREATE_TABLE_203 = "create table tblSchemeSlabDetail (SchemeID text null,SchemeSlabID text null,SchemeSlabDesc text null,BenifitDescr text null);";
    private static final String DATABASE_CREATE_TABLE_204 = "create table tblSchemeSlabBucketDetails (RowID text null,SchemeID text null" +
            ",SchemeSlabID text null,BucketID text null,SubBucketID text null,SlabSubBucketType text null,SlabSubBucketValue text null,SubBucketValType text null);";
    private static final String DATABASE_CREATE_TABLE_205 = "create table tblSchemeSlabBucketProductMapping (RowID text null,ProductID text null);";
    private static final String DATABASE_CREATE_TABLE_206 = "create table tblSchemeSlabBenefitsBucketDetails (RowID text null," +
            "SchemeID text null,SchemeSlabID text null,BucketID text null,SubBucketID text null,BenSubBucketType text null," +
            "BenDiscApplied text null,CouponCode text null,BenSubBucketValue text null,Per real null,UOM real null,ProRata int null);";
    private static final String DATABASE_CREATE_TABLE_207 = "create table tblSchemeSlabBenefitsProductMappingDetail (RowID text null,ProductID text null);";
    private static final String DATABASE_CREATE_TABLE_208 = "create table tblSchemeSlabBenefitsValueDetail (RowID text null,BenValue text null,Remarks text null,Type text null);";
    private static final String DATABASE_CREATE_TABLE_209 = "create table tblProductRelatedScheme (ProductID text null,PrdString text null);";

    // Tables for New Schemes Structure
    private static final String DATABASE_CREATE_TABLE_211 = "create table tblStoreProductAppliedSchemesBenifitsRecords (StoreID text not null,ProductID int not null,schId int not null,schSlabId integer not null,schSlbBuckId integer not null,schSlabSubBucketValue real not null,schSubBucketValType integer not null,schSlabSubBucketType int not null,BenifitRowID integer not null,BenSubBucketType int null,FreeProductID int null,BenifitSubBucketValue real null,BenifitMaxValue real null,BenifitAssignedValue real null,BenifitAssignedValueType int null,BenifitDiscountApplied int null,BenifitCouponCode text null,Sstat integer not null,Per real null,UOM real null,WhatFinallyApplied int null,schSlbRowId int null,SchTypeId int null,DiscountPercentage real null,OrderIDPDA text null,TmpInvoiceCodePDA text null);";
    private static final String DATABASE_CREATE_TABLE_RETURNREASON = "create table tblGetReturnsReasonForPDAMstr(StockStatusId text not null,StockStatus text not null);";
    private static final String TABLE_tblDistributorDayReport="tblDistributorDayReport";
    private static final String TABLE_tblDistributorDayReportColumnsDesc="tblDistributorDayReportColumnsDesc";
    private static final String TABLE_tblDistributorSavedData="tblDistributorSavedData";
    private static final String TABLE_tblDistributorOldStockData="tblDistributorOldStockData";
    private static final String CREATE_TABLE_tblDistributorDayReport="create table tblDistributorDayReport(ProductNodeID text null, ProductNodeType text null, SKUName text null, FlvShortName text null,StockDate text null,DistributorNodeID int null,DistributorNodeType int null);";
    private static final String CREATE_TABLE_tblDistributorDayReportColumnsDesc="create table tblDistributorDayReportColumnsDesc(DistDayReportCoumnName text null, DistDayReportColumnDisplayName text null,DistributorNodeID int null,DistributorNodeType int null);";
    private static final String CREATE_TABLE_tblDistributorSavedData="create table tblDistributorSavedData(ProductName text null,ShortName text null,ProductID text null,Date text null,EnteredValue text null,DistribtrId int null,DistributorNodeType int null,ProductNodeType int null,StockDate text null,EntryType int null,StockPcsCaseType int null,Sstat int null);";
    private static final String CREATE_TABLE_tblDistributorOldStockData="create table tblDistributorOldStockData (DistribtrId text null,DistributorNodeType text null,DistribtrTag text null,EnteredValue text null);";
    private static final String DATABASE_CREATE_TABLE_231 = "create table tblSKUWiseDaySummary (AutoId int not null,ProductId text null," +
            "Product text null,MRP text null,Rate text null,NoofStores text null,OrderQty text null,FreeQty text null," +
            "DiscValue text null,ValBeforeTax text null,TaxValue text null,ValAfterTax text null,Lvl text null," +
            "Category text null,UOM text null);";
    private static final String DATABASE_CREATE_TABLE_232 = "create table tblStoreWiseDaySummary (AutoId int not null,Store text null," +
            "LinesperBill text null,StockValue text null,DiscValue text null,ValBeforeTax text null,TaxValue text null," +
            "ValAfterTax text null,Lvl text null);";
    private static final String DATABASE_CREATE_TABLE_233 = "create table tblStoreSKUWiseDaySummary (AutoId int not null,ProductId text null," +
            "Product text null,MRP text null,Rate text null,OrderQty text null,FreeQty text null," +
            "DiscValue text null,ValBeforeTax text null,TaxValue text null,ValAfterTax text null,Lvl text null,StoreId text null,StockQty text null);";
    private static final String DATABASE_CREATE_TABLE_234 = "create table tblAllSummary (AutoId int not null,Measures text null," +
            "TodaysSummary text null,MTDSummary text null);";
    private static final String DATABASE_CREATE_TABLE_11 = "create table tblPdaDate (PdaDate text null);";
    private static final String DATABASE_CREATE_TABLE_12 = "create table tblDayStartEndDetails (IMEINo text null,SyncTime text null,RouteID text null,EndTime text null,DayEndFlag int null,ChangeRouteFlg int null,ForDate text null,AppVersionID string null,Sstat int null,CycleId text null);";//,AppVersionID int null//, VersionNo string null
    private static final String DATABASE_CREATE_TABLE_13 = "create table tblStoreList(IMEINumber text null,AutoIdStore INTEGER PRIMARY KEY AUTOINCREMENT not null,StoreID text not null, StoreName string not null,OwnerName text null,StoreContactNo text null,StoreAddress text null,StoreType string not null,chainID integer null,StoreLatitude real not null, StoreLongitude real not null, LastVisitDate string not null, LastTransactionDate string not null, Sstat integer not null,ISNewStore int null,StoreRouteID int null,RouteNodeType int null,StoreCatNodeId int null,PaymentStage text null,flgHasQuote int null,flgAllowQuotation int null,flgGSTCapture text null,flgGSTCompliance text null,GSTNumber text null,flgGSTRecordFromServer int null,DistanceNear int null,flgStoreOrder int null,StoreCity text null,StorePinCode text  null,StoreState text null,OutStanding float null,OverDue float null,DBR text null,flgRuleTaxVal integer null,flgTransType integer null,StoreCatType text null,IsNewStoreDataCompleteSaved int null,StoreClose int null,SalesPersonName text null,SalesPersonContact text null,IsComposite int null,StoreStateID int null,StoreCityID int null,flgOrderType int not null);";//
    private static final String DATABASE_CREATE_TABLE_14 = "create table tblProductListMaster(CategoryID text not  null,ProductID text not  null, ProductShortName text not  null, DisplayUnit text not null, CalculateKilo real not  null,KGLiter string not null,CatOrdr int null,PrdOrdr int null,StoreCatNodeId int not null,SearchField text not null,ManufacturerID int null,RptUnitName text null,PerbaseUnit text null,HSNCode text null);";
    private static final String DATABASE_CREATE_TABLE_ProductSegementMap = "create table tblProductSegementMap(ProductID text not null,ProductMRP real not null, ProductRLP real not null, ProductTaxAmount real not null,RetMarginPer real not null,VatTax real not null,StandardRate real not null,StandardRateBeforeTax real not null,StandardTax real not null,BusinessSegmentId int not null,flgPriceAva int not null,flgWholeSellApplicable int  not null,PriceRangeWholeSellApplicable real null,StandardRateWholeSale real null,StandardRateBeforeTaxWholeSell real null,StandardTaxWholeSale real null);";

    //AutoId int null
    private static final String DATABASE_CREATE_TABLE_15 = "create table tblCategoryMaster (CategoryID text not null,CategoryDescr text not null,CatOrdr int null);";


    private static final String DATABASE_CREATE_TABLE_9 = "create table tblVisibilityMstr (VisibilityID text null, VisibilityDescr text null);";

    private static final String DATABASE_CREATE_TABLE_10 = "create table tblVisibilityDetails (StoreID text not null,VisibilityID text null, VisibilityStock text null,Sstat  integer not null);";
    private static final String DATABASE_CREATE_TABLE_16 = "create table tblNewStoreListEntries (StoreID text null, StoreCity text null, StorePinCode text not null, StoreState text null, ActiveRouteID text null, Sstat integer not null);";
    private static final String DATABASE_CREATE_TABLE_17 = "create table tblPDALastInvoiceDet (StoreID text null, InvoiceID text null, LastTransDate text not null, BalanceAmount text null,CreditPreviousDue real null);";
    private static final String DATABASE_CREATE_TABLE_18 = "create table tblPDATargetQtyForSecondPage (StoreID text null, ProductID text null, SKUShortName text not null, TargetQty text null);";

    //private static final String DATABASE_CREATE_TABLE_13 = "create table tblStoreList (StoreID text not null, StoreType string not null, StoreName string not null, StoreLatitude real not null, StoreLongitude real not null, LastVisitDate string not null, LastTransactionDate string not null, Sstat integer not null, ForDate string not null, ActualLatitude text null, ActualLongitude text null, VisitStartTS text null, VisitEndTS text null, ISNewStore int null, AutoIdStore int null, LocProvider text null, Accuracy text null, BateryLeftStatus text null,StoreRouteID text null);";
    private static final String DATABASE_CREATE_TABLE_19 = "create table tblPDAProductReturnMstr (AutoReturnIdMstr int null,StoreID text null, ReturnDate text null, Comment text null, TotalReturnQty int null, TotalReturnValue real null, Sstat integer null,TotalAdjustQty integer null,TotalAdjustValue real null,FinalBalanceAmount real null,LastCreditAmount real null,OrderIDPDA text not null,TmpInvoiceCodePDA text null);";

    //private static final String DATABASE_CREATE_TABLE_2 = "create table tblProductListMaster (ProductID text not null, ProductShortName text not null, ProductMRP real not null, ProductRLP real not null, ProductTaxAmount real not null, KGLiter string nulll);";//,DisplayUnit string nul
    private static final String DATABASE_CREATE_TABLE_20 = "create table tblPDAProductReturnDetails (AutoReturnDetailsId int null,ReturnIdMstr int null, ProductId text null, ProdReturnQty text null, ProdRate real null, ProdReturnValue real null, ProdReturnReason text null, ProdReturnReasonDescr text null, ProdLastOrderDate text null, ProdLastOrderQyt text null, Sstat integer null,AdjustReturnQty integer null,AdjustReturnValue real null,TmpInvoiceCodePDA text null);";

    //private static final String DATABASE_CREATE_TABLE_ProductSegementMap = "create table tblProductSegementMap(ProductID text  null,ProductMRP real not null, ProductRLP real not null, ProductTaxAmount real not null,RetMarginPer real null,VatTax real null,StandardRate real null,StandardRateBeforeTax real null,StandardTax real null,BusinessSegmentId int null,flgPriceAva int null);";
    private static final String DATABASE_CREATE_TABLE_31 = "create table tblTransac (IMEIno text not null, TransDate string not null, StoreID text not null, ProdID text not null, Stock integer not null, OrderQty integer not null, OrderVal real not null, FreeQty integer not null, DisVal real not null, SchemeID text null, AppliedSlab text null, AppliedAbsVal text null, Sstat integer not null, SampleQuantity int null, ProductShortName text null, ProductPrice real null,RouteID int null,CatID text  null);";//, DisplayUnit text null
    private static final String DATABASE_CREATE_TABLE_StoreProductMap = "create table tblStoreProductMap (StoreID text  null,ProductID text  null, ProductMRP real  null, ProductRLP real  null, ProductTaxAmount real  null, DistributorPrice real null,CategoryID integer null);";

    //private static final String DATABASE_CREATE_TABLE_5 = "create table tblCategoryQuestionInformation (CategoryID text null,ProductID text null, Stock text null,Sstat integer not null,StoreID text not null);";

    //private static final String DATABASE_CREATE_TABLE_7 = "create table tblDistributionStoreProductWiseDetails (CatId integer not null,ProductID integer not null,StoreID text not null,Stock text null,ProductMfgDate text null,Sstat integer not null);";
    private static final String DATABASE_CREATE_TABLE_51 = "create table tblSchemeList (SchemeID text not null, SchemeName string not null, SchemeType string not null, StoreType string null, CombTypeID integer null,flgDiscountType integer null);";
    private static final String DATABASE_CREATE_TABLE_52 = "create table tblSchemeDetails (SchemeDetID text not null, SchemeID text not null, SlabFrom integer not null, SlabTo integer not null, FreeQuantity integer not null, Discount real not null, FreeProductID text null);";
    private static final String DATABASE_CREATE_TABLE_53 = "create table tblschemeStoreTypeMap (SchemeID text not null, StoreTypeID integer not null);";
    private static final String DATABASE_CREATE_TABLE_54 = "create table tblschemeProductMap (SchemeID text not null, ProductID text not null, SchemeType int null);";
    private static final String DATABASE_CREATE_TABLE_55 = "create table tblspForPDASchemeApplicableList(SchemeID string null, StoreType string null, SchemeDesc string null,flgSpecialScheme integer null);";
    private static final String DATABASE_CREATE_TABLE_56 = "create table tblPDAIsSchemeApplicable (IsSchemeApplicable int null);";
    private static final String DATABASE_CREATE_TABLE_61 = "create table tblLastTransactionDetails (StoreID text not null, ProductID text not null, LastTransDate string not null, Quantity integer not null, SampleQuantity int null,CategoryID integer null);";
    private static final String DATABASE_CREATE_TABLE_62 = "create table tblPDALastTranDateForSecondPage(StoreID text null, LastTransDate string null, RetailerName string null, SKUName string null, Stock string null, OrderQty string null, FreeQty string null);";

    //private static final String DATABASE_CREATE_TABLE_31 = "create table tblTransac (IMEIno text not null, TransDate string not null, StoreID text not null, ProdID text not null, OrderQty integer not null, OrderVal real not null, Sstat integer not null,ProductMRP real not null,TaxRate real not null);";
    //private static final String DATABASE_CREATE_TABLE_32 = "create table tblTmpInvoiceHeader (IMEIno text not null, StoreID text not null, InvoiceDate string not null,  TaxAmt real not null,  InvoiceVal real not null,GrossVal real not null,  Sstat integer not null, AmtColl real null, AmtOut real null);";



    //private static final String DATABASE_CREATE_TABLE_StoreProductMap = "create table tblSIMEInotoreProductMap (StoreID text  null,ProductID text  null, ProductMRP real  null, ProductRLP real  null, ProductTaxAmount real  null, DistributorPrice real null);";
    private static final String DATABASE_CREATE_TABLE_63 = "create table tblStorTypeMstr(ID string null, Descr string null);";
    private static final String DATABASE_CREATE_TABLE_71 = "create table tblSyncSummuryDetails (ActualCalls int null,ProductiveCalls int null, TotSalesValue text null, TotKGSales text null, TotFreeQtyKGSales text null, TotSampleKGSales text null, TotLTSales text null, TotFreeQtyLTSales text null, TotSampleLTSales text null, TotDiscountKGSales text null, TotDiscountLTales text null,Lines int null);";
    private static final String DATABASE_CREATE_TABLE_72 = "create table tblSyncSummuryForProductDetails (SkuName text null,OrderQty text null, FreeQty text null, SampleQty text null, TotalOrderKgs text null, TotalFreeKgs text null, TotalSampleKgs text null, TotalSales text null,Lines int null,OrderVal text null,DisVal text null,ProductPrice text null);";
    private static final String DATABASE_CREATE_TABLE_81 = "create table tblStrachApplicableOnScheme (SchID int null, flgIsStrachApplicable int null);";
    private static final String DATABASE_CREATE_TABLE_82 = "create table tblStrachOnSchemeDetails (SchID int null, cardStrachID int null, Slab int Null, Qty int null, ProductValueOrSlabBased int null);";
    private static final String DATABASE_CREATE_TABLE_91 = "create table tblOutLetInfoOnQuadVolumeCategoryBasis (OutID text null,OutletName text  null," +
            " OwnerName text  null,ContactNo text null,MarketAreaName text null,Latitude text null,Longitutde text null);";
    private static final String DATABASE_CREATE_TABLE_92 = "create table tblSelectedStoreIDinChangeRouteCase (StoreID text null);";
    private static final String DATABASE_CREATE_TABLE_94 = "create table tblSysVisitID (IMEINo text null,SysVisitID int null );";
    private static final String DATABASE_CREATE_tblDaySummaryNew = "create table tblDaySummaryNew (TargetCalls int null,ActualCallOnRoute int null,ActualCallOffRoute int null,ProdCallOnRoute int null,ProdCallOffRoute real null,TargetSalesForDay real null,TotalSalesForDay real null,CallsRemaining int null,TargetSalesMTD real null,AchievedSalesMTD real null,ProdStoresMTD int null,RunRate real null);";//, AutoIdOutlet int null
    private static final String DATABASE_CREATE_TABLE_101 = "create table tblFirstOrderDetailsOnLastVisitDetailsActivity(StoreID text null,Date text null,SKUID text null,OrderQty integer null,FreeQty integer null,Stock integer null,SKUName text null);";
    private static final String DATABASE_CREATE_TABLE_102 = "create table tblSecondVisitDetailsOnLastVisitDetailsActivity(StoreID text null,Date text null,SKUID text  null,OrderQty integer null,SKUName text null);";
    private static final String DATABASE_CREATE_TABLE_103 = "create table tblPDAGetLODQty(StoreID text not null,Date text null,SKUID text not null,Qty integer null,SKUName text not null);";
    private static final String DATABASE_CREATE_TABLE_111 = "create table tblPendingInvoices(StoreID integer null," +
            "StoreName text null,RouteId integer null,RouteNodeType integer null,RouteName text null,DistId integer null,DistName text null," +
            "InvoiceForDate text null,flgSubmit integer null,Sstat integer not null,IMEIno text not null,OrderID text  null,flgCancel int null,ServerOrdersFlg int null);";
    private static final String DATABASE_CREATE_TABLE_112 = "create table tblInvoiceExecutionProductList (ProductId integer null, ProductName text null);";
    private static final String DATABASE_CREATE_TABLE_113 = "create table tblProductWiseInvoice (StoreID integer not null," +
            " ProductID integer not null,OrderQty integer not null,ProductPrice real not null,InvoiceForDate text null,OrderID integer not null,CatID integer not null,Freeqty integer not null,TotLineDiscVal real null);";
    private static final String DATABASE_CREATE_TABLE_114 = "create table tblInvoiceButtonTransac (IMEIno text not null, " +
            "TransDate string not null, StoreID text not null, ProdID text not null, OrderQty integer not null, " +
            "DelQty integer not null,FreeQty integer not null,Sstat integer not null,ProductShortName text null, ProductPrice real null," +
            "RouteID int null,OrderID text  null,CatID text null,flgCancel int null,DiscountVal real null,additionalDiscount text null);";
    private static final String DATABASE_CREATE_TABLE_141 = "create table tblPDAGetLastVisitDate(StoreID text not null,VisitDate text not null,flgOrder text null);";


    // private static final String DATABASE_CREATE_tblDaySummary = "create table tblDaySummary (StoreID text null,flgTarget int null,flgActualVisited int null,flgProductiveDay int null,flgProductiveMTD int null,DaySales real null,MTDSales real null);";//, AutoIdOutlet int null
    private static final String DATABASE_CREATE_TABLE_142 = "create table tblPDAGetLastOrderDate(StoreID text not null,OrderDate text not null,flgExecutionSummary text not null);";
    private static final String DATABASE_CREATE_TABLE_143 = "create table tblPDAGetLastVisitDetails(StoreID text not null,Date123 text null,Order123 text null,Stock text null,SKUName text not null,ExecutionQty text null,ProductID text not null);";
    //private static final String DATABASE_CREATE_TABLE_143 = "create table tblPDAGetLastVisitDetails(StoreID text null,Date123 text null,Order123 text null,Stock text null,SKUName text null,ExecutionQty text null);";

    private static final String DATABASE_CREATE_TABLE_144 = "create table tblPDAGetLastOrderDetails(StoreID text not null,OrderDate text not null,ProductID text not null,OrderQty text not null,FreeQty text null,PrdName text null,ExecutionQty text null);";
    private static final String DATABASE_CREATE_TABLE_145 = "create table tblPDAGetLastOrderDetailsTotalValues(StoreID text not null,OrderValue text not null,ExecutionValue text null);";
    private static final String DATABASE_CREATE_TABLE_146 = "create table tblPDAGetExecutionSummary(StoreID text not null,OrderDate text not null,ProductID text not null,OrderQty text not null,flgInvStatus text not null,ProductQty text not null,PrdName text not null);";
    private static final String DATABASE_CREATE_TABLE_147 = "create table tblStoreSchemeFreeProQtyOtherDetails(StoreID text null,StoreType text null,SchemeID text null,SchemeType string not null,CombTypeID integer null,flgDiscountType integer null,FreeProductID text null,FreeProductQty text null,Discount real not null);";
    private static final String DATABASE_CREATE_TABLE_151 = "create table tblProductListForAvailableStock (ProductID text  null, ProductName text  null);";
    private static final String DATABASE_TABLE_MAIN261 = "tblManagerMstr";

    //private static final String DATABASE_CREATE_TABLE_115 = "create table tblPdaDate (PdaDate text null);";
    private static final String DATABASE_TABLE_MAIN262 = "tblSelectedManagerDetails";
    private static final String DATABASE_CREATE_TABLE_261 = "create table tblManagerMstr(PersonID text not null,PersonType text not null,PersonName text not null,ManagerID text not null,ManagerType text not null,ManagerName text not null);";
    private static final String DATABASE_CREATE_TABLE_262 = "create table tblSelectedManagerDetails(IMEI text null,CurDate text null,PersonID text null,PersonType text null" +
            ",PersonName text null,ManagerID text null,ManagerType text null,ManagerName text null,OtherName text null,Sstat integer not null);";
    //store close info
    private static final String DATABASE_TABLE_tblStoreCloseLocationDetails = "tblStoreCloseLocationDetails";
    private static final String DATABASE_CREATE_TABLE_tblStoreCloseLocationDetails = "create table tblStoreCloseLocationDetails (StoreID text null,Lattitude text null,Longitude text null,Accuracy text null,Address text null,City text null,Pincode text null,State text null,fnAccurateProvider  text null,GpsLat  text null,GpsLong  text null,GpsAccuracy  text null,NetwLat  text null,NetwLong  text null,NetwAccuracy  text null,FusedLat  text null,FusedLong  text null,FusedAccuracy  text null,AllProvidersLocation  text null,GpsAddress  text null,NetwAddress  text null,FusedAddress  text null,FusedLocationLatitudeWithFirstAttempt  text null,FusedLocationLongitudeWithFirstAttempt  text null,FusedLocationAccuracyWithFirstAttempt  text null,Sstat int null,StoreVisitCode text null);";
    private static final String DATABASE_TABLE_tblStoreClosedPhotoDetail = "tblStoreClosedPhotoDetail";
    private static final String DATABASE_CREATE_TABLE_tblStoreClosedPhotoDetail = "create table tblStoreClosedPhotoDetail (StoreID text null,ClickedDateTime text null,PhotoName text null,PDAPhotoPath text null,Sstat integer null,StoreVisitCode text null);";
    private static final String DATABASE_TABLE_tblStoreCloseReasonMaster = "tblStoreCloseReasonMaster";
    //private static final String DATABASE_CREATE_TABLE_152 = "create table tblCategoryMaster (CategoryID text not null,CategoryDescr text null);";
    private static final String DATABASE_CREATE_TABLE_tblStoreCloseReasonMaster = "create table tblStoreCloseReasonMaster (CloseReasonID int not null,CloseReasonDescr text not null);";
    private static final String DATABASE_TABLE_tblStoreCloseReasonSaving = "tblStoreCloseReasonSaving";
    private static final String DATABASE_CREATE_TABLE_tblStoreCloseReasonSaving = "create table tblStoreCloseReasonSaving (StoreID text null,ReasonID text null,ReasonDescr text null,Sstat integer null,StoreVisitCode text null);";
    public static String DATABASE_NAME = CommonInfo.DATABASE_NAME;
    public static int DATABASE_VERSION = CommonInfo.DATABASE_VERSIONID;
    public static String AppVersionID = CommonInfo.AppVersionID.trim();
    public static int Application_TypeID = CommonInfo.Application_TypeID; //1=Parag Store Mapping,2=Parag SFA Indirect,3=Parag SFA Direct
    private static String DATABASE_CREATE_TABLE_tblIncentiveDetailsData="";
    private static String DATABASE_CREATE_TABLE_tblIncentivePastDetailsData="";
    private final Context context;
    private static Context contextForRecreate;
    public static Cursor cursor;
    public static int checkNumberOfStore=1;
    Locale locale  = new Locale("en", "UK");
    String pattern = "###.##";
    DecimalFormat decimalFormat = (DecimalFormat)NumberFormat.getNumberInstance(locale);
    private boolean isDBOpenflag = false;
    private static DatabaseHelper DBHelper;
    private static SQLiteDatabase db;


  /*  // ---opens the database---
    public PRJDatabase open() throws SQLException {
        db = DBHelper.getWritableDatabase();
        isDBOpenflag = true;
        return this;
    }*/

        public boolean isDBOpen() {
            this.isDBOpenflag = false;
            return this.isDBOpenflag;
        }

    // ---closes the database---
  /*  public void close() {
        DBHelper.close();
    }*/

    public static void saveOutletChammetQstnIdGrpId(int grpQstId,int qstId,String optId,int section_count)
    {
     ContentValues values=new ContentValues();
        values.put("GrpQstId", grpQstId);
        values.put("QuestID", qstId);
        values.put("OptID", optId);
        values.put("SectionCount", section_count);
        gblQuestIDForOutChannel=qstId;
        db.insert(TABLE_QSTOUTCHANNEL, null, values);

    }


    // function for new store master data start

    public static void savetblQuestIDForName(int id,int grpQstId,int qstId,String QuestDesc)
    {
  /*private static final String TABLE_QSTOUTCHANNEL = "tblQuestIDForOutChannel";
   private static final String TABLE_QST_NAME = "tblQuestIDForName";
    private static final String DATABASE_CREATE_TABLE_QSTOUTCHANNEL = "create table tblGetPDAQuestOptionMstr(GrpQstId int null,QuestID int null);";
    private static final String DATABASE_CREATE_TABLE_QST_NAME = "create table tblGetPDAQuestOptionMstr(GrpQstId int null,QuestID int null);";*/
        ContentValues values=new ContentValues();
        values.put("ID", id);
        values.put("QuestID", qstId);
        values.put("GrpQstId", grpQstId);
        values.put("QuestDesc", QuestDesc);
        db.insert(TABLE_QST_NAME, null, values);

    }


    public static void savetblPDAQuestOptionValuesDependentMstr(int DepQstId,String DepAnswValId ,int QstId,String AnswValId,String OptDescr,int Sequence,int GrpQuestID,int GrpDepQuestID)
    {

        ContentValues values=new ContentValues();
        values.put("DepQstId", DepQstId);
        values.put("DepAnswValId", DepAnswValId);
        values.put("QstId", QstId);
        values.put("AnswValId", AnswValId);
        values.put("OptDescr", OptDescr);
        values.put("Sequence", Sequence);
        values.put("GrpQuestID", GrpQuestID);
        values.put("GrpDepQuestID", GrpDepQuestID);
        db.insert(TABLE_QuestOptionValuesDependentMstr, null, values);

    }

    public static void Delete_tblMessageTextFileContainer()
    {
        db.execSQL("DELETE FROM tblMessageTextFileContainer");
    }


    // function for new store master data end

    public static void Delete_tblDsrRegDetails()

    {
        db.execSQL("DELETE FROM tblDsrRegDetails");
    }

    public static void Delete_tblUserRegistarationStatus()

    {
        db.execSQL("DELETE FROM tblUserRegistarationStatus");
    }

    //tblStockUploadedStatus
    public static void Delete_tblStockUploadedStatus()

    {
        db.execSQL("DELETE FROM tblStockUploadedStatus");
    }

    public static int countNumberOFTextFile()  throws IOException
    {
        // int entryCount;sdfsfsf

        Cursor cursorE2 = db.rawQuery("SELECT Count(*) from tblMessageTextFileContainer where FileFlag=0", null);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    public static String[] returnTextFileName()
    {

        String qry="select FileName from tblMessageTextFileContainer where FileFlag=0";
        Cursor cur = db.rawQuery(qry,null);
        String TextFileUpload[]= new String[cur.getCount()];
        try {
            if(cur.moveToFirst())
            {
                //for(int i=0;i<cur.getCount();i++)
                for(int i=0;i<cur.getCount();i++)
                {
                    TextFileUpload[i]= (String) cur.getString(0).toString();
                    cur.moveToNext();

                }


            }
            return TextFileUpload;
        } finally {
            cur.close();
        }
    }

    public static void upDateTextFileFlag(String FileName, int FileFlag) {

        try {

            //initialValues.put("FileName", FileName);
            //initialValues.put("FileFlag", FileFlag);

            final ContentValues values = new ContentValues();
            values.put("FileFlag", FileFlag);

            int affected = db.update("tblMessageTextFileContainer", values, "FileName=?",
                    new String[] {FileName});

            Log.w(TAG, "Record(s) Updated..");

        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }

    public static void deleteTextFileRow(String fileName)
    {

        db.execSQL("DELETE FROM tblMessageTextFileContainer WHERE FileName ='" + fileName +"'");
    }

    public static void deleteViewAddedStore()
    {
        //open();
        db.execSQL("DELETE FROM tblViewOutletQuestAnsMstr");
        db.execSQL("DELETE FROM tblViewOutletNameAndId");
       // close();
    }

    public static void deleteAllSingleCallWebServiceTable()
    {
        //open();
        db.execSQL("DELETE FROM tblNewStoreSalesQuotePaymentDetails");

        db.execSQL("DELETE FROM tblGetPDAQuestMstr");
        db.execSQL("DELETE FROM tblOutletChannelBusinessSegmentMaster");
        db.execSQL("DELETE FROM tblGetPDAQuestOptionMstr");
        db.execSQL("DELETE FROM tblPDAQuestOptionDependentMstr");
        db.execSQL("DELETE FROM tblPDAQuestOptionValuesDependentMstr");
        //db.execSQL("DELETE FROM tblLatLongDetails");
        //  db.execSQL("DELETE FROM tblOutletMstr");
        //  db.execSQL("DELETE FROM tblOutletQuestAnsMstr");

      /*  db.execSQL("DELETE FROM tblStoreList WHERE Sstat ="+ 4);
        db.execSQL("DELETE FROM tblOutletQuestAnsMstr WHERE Sstat ="+ 4);

        db.execSQL("DELETE FROM tblNewAddedStoreLocationDetails WHERE Sstat ="+ 4);


        db.execSQL("DELETE FROM tblOutletPhotoDetail WHERE Sstat ="+ 4);*/




        //  db.execSQL("DELETE FROM tblOutletPhotoDetail");
        //db.execSQL("DELETE FROM tblAvailableVersion");
        db.execSQL("DELETE FROM tblGetPDAQuestionDependentMstr");
        db.execSQL("DELETE FROM tblGetPDAQuestGrpMapping");
        db.execSQL("DELETE FROM tblGetReturnsReasonForPDAMstr");

        // db.execSQL("DELETE FROM tblViewOutletNameAndId");

        db.execSQL("DELETE FROM tblsameLocationForStoreRestartDone");

        //close();
    }

    public static void deleteAllSingleCallWebServiceTableWhole()
    {
        //open();
        //db.execSQL("DELETE FROM tblNewStoreSalesQuotePaymentDetails");

        //db.execSQL("DELETE FROM tblGetPDAQuestMstr");
        //db.execSQL("DELETE FROM tblOutletChannelBusinessSegmentMaster");
        //db.execSQL("DELETE FROM tblGetPDAQuestOptionMstr");
        //db.execSQL("DELETE FROM tblPDAQuestOptionDependentMstr");
        //db.execSQL("DELETE FROM tblPDAQuestOptionValuesDependentMstr");
        //db.execSQL("DELETE FROM tblLatLongDetails");
        //  db.execSQL("DELETE FROM tblOutletMstr");
        //  db.execSQL("DELETE FROM tblOutletQuestAnsMstr");

        //db.execSQL("DELETE FROM tblStoreList");
        //	db.execSQL("DELETE FROM tblOutletQuestAnsMstr");


       // db.execSQL("DELETE FROM tblOutletPhotoDetail");




        //  db.execSQL("DELETE FROM tblOutletPhotoDetail");
        //db.execSQL("DELETE FROM tblAvailableVersion");
        //db.execSQL("DELETE FROM tblGetPDAQuestionDependentMstr");
        //db.execSQL("DELETE FROM tblGetPDAQuestGrpMapping");
        //db.execSQL("DELETE FROM tblGetReturnsReasonForPDAMstr");

        // db.execSQL("DELETE FROM tblViewOutletNameAndId");

        db.execSQL("DELETE FROM tblsameLocationForStoreRestartDone");

       // close();
    }

    public static long savetblSKUWiseDaySummary(int AutoId,String ProductId, String Product, String MRP,
                                         String Rate, String NoofStores, String OrderQty, String FreeQty,String DiscValue,
                                         String ValBeforeTax, String  TaxValue,String ValAfterTax,String Lvl,String Category,String UOM)
    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("AutoId", AutoId);
        initialValues.put("ProductId", ProductId.trim());
        initialValues.put("Product", Product.trim());
        initialValues.put("MRP", MRP.trim());
        initialValues.put("Rate", Rate.trim());
        initialValues.put("NoofStores", NoofStores.trim());
        initialValues.put("OrderQty", OrderQty.trim());
        initialValues.put("FreeQty", FreeQty.trim());
        initialValues.put("DiscValue", DiscValue.trim());

        initialValues.put("ValBeforeTax", ValBeforeTax.trim());
        initialValues.put("TaxValue", TaxValue.trim());
        initialValues.put("ValAfterTax", ValAfterTax.trim());
        initialValues.put("Lvl", Lvl.trim());
        initialValues.put("Category", Category.trim());
        initialValues.put("UOM", UOM.trim());

        //// System.out.println("Value inserting by sunil Table 231..");

        return db.insert(DATABASE_TABLE_MAIN231, null, initialValues);
    }


	/* private static final String DATABASE_CREATE_TABLE_231 = "create table tblSKUWiseDaySummary (AutoId int not null,ProductId text null," +
		 		"Product text null,MRP text null,Rate text null,NoofStores text null,OrderQty text null,FreeQty text null," +
		 		"DiscValue text null,ValBeforeTax text null,TaxValue text null,ValAfterTax text null,Lvl text null," +
		 		"Category text null,UOM text null);";*/

    // change by sunil for Summary Report

    public static int checkCountIntblSalesQuotePersonMeetMstr(String  StoreId)
    {

        Cursor cursor = db.rawQuery("SELECT Count(*) FROM tblSalesQuotePersonMeetMstr WHERE  StoreId ='"+ StoreId + "'", null);

        try {

            int check=0;

            if (cursor.getCount() > 0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        check=1;
                        cursor.moveToNext();
                    }
                }

            }
            return check;

        } finally {
            cursor.close();
        }

    }

    public static long savetbltblUOMMstr(String UOMID,String UOM)
    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("UOMID", UOMID.toString().trim());
        initialValues.put("UOM", UOM.toString().trim());

        return db.insert(DATABASE_TABLE_UOMMstr, null, initialValues);
    }

    public static long saveSalesQuotePrcsMstr(String SalesQuotePrcsId,String SalesQuotePrcs)
    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("SalesQuotePrcsId", SalesQuotePrcsId.toString().trim());
        initialValues.put("SalesQuotePrcs", SalesQuotePrcs.toString().trim());

        return db.insert(DATABASE_TABLE_SalesQuotePrcsMstr, null, initialValues);
    }

    public static long SavetblSalesQuotePaymentModeMstr(String PymtModeId,String PymtMode)
    {
        ContentValues initialValues= new ContentValues();

        initialValues.put("PymtModeId", PymtModeId.toString().trim());
        initialValues.put("PymtMode", PymtMode.toString().trim());

        return db.insert(DATABASE_TABLE_tblSalesQuotePaymentModeMstr, null, initialValues);
    }

    public static long SavetblSalesQuotePaymentStageMstr(String PymtStageId,String PymtStage, String PymtModeId)
    {
        ContentValues initialValues= new ContentValues();

        initialValues.put("PymtStageId", PymtStageId.toString().trim());
        initialValues.put("PymtStage", PymtStage.toString().trim());
        initialValues.put("PymtModeId", PymtModeId.toString().trim());

        return db.insert(DATABASE_TABLE_tblSalesQuotePaymentStageMstr, null, initialValues);
    }

    //surbhi
    public static long SavetblSalesQuoteTypeMstr(String SalesQuotetypeId	, String SalesQuoteType)
    {
        ContentValues initialValues=new ContentValues();

        initialValues.put("SalesQuotetypeId", SalesQuotetypeId);
        initialValues.put("SalesQuoteType", SalesQuoteType);

        return db.insert(DATABASE_TABLE_tblSalesQuoteTypeMstr, null, initialValues);
    }

    public static long SavetblSalesQuotePaymentStageModeMapMstr(String PymtStageId, String PymtModeId )
    {
        ContentValues initialValues=new ContentValues();

        initialValues.put("PymtStageId", PymtStageId);
        initialValues.put("PymtModeId", PymtModeId);

        return db.insert(DATABASE_TABLE_tblSalesQuotePaymentStageModeMapMstr, null, initialValues);
    }

    public static LinkedHashMap<String, String> fnGettblUOMMstr()
    {
        LinkedHashMap<String, String> hmapQuestionMstr=new LinkedHashMap<String, String>();
        //open();
        // Cursor cursor = db.rawQuery("SELECT SST_NameId,SST_Name_des from tbl_SST_NameMstr Order By Sequence ASC  ", null);// Where PNodeID='"+TSIID+"'

        // (String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString()+"^"+(String) cursor.getString(2).toString()+"^"+(String) cursor.getString(3).toString()+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(5).toString()+"^"+(String) cursor.getString(6).toString()+"^"+(String) cursor.getString(7).toString()+"^"+(String) cursor.getString(8).toString()+"^"+(String) cursor.getString(9).toString()+"^"+(String) cursor.getString(10).toString()
        // close();
        try {
            Cursor cursor = db.rawQuery("SELECT UOMID,UOM from tblUOMMstr   ", null);// Where PNodeID='"+TSIID+"'
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapQuestionMstr.put((String) cursor.getString(1).toString(),(String) cursor.getString(0).toString());
                        //    System.out.println("QuestID:"+(String)cursor.getString(0).toString()+"QuestCode:"+(String) cursor.getString(1).toString()+"QuestDesc:"+(String) cursor.getString(2).toString()+"QuestType:"+(String) cursor.getString(3).toString()+"AnsControlType:"+(String) cursor.getString(4).toString()+"AnsControlInputTypeID:"+(String) cursor.getString(5).toString()+"AnsControlInputTypeMaxLength:"+(String) cursor.getString(6).toString()+"AnsMustRequiredFlg:"+(String) cursor.getString(7).toString()+"QuestBundleFlg:"+(String) cursor.getString(8).toString()+"ApplicationTypeID:"+(String) cursor.getString(9).toString()+"Sequence:"+(String) cursor.getString(10).toString());
                        cursor.moveToNext();
                    }
                }
            }

        }
        catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= "+e.toString());
        }
        finally
        {

            //close();
            return hmapQuestionMstr;
        }
    }

    public static String  fngettblSalesQuotePersonMeetMstr(String SalesQuoteId)
    {
        String flag="0";
        try {
            //open();
            Cursor cursor = db.rawQuery("SELECT SalesQuotePrcsId,SalesQuotePrcs,SalesQuoteValidFrom,SalesQuoteValidTo,SalesQuoteType from tblSalesQuotePersonMeetMstr where SalesQuoteId = '"+SalesQuoteId +"'", null);

            if(cursor.getCount()>0){
                if (cursor.moveToFirst()){
                    flag=	cursor.getString(0).toString()+"^"+cursor.getString(1).toString()+"^"+cursor.getString(2).toString()+"^"+cursor.getString(3).toString()+"^"+cursor.getString(4).toString();
                }

            }
            return flag;
        }catch(Exception e)
        {

        }

        finally
        {

            //close();
            return flag;
        }
    }

    public static long SalesQuoteProductsMstr(String SalesQuoteId,String Row_No,String PrdId,String StandardRate,String StandardRateBeforeTax,String RateOffer,String InclusiveTax,String ValidFrom,String ValidTo,String MinDlvryQty,String UOMID ,String Remarks,String LastTranscRate,String ProductTaxRateBK)
    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("SalesQuoteId", SalesQuoteId.toString().trim());
        initialValues.put("Row_No", Row_No.toString().trim());
        initialValues.put("PrdId", PrdId.toString().trim());
        initialValues.put("StandardRate", StandardRate.toString().trim());
        initialValues.put("StandardRateBeforeTax", StandardRateBeforeTax.toString().trim());
        initialValues.put("RateOffer", RateOffer.toString().trim());
        initialValues.put("InclusiveTax", InclusiveTax.toString().trim());
        initialValues.put("ValidFrom", ValidFrom.toString().trim());
        initialValues.put("ValidTo", ValidTo.toString().trim());
        initialValues.put("MinDlvryQty", MinDlvryQty.toString().trim());
        initialValues.put("UOMID", UOMID.toString().trim());
        initialValues.put("Remarks", Remarks.toString().trim());
        initialValues.put("LastTranscRate", LastTranscRate.toString().trim());
        initialValues.put("TaxRate", ProductTaxRateBK.toString().trim());
        initialValues.put("Sstat", "1");

        //LastTranscRate

        return db.insert(DATABASE_TABLE_SalesQuoteProductsMstr, null, initialValues);
    }

    public static void deleteAllQuotationTables()
    {

        db.execSQL("DELETE FROM tblUOMMstr");
        db.execSQL("DELETE FROM tblSalesQuotePrcsMstr");
        db.execSQL("DELETE FROM tblSalesQuotePersonMeetMstr");
        db.execSQL("DELETE FROM tblSalesQuoteProductsMstr");
        db.execSQL("DELETE FROM tblSalesQuotePaymentModeMstr");
        db.execSQL("DELETE FROM tblSalesQuotePaymentStageMstr");
        db.execSQL("DELETE FROM tblSalesQuoteTypeMstr");
        db.execSQL("DELETE FROM tblSalesQuotePaymentStageModeMapMstr");
        db.execSQL("DELETE FROM tblSalesQuoteSponsorMstr");
        db.execSQL("DELETE FROM tblManufacturerMstrMain");

    }

    public static void deletetblSalesQuoteProductsMstr(String PrdId,String SalesQuoteId)
    {

        db.execSQL("DELETE FROM tblSalesQuoteProductsMstr WHERE PrdId ='" + PrdId +"' and SalesQuoteId='"+SalesQuoteId+"' ");
    }

    public static void deletetblRateDistribution(String SalesQuoteId,String StoreId)
    {

        db.execSQL("DELETE FROM tblRateDistribution WHERE SalesQuoteId ='" + SalesQuoteId +"' and StoreId='"+StoreId+"' ");
    }

    public static String[] fetchAllDataFromtblSKUWiseDaySummary()
    {
        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT *  FROM tblSKUWiseDaySummary", null);
        try {
            String allData[]=new String[cursor.getCount()];
            if (cursor.moveToFirst()) {

                for (int i = 0; i < cursor.getCount(); i++)
                {
                    ScodecolumnIndex = 1;
                    allData[i] = (String) cursor.getString(0).toString().trim()+"^"+(String) cursor.getString(1).toString().trim()+"^"+(String) cursor.getString(2).toString().trim()+"^"+(String) cursor.getString(3).toString().trim()+"^"+(String) cursor.getString(4).toString().trim()+"^"+(String) cursor.getString(5).toString().trim()+"^"+(String) cursor.getString(6).toString().trim()+"^"+(String) cursor.getString(7).toString().trim()+"^"+(String) cursor.getString(8).toString().trim()+"^"+(String) cursor.getString(9).toString().trim()+"^"+(String) cursor.getString(10).toString().trim()+"^"+(String) cursor.getString(11).toString().trim()+"^"+(String) cursor.getString(12).toString().trim()+"^"+(String) cursor.getString(13).toString().trim()+"^"+(String) cursor.getString(14).toString().trim();
                    //// System.out.println("Value inserting 231 fetching :"+allData[i]);
                    cursor.moveToNext();
                    // cursor.close();
                }

            }
            ////// System.out.println("value  of new store is in DBadapter"+ScodecolumnIndex);
            return allData;
        } finally {
            cursor.close();
        }

    }

    public static long savetblStoreWiseDaySummary(int AutoId,String Store, String LinesperBill, String StockValue,
                                           String DiscValue, String ValBeforeTax, String TaxValue, String ValAfterTax,String Lvl)
    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("AutoId", AutoId);
        initialValues.put("Store", Store.trim());
        initialValues.put("LinesperBill", LinesperBill.trim());
        initialValues.put("StockValue", StockValue.trim());
        initialValues.put("DiscValue", DiscValue.trim());
        initialValues.put("ValBeforeTax", ValBeforeTax.trim());
        initialValues.put("TaxValue", TaxValue.trim());
        initialValues.put("ValAfterTax", ValAfterTax.trim());
        initialValues.put("Lvl", Lvl.trim());

        ////// System.out.println("inserting records in StoreList table..");

        return db.insert(DATABASE_TABLE_MAIN232, null, initialValues);
    }



	/* private static final String DATABASE_CREATE_TABLE_232 = "create table tblStoreWiseDaySummary (AutoId int not null,Store text null," +
		 		"LinesperBill text null,StockValue text null,DiscValue text null,ValBeforeTax text null,TaxValue text null," +
		 		"ValAfterTax text null,Lvl text null);";*/

    public static String[] fetchAllDataFromtblStoreWiseDaySummary()
    {

        Cursor cursor = db.rawQuery("SELECT *  FROM tblStoreWiseDaySummary", null);
        try {
            String allData[]=new String[cursor.getCount()];
            if (cursor.moveToFirst()) {

                for (int i = 0; i < cursor.getCount(); i++)
                {

                    allData[i] = (String) cursor.getString(0).toString().trim()+"^"+(String) cursor.getString(1).toString().trim()+"^"+(String) cursor.getString(2).toString().trim()+"^"+(String) cursor.getString(3).toString().trim()+"^"+(String) cursor.getString(4).toString().trim()+"^"+(String) cursor.getString(5).toString().trim()+"^"+(String) cursor.getString(6).toString().trim()+"^"+(String) cursor.getString(7).toString().trim()+"^"+(String) cursor.getString(8).toString().trim();
                    //// System.out.println("Value inserting 232 fetching :"+allData[i]);
                    cursor.moveToNext();
                    // cursor.close();
                }

            }
            ////// System.out.println("value  of new store is in DBadapter"+ScodecolumnIndex);
            return allData;
        } finally {
            cursor.close();
        }

    }

    /*private static final String DATABASE_CREATE_TABLE_233 = "create table tblStoreSKUWiseDaySummary (AutoId int not null,
	 * ProductId text null," +
	 		"Product text null,MRP text null,Rate text null,OrderQty text null,FreeQty text null," +
	 		"DiscValue text null,ValBeforeTax text null,TaxValue text null,ValAfterTax text null,Lvl text null,
	 		StoreId text null);";

	*/
    public static long savetblStoreSKUWiseDaySummary(int AutoId,String ProductId, String Product, String MRP,
                                              String Rate, String OrderQty, String FreeQty,String DiscValue,
                                              String ValBeforeTax, String  TaxValue,String ValAfterTax,String Lvl,String StoreId,String StockQty)
    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("AutoId", AutoId);
        initialValues.put("ProductId", ProductId.trim());
        initialValues.put("Product", Product.trim());
        initialValues.put("MRP", MRP.trim());
        initialValues.put("Rate", Rate.trim());
        initialValues.put("OrderQty", OrderQty.trim());
        initialValues.put("FreeQty", FreeQty.trim());
        initialValues.put("DiscValue", DiscValue.trim());
        initialValues.put("ValBeforeTax", ValBeforeTax.trim());
        initialValues.put("TaxValue", TaxValue.trim());
        initialValues.put("ValAfterTax", ValAfterTax.trim());
        initialValues.put("Lvl", Lvl.trim());
        initialValues.put("StoreId", StoreId.trim());
        initialValues.put("StockQty", StockQty.trim());

        ////// System.out.println("inserting records in StoreList table..");

        return db.insert(DATABASE_TABLE_MAIN233, null, initialValues);
    }

    public static void deleteSalesQuotePersonMeetMstr(String SalesQuoteId)
    {

        db.execSQL("DELETE FROM tblSalesQuotePersonMeetMstr WHERE SalesQuoteId ='" + SalesQuoteId +"'");
    }

    public static long saveSalesQuotePersonMeetMstr(String SalesQuoteId,String SalesQuoteCode,String SalesQuotePrcsId,String SalesQuotePrcs,
                                             String StoreName,String Remarks,String StoreId,String CreditLimit,String CreditDays,
                                             String ExpectedBusinessValue,String SalesQuoteValidFrom ,String SalesQuoteValidTo,String SalesQuoteDate,
                                             String SalesQuoteType,String ContactPerson,String ContactPersonEmail,String ContactPersonPhone,
                                             String PaymentModeId,String PaymentStageId,String ManufacturerID,String ManufacturerName)
    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("SalesQuoteId", SalesQuoteId.toString().trim());
        initialValues.put("SalesQuoteCode", SalesQuoteCode.toString().trim());
        initialValues.put("SalesQuotePrcsId", SalesQuotePrcsId.toString().trim());
        initialValues.put("SalesQuotePrcs", SalesQuotePrcs.toString().trim());
        initialValues.put("StoreName", StoreName.toString().trim());
        initialValues.put("Remarks", Remarks.toString().trim());
        initialValues.put("StoreId", StoreId.toString().trim());
        initialValues.put("CreditLimit", CreditLimit.toString().trim());
        initialValues.put("CreditDays", CreditDays.toString().trim());
        initialValues.put("ExpectedBusinessValue", ExpectedBusinessValue.toString().trim());
        initialValues.put("SalesQuoteValidFrom", SalesQuoteValidFrom.toString().trim());
        initialValues.put("SalesQuoteValidTo", SalesQuoteValidTo.toString().trim());
        initialValues.put("SalesQuoteDate", SalesQuoteDate.toString().trim());
        initialValues.put("SalesQuoteType", SalesQuoteType.toString().trim());
        initialValues.put("ContactPerson", ContactPerson.toString().trim());
        initialValues.put("ContactPersonEmail", ContactPersonEmail.toString().trim());
        initialValues.put("ContactPersonPhone", ContactPersonPhone.toString().trim());
        initialValues.put("PaymentModeId", PaymentModeId.toString().trim());
        initialValues.put("PymtStageId", PaymentStageId.toString().trim());
        initialValues.put("ManufacturerID", ManufacturerID.toString().trim());
        initialValues.put("ManufacturerName", ManufacturerName.toString().trim());
        initialValues.put("Sstat", "1");

        return db.insert(DATABASE_TABLE_SalesQuotePersonMeetMstr, null, initialValues);
    }

    public static String fngetPaymentModeIDsBasedOnStageID(String PaymentStageID)
    {

        String flag="0";
        try {
            ////open();
            Cursor cursor = db.rawQuery("SELECT PymtModeId from tblSalesQuotePaymentStageMstr where PymtStageId= '"+PaymentStageID +"'", null);

            if(cursor.getCount()>0){
                if (cursor.moveToFirst()){
                    flag=	cursor.getString(0).toString();
                }

            }
            return flag;
        }catch(Exception e)
        {

        }

        finally
        {

            //close();
            return flag;
        }

    }

    public static LinkedHashMap<String, String> fnGettblSalesQuotePaymentStageMstr()
    {
        LinkedHashMap<String, String> hmapQuestionMstr=new LinkedHashMap<String, String>();
        //open();
        Cursor cursor= db.rawQuery("SELECT PymtStageId,PymtStage from tblSalesQuotePaymentStageMstr", null);// Where PNodeID='"+TSIID+"'
        //(String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString()+"^"+(String) cursor.getString(2).toString()+"^"+(String) cursor.getString(3).toString()+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(5).toString()+"^"+(String) cursor.getString(6).toString()+"^"+(String) cursor.getString(7).toString()+"^"+(String) cursor.getString(8).toString()+"^"+(String) cursor.getString(9).toString()+"^"+(String) cursor.getString(10).toString()
        // close();
        try {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapQuestionMstr.put((String) cursor.getString(0).toString(),(String) cursor.getString(1).toString());
                        //    System.out.println("QuestID:"+(String)cursor.getString(0).toString()+"QuestCode:"+(String) cursor.getString(1).toString()+"QuestDesc:"+(String) cursor.getString(2).toString()+"QuestType:"+(String) cursor.getString(3).toString()+"AnsControlType:"+(String) cursor.getString(4).toString()+"AnsControlInputTypeID:"+(String) cursor.getString(5).toString()+"AnsControlInputTypeMaxLength:"+(String) cursor.getString(6).toString()+"AnsMustRequiredFlg:"+(String) cursor.getString(7).toString()+"QuestBundleFlg:"+(String) cursor.getString(8).toString()+"ApplicationTypeID:"+(String) cursor.getString(9).toString()+"Sequence:"+(String) cursor.getString(10).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return hmapQuestionMstr;
        }
        finally
        {
            cursor.close();
         //   close();
        }
    }

    public static LinkedHashMap<String, String> fnGettblSalesQuoteTypeMstr()
    {
        LinkedHashMap<String, String> hmapQuestionMstr=new LinkedHashMap<String, String>();
        //open();
        Cursor cursor= db.rawQuery("SELECT SalesQuotetypeId,SalesQuoteType from tblSalesQuoteTypeMstr", null);// Where PNodeID='"+TSIID+"'
        //(String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString()+"^"+(String) cursor.getString(2).toString()+"^"+(String) cursor.getString(3).toString()+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(5).toString()+"^"+(String) cursor.getString(6).toString()+"^"+(String) cursor.getString(7).toString()+"^"+(String) cursor.getString(8).toString()+"^"+(String) cursor.getString(9).toString()+"^"+(String) cursor.getString(10).toString()
        // close();
        try {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapQuestionMstr.put((String) cursor.getString(1).toString(),(String) cursor.getString(0).toString());
                        //    System.out.println("QuestID:"+(String)cursor.getString(0).toString()+"QuestCode:"+(String) cursor.getString(1).toString()+"QuestDesc:"+(String) cursor.getString(2).toString()+"QuestType:"+(String) cursor.getString(3).toString()+"AnsControlType:"+(String) cursor.getString(4).toString()+"AnsControlInputTypeID:"+(String) cursor.getString(5).toString()+"AnsControlInputTypeMaxLength:"+(String) cursor.getString(6).toString()+"AnsMustRequiredFlg:"+(String) cursor.getString(7).toString()+"QuestBundleFlg:"+(String) cursor.getString(8).toString()+"ApplicationTypeID:"+(String) cursor.getString(9).toString()+"Sequence:"+(String) cursor.getString(10).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return hmapQuestionMstr;
        }
        finally
        {
            cursor.close();
            //close();
        }
    }

    public static String[] fetchAllDataFromtblStoreSKUWiseDaySummary()
    {

        Cursor cursor = db.rawQuery("SELECT *  FROM tblStoreSKUWiseDaySummary", null);
        try {
            String allData[]=new String[cursor.getCount()];
            if (cursor.moveToFirst()) {

                for (int i = 0; i < cursor.getCount(); i++)
                {

                    allData[i] = (String) cursor.getString(0).toString().trim()+"^"+(String) cursor.getString(1).toString().trim()+"^"+(String) cursor.getString(2).toString().trim()+"^"+(String) cursor.getString(3).toString().trim()+"^"+(String) cursor.getString(4).toString().trim()+"^"+(String) cursor.getString(5).toString().trim()+"^"+(String) cursor.getString(6).toString().trim()+"^"+(String) cursor.getString(7).toString().trim()+"^"+(String) cursor.getString(8).toString().trim()+"^"+(String) cursor.getString(9).toString().trim()+"^"+(String) cursor.getString(10).toString().trim()+"^"+(String) cursor.getString(11).toString().trim()+"^"+(String) cursor.getString(12).toString().trim()+"^"+(String) cursor.getString(13).toString().trim();
                    //// System.out.println("Value inserting 233 fetching :"+allData[i]);
                    cursor.moveToNext();
                    // cursor.close();
                }

            }
            ////// System.out.println("value  of new store is in DBadapter"+ScodecolumnIndex);
            return allData;
        } finally {
            cursor.close();
        }

    }

    public static long savetblAllSummary(int AutoId,String Measures,String TodaysSummary,String MTDSummary)
    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("AutoId", AutoId);
        initialValues.put("Measures", Measures.trim());
        initialValues.put("TodaysSummary", TodaysSummary.trim());
        initialValues.put("MTDSummary", MTDSummary.trim());


        return db.insert(DATABASE_TABLE_MAIN234, null, initialValues);
    }

    public static String[] fetchAllDataFromtblAllSummary()
    {
        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT *  FROM tblAllSummary", null);
        try {
            String allData[]=new String[cursor.getCount()];
            if (cursor.moveToFirst()) {

                for (int i = 0; i < cursor.getCount(); i++)
                {
                    ScodecolumnIndex = 1;
                    allData[i] = (String) cursor.getString(0).toString().trim()+"^"+(String) cursor.getString(1).toString().trim()+"^"+(String) cursor.getString(2).toString().trim()+"^"+(String) cursor.getString(3).toString().trim();
                    //// System.out.println("Value inserting 231 fetching :"+allData[i]);
                    cursor.moveToNext();
                    // cursor.close();
                }

            }
            ////// System.out.println("value  of new store is in DBadapter"+ScodecolumnIndex);
            return allData;
        } finally {
            cursor.close();
        }

    }


	/* private static final String DATABASE_CREATE_TABLE_234 = "create table tblAllSummary (AutoId int not null,Measures text null," +
		 		"TodaysSummary text null,MTDSummary text null);";*/

    public static HashMap<String, String> getProductPicInfo(File[] fileImageName,String storeId,String TmpInvoiceCodePDA)
    {
        HashMap<String, String> pathForPhotoInfo=new HashMap<String, String>();//=null;
        //open();
        for(int position=0;position<fileImageName.length;position++)
        {
            Cursor cur=db.rawQuery("Select PhotoName,ProductID,ReasonForReturn from tblStoreProductPhotoDetail where PhotoName = '"+fileImageName[position].getName().toString()+"' and StoreID = '"+storeId+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'", null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    // System.out.println("System Value :"+cur.getString(0)+"="+ cur.getString(1)+"~"+cur.getString(2));
                    pathForPhotoInfo.put(cur.getString(0), cur.getString(1)+"~"+cur.getString(2));

                }

            }
        }

        close();
        return pathForPhotoInfo;
    }

    public static long insertPhotoDetail(String storeId,String productId,String clickedDate,String photoName,
                                  String reasonForPhotoReturn,String photoValidation,String pdaPhotoPath,int Sstat,String OrderPDAID,String TmpInvoiceCodePDA)
    {

        //open();
        ContentValues initialValues = new ContentValues();
        // StoreID ,ProductID ,ClickedDateTime ,PhotoName ,PhotoValidation ,PDAPhotoPath ,outstat
        initialValues.put("StoreID", storeId.trim());
        initialValues.put("ProductID", productId.trim());
        initialValues.put("ClickedDateTime", clickedDate.trim());
        initialValues.put("PhotoName", photoName.trim());
        initialValues.put("ReasonForReturn", reasonForPhotoReturn.trim());

        initialValues.put("PhotoValidation", photoValidation.trim());
        initialValues.put("PDAPhotoPath", pdaPhotoPath.trim());
        initialValues.put("Sstat", Sstat);
        initialValues.put("OrderIDPDA", OrderPDAID);
        initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
        long inserted=db.insert(DATABASE_TABLE_Main212, null, initialValues);
        //close();
        return inserted;
    }

    public static long insertMaterialPhotoDetail(String storeId,String MaterialID,String clickedDate,String photoName,
                                          String reasonForPhotoReturn,String photoValidation,String pdaPhotoPath,int Sstat)
    {

        //open();

        String RouteID= GetActiveRouteID();
        ContentValues initialValues = new ContentValues();
        // StoreID ,ProductID ,ClickedDateTime ,PhotoName ,PhotoValidation ,PDAPhotoPath ,outstat
        initialValues.put("RouteID", RouteID.trim());
        initialValues.put("StoreID", storeId.trim());
        initialValues.put("MaterialID", MaterialID.trim());
        initialValues.put("ClickedDateTime", clickedDate.trim());
        initialValues.put("PhotoName", photoName.trim());

        initialValues.put("PhotoValidation", photoValidation.trim());
        initialValues.put("PDAPhotoPath", pdaPhotoPath.trim());
        initialValues.put("Sstat", Sstat);

        long inserted=db.insert(DATABASE_TABLE_Main164, null, initialValues);
        //close();
        return inserted;
    }


/* tblStoreMaterialPhotoDetail (RouteID text null,StoreID text null,MaterialID text null,ClickedDateTime text null,
		 PhotoName text null,PhotoValidation text null,PDAPhotoPath text null,Sstat integer null)*/

    public static long insertStoreMaterialDetail(String storeId,String MaterialID,int ExistStock,int ReturntoDistributor,
                                          int FreshOrder,int DiscardDamage,int Sstat)
    {

        //open();

        String RouteID= GetActiveRouteID();
        ContentValues initialValues = new ContentValues();
        // StoreID ,ProductID ,ClickedDateTime ,PhotoName ,PhotoValidation ,PDAPhotoPath ,outstat
        initialValues.put("RouteID", RouteID.trim());
        initialValues.put("StoreID", storeId.trim());
        initialValues.put("MaterialID", MaterialID.trim());
        initialValues.put("ExistStock", ExistStock);
        initialValues.put("ReturntoDistributor", ReturntoDistributor);

        initialValues.put("FreshOrder", FreshOrder);
        initialValues.put("DiscardDamage",DiscardDamage);
        initialValues.put("Sstat", Sstat);

        long inserted=db.insert(DATABASE_TABLE_Main163, null, initialValues);
        //close();
        return inserted;
    }




 /*private static final String DATABASE_CREATE_TABLE_163 = "create table tblStoreMaterialDetail" +
 		" (RouteID text null,StoreID text null,MaterialID text null,ExistStock integer null,ReturntoDistributor integer null," +
 		"FreshOrder integer null,DiscardDamage integer null,Sstat integer null);";*/

    public static void updatePhotoValidation(String validation,String imageNameToUpdate)
    {

        //open();
        final ContentValues values = new ContentValues();
        values.put("PhotoValidation", validation);
        int affected = db.update("tblStoreProductPhotoDetail", values, "PhotoName=?",
                new String[] { imageNameToUpdate });
        //close();

    }

    public static void updatePhotoValidationMaterial(String validation,String imageNameToUpdate)
    {

        //open();
        final ContentValues values = new ContentValues();
        values.put("PhotoValidation", validation);
        int affected = db.update("tblStoreMaterialPhotoDetail", values, "PhotoName=?",
                new String[] { imageNameToUpdate });
        //close();

    }

    public static String[] deletFromSDcCardPhotoValidation(String storeId) {

        String[] imageNameToBeDeleted = null;
        //open();

        Cursor cursor = db.rawQuery("SELECT  PhotoName from tblStoreProductPhotoDetail where StoreID='"+storeId+"'", null);
        try{
            if(cursor.getCount()>0)
            {
                imageNameToBeDeleted=new String[cursor.getCount()];
                if(cursor.moveToFirst())
                {
                    for(int i=0;i<cursor.getCount();i++)
                    {
                        imageNameToBeDeleted[i]=cursor.getString(0);
                        cursor.moveToNext();
                    }
                }
            }
            else
            {
                imageNameToBeDeleted=new String[1];
                imageNameToBeDeleted[0]="No Data";
            }
        }finally
        {
            cursor.close();
            //close();
        }


        //	Log.w(TAG, "affected records: " + affected);


        return imageNameToBeDeleted;
    }

    public static long insertPhotoDetail(String storeId,String productId,String clickedDate,String photoName,String photoValidation,String pdaPhotoPath,String outstat)
    {

        ContentValues initialValues = new ContentValues();
        // StoreID ,ProductID ,ClickedDateTime ,PhotoName ,PhotoValidation ,PDAPhotoPath ,outstat
        initialValues.put("StoreID", storeId.trim());
        initialValues.put("ProductID", productId.trim());
        initialValues.put("ClickedDateTime", clickedDate.trim());
        initialValues.put("PhotoName", photoName.trim());
        initialValues.put("PhotoValidation", photoValidation.trim());
        initialValues.put("PDAPhotoPath", pdaPhotoPath.trim());
        initialValues.put("outstat", outstat.trim());


        return db.insert(DATABASE_TABLE_Main212, null, initialValues);
    }

    public static long savetblStoreTypeMstr(int AutoIdStore,int StoreTypeID,String StoreTypeDescr)
    {

        ContentValues initialValues = new ContentValues();
        initialValues.put("AutoIdStore", AutoIdStore);
        initialValues.put("StoreTypeID", StoreTypeID);
        initialValues.put("StoreTypeDescr", StoreTypeDescr.trim());

        //// System.out.println("Arjun data insert properly tblStoreTypeMstrr ");

        return db.insert(DATABASE_TABLE_MAIN221, null, initialValues);
    }

    public static String fetchStoreTypeDescrBasicOfStoreTypeID(int StoreTypeID)
    {

        int SnamecolumnIndex1 = 0;
        String LocIDDesc="0";
        Cursor cursor = db.rawQuery("SELECT  StoreTypeDescr from tblStoreTypeMstr where StoreTypeID='"+StoreTypeID+"'", null);
        try {

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    LocIDDesc = (String) cursor.getString(SnamecolumnIndex1).toString().trim();

                    //// System.out.println("Fetching StoreTypeDescr:"+LocIDDesc);
                    cursor.moveToNext();
                }

            }
            return LocIDDesc;
        } finally {
            cursor.close();
        }


    }

    public static long savetblTradeChannelMstr(int AutoIdStore,int TradeChannelID,String TradeChannelName)
    {

        ContentValues initialValues = new ContentValues();
        initialValues.put("AutoIdStore", AutoIdStore);
        initialValues.put("TradeChannelID", TradeChannelID);
        initialValues.put("TradeChannelName", TradeChannelName.trim());

        //// System.out.println("Arjun data insert properly tblTradeChannelMstr ");
        return db.insert(DATABASE_TABLE_MAIN223, null, initialValues);
    }

    public static String[] fnGetAllTradeChannelNames() {

        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT TradeChannelName FROM tblTradeChannelMstr", null);
        try {
            String strStoreTypeNamesDetais[] = new String[cursor2.getCount()+1];
            if(cursor2.getCount()==0)
            {
                strStoreTypeNamesDetais[0]="Please Select Trade Channel";
            }
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    if(i==0)
                    {
                        strStoreTypeNamesDetais[i]="Please Select Trade Channel";
                    }
                    strStoreTypeNamesDetais[i+1] = cursor2.getString(LoncolumnIndex);
                    cursor2.moveToNext();

                }

            }
            return strStoreTypeNamesDetais;
        } finally {
            cursor2.close();
        }

    }

    public static String[] fnGetAllTradeChannelIDs()
    {

        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT TradeChannelID FROM tblTradeChannelMstr", null);
        try {
            String strStoreTypeIdsDetais[] = new String[cursor2.getCount()+1];
            if(cursor2.getCount()==0)
            {
                strStoreTypeIdsDetais[0]="0";
            }
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    if(i==0)
                    {
                        strStoreTypeIdsDetais[i]="0";
                    }
                    strStoreTypeIdsDetais[i+1] = cursor2
                            .getString(LoncolumnIndex);
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strStoreTypeIdsDetais;
        } finally {
            cursor2.close();
        }

    }

    // Start Fifth Table Working
    public static long savetblStoreProductClassificationTypeListMstr(int AutoIdStore,int CategoryNodeID,
                                                              int CategoryNodeType,String Category,int ProductTypeNodeID,int ProductTypeNodeType,String ProductType,int IsCategorySeleted,int IsSubCategorySeleted,String SubCategoryValue)
    {

        ContentValues initialValues = new ContentValues();
        initialValues.put("AutoIdStore", AutoIdStore);
        initialValues.put("CategoryNodeID", CategoryNodeID);
        initialValues.put("CategoryNodeType", CategoryNodeType);
        initialValues.put("Category", Category);
        initialValues.put("ProductTypeNodeID", ProductTypeNodeID);
        initialValues.put("ProductTypeNodeType", ProductTypeNodeType);
        initialValues.put("ProductType", ProductType);
        initialValues.put("IsCategorySeleted", IsCategorySeleted);
        initialValues.put("IsSubCategorySeleted", IsSubCategorySeleted);
        initialValues.put("SubCategoryValue", SubCategoryValue);

        //	// System.out.println("Arjun data insert properly StoreProductClassificationType ");
        return db.insert(DATABASE_TABLE_MAIN222, null, initialValues);
    }

    public static void fnCheckCategoryIds()
    {
        try
        {
            db.execSQL("UPDATE tblStoreProductClassificationTypeListMstr SET IsCategorySeleted=0" );
            // // System.out.println("Anil Dangi SET flgTodayRoute= 0 :");
        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }
    }

    public static void fnTickCheckCategoryId(int CatId)
    {
        try
        {
            db.execSQL("UPDATE tblStoreProductClassificationTypeListMstr SET IsCategorySeleted=1 where CategoryNodeID="+ CatId);
            // // System.out.println("Anil Dangi SET flgTodayRoute= 0 :");
        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }
    }

    public static void funInsertDataStoreCategoryProductWise(String RouteID,String StoreID)
    {
        db.execSQL("INSERT INTO tblTemp (ProductType,RouteID,StoreID,CategoryNodeID,CategoryNodeType,Category,ProductTypeNodeID,ProductTypeNodeType,IsCategorySeleted,IsSubCategorySeleted,SubCategoryValue,Sstat) SELECT DISTINCT ProductType,'"+ RouteID +"','"+StoreID+"',CategoryNodeID,CategoryNodeType,Category,ProductTypeNodeID,ProductTypeNodeType,IsCategorySeleted,IsSubCategorySeleted,ifnull(SubCategoryValue,'0'),1 FROM   tblStoreProductClassificationTypeListMstr where tblStoreProductClassificationTypeListMstr.IsCategorySeleted=1 and tblStoreProductClassificationTypeListMstr.IsSubCategorySeleted=1");
    }

    public static void funResetMainTables()
    {
        db.execSQL("Update tblStoreProductClassificationTypeListMstr Set IsCategorySeleted=0");
        db.execSQL("Update tblStoreProductClassificationTypeListMstr Set IsSubCategorySeleted=0");
        db.execSQL("Update tblStoreProductClassificationTypeListMstr Set SubCategoryValue=''");
    }

    public static void fnCheckUnCheckSubCategoryId(int CatId,int SubCatId,int SelectStatus)
    {
		/*try
        {*/
        db.execSQL("UPDATE tblStoreProductClassificationTypeListMstr SET IsSubCategorySeleted="+SelectStatus +" where CategoryNodeID="+ CatId +" and ProductTypeNodeID="+SubCatId);
        // // System.out.println("Anil Dangi SET flgTodayRoute= 0 :");
		/*}
      catch (Exception ex)
        {
			Log.e(TAG, ex.toString());
		}*/
    }

    public static void fnUpdateSubCategoryValue(int CatId,int SubCatId,String SubCatValue)
    {
		/*try
        {*/
        db.execSQL("UPDATE tblStoreProductClassificationTypeListMstr SET SubCategoryValue='"+SubCatValue +"' where CategoryNodeID="+ CatId +" and ProductTypeNodeID="+SubCatId);
        // // System.out.println("Anil Dangi SET flgTodayRoute= 0 :");
		/*}
      catch (Exception ex)
        {
			Log.e(TAG, ex.toString());
		}*/
    }

    public static String[] fnGetAllSubCategoryNames(String CategoryNodeID) {

        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT DISTINCT ProductType  FROM tblStoreProductClassificationTypeListMstr where CategoryNodeID='"+ CategoryNodeID + "'", null);
        try {
            String strStoreTypeNamesDetais[] = new String[cursor2.getCount()];
			/*if(cursor2.getCount()==0)
			{
				strStoreTypeNamesDetais[0]="Please select Store Product Classification";
			}*/
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++)
                {
					/*if(i==0)
					{
						strStoreTypeNamesDetais[i]="Please select Store Product Classification";
					}*/
                    //strStoreTypeNamesDetais[i+1] = cursor2.getString(LoncolumnIndex);
                    strStoreTypeNamesDetais[i] = cursor2.getString(LoncolumnIndex);
                    cursor2.moveToNext();

                }

            }
            return strStoreTypeNamesDetais;
        } finally {
            cursor2.close();
        }

    }

    public static String[] fnGetAllSubCategoryCheckStatus(String CategoryNodeID) {

        int LoncolumnIndex = 1;

        Cursor cursor2 = db.rawQuery("SELECT DISTINCT ProductType,IsSubCategorySeleted  FROM tblStoreProductClassificationTypeListMstr where CategoryNodeID="+ CategoryNodeID, null);
        try {
            String strStoreTypeNamesDetais[] = new String[cursor2.getCount()];
			/*if(cursor2.getCount()==0)
			{
				strStoreTypeNamesDetais[0]="Please select Store Product Classification";
			}*/
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++)
                {
					/*if(i==0)
					{
						strStoreTypeNamesDetais[i]="Please select Store Product Classification";
					}*/
                    //strStoreTypeNamesDetais[i+1] = cursor2.getString(LoncolumnIndex);
                    strStoreTypeNamesDetais[i] = cursor2.getString(LoncolumnIndex);

                    //	// System.out.println("Sunil SubCategory check  strStoreTypeNamesDetais[i] :"+strStoreTypeNamesDetais[i]);
                    cursor2.moveToNext();

                }

            }
            return strStoreTypeNamesDetais;
        } finally {
            cursor2.close();
        }

    }

    public static String[] fnGetAllSubCategoryValues(String CategoryNodeID) {

        int LoncolumnIndex = 1;

        Cursor cursor2 = db.rawQuery("SELECT DISTINCT ProductType,SubCategoryValue  FROM tblStoreProductClassificationTypeListMstr where CategoryNodeID="+ CategoryNodeID, null);
        try {
            String strStoreTypeNamesDetais[] = new String[cursor2.getCount()];
			/*if(cursor2.getCount()==0)
			{
				strStoreTypeNamesDetais[0]="Please select Store Product Classification";
			}*/
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++)
                {
					/*if(i==0)
					{
						strStoreTypeNamesDetais[i]="Please select Store Product Classification";
					}*/
                    //strStoreTypeNamesDetais[i+1] = cursor2.getString(LoncolumnIndex);
                    strStoreTypeNamesDetais[i] = cursor2.getString(LoncolumnIndex);

                    //	// System.out.println("Sunil SubCategory check  strStoreTypeNamesDetais[i] :"+strStoreTypeNamesDetais[i]);
                    cursor2.moveToNext();

                }

            }
            return strStoreTypeNamesDetais;
        } finally {
            cursor2.close();
        }

    }

    public static String[] fnGetAllSubCategoryIds(String CategoryNodeID)
    {

        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT DISTINCT ProductTypeNodeID FROM tblStoreProductClassificationTypeListMstr where CategoryNodeID='"+ CategoryNodeID + "'", null);
        try {
            String strStoreTypeIdsDetais[] = new String[cursor2.getCount()];
			/*if(cursor2.getCount()==0)
			{
				strStoreTypeIdsDetais[0]="0";
			}*/
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++)
                {
					/*if(i==0)
					{
						strStoreTypeIdsDetais[i]="0";
					}*/
                    strStoreTypeIdsDetais[i] = cursor2
                            .getString(LoncolumnIndex);
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strStoreTypeIdsDetais;
        } finally {
            cursor2.close();
        }

    }

    public static String fetchStoreProductClassificationDescrBasicOfStoreProductClassificationID(int StoreProductClassificationID)
    {

        int SnamecolumnIndex1 = 0;
        String LocIDDesc="0";
        Cursor cursor = db.rawQuery("SELECT  StoreProductClassificationDescr from tblStoreProductClassificationTypeListMstr where StoreProductClassificationID='"+StoreProductClassificationID+"'", null);
        try {

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    LocIDDesc = (String) cursor.getString(SnamecolumnIndex1).toString().trim();

                    //	// System.out.println("Fetching StoreTypeDescr:"+LocIDDesc);
                    cursor.moveToNext();
                }

            }
            return LocIDDesc;
        } finally {
            cursor.close();
        }


    }

    public static String[] fnGetAllStoreProductClassificationTypeNames() {

        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT DISTINCT Category  FROM tblStoreProductClassificationTypeListMstr order by CategoryNodeID", null);
        try {
            String strStoreTypeNamesDetais[] = new String[cursor2.getCount()];

            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    strStoreTypeNamesDetais[i]= cursor2.getString(LoncolumnIndex);
                    //// System.out.println("Abhiav Raj New :"+strStoreTypeNamesDetais[i]);
                    cursor2.moveToNext();

                }

            }
            return strStoreTypeNamesDetais;
        } finally {
            cursor2.close();
        }

    }

    public static String[] fnGetAllStoreProductClassificationTypeIds()
    {

        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT DISTINCT CategoryNodeID FROM tblStoreProductClassificationTypeListMstr order by CategoryNodeID", null);
        try {
            String strStoreTypeIdsDetais[] = new String[cursor2.getCount()];

            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++)
                {

                    strStoreTypeIdsDetais[i] = cursor2.getString(LoncolumnIndex);
                    cursor2.moveToNext();

                }

            }
            return strStoreTypeIdsDetais;
        } finally {
            cursor2.close();
        }

    }

    public static String[] fnGetAllRouteDescrNewStore() {

        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT Descr FROM tblRouteListMaster", null);
        try {
            String strStoreTypeNamesDetais[] = new String[cursor2.getCount()+1];
            if(cursor2.getCount()==0)
            {
                strStoreTypeNamesDetais[0]="Please Select Route";
            }
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    if(i==0)
                    {
                        strStoreTypeNamesDetais[i]="Please Select Route";
                    }
                    strStoreTypeNamesDetais[i+1] = cursor2.getString(LoncolumnIndex);
                    //	// System.out.println("Fetching Data from tblRouteListMaster is Desc :"+strStoreTypeNamesDetais[i+1]);
                    cursor2.moveToNext();

                }

            }
            return strStoreTypeNamesDetais;
        } finally {
            cursor2.close();
        }

    }

    // End Second Table Working

    public static String[] fnGetAllRouteIDNewStore()
    {

        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT ID FROM tblRouteListMaster", null);
        try {
            String strStoreTypeIdsDetais[] = new String[cursor2.getCount()+1];
            if(cursor2.getCount()==0)
            {
                strStoreTypeIdsDetais[0]="0";
            }
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    if(i==0)
                    {
                        strStoreTypeIdsDetais[i]="0";
                    }
                    strStoreTypeIdsDetais[i+1] = cursor2.getString(LoncolumnIndex);
                    //// System.out.println("Fetching Data from tblRouteListMaster is ID :"+strStoreTypeIdsDetais[i+1]);
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strStoreTypeIdsDetais;
        } finally {
            cursor2.close();
        }

    }

    //tblRouteListMaster(AutoIdStore integer null,RouteID integer null, RouteDescr text null);";

    public static String[] fnGetAllStoreTypeNames() {

        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT StoreTypeDescr FROM tblStoreTypeMstr", null);
        try {
            String strStoreTypeNamesDetais[] = new String[cursor2.getCount()+1];
            if(cursor2.getCount()==0)
            {
                strStoreTypeNamesDetais[0]="Please Select Store Type";
            }
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    if(i==0)
                    {
                        strStoreTypeNamesDetais[i]="Please Select Store Type";
                    }
                    strStoreTypeNamesDetais[i+1] = cursor2.getString(LoncolumnIndex);
                    //	// System.out.println("Fetching tblStoreTypeMstr from tblRouteListMaster is Desc :"+strStoreTypeNamesDetais[i+1]);
                    cursor2.moveToNext();

                }

            }
            return strStoreTypeNamesDetais;
        } finally {
            cursor2.close();
        }

    }

    public static String[] fnGetAllStoreTypeIds()
    {

        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT StoreTypeID FROM tblStoreTypeMstr", null);
        try {
            String strStoreTypeIdsDetais[] = new String[cursor2.getCount()+1];
            if(cursor2.getCount()==0)
            {
                strStoreTypeIdsDetais[0]="0";
            }
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    if(i==0)
                    {
                        strStoreTypeIdsDetais[i]="0";
                    }
                    strStoreTypeIdsDetais[i+1] = cursor2.getString(LoncolumnIndex);
                    //	// System.out.println("Fetching tblStoreTypeMstr from tblStoreTypeMstr is Desc :"+strStoreTypeIdsDetais[i+1]);
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strStoreTypeIdsDetais;
        } finally {
            cursor2.close();
        }

    }

    public static void fnReleaseTableUnReuqiredData()
    {
        try
        {
            db.execSQL("Delete from tblTemp where Sstat=4" );
            db.execSQL("Delete from tblNewStoreEntries where Sstat=4" );
            //   // System.out.println("Anil Dangi SET flgTodayRoute= 0 :");
        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }

    }

    public static long savetblStoreMainAfterCountNUmberOfStore(String RouteID,String StoreID,String StoreName,String RetailerName,String emailID,String TinNo,
                                                        String RetailerContactNo,String StoreAddress,String StorePincode,String City,String KeyAccount,int TradeChannelID, int StoreTypeId,
                                                        int StoreCategoryId,int RetailSalesTypeId,int StorePotentialId,String StoreProductClassificationId,
                                                        String VisitStartTS, String Imei,String BatteryStatus,int Sstat,int CityId,
                                                        String ActualLatitude,String ActualLongitude,String Accuracy,String LocProvider)
    {

        long  syncTIMESTAMP = System.currentTimeMillis();
        Date dateobj = new Date(syncTIMESTAMP);
        SimpleDateFormat df = new SimpleDateFormat("dd-MMM-yyyy HH:mm:ss",Locale.ENGLISH);
        String StampEndsTime = df.format(dateobj);


        ContentValues initialValues = new ContentValues();

        initialValues.put("RouteID", RouteID);
        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("StoreName", StoreName.trim());
        initialValues.put("RetailerName", RetailerName.trim());
        initialValues.put("emailID", emailID);
        initialValues.put("TinNo", TinNo);
        initialValues.put("RetailerContactNo", RetailerContactNo.trim());
        initialValues.put("StoreAddress", StoreAddress);
        initialValues.put("StorePincode", StorePincode);
        initialValues.put("City", City);
        initialValues.put("KeyAccount", KeyAccount);
        initialValues.put("TradeChannelID", TradeChannelID);

        initialValues.put("StoreAttrHierID", StoreTypeId);

        initialValues.put("StoreProductClassificationId", StoreProductClassificationId.trim());



        initialValues.put("ActualLatitude", ActualLatitude.trim());
        initialValues.put("ActualLongitude", ActualLongitude.trim());
        initialValues.put("LocProvider", LocProvider.trim());
        initialValues.put("Accuracy", Accuracy.trim());
        //initialValues.put("Accuracy", LocProvider.trim());
        //// System.out.println("DateTime fnDBKenya savetblStoreMainAfterCountNUmberOfStore = "+VisitStartTS);
        initialValues.put("VisitStartTS", VisitStartTS.trim());
        initialValues.put("VisitEndTS", StampEndsTime.trim());



        initialValues.put("Imei", Imei.trim());
        initialValues.put("BatteryStatus", BatteryStatus.trim());
        initialValues.put("Sstat", Sstat);
        initialValues.put("CityId", CityId);



        initialValues.put("AppVersion", DATABASE_VERSION);


        checkNumberOfStore++;

        //// System.out.println("Data insert Properly in DATABASE_TABLE_MAIN21");


        return db.insert(DATABASE_TABLE_MAIN21, null, initialValues);
    }

    public static void deletetblstoreMstrOnStoreIDBasis(String StoreID)
    {

        db.execSQL("DELETE FROM tblStoreList WHERE StoreID ='"+ StoreID +"'");
        db.execSQL("DELETE FROM tblNewAddedStoreLocationDetails WHERE StoreID ='"+ StoreID +"'");
        db.execSQL("DELETE FROM tblNewStoreListEntries WHERE StoreID ='"+ StoreID +"'");


    }






/*	public static void deletetblstoreMstrOnStoreIDBasis(String StoreID) {

		db.execSQL("DELETE FROM tblStoreList WHERE StoreID ='"+ StoreID +"'");
		db.execSQL("DELETE FROM tblNewStoreListEntries WHERE StoreID ='"+ StoreID +"'");

	}*/

    public static void savetblStoreMain(String RouteID,String StoreID,String StoreName,String RetailerName,String emailID,
                                 String TinNo,
                                 String RetailerContactNo,String StoreAddress,String StorePincode,String City,String KeyAccount,
                                 int TradeChannelID, int StoreTypeId,
                                 int StoreCategoryId,int RetailSalesTypeId,int StorePotentialId,String StoreProductClassificationId,
                                 String VisitStartTS, String Imei,String BatteryStatus,int Sstat,int CityId,String ActualLatitude,
                                 String ActualLongitude,String Accuracy,String LocProvider,int IsNewStoreDataCompleteSaved,
                                 String fetchAddress,String PaymentStage,int flgHasQuote,int flgAllowQuotation,
                                 int flgSubmitFromQuotation,String flgGSTCapture,String flgGSTCompliance,String GSTNumber,int flgGSTRecordFromServer, int flgLocationServicesOnOff, int flgGPSOnOff, int flgNetworkOnOff, int flgFusedOnOff, int flgInternetOnOffWhileLocationTracking, int flgRestart, int flgStoreOrder, String StoreCity,String StorePinCode, String StoreState,String DBR,String OwnerName,String StoreContactNo,String StoreCatType,int flgRuleTaxVal,int flgTransType,String mobileFnl,String SalesPersonName,String SalesPersonContactNo,int IsComposite,int StoreStateID,int  StoreCityID)
    {

        int MaxAutoStore = 0;
        int cntTotStore=0;
        cntTotStore=fnGetCountForNewStore();
        String strGetMaxIDForNewStore="0";
        //String activeRid;
        //activeRid = GetActiveRouteID();
        if(cntTotStore>0)
        {
            MaxAutoStore = fnGetMaxAutoStoreIncrementForNewStore();
            MaxAutoStore = MaxAutoStore + 1;
            strGetMaxIDForNewStore = fnGetMaxIdWithIncrementForNewStore(MaxAutoStore);
        }
        else
        {
            MaxAutoStore=0;
            MaxAutoStore = MaxAutoStore + 1;

            strGetMaxIDForNewStore = "-000^" + (1) + "$" + MaxAutoStore;

        }

        if (!StoreID.equals("") && !StoreID.equals(null) && !StoreID.equals(0))
        {

            String prevDate2Send = fnGetDateTimeString();//GetPrevDate();

            if(prevDate2Send.equals("") || prevDate2Send.equals("NA"))
            {
                long syncTIMESTAMP = System.currentTimeMillis();
                Date dateobj = new Date(syncTIMESTAMP);
                SimpleDateFormat df = new SimpleDateFormat("dd-MMM-yyyy",Locale.ENGLISH);
                prevDate2Send = df.format(dateobj);
            }

            //saveSOAPdataStoreList = DBR,flgRetailerCredit
            saveSOAPdataStoreListNewStore(StoreID, ""+StoreTypeId, StoreName, Double.parseDouble(ActualLatitude.trim()), Double.parseDouble(ActualLongitude.trim()), "", "", prevDate2Send, MaxAutoStore,Sstat,Accuracy.trim(),LocProvider.trim(),RouteID,BatteryStatus,IsNewStoreDataCompleteSaved,fetchAddress,PaymentStage,flgHasQuote,flgAllowQuotation,flgSubmitFromQuotation,flgGSTCapture,flgGSTCompliance,GSTNumber,flgGSTRecordFromServer,flgLocationServicesOnOff,flgGPSOnOff,flgNetworkOnOff,flgFusedOnOff,flgInternetOnOffWhileLocationTracking,flgRestart,flgStoreOrder,StoreCity,StorePinCode,StoreState,DBR,OwnerName,StoreContactNo,StoreCatType,flgRuleTaxVal,flgTransType,SalesPersonName,SalesPersonContactNo,IsComposite,StoreStateID,StoreCityID); // in last parameter Fdate

            fnInsert_tblNewAddedStoreLocationDetails( StoreID, Sstat, ActualLatitude, ActualLongitude, prevDate2Send, LocProvider, Accuracy, BatteryStatus, flgLocationServicesOnOff, flgGPSOnOff, flgNetworkOnOff, flgFusedOnOff, flgInternetOnOffWhileLocationTracking);
        }


    }

    public static int checkRouteIDExistInStoreListTable(int StoreRouteID)
    {

        Cursor cursor = db.rawQuery("SELECT Count(*) FROM tblStoreList WHERE StoreRouteID="+StoreRouteID, null);

        try {

            int check=0;

            if (cursor.getCount() > 0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        check=1;
                        cursor.moveToNext();
                    }
                }

            }
            return check;

        } finally {
            cursor.close();
        }

    }

    public static int counttblForPDAGetLastVisitDate(String StoreID)
    {
        Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblPDAGetLastVisitDate WHERE StoreID ='"+ StoreID + "'", null);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    public static String fnGetVisitDateAndflgOrderFromtblForPDAGetLastVisitDate(String StoreID) {

        Cursor cursorE2 = db.rawQuery("SELECT VisitDate,flgOrder FROM tblPDAGetLastVisitDate WHERE StoreID ='"
                + StoreID + "'", null);
        String LastTransDate = "";
        int ScodecolumnIndex = 0;
        try {

            if (cursorE2.moveToFirst()) {

                for (int i = 0; i <= (cursorE2.getCount() - 1); i++)
                {
                    LastTransDate = (String) cursorE2.getString(0).toString()+"^"+(String) cursorE2.getString(1).toString();
                    // // System.out.println("Sunil Jai Testing LastTransDate :"+LastTransDate);
                    cursorE2.moveToNext();
                }
            }
            return LastTransDate;
        } finally {
            cursorE2.close();
        }

    }


    public static int counttblForPDAGetLastOrderDate(String StoreID)
    {
        Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblPDAGetLastOrderDate WHERE StoreID ='"
                + StoreID + "'", null);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    public static String fnGettblForPDAGetLastOrderDate(String StoreID) {
        int ScodecolumnIndex = 0;

        Cursor cursorE2 = db.rawQuery("SELECT OrderDate,flgExecutionSummary FROM tblPDAGetLastOrderDate WHERE StoreID ='"+ StoreID + "' Limit 1", null);
        String LastTransDate = "";

        try {

            if (cursorE2.moveToFirst()) {

                for (int i = 0; i <= (cursorE2.getCount() - 1); i++)
                {
                    LastTransDate = (String) cursorE2.getString(0).toString()+"^"+(String) cursorE2.getString(1).toString();
                    cursorE2.moveToNext();
                }
            }
            return LastTransDate;
        } finally {
            cursorE2.close();
        }

    }

    public static int counttblForPDAGetLastVisitDetails(String StoreID)
    {
        Cursor cursorE2 = db.rawQuery("select Count(*) from tblPDAGetLastVisitDetails WHERE StoreID ='"+ StoreID + "'", null);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    public static String[] fetchDateFromtblForPDAGetLastVisitDetails(String StoreID)
    {

        Cursor cursor = db
                .rawQuery("SELECT Date123 FROM tblPDAGetLastVisitDetails WHERE StoreID ='"+ StoreID + "'", null);

        try {

            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = (String) cursor.getString(0)
                                .toString();

                        ////// // System.out.println("Aajtak value CompleteResult :"+CompleteResult[i]);
                        //// // System.out.println("Ashish and Anuj CompleteResult[i] : "+CompleteResult[i]);


                        cursor.moveToNext();
                    }
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public static String[] fetchAllDataFromtblForPDAGetLastVisitDetails(String StoreID)
    {

        Cursor cursor = db
                .rawQuery("SELECT SKUName, Stock, Order123, ExecutionQty FROM tblPDAGetLastVisitDetails WHERE StoreID ='"+ StoreID + "'", null);

        try {

            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = (String) cursor.getString(0)
                                .toString()
                                + "^"
                                + (String) cursor.getString(1).toString()
                                + "^"
                                + (String) cursor.getString(2).toString()
                                + "^"
                                + (String) cursor.getString(3).toString();

                        ////// // System.out.println("Aajtak value CompleteResult :"+CompleteResult[i]);
                        //// // System.out.println("Ashish and Anuj CompleteResult[i] : "+CompleteResult[i]);


                        cursor.moveToNext();
                    }
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public static HashMap<String, String> getProductPicInfoMaterial(File[] fileImageName,String storeId)
    {
        HashMap<String, String> pathForPhotoInfo=new HashMap<String, String>();//=null;
        //open();
        for(int position=0;position<fileImageName.length;position++)
        {
            Cursor cur=db.rawQuery("Select PhotoName,MaterialID from tblStoreMaterialPhotoDetail where PhotoName = '"+fileImageName[position].getName().toString()+"' and StoreID = '"+storeId+"'", null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    // System.out.println("System Value :"+cur.getString(0)+"="+ cur.getString(1)+"~"+cur.getString(2));
                    pathForPhotoInfo.put(cur.getString(0), cur.getString(1));

                }

            }
        }

       // close();
        return pathForPhotoInfo;
    }

    public static ArrayList<HashMap<String, String>> fetch_matID_ReturnData(String storeId) {
        // System.out.println("Abhinav Raj is 2");
        //open();
        ArrayList<HashMap<String, String>> totalProductDetail=new ArrayList<HashMap<String, String>>(4);

        HashMap<String, String> hmapMatIDExistingStock=new HashMap<String, String>();
        HashMap<String, String> hmapMatIDReturntoDistributor=new HashMap<String, String>();
        HashMap<String, String> hmapMatIDFreshOrder=new HashMap<String, String>();

        HashMap<String, String> hmapMatIDDiscardDamage=new HashMap<String, String>();




		    /*  private static final String DATABASE_CREATE_TABLE_163 = "create table tblStoreMaterialDetail " +
		      		"(RouteID text null,StoreID text null,MaterialID text null,ExistStock integer null," +
		      		"ReturntoDistributor integer null,FreshOrder integer null,DiscardDamage integer null,Sstat integer null);";*/

        //Cursor cursor = db.rawQuery("SELECT ProductID,CategoryID,ProductShortName FROM tblProductListMaster",null);
        Cursor cursor = db.rawQuery("SELECT MaterialID,ExistStock,ReturntoDistributor,FreshOrder,DiscardDamage FROM tblStoreMaterialDetail where StoreID='"+storeId+"'",null);
        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i < cursor.getCount(); i++)
                    {
                        hmapMatIDExistingStock.put(cursor.getString(0), cursor.getString(1));

                        hmapMatIDReturntoDistributor.put(cursor.getString(0), cursor.getString(2));
                        hmapMatIDFreshOrder.put(cursor.getString(0), cursor.getString(3));
                        hmapMatIDDiscardDamage.put(cursor.getString(0), cursor.getString(4));
                        cursor.moveToNext();

                    }
                    totalProductDetail.add(0,hmapMatIDExistingStock);
                    totalProductDetail.add(1,hmapMatIDReturntoDistributor);
                    totalProductDetail.add(2,hmapMatIDFreshOrder);
                    totalProductDetail.add(3,hmapMatIDDiscardDamage);

                }
            }


            return totalProductDetail;
        } finally {
            cursor.close();

           // close();
        }


    }


    public static int counttblForPDAGetLastOrderDetails(String StoreID)
    {
        Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblPDAGetLastOrderDetails WHERE StoreID ='"
                + StoreID + "'", null);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    public static String[] fetchOrderDateFromtblForPDAGetLastOrderDetails(String StoreID)
    {

        Cursor cursor = db
                .rawQuery(
                        "SELECT OrderDate FROM tblPDAGetLastOrderDetails WHERE StoreID ='"+ StoreID + "'", null);

        try {

            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = (String) cursor.getString(0)
                                .toString();

                        ////// // System.out.println("Aajtak value CompleteResult :"+CompleteResult[i]);
                        //// // System.out.println("Ashish and Anuj CompleteResult[i] : "+CompleteResult[i]);


                        cursor.moveToNext();
                    }
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public static String[] fetchAllDataFromtblForPDAGetLastOrderDetails(String StoreID)
    {

        Cursor cursor = db
                .rawQuery(
                        "SELECT PrdName, OrderQty, FreeQty, ExecutionQty FROM tblPDAGetLastOrderDetails WHERE StoreID ='"+ StoreID + "'", null);

        try {

            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = (String) cursor.getString(0)
                                .toString()
                                + "^"
                                + (String) cursor.getString(1).toString()
                                + "^"
                                + (String) cursor.getString(2).toString()
                                + "^"
                                + (String) cursor.getString(3).toString();

                        ////// // System.out.println("Aajtak value CompleteResult :"+CompleteResult[i]);
                        //// // System.out.println("Ashish and Anuj CompleteResult[i] : "+CompleteResult[i]);


                        cursor.moveToNext();
                    }
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public static int counttblspForPDAGetLastOrderDetails_TotalValues(String StoreID)
    {
        Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblPDAGetLastOrderDetailsTotalValues WHERE StoreID ='"
                + StoreID + "'", null);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    public static String[] fetchAllDataFromtblspForPDAGetLastOrderDetails_TotalValues(String StoreID)
    {

        Cursor cursor = db
                .rawQuery(
                        "SELECT OrderValue,ExecutionValue FROM tblPDAGetLastOrderDetailsTotalValues WHERE StoreID ='"+ StoreID + "'", null);

        try {

            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = (String) cursor.getString(0)
                                .toString()
                                + "_"
                                + (String) cursor.getString(1).toString();

                        ////// // System.out.println("Aajtak value CompleteResult :"+CompleteResult[i]);
                        //// // System.out.println("Ashish and Anuj CompleteResult[i] : "+CompleteResult[i]);


                        cursor.moveToNext();
                    }
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public static String[] fetchOrderDateFromtblForPDAGetExecutionSummary(String StoreID)
    {

        Cursor cursor = db
                .rawQuery(
                        "SELECT DISTINCT OrderDate FROM tblPDAGetExecutionSummary WHERE StoreID ='"+ StoreID + "'", null);

        try {

            //// // System.out.println("Aajtak value CompleteResult coung:"+cursor.getCount());
            String DateResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        DateResult[i] = (String) cursor.getString(0)
                                .toString();

                        // // System.out.println("Aajtak value DateResult :"+DateResult[i]);
                        //// // System.out.println("Ashish and Anuj CompleteResult[i] : "+CompleteResult[i]);


                        cursor.moveToNext();
                    }
                }

            }
            return DateResult;

        } finally {
            cursor.close();
        }

    }

	/*SELECT DISTINCT Category, MAX(CreationDate)
	FROM MonitoringJob
	GROUP BY Category
	ORDER BY MAX(CreationDate) DESC, Category*/

    public static int fnfetchMinNoOfSKUFromtblCouponMasterNewFormat()
    {


        Cursor cursorE2 = db.rawQuery(
                "SELECT MinNoOfSKU FROM tblCouponMasterNewFormat", null);

        //////////// // System.out.println("SELECT Sum(flgIsStrachApplicable) FROM tblStrachApplicableOnScheme");
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {
                for (int i = 0; i < cursorE2.getCount(); i++)
                {
                    if (!cursorE2.isNull(0))
                    {
                        chkI = Integer.parseInt(cursorE2.getString(0));
                    } else {
                        chkI = 0;
                    }
                    cursorE2.moveToNext();
                }

            }

        } finally {
            cursorE2.close();
        }
        //////////// // System.out.println("fnCheckflgToShowStrachRowOrNot : " +chkI);
        return chkI;

    }

    public static Double fnfetchAdditionalAmountFromtblCouponSlabNewFormat()
    {

        Cursor cursorE2 = db.rawQuery(
                "SELECT AdditionalAmount FROM tblCouponSlabNewFormat", null);

        //////////// // System.out.println("SELECT Sum(flgIsStrachApplicable) FROM tblStrachApplicableOnScheme");
        Double chkI = 0.0;
        try {
            if (cursorE2.moveToFirst()) {
                for (int i = 0; i < cursorE2.getCount(); i++)
                {
                    if (!cursorE2.isNull(0))
                    {
                        chkI = Double.parseDouble((cursorE2.getString(0)));
                    } else {
                        chkI = 0.0;
                    }
                    cursorE2.moveToNext();
                }

            }

        } finally {
            cursorE2.close();
        }
        //////////// // System.out.println("fnCheckflgToShowStrachRowOrNot : " +chkI);
        return chkI;

    }

    public static int countCouponNewFormatApplyOrNot(String StoreID)
    {
        Cursor cursorE2 = db.rawQuery("SELECT ProductID,flgMust,Qty FROM tblTempNewFormat WHERE flgMust=1 AND Qty>=MinQty_Value And StoreID='"+StoreID+"'", null);
        //Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblTempNewFormat WHERE (flgMust ="+1+" AND Qty>=MinQty_Value)", null);
        //Cursor cursorE2 = db.rawQuery("SELECT Qty,MinQty_Value FROM tblTempNewFormat WHERE flgMust = 1", null);
        //Cursor cursorE2 = db.rawQuery("SELECT Qty,MinQty_Value,flgMust FROM tblTempNewFormat", null);
        int chkI = 0;
        try
        {
            // // System.out.println("Sunil grater value getCount"+cursorE2.getCount());
            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst())
                {
                    chkI=1;
					/*for (int i = 0; i < cursorE2.getCount(); i++)
					{


						// // System.out.println("Sunil grater value ProductID"+cursorE2.getString(0).toString());
						// // System.out.println("Sunil grater value flgMust"+cursorE2.getString(1).toString());
						// // System.out.println("Sunil grater value Qty"+cursorE2.getString(2).toString());
							cursorE2.moveToNext();

					}*/
                    cursorE2.moveToNext();
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    public static long fninsertPDAProductReturnDetails(int AutoReturnIdMstr,
                                                int AutoReturnIdDetails, String strProductId,
                                                String strProdReturnQty, Double ProdRate, Double ProdReturnValue,
                                                int proSingleAdjQty, Double proSingleAdjAmt,String CatId)
    {

        ContentValues initialValues = new ContentValues();

        //////////// // System.out.println("Saved AutoReturnIdMstr:" + AutoReturnIdMstr+ "Saved AutoReturnIdDetails:" + "" + AutoReturnIdDetails);

        String activeRid;
        activeRid = GetActiveRouteID();

        initialValues.put("AutoReturnDetailsId", AutoReturnIdDetails);
        initialValues.put("ReturnIdMstr", AutoReturnIdMstr);
        initialValues.put("ProductId", strProductId.trim());
        initialValues.put("ProdReturnQty", strProdReturnQty.trim());
        initialValues.put("ProdRate", ProdRate);
        initialValues.put("ProdReturnValue", ProdReturnValue);

        initialValues.put("AdjustReturnQty", proSingleAdjQty);
        initialValues.put("AdjustReturnValue", proSingleAdjAmt);


        initialValues.put("ProdReturnReason", " ");
        initialValues.put("ProdReturnReasonDescr", " ");
        initialValues.put("ProdLastOrderDate", " ");
        initialValues.put("ProdLastOrderQyt", " ");
        initialValues.put("CatId", CatId.trim());
        initialValues.put("RouteID", Integer.parseInt(activeRid));



        return db.insert(DATABASE_TABLE_MAIN20, null, initialValues);
    }

    public static int fnCheckflgToShowCouponNewFormat()
    {


        Cursor cursorE2 = db.rawQuery(
                "SELECT CouponApplicable FROM tblCouponApplicableNewFormat", null);

        //////////// // System.out.println("SELECT Sum(flgIsStrachApplicable) FROM tblStrachApplicableOnScheme");
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {
                for (int i = 0; i < cursorE2.getCount(); i++)
                {
                    if (!cursorE2.isNull(0))
                    {
                        chkI = Integer.parseInt(cursorE2.getString(0));
                    } else {
                        chkI = 0;
                    }
                    cursorE2.moveToNext();
                }

            }

        } finally {
            cursorE2.close();
        }
        //////////// // System.out.println("fnCheckflgToShowStrachRowOrNot : " +chkI);
        return chkI;

    }

    public static Double fnfetchMinInvoiceAmountFromtblCouponMasterNewFormat()
    {

        Cursor cursorE2 = db.rawQuery(
                "SELECT MinInvoiceAmount FROM tblCouponMasterNewFormat", null);

        //////////// // System.out.println("SELECT Sum(flgIsStrachApplicable) FROM tblStrachApplicableOnScheme");
        Double chkI = 0.0;
        try {
            if (cursorE2.moveToFirst()) {
                for (int i = 0; i < cursorE2.getCount(); i++)
                {
                    if (!cursorE2.isNull(0))
                    {
                        chkI = Double.parseDouble((cursorE2.getString(0)));
                    } else {
                        chkI = 0.0;
                    }
                    cursorE2.moveToNext();
                }

            }

        } finally {
            cursorE2.close();
        }
        //////////// // System.out.println("fnCheckflgToShowStrachRowOrNot : " +chkI);
        return chkI;

    }

    public static String[] fetchProductIDFromtblForPDAGetExecutionSummary(String StoreID)
    {

        Cursor cursor = db
                .rawQuery(
                        "SELECT DISTINCT ProductID FROM tblPDAGetExecutionSummary WHERE StoreID ='"+ StoreID + "'", null);

        try {

            //// // System.out.println("Aajtak value CompleteResult coung:"+cursor.getCount());
            String DateResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        DateResult[i] = (String) cursor.getString(0)
                                .toString();

                        // // System.out.println("Aajtak value DateResult :"+DateResult[i]);
                        //// // System.out.println("Ashish and Anuj CompleteResult[i] : "+CompleteResult[i]);


                        cursor.moveToNext();
                    }
                }

            }
            return DateResult;

        } finally {
            cursor.close();
        }

    }

    public static String[] fetchPrdNameFromtblForPDAGetExecutionSummary(String StoreID)
    {

        Cursor cursor = db
                .rawQuery(
                        "SELECT DISTINCT PrdName FROM tblPDAGetExecutionSummary WHERE StoreID ='"+ StoreID + "'", null);

        try {

            //// // System.out.println("Aajtak value CompleteResult coung:"+cursor.getCount());
            String DateResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        DateResult[i] = (String) cursor.getString(0)
                                .toString();

                        // // System.out.println("Aajtak value DateResult :"+DateResult[i]);
                        //// // System.out.println("Ashish and Anuj CompleteResult[i] : "+CompleteResult[i]);


                        cursor.moveToNext();
                    }
                }

            }
            return DateResult;

        } finally {
            cursor.close();
        }

    }

    public static String[] fetchAllDataNewFromtbltblForPDAGetExecutionSummary(String StoreID,String OrderDate,String ProductID)
    {

        Cursor cursor = db
                .rawQuery(
                        "SELECT  OrderQty,ProductQty FROM tblPDAGetExecutionSummary WHERE StoreID ='"+ StoreID.trim() + "' and OrderDate ='"+ OrderDate.trim() + "' and ProductID ='"+ ProductID.trim() + "'", null);

        try {

            //// // System.out.println("Aajtak value CompleteResult coung:"+cursor.getCount());
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = (String) cursor.getString(0)
                                .toString()
                                + "_"
                                + (String) cursor.getString(1).toString();

                        ////// // System.out.println("Aajtak value CompleteResult :"+CompleteResult[i]);
                        //// // System.out.println("Ashish and Anuj CompleteResult[i] : "+CompleteResult[i]);


                        cursor.moveToNext();
                    }
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public static String[] fetchAllDataFromtbltblForPDAGetExecutionSummary(String StoreID)
    {

        Cursor cursor = db
                .rawQuery(
                        "SELECT PrdName, OrderQty, flgInvStatus, ProductQty FROM tblPDAGetExecutionSummary WHERE StoreID ='"+ StoreID + "'", null);

        try {

            //// // System.out.println("Aajtak value CompleteResult coung:"+cursor.getCount());
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = (String) cursor.getString(0)
                                .toString()
                                + "_"
                                + (String) cursor.getString(1).toString()
                                + "_"
                                + (String) cursor.getString(2).toString()
                                + "_"
                                + (String) cursor.getString(3).toString();

                        ////// // System.out.println("Aajtak value CompleteResult :"+CompleteResult[i]);
                        //// // System.out.println("Ashish and Anuj CompleteResult[i] : "+CompleteResult[i]);


                        cursor.moveToNext();
                    }
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public static String fetchNoti_textFromtblPDANotificationMaster()
    {

        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;

        Cursor cursor2 = db.rawQuery("SELECT MsgServerID,Noti_text  FROM tblPDANotificationMaster where Noti_NewOld=1 and Noti_ReadStatus=1", null);

        try
        {
            String UniqueProductShortName="Null";

            if(cursor2.getCount()>0)
            {

                if (cursor2.moveToFirst())
                {

                    UniqueProductShortName =cursor2.getString(LoncolumnIndex).toString()+"_"+cursor2.getString(LoncolumnIndex1).toString();


                    cursor2.moveToNext();
                }

            }



            return UniqueProductShortName;
        } finally {
            cursor2.close();
        }
    }

    public static void updatetblPDANotificationMaster(int MsgServerID,String Noti_text,int Noti_ReadStatus,String Noti_ReadDateTime,int Sstat)
    {

        final ContentValues values = new ContentValues();
        values.put("Noti_ReadStatus", Noti_ReadStatus);
        values.put("Noti_ReadDateTime", Noti_ReadDateTime.trim());
        values.put("Sstat", Sstat);


        int affected = db.update(TABLE_tblPDANotificationMaster_Define, values,"MsgServerID=?", new String[] { ""+MsgServerID });

        Log.w(TAG, "tblPDANotificationMaster Updated..");
    }

    public static int countNoRowIntblPDANotificationMaster()
    {
        Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblPDANotificationMaster", null);
        int chkI = 0;
        try {
            // // System.out.println("Sunil LastNitificationrList cursorE2.getCount() SerialNo : "+cursorE2.getCount());

            if(cursorE2.getCount()>0)
            {
                cursorE2.moveToFirst();
                // // System.out.println("Sunil LastNitificationrList cursorE2.getCount() SerialNo value : "+cursorE2.getString(0).toString());

                chkI=Integer.parseInt(cursorE2.getString(0).toString());
            }


        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    public static String[] LastNitificationrListDB()
    {

        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;

        Cursor cursor2 = db.rawQuery("SELECT Noti_DateTime,Noti_text  FROM tblPDANotificationMaster Order By SerialNo desc ", null);

        try
        {
            String UniqueProductShortName[] = new String[cursor2.getCount()];
            // // System.out.println("Sunil Prev Noti List cursor2.getCount() :"+cursor2.getCount());
            if(cursor2.getCount()>0)
            {
                // // System.out.println("Sunil Prev Noti List H1:");
                if (cursor2.moveToFirst())
                {
                    // // System.out.println("Sunil Prev Noti List H2:");
                    for (int i = 0; i < cursor2.getCount(); i++)
                    {
                        // // System.out.println("Sunil Prev Noti List H3:");
                        if (!cursor2.isNull(LoncolumnIndex))
                        {
                            // // System.out.println("Sunil Prev Noti List H4:");
                            UniqueProductShortName[i] =cursor2.getString(LoncolumnIndex).toString() + "_" + cursor2.getString(LoncolumnIndex1).toString();
                            // // System.out.println("Sunil Prev Noti List :"+UniqueProductShortName[i]);

                            cursor2.moveToNext();
                        }

                    }

                }
            }

            return UniqueProductShortName;
        } finally {
            cursor2.close();
        }
    }

    public static void deletetblPDANotificationMasterOneRow(int SerialNo) {

        db.execSQL("DELETE FROM tblPDANotificationMaster WHERE SerialNo ="+ SerialNo);
        for(int i=0;i<9;i++)
        {
            final ContentValues values = new ContentValues();
            values.put("SerialNo", i+1);

            int affected = db.update(TABLE_tblPDANotificationMaster_Define, values,"SerialNo=?", new String[] { ""+(i+2) });

        }

    }


    public static void updateInvoiceButtonRecordsSyncd(String flag) {

        try {

            Log.w(TAG, "Updating Synced Records..");
            //String flag1="3";

            final ContentValues values = new ContentValues();
            values.put("Sstat", "4");
            int affected = db.update("tblInvoiceButtonTransac", values, "Sstat=?",
                    new String[] { flag });

            int affected1 = db.update("tblPendingInvoices", values, "Sstat=?",
                    new String[] { flag });



			/*db.execSQL("Update tblInvoiceButtonTransac Set Sstat=4 where Sstat=7");
			db.execSQL("Update tblPendingInvoices Set Sstat=4 where Sstat=7");*/



        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }

    public static String fnGetPdaDate()
    {

        int LoncolumnIndex = 0;
        String strPDADate="";
        Cursor cursor2 = db.rawQuery("SELECT PdaDate FROM tblPdaDate", null);

        try
        {
            if(cursor2.getCount()>0)
            {
                if (cursor2.moveToFirst())
                {
                    strPDADate =cursor2.getString(LoncolumnIndex).toString();
                }
            }

            return strPDADate;
        } finally {
            cursor2.close();
        }
    }

    public static String fnGetServerDate()
    {

        int LoncolumnIndex = 0;
        String strServerDate="";
        Cursor cursor2 = db.rawQuery("SELECT ServerDate FROM tblAvailableVersion", null);

        try
        {
            if(cursor2.getCount()>0)
            {
                if (cursor2.moveToFirst())
                {
                    strServerDate =cursor2.getString(LoncolumnIndex).toString();
                }
            }

            return strServerDate;
        } finally {
            cursor2.close();
        }
    }

    public static long maintainPDADate()
    {
        db.execSQL("DELETE FROM tblPdaDate");
        Date pdaDate=new Date();
        SimpleDateFormat	sdfPDaDate = new SimpleDateFormat("dd-MMM-yyyy",Locale.ENGLISH);
        String fDatePda = sdfPDaDate.format(pdaDate).toString().trim();
        ContentValues initialValues = new ContentValues();
        initialValues.put("PdaDate",fDatePda);

        return db.insert("tblPdaDate", null, initialValues);
    }

    public static long maintainSplashPDADate()
    {
        db.execSQL("DELETE FROM tblPdaDate");
        Date pdaDate=new Date();
        SimpleDateFormat	sdfPDaDate = new SimpleDateFormat("dd-MMM-yyyy",Locale.ENGLISH);
        String fDatePda = sdfPDaDate.format(pdaDate).toString().trim();
        ContentValues initialValues = new ContentValues();
        initialValues.put("PdaDate",fDatePda);

        return db.insert("tblPdaDate", null, initialValues);
    }

    public static int fnCheckPdaDateExistOrNot()
    {

        int strReturnPDADateExistOrNot = 0;

        Cursor cursor2 = db.rawQuery("SELECT PdaDate FROM  tblPdaDate", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strReturnPDADateExistOrNot = 1;
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }

            return strReturnPDADateExistOrNot;
        } finally {
            cursor2.close();
        }
    }

    public static String[] fnGetStoreListForInvoice(String DistID,String RouteID,String ForDate)
    {
         /*  if(DistID.equals("null"))
           {
           	DistID="0";
           }
           if(RouteID.equals("null"))
           {
           	RouteID="0";
           }*/
        /*= cursor=db.rawQuery("SELECT StoreName || '(Distributor:' || DistName || ',Route:'|| RouteName ||',Date:'|| InvoiceForDate ||')' AS StoreList,StoreId||'_'||RouteId||'_'||DistId||'_'||InvoiceForDate AS SRDITag  from tblPendingInvoices Order BY StoreName", null);;
         */ // // System.out.println("Dangi new testing  DB DistID:"+DistID);
        // // System.out.println("Dangi new testing DB RouteID:"+RouteID);

        if(Integer.parseInt(DistID)!=0 && Integer.parseInt(RouteID)==0 && ForDate.equals(""))
        {
            cursor=db.rawQuery("SELECT StoreName || '(Route:'|| RouteName || ',Date:'|| InvoiceForDate ||')' AS StoreList,StoreId||'_'||OrderID||'_'||RouteId||'_'||DistId||'_'||InvoiceForDate||'_'||Sstat||'_'||flgCancel AS SRDITag,Sstat,flgCancel As flgCancel from tblPendingInvoices Where DistId='"+DistID+"' and Sstat<>4  Order BY StoreName", null);
        }
        else if(Integer.parseInt(DistID)!=0 && Integer.parseInt(RouteID)!=0 && ForDate.equals(""))
        {
            cursor=db.rawQuery("SELECT StoreName || '(Date:'|| InvoiceForDate ||')' AS StoreList,StoreId||'_'||OrderID||'_'||RouteId||'_'||DistId||'_'||InvoiceForDate||'_'||Sstat||'_'||flgCancel AS SRDITag,Sstat,flgCancel As flgCancel  from tblPendingInvoices Where DistId='"+DistID+"' and RouteId='"+RouteID+"' and Sstat<>4  Order BY StoreName", null);
        }
        else if(Integer.parseInt(DistID)!=0 && Integer.parseInt(RouteID)!=0 && !ForDate.equals(""))
        {
            cursor=db.rawQuery("SELECT StoreName  AS StoreList,StoreId||'_'||OrderID||'_'||RouteId||'_'||DistId||'_'||InvoiceForDate||'_'||Sstat||'_'||flgCancel AS SRDITag,Sstat,flgCancel As flgCancel  from tblPendingInvoices Where DistId='"+DistID+"' and RouteId='"+RouteID+"' and InvoiceForDate='"+ForDate+"' and Sstat<>4 Order BY StoreName", null);
        }
        else if(Integer.parseInt(DistID)==0 && Integer.parseInt(RouteID)!=0 && ForDate.equals(""))
        {
            cursor=db.rawQuery("SELECT StoreName || '(Date:'|| InvoiceForDate ||')' AS StoreList,StoreId||'_'||OrderID||'_'||RouteId||'_'||DistId||'_'||InvoiceForDate||'_'||Sstat||'_'||flgCancel AS SRDITag,Sstat,flgCancel As flgCancel  from tblPendingInvoices Where RouteId='"+RouteID+"' and Sstat<>4 Order BY StoreName", null);
        }
        else if(Integer.parseInt(DistID)==0 && Integer.parseInt(RouteID)!=0 && !ForDate.equals(""))
        {
            cursor=db.rawQuery("SELECT StoreName  AS StoreList,StoreId||'_'||OrderID||'_'||RouteId||'_'||DistId||'_'||InvoiceForDate||'_'||Sstat||'_'||flgCancel AS SRDITag,Sstat,flgCancel As flgCancel  from tblPendingInvoices Where RouteId='"+RouteID+"' and InvoiceForDate='"+ForDate+"' and Sstat<>4 Order BY StoreName", null);
        }
        else if(Integer.parseInt(DistID)==0 && Integer.parseInt(RouteID)==0 && !ForDate.equals(""))
        {
            cursor=db.rawQuery("SELECT StoreName || '(Route:'|| RouteName ||')' AS StoreList,StoreId||'_'||OrderID||'_'||RouteId||'_'||DistId||'_'||InvoiceForDate||'_'||Sstat||'_'||flgCancel AS SRDITag,Sstat,flgCancel As flgCancel  from tblPendingInvoices Where InvoiceForDate='"+ForDate+"' and Sstat<>4 Order BY StoreName", null);
        }
        else if(Integer.parseInt(DistID)!=0 && Integer.parseInt(RouteID)==0 && !ForDate.equals(""))
        {
            cursor=db.rawQuery("SELECT StoreName || '(Route:'|| RouteName ||')' AS StoreList,StoreId||'_'||OrderID||'_'||RouteId||'_'||DistId||'_'||InvoiceForDate||'_'||Sstat||'_'||flgCancel AS SRDITag,Sstat,flgCancel As flgCancel  from tblPendingInvoices Where DistId='"+DistID+"' and InvoiceForDate='"+ForDate+"' and Sstat<>4 Order BY StoreName", null);
        }
        else if(Integer.parseInt(DistID)==0 && Integer.parseInt(RouteID)==0 && ForDate.equals(""))
        {
            cursor=db.rawQuery("SELECT StoreName || '(Route:'|| RouteName ||',Date:'|| InvoiceForDate ||')' AS StoreList,StoreId||'_'||OrderID||'_'||RouteId||'_'||DistId||'_'||InvoiceForDate||'_'||Sstat||'_'||flgCancel AS SRDITag,Sstat,flgCancel As flgCancel  from tblPendingInvoices WHERE   Sstat<>4 Order BY StoreName", null);
        }

        try {
            String StoreInvoiceList[]= new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        // // System.out.println("getDataListAdapter = "+cursor.getString(1));
                        StoreInvoiceList[i] = cursor.getString(0) + "^"+ cursor.getString(1) + "^"+ cursor.getString(2) + "^"+ cursor.getString(3);
                        cursor.moveToNext();
                    }
                }

            }

            return StoreInvoiceList;

        } finally {
            cursor.close();
        }

    }


    public static String[] fnGetDistinctDistributorsID()
    {

        Cursor cursor=db.rawQuery("SELECT DISTINCT DistID from tblPendingInvoices Order BY DistId", null);

        try
        {
            String DistinctDistributorsID[]= new String[cursor.getCount()+1];
            if(cursor.getCount()==0)
            {
                DistinctDistributorsID[0]="0";
            }
            else {

                if (cursor.moveToFirst())
                {

                    for (int i = 0; i < cursor.getCount(); i++)
                    {
                        if(i==0)
                        {
                            DistinctDistributorsID[i]="0";
                        }

                        DistinctDistributorsID[i+1] = cursor.getString(0);
                        cursor.moveToNext();
                    }
                }

            }
            return DistinctDistributorsID;

        } finally {
            cursor.close();
        }

    }

    public static String[] fnGetDistinctDistributorsName()
    {
        Cursor cursor=db.rawQuery("SELECT DISTINCT DistName from tblPendingInvoices Order BY DistId", null);

        try {
            String DistinctDistributorsName[]= new String[cursor.getCount()+1];
            if(cursor.getCount()==0)
            {
                DistinctDistributorsName[0]="Please Select Distributor";
            }
            else
            {

                if (cursor.moveToFirst())
                {

                    for (int i = 0; i < cursor.getCount(); i++)
                    {
                        if(i==0)
                        {
                            DistinctDistributorsName[i]="Please Select Distributor";
                        }

                        DistinctDistributorsName[i+1] = cursor.getString(0);
                        cursor.moveToNext();
                    }
                }


            }
            return DistinctDistributorsName;

        } finally {
            cursor.close();
        }

    }

    public static long saveInvoiceButtonStoreTransac(String IMEIno, String TransDate,
                                              String StoreID, String ProdID,String ProductShortName,Double ProductRate,int OrderQty,
                                              int DelQty, int FreeQty,String OrderID,String CatID,String Sstat,int flgCancel,Double DiscountVal,String RutID
            ,String additionalDiscount) {


        ContentValues initialValues = new ContentValues();

        initialValues.put("IMEIno", IMEIno.trim());
        initialValues.put("TransDate", TransDate.trim());
        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("ProdID", ProdID.trim());
        initialValues.put("ProductShortName", ProductShortName.trim());
        initialValues.put("ProductPrice", ProductRate);
        initialValues.put("OrderQty", OrderQty);
        initialValues.put("DelQty", DelQty);
        initialValues.put("FreeQty", FreeQty);


        initialValues.put("Sstat", Sstat.trim());

        initialValues.put("RouteID", Integer.parseInt(RutID));
        initialValues.put("OrderID", OrderID.trim());
        initialValues.put("CatID", CatID.trim());
        initialValues.put("flgCancel", flgCancel);
        initialValues.put("DiscountVal", DiscountVal);
        initialValues.put("additionalDiscount", additionalDiscount);

        //initialValues.put(Key_DisplayUnit, DisplayUnit);

        ////// // System.out.println("inserting saveStoreTransac records..");

        return db.insert(DATABASE_TABLE_MAIN114, null, initialValues);
    }

    public static String[] ProcessCancelStoreReq()
    {

        int LoncolumnIndex = 0;
        int LoncolumnIndex2 = 1;

        Cursor cursor2 = db.rawQuery("SELECT StoreID, StoreName FROM tblPendingInvoices WHERE (Sstat=10) and Sstat<>4",null);
        //// // System.out.println("Nitish Invoice :"+cursor2.getCount());
        try
        {
            String strAreaIdsDetais[] = new String[cursor2.getCount()];

            ////// // System.out.println("records count[ProcessStoreReq]: "+cursor2.getCount());
            //// // System.out.println("Nitish Invoice 2 :"+cursor2.getCount());
            if (cursor2.moveToFirst())
            {

                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    strAreaIdsDetais[i] = (String) cursor2.getString(LoncolumnIndex)+ "%"+ (String) cursor2.getString(LoncolumnIndex2);

                    ////// // System.out.println("VAL1: "+(String) cursor2.getString(LoncolumnIndex) + "  "+"VAL2: "+(String) cursor2.getString(LoncolumnIndex2));
                    cursor2.moveToNext();
                }

            }
            return strAreaIdsDetais;
        }
        finally
        {

            cursor2.close();
        }

    }

    public static int CheckNonSubmitDataIntblPendingInvoices()
    {

        int LoncolumnIndex = 0;
        int LoncolumnIndex2 = 1;

        Cursor cursor2 = db.rawQuery("SELECT StoreID, StoreName FROM tblPendingInvoices WHERE (Sstat = 7 ) or (Sstat = 9 )  ",null);
        try
        {
            int check=0;

            if (cursor2.moveToFirst())
            {

                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    check=1;
                    cursor2.moveToNext();
                }

            }
            return check;
        }
        finally
        {
            cursor2.close();
        }

    }

    public static HashMap<String, String> FetchtblStoreProductClassificationType()
    {

        //open();
        Cursor cursor = db.rawQuery("SELECT ProductTypeNodeID,CategoryNodeID,CategoryNodeType,Category,ProductTypeNodeType,ProductType FROM tblStoreProductClassificationTypeListMstr" ,null);
        try
        {
            HashMap<String, String> SchemeIDFreePRodQtyDetails= new HashMap<String, String>();
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        SchemeIDFreePRodQtyDetails.put(cursor.getString(0).toString(), cursor.getString(1).toString()+"^"+cursor.getString(2).toString()+"^"+cursor.getString(3).toString()+"^"+cursor.getString(0).toString()+"^"+cursor.getString(4).toString()+"^"+cursor.getString(5).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return SchemeIDFreePRodQtyDetails;
        }
        finally
        {
            cursor.close();
            //close();
        }


    }

	/*private static final String DATABASE_CREATE_TABLE_222 = "create table tblStoreProductClassificationTypeListMstr(AutoIdStore integer null," +
			"CategoryNodeID integer null,CategoryNodeType integer null, Category text null,ProductTypeNodeID integer null,ProductTypeNodeType integer null,ProductType text null,IsCategorySeleted int null,IsSubCategorySeleted int null,SubCategoryValue text null);";
*/

    public static String[] ProcessConformStoreReq()
    {

        int LoncolumnIndex = 0;
        int LoncolumnIndex2 = 1;    //tblPendingInvoices

        Cursor cursor2 = db.rawQuery("SELECT StoreID, StoreName FROM tblPendingInvoices WHERE (Sstat=10) and Sstat<>4",null);
        try
        {
            String strAreaIdsDetais[] = new String[cursor2.getCount()];

            ////// // System.out.println("records count[ProcessStoreReq]: "+cursor2.getCount());

            if (cursor2.moveToFirst())
            {

                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    strAreaIdsDetais[i] = (String) cursor2.getString(LoncolumnIndex)+ "%"+ (String) cursor2.getString(LoncolumnIndex2);

                    ////// // System.out.println("VAL1: "+(String) cursor2.getString(LoncolumnIndex) + "  "+"VAL2: "+(String) cursor2.getString(LoncolumnIndex2));
                    cursor2.moveToNext();
                }

            }
            return strAreaIdsDetais;
        }
        finally
        {
            cursor2.close();
        }

    }

    public static String[] fnGetDistinctRouteId(String DistId)
    {
        //String[] DistinctDistributorsID;
        Cursor cursor=db.rawQuery("SELECT DISTINCT RouteId from tblPendingInvoices Where DistId='"+DistId+"'  Order BY RouteId", null);

        try {
            String DistinctRouteId[]= new String[cursor.getCount()+1];
            if(cursor.getCount()==0)
            {
                DistinctRouteId[0]="0";
            }
            else
            {
                if (cursor.getCount() > 0) {

                    if (cursor.moveToFirst()) {

                        for (int i = 0; i <cursor.getCount(); i++)
                        {
                            if(cursor.getCount()==0)
                            {
                                DistinctRouteId[0]="0";
                            }
                            DistinctRouteId[i+1] = cursor.getString(0);
                            cursor.moveToNext();
                        }
                    }

                }
            }
            return DistinctRouteId;

        } finally {
            cursor.close();
        }

    }

    public static String[] fnGetDistinctRouteName(String DistId)
    {
        //String[] DistinctDistributorsID;
        Cursor cursor=db.rawQuery("SELECT DISTINCT RouteName from tblPendingInvoices Where DistId='"+DistId+"'  Order BY RouteId", null);

        try {
            String DistinctRouteName[]= new String[cursor.getCount()+1];
            if(cursor.getCount()==0)
            {
                DistinctRouteName[0]="Please Select Route";
            }
            else
            {


                if (cursor.moveToFirst())
                {

                    for (int i = 0; i < cursor.getCount(); i++)
                    {
                        if(i==0)
                        {
                            DistinctRouteName[0]="Please Select Route";
                        }
                        DistinctRouteName[i+1] = cursor.getString(0);
                        cursor.moveToNext();
                    }
                }


            }
            return DistinctRouteName;

        } finally {
            cursor.close();
        }

    }

    public static void deleteOldInvoiceButtonStoreTransac(String sID2del) {
        // int entryCount;
        db.execSQL("DELETE FROM tblInvoiceButtonTransac WHERE StoreID ='" + sID2del + "'");


    }

    //public static void UpdateInvoiceButtonStoreFlag(String sID, int flag2set, String RouteId, String DistId, String Invdate,int flgCancel)
    public static void UpdateInvoiceButtonStoreFlag(String sID, int flag2set,int flgCancel,String OrderID)
    {

        try
        {



            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);
            values.put("flgCancel", flgCancel);
            ////// // System.out.println("Updating Status for Store ID: " + sID);
            //int affected = db.update("tblPendingInvoices", values, "StoreID=? AND RouteId=? AND DistId=? AND InvoiceForDate=?",new String[] { sID,RouteId,DistId,Invdate });

            int affected = db.update("tblPendingInvoices", values, "StoreID=? AND OrderID=?",new String[] { sID,OrderID });

            //int affected2 = db.update("tblInvoiceButtonTransac", values, "StoreID=? AND OrderID=?",new String[] { sID,OrderID });
            //int affected1 = db.update("tblInvoiceButtonTransac", values, "StoreID=? AND OrderID=?",new String[] { sID,OrderID });





        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }

    }

    public static void UpdatetblInvoiceButtonTransac(String sID, int flag2set,int flgCancel,String OrderID)
    {

        try
        {



            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);
            values.put("flgCancel", flgCancel);
            int affected1 = db.update("tblInvoiceButtonTransac", values, "StoreID=? AND OrderID=?",new String[] { sID,OrderID });





        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }

    }

    public static void deleteInvoiceRelatedTableEtrySavedData(String sID,String OrderID)
    {

        try
        {


            db.execSQL("DELETE FROM tblInvoiceButtonTransac WHERE StoreID='"+sID+"' and OrderID='"+OrderID+"'");


        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }

    }

    public static void UpdateInvoiceButtonCancelStoreSynFlag(String sID, int flag2set,int flgCancel)
    {

        try
        {

            final ContentValues values = new ContentValues();
            // // System.out.println("After Sync Successful Sstat: " + flag2set);
            // // System.out.println("After Sync Successful flgCancel: " + flgCancel);
            values.put("Sstat", flag2set);
            values.put("flgCancel", flgCancel);

            int affected = db.update("tblPendingInvoices", values, "StoreID=?",new String[] { sID });






        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }

    }

    public static String FetchPNameInvoice(String ProductId)
    //public static String FetchPNameInvoice()
    {

        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT ProductName FROM tblInvoiceExecutionProductList where ProductId='"+ProductId+"'", null);
        //Cursor cursor = db.rawQuery("SELECT ProductName FROM tblInvoiceExecutionProductList", null);

        try
        {
            String StoreName="0";// = new String[cursor.getCount()];
            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    StoreName= (String) cursor.getString(ScodecolumnIndex)
                            .toString();
                    ////// // System.out.println("product short name :"+StoreName[i]);
                    cursor.moveToNext();
                }
            }
            return StoreName;
        }
        finally
        {
            cursor.close();
        }
    }

    public static String[] FetchCategoryIDfromInvoiceProduct()
    {
        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT CatID FROM tblProductWiseInvoice",null);
        try
        {
            String TaxRate[] = new String[cursor.getCount()];

            if (cursor.moveToFirst())
            {
                ////// // System.out.println("CategoryID Sunil Available");
                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    TaxRate[i] = (String) cursor.getString(ScodecolumnIndex);
                    cursor.moveToNext();
                }
            }
            ////// // System.out.println("CategoryID Sunil: not");
            return TaxRate;
        }
        finally
        {
            cursor.close();
        }
    }

    public static String[] FetchOrderQtyInvoice(String StoreID,String InvoiceForDate,String OrderID) {

        int ScodecolumnIndex = 0;


        Cursor cursor = db.rawQuery("SELECT OrderQty FROM tblProductWiseInvoice where StoreID='"+StoreID+"'  and OrderID='"+OrderID+"'",null);
        try {
            String StoreName[] = new String[cursor.getCount()];
            ;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    StoreName[i] = (String) cursor.getString(ScodecolumnIndex)
                            .toString();
                    // // System.out.println("Sunil data OrderQty FROM tblProductWiseInvoice: "+ StoreName[i]);
                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }
    }

    public static String[] FetchOrderDiscountInvoice(String StoreID,String InvoiceForDate,String OrderID) {

        int ScodecolumnIndex = 0;


        Cursor cursor = db.rawQuery("SELECT TotLineDiscVal FROM tblProductWiseInvoice where StoreID='"+StoreID+"'  and OrderID='"+OrderID+"'",null);
        try {
            String StoreName[] = new String[cursor.getCount()];
            ;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    StoreName[i] = (String) cursor.getString(ScodecolumnIndex)
                            .toString();
                    // // System.out.println("Sunil data OrderQty FROM tblProductWiseInvoice: "+ StoreName[i]);
                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }
    }

    public static String[] FetchOrderFreeQtyInvoice(String StoreID,String InvoiceForDate,String OrderID) {

        int ScodecolumnIndex = 0;


        Cursor cursor = db.rawQuery("SELECT Freeqty FROM tblProductWiseInvoice where StoreID='"+StoreID+"'  and OrderID='"+OrderID+"'",null);
        try {
            String StoreName[] = new String[cursor.getCount()];
            ;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    StoreName[i] = (String) cursor.getString(ScodecolumnIndex)
                            .toString();
                    // // System.out.println("Sunil data OrderQty FROM tblProductWiseInvoice: "+ StoreName[i]);
                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }
    }

    public static String[] FetchRateInvoice(String StoreID,String InvoiceForDate,String OrderID)
    //public static String[] FetchRateInvoice()
    {

        int ScodecolumnIndex = 0;


        Cursor cursor = db.rawQuery("SELECT ProductPrice FROM tblProductWiseInvoice where StoreID='"+StoreID+"' and OrderID='"+OrderID+"'",null);
        //Cursor cursor = db.rawQuery("SELECT ProductPrice FROM tblProductWiseInvoice",null);

        try {
            String StoreName[] = new String[cursor.getCount()];
            ;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    StoreName[i] = (String) cursor.getString(ScodecolumnIndex)
                            .toString();
                    // // System.out.println("Sunil data ProductPrice FROM tblProductWiseInvoice: "+ StoreName[i]);
                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }
    }

    public static String[] FetchPidInvoice(String StoreID,String InvoiceForDate,String OrderID)
    //public static String[] FetchPidInvoice()

    {
        int ScodecolumnIndex = 0;
        ////// // System.out.println("a");
        // // System.out.println("Sameer cursor StoreID :"+ StoreID);
        // // System.out.println("Sameer cursor InvoiceForDate :"+ InvoiceForDate);

        //Cursor cursor = db.rawQuery("SELECT ProductID FROM tblProductListMaster where CategoryID='"+CATID+"'",null);
        Cursor cursor = db.rawQuery("SELECT ProductId FROM tblProductWiseInvoice where StoreID='"+StoreID+"'  and OrderID='"+OrderID+"'",null);
        //Cursor cursor = db.rawQuery("SELECT ProductId FROM tblProductWiseInvoice",null);

        ////// // System.out.println("b");
        try
        {
            String ProductId[] = new String[cursor.getCount()];

            // // System.out.println("Sameer cursor count in DBAdapter1"+ cursor.getCount());
            ////// // System.out.println("c");
            if (cursor.moveToFirst())
            {
                ////// // System.out.println("d");
                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    ////// // System.out.println("e");
                    ProductId[i] = (String) cursor.getString(ScodecolumnIndex).toString();

                    // // System.out.println("Sunil data ProductID FROM tblProductWiseInvoice: "+ ProductId[i]);
                    cursor.moveToNext();
                }
            }
            ////// // System.out.println("f");
            return ProductId;
        }
        finally
        {
            cursor.close();
        }
    }

    public static String FetchStoreNameBasedStoreID(String StoreID,String Data)
    {

        int ScodecolumnIndex = 0;
        int ScodecolumnIndex1 = 1;
        int ScodecolumnIndex2 = 2;

        Cursor cursor = db.rawQuery("SELECT StoreName,RouteName,InvoiceForDate FROM tblPendingInvoices where StoreID='"+StoreID+"' and InvoiceForDate='"+Data+"'", null);
        //Cursor cursor = db.rawQuery("SELECT ProductName FROM tblInvoiceExecutionProductList", null);

        try
        {
            String StoreName="0";// = new String[cursor.getCount()];
            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    StoreName= (String) cursor.getString(ScodecolumnIndex)
                            .toString()+"("+(String) cursor.getString(ScodecolumnIndex1)
                            .toString()+")("+(String) cursor.getString(ScodecolumnIndex2)
                            .toString()+")";
                    ////// // System.out.println("product short name :"+StoreName[i]);
                    cursor.moveToNext();
                }
            }
            return StoreName;
        }
        finally
        {
            cursor.close();
        }
    }

    public static String FetchDistNameBasedDistID(String DistId)
    {

        int ScodecolumnIndex = 0;
// // System.out.println("Sanjay testing DistID :"+DistId);

        //Cursor cursor = db.rawQuery("SELECT DistName FROM tblPendingInvoices where DistId='"+DistId+"'", null);
        Cursor cursor = db.rawQuery("SELECT DistName FROM tblPendingInvoices where DistId='"+DistId+"'", null);
        try
        {
            String StoreName="NA";// = new String[cursor.getCount()];
            // // System.out.println("Sanjay testing cursor.getCount() :"+cursor.getCount());
            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    StoreName= (String) cursor.getString(ScodecolumnIndex)
                            .toString();
                    // // System.out.println("Sanjay testing StoreName :"+StoreName);
                    cursor.moveToNext();
                }
            }
            return StoreName;
        }
        finally
        {
            cursor.close();
        }
    }

    public static void inserttblPendingInvoices(List<TblPendingInvoices> tblPendingInvoicesData,HashMap<String,String> hmapInvoiceOrderIDandStatus)//String StoreID,String StoreName,String RouteID, //String RouteName,String DistID,String DistName,String InvoiceForDate,String flgSubmit,String IMEIno,String OrderID)

    {

        db.beginTransaction();
        ContentValues initialValues=new ContentValues();
        for(TblPendingInvoices tblPendingInvoicesDataData:tblPendingInvoicesData)
        {
            int flgToInsrtOrNot=0;
            if(hmapInvoiceOrderIDandStatus.containsKey(tblPendingInvoicesDataData.getOrderID()))
            {
                if(hmapInvoiceOrderIDandStatus.get(tblPendingInvoicesDataData.getOrderID()).equals("4"))
                {

                }
                else
                {
                    flgToInsrtOrNot=1;
                    fnDeletetblInvoiceSubmittedRecords(tblPendingInvoicesDataData.getOrderID());
                }
            }
            else
            {
                flgToInsrtOrNot=1;
            }
            if(flgToInsrtOrNot==1)
            {
                initialValues.put("StoreID", tblPendingInvoicesDataData.getStoreId());
                initialValues.put("StoreName", tblPendingInvoicesDataData.getStoreName());
             initialValues.put("RouteID", tblPendingInvoicesDataData.getRouteID());
                initialValues.put("RouteNodeType", tblPendingInvoicesDataData.getRouteNodeType());
           initialValues.put("RouteName", tblPendingInvoicesDataData.getRouteName());
            initialValues.put("DistID", tblPendingInvoicesDataData.getDistID());
            initialValues.put("DistName", tblPendingInvoicesDataData.getDistName());
            initialValues.put("InvoiceForDate", tblPendingInvoicesDataData.getInvoiceForDate());
            initialValues.put("flgSubmit", tblPendingInvoicesDataData.getFlgSubmit());
            initialValues.put("Sstat",0);
            initialValues.put("IMEIno",CommonInfo.imei);
            initialValues.put("OrderID","NA");
            initialValues.put("flgCancel",0);
            initialValues.put("OrderID",tblPendingInvoicesDataData.getOrderID());
            initialValues.put("ServerOrdersFlg",0);

                db.insert(DATABASE_TABLE_MAIN111, null, initialValues);
            }

        }
        db.setTransactionSuccessful();
        db.endTransaction();
    }




    public static int getOverAllSampleQty(String sID2Fetch) {

        // id = getAllEntries();

        int SnamecolumnIndex1 = 0;
        int OverAllSampleQty=0;
        // int Stock,int OrderQty, Double OrderVal, int FreeQty, Double DisVal

        Cursor cursor = db.rawQuery("SELECT Sum(SampleQuantity)  FROM tblTransac WHERE StoreID ='"
                + sID2Fetch + "'", null);
        try {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                        OverAllSampleQty = Integer.parseInt(cursor.getString(SnamecolumnIndex1).toString());

                        cursor.moveToNext();
                        // cursor.close();

                    }

                }
            }
            return OverAllSampleQty;
        } finally {
            cursor.close();
        }

    }

    public static int counttblCountRoute()
    {
        Cursor cursorE2=null;
        int chkI = 0;
        try {
            cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblRouteListMaster", null);
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }


        } catch(Exception ex)
        {

        }
        finally {
            if(cursorE2!=null)
            {
                cursorE2.close();
            }
        }
        return chkI;
    }

    public static long savetblAvailbUpdatedVersion(String VersionID, String VersionSerialNo,String VersionDownloadStatus,String ServerDate)
    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("VersionID", VersionID.trim());
        initialValues.put("VersionSerialNo", VersionSerialNo.trim());
        initialValues.put("VersionDownloadStatus", VersionDownloadStatus.trim());
        initialValues.put("ServerDate", ServerDate.trim());
        return db.insert(TABLE_tblAvailableVersionMstr_Define, null, initialValues);
    }

    public static String FetchInvoiceButtonSstat1(String StoreID,String OrderID)
    //public static String[] FetchInvoiceButtonStoreStatus()
    {

        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT Sstat FROM tblPendingInvoices WHERE StoreID ='"+ StoreID.trim()  + "' and  OrderID ='"+ OrderID.trim()  + "'", null);
        //Cursor cursor = db.rawQuery("SELECT Sstat FROM tblPendingInvoices", null);
        // // System.out.println("Arjun cursor.getCount() :"+cursor.getCount());
        try
        {
            String StoreName ="0";// new String[cursor.getCount()];

            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    StoreName = (String) cursor.getString(ScodecolumnIndex).toString();
                    cursor.moveToNext();
                }
            }
            return StoreName;
        }
        finally
        {
            cursor.close();
        }
    }
	/*public static String getVersionNumber() {
		Cursor cursor = SQLiteDatabase.openOrCreateDatabase(":memory:", null).rawQuery("select sqlite_version() AS sqlite_version", null);
		String sqliteVersion = "";
		while(cursor.moveToNext()){
		   sqliteVersion += cursor.getString(0);
		}
		return sqliteVersion;

	}*/

    //imei,startTS,rID,getVersionNumber,DayEndFlg,ChangeRouteFlg

    public static String FetchInvoiceButtonSstat(String StoreID,String OrderID)
    //public static String[] FetchInvoiceButtonStoreStatus()
    {

        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT Sstat FROM tblInvoiceButtonTransac WHERE StoreID ='"+ StoreID.trim()  + "' and  OrderID ='"+ OrderID.trim()  + "'", null);
        //Cursor cursor = db.rawQuery("SELECT Sstat FROM tblPendingInvoices", null);
        // // System.out.println("Arjun cursor.getCount() :"+cursor.getCount());
        try
        {
            String StoreName ="0";// new String[cursor.getCount()];

            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    StoreName = (String) cursor.getString(ScodecolumnIndex).toString();
                    cursor.moveToNext();
                }
            }
            return StoreName;
        }
        finally
        {
            cursor.close();
        }
    }

    public static String[] fngetDistictOrderIdsForSubmission()
    //public static String[] FetchInvoiceButtonStoreStatus()
    {

        int ScodecolumnIndex = 0;
        //open();
        Cursor cursor = db.rawQuery("SELECT DISTINCT OrderID FROM tblInvoiceButtonTransac  order by OrderID Desc", null);
        //Cursor cursor = db.rawQuery("SELECT Sstat FROM tblPendingInvoices", null);
        // // System.out.println("Arjun cursor.getCount() :"+cursor.getCount());
        try
        {
            String[] StoreName =new String[cursor.getCount()];

            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    StoreName[i] = (String) cursor.getString(ScodecolumnIndex).toString();
                    cursor.moveToNext();
                }
            }
            return StoreName;
        }
        finally
        {
            cursor.close();
            //close();
        }
    }

    public static void UpdateTblDayStartEndDetails(int rID, int btnClickFlg) {//btnClickFlg=1(clicked on Day End) , btnClickFlg=1(clicked on ChangeRoute)

        final ContentValues values = new ContentValues();
        long syncTIMESTAMP = System.currentTimeMillis();
        Date dateobj = new Date(syncTIMESTAMP);
        SimpleDateFormat df = new SimpleDateFormat(
                "dd-MMM-yyyy HH:mm:ss",Locale.ENGLISH);
        String EndTS = df.format(dateobj);
        values.put("EndTime", EndTS);
        if(btnClickFlg==1)
        {
            values.put("DayEndFlag", 1);
            values.put("ChangeRouteFlg", 0);
        }
        if(btnClickFlg==2)
        {
            values.put("DayEndFlag", 0);
            values.put("ChangeRouteFlg", 1);
        }
        int cycleId=fetchtblVanCycleId();
        if(cycleId!=-1)
        {
            values.put("CycleId",String.valueOf(cycleId));
            int affected = db.update("tblDayStartEndDetails", values, "RouteID=?",
                    new String[] { ""+rID });
        }
        else
        {
            values.put("CycleId","0");
            int affected = db.update("tblDayStartEndDetails", values, "RouteID=?",
                    new String[] { ""+rID });
        }


        //Log.w(TAG, "affected records: " + affected);

        Log.w(TAG, "UpdatetblDayStartEndDetails Updated..");
    }

    public static long insertTblDayStartEndDetails(String imei,String startTS, String rID, int DayEndFlg, int ChangeRouteFlg, String ForDate, String strAppVersionID )//,int AppVersionID//, String getVersionNumber
    {
        db.execSQL("DELETE FROM tblDayStartEndDetails");
        ContentValues initialValues = new ContentValues();


        initialValues.put("IMEINo",imei);
        initialValues.put("SyncTime",startTS.trim());
        initialValues.put("RouteID", rID);
        //initialValues.put("VersionNo", getVersionNumber.trim());
        initialValues.put("DayEndFlag", DayEndFlg);
        initialValues.put("ChangeRouteFlg", ChangeRouteFlg);
        initialValues.put("ForDate", ForDate);
        //initialValues.put("AppVersionID", AppVersionID);
        initialValues.put("AppVersionID", strAppVersionID.trim());
        initialValues.put("Sstat", 3);


        //initialValues.put("StoreID", StoreID);

        //initialValues.put("Sstat", 0);

        ////// // System.out.println("inserting records in Details  TblDayStartEndDetails..");
        ////// // System.out.println("inserting records..");

        return db.insert(DATABASE_TABLE_MAIN12, null, initialValues);
    }

    public static int FetchVersionDownloadStatus()
    {
        int SnamecolumnIndex1 = 0;
        int CatId=0;

        Cursor cursor = db.rawQuery("SELECT VersionDownloadStatus from tblAvailableVersion", null);
        try {
            //String OldDateInfo[] = new String[cursor.getCount() ];
            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    //CatId = cursor.getString(SnamecolumnIndex1).toString();
                    String abc =(String) cursor.getString(SnamecolumnIndex1).toString();
                    CatId=Integer.parseInt(abc);
                    cursor.moveToNext();
                }

            }
            return CatId;
        } finally {
            cursor.close();
        }

    }

    public static long inserttblFirstOrderDetailsOnLastVisitDetailsActivity(String StoreID,String Date,String SKUID,int OrderQty,String FreeQty,
                                                                     int Stock,String SKUName)
    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("Date", Date.trim());
        initialValues.put("SKUID", SKUID);
        initialValues.put("OrderQty", OrderQty);
        initialValues.put("FreeQty", FreeQty.trim());
        initialValues.put("Stock", Stock);
        initialValues.put("SKUName", SKUName);

        //// // System.out.println("Aaaj insert  value table 101");
        //// // System.out.println("Ashish and Anuj insert  value table 101 : "+SKUName);

        return db.insert(DATABASE_TABLE_MAIN101 , null, initialValues);
    }

    public static long inserttblSecondVisitDetailsOnLastVisitDetailsActivity(String StoreID,String Date,String SKUID,int OrderQty,String SKUName)
    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("Date", Date.trim());
        initialValues.put("SKUID", SKUID);
        initialValues.put("OrderQty", OrderQty);
        initialValues.put("SKUName", SKUName.trim());


        //// // System.out.println("Aaaj insert  value table 102");
        return db.insert(DATABASE_TABLE_MAIN102 , null, initialValues);
    }


    public static String fnGettblFirstOrderDetailsOnLastVisitDetailsActivity(String StoreID) {
        int ScodecolumnIndex = 0;

        Cursor cursorE2 = db.rawQuery("SELECT Date FROM tblFirstOrderDetailsOnLastVisitDetailsActivity WHERE StoreID ='"+ StoreID + "' Limit 1", null);
        String LastTransDate = "";

        try {

            if (cursorE2.moveToFirst()) {

                for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
                    LastTransDate = (String) cursorE2.getString(
                            ScodecolumnIndex).toString();
                    cursorE2.moveToNext();
                }
            }
            return LastTransDate;
        } finally {
            cursorE2.close();
        }

    }

    public static String[] fetchAllDataFromtblFirstOrderDetailsOnLastVisitDetailsActivity(String strStoreID)
    {
		/*StoreID text null, " +
		"Date string null,SKUID text  null,OrderQty integer null,FreeQty integer null,Stock integer null,SKUName text null);";
		*/
        Cursor cursor = db
                .rawQuery(
                        "SELECT SKUName, Stock, OrderQty, FreeQty FROM tblFirstOrderDetailsOnLastVisitDetailsActivity WHERE StoreID ='"+ strStoreID + "'", null);

        try {

            //// // System.out.println("Aajtak value CompleteResult coung:"+cursor.getCount());
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = (String) cursor.getString(0)
                                .toString()
                                + "_"
                                + (String) cursor.getString(1).toString()
                                + "_"
                                + (String) cursor.getString(2).toString()
                                + "_"
                                + (String) cursor.getString(3).toString();

                        ////// // System.out.println("Aajtak value CompleteResult :"+CompleteResult[i]);
                        //// // System.out.println("Ashish and Anuj CompleteResult[i] : "+CompleteResult[i]);


                        cursor.moveToNext();
                    }
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public static int counttblSecondVisitDetailsOnLastVisitDetailsActivity(String StoreID)
    {
        Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblSecondVisitDetailsOnLastVisitDetailsActivity WHERE StoreID ='"
                + StoreID + "'", null);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    public static String fnGettblSecondVisitDetailsOnLastVisitDetailsActivity(String StoreID) {

        Cursor cursorE2 = db.rawQuery("SELECT Date FROM tblSecondVisitDetailsOnLastVisitDetailsActivity WHERE StoreID ='"
                + StoreID + "'", null);
        String LastTransDate = "";
        int ScodecolumnIndex = 0;
        try {

            if (cursorE2.moveToFirst()) {

                for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
                    LastTransDate = (String) cursorE2.getString(
                            ScodecolumnIndex).toString();
                    cursorE2.moveToNext();
                }
            }
            return LastTransDate;
        } finally {
            cursorE2.close();
        }

    }

    public static String[] fetchtblSecondVisitDetailsOnLastVisitDetailsActivity(String sID2Fetch) {

        // id = getAllEntries();

        int SnamecolumnIndex1 = 0;
        int SnamecolumnIndex2 = 1;

        Cursor cursor = db
                .rawQuery(
                        "SELECT SKUName, OrderQty  FROM tblSecondVisitDetailsOnLastVisitDetailsActivity WHERE StoreID ='"
                                + sID2Fetch + "'", null);
        try {

            String ProductTarget[] = new String[cursor.getCount()];
            ;

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                    ProductTarget[i] = (String) cursor.getString(
                            SnamecolumnIndex1).toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex2)
                            .toString();

                    cursor.moveToNext();
                    // cursor.close();

                }

            }
            return ProductTarget;
        } finally {
            cursor.close();
        }

    }

    public static void truncateSKUDataTable()
    {
        db.execSQL("DELETE FROM tblSKUWiseDaySummary");

    }

    public static void truncateStoreWiseDataTable()
    {
        db.execSQL("DELETE FROM tblStoreWiseDaySummary");

    }

    public static void truncateStoreAndSKUWiseDataTable()
    {
        db.execSQL("DELETE FROM tblStoreSKUWiseDaySummary");

    }

    public static void truncateAllSummaryDataTable()
    {
        db.execSQL("DELETE FROM tblAllSummary");

    }

    public static void reTruncateRouteTbl()
    {
        db.execSQL("DELETE FROM tblRouteListMaster");
        //db.execSQL("DELETE FROM tblAvailableVersion");
    }

    public static void reCreateDB()
    {
        sPref= contextForRecreate.getSharedPreferences(CommonInfo.Preference, contextForRecreate.MODE_PRIVATE);
        Editor editor=sPref.edit();
        editor.clear();
        editor.commit();

        sharedPrefReport=contextForRecreate.getSharedPreferences("Report", contextForRecreate.MODE_PRIVATE);
        Editor editorReport=sharedPrefReport.edit();
        editorReport.clear();
        editorReport.commit();

        SplashScreen.sPrefVanStockChanged = contextForRecreate.getSharedPreferences(CommonInfo.sPrefVanLoadedUnloaded, 0);
        Editor editorVanStockChanged = SplashScreen.sPrefVanStockChanged.edit();
        editorVanStockChanged.clear();
        editorVanStockChanged.commit();
        db.execSQL("DELETE FROM tblAllServicesCalledSuccessfull");
        db.execSQL("DELETE FROM tblStoreOrderVisitDayActivity");
        db.execSQL("DELETE FROM  tblCollectionReportCashChange");
        db.execSQL("DELETE FROM  tblCollectionReportChequeChange");

        db.execSQL("DELETE FROM  tblStoreCheckInPic");

        db.execSQL("DELETE FROM  tblActualVisitStock");
        db.execSQL("DELETE FROM tblAttandanceDetails");
        db.execSQL("DELETE FROM tblInvoiceDetails");
        db.execSQL("DELETE FROM tblTmpInvoiceHeader");
        db.execSQL("DELETE FROM tblStoreVisitMstr");
        db.execSQL("DELETE FROM tblInvoiceHeader");
        db.execSQL("DELETE FROM tblStockUploadedStatus");
        db.execSQL("DELETE FROM tblCycleID");
        db.execSQL("DELETE FROM tblStockConfirm");

        db.execSQL("DELETE FROM tblDistributorProductStock");
        db.execSQL("DELETE FROM tblTmpDistributorStock");



        db.execSQL("DELETE FROM tblDayCheckIn");
        db.execSQL("DELETE FROM tblPriceApplyType");
        db.execSQL("DELETE FROM tblInvoiceCaption");
        db.execSQL("DELETE FROM tblLastOutstanding");
        db.execSQL("DELETE FROM tblInvoiceLastVisitDetails");
        db.execSQL("DELETE FROM tblStockConfirm");
        db.execSQL("DELETE FROM tblStoreList");
        db.execSQL("DELETE FROM tblNewAddedStoreLocationDetails");
       // db.execSQL("DELETE FROM tblProductListMaster");
        db.execSQL("DELETE FROM tblProductSegementMap");
        db.execSQL("DELETE FROM tblCategoryMaster");

        db.execSQL("DELETE FROM tblVisibilityMstr");
        db.execSQL("DELETE FROM tblVisibilityDetails");



        db.execSQL("DELETE FROM tblNewStoreListEntries");
        db.execSQL("DELETE FROM tblPDALastInvoiceDet");
        db.execSQL("DELETE FROM tblPDATargetQtyForSecondPage");
        db.execSQL("DELETE FROM tblPDAProductReturnMstr");
        db.execSQL("DELETE FROM tblPDAProductReturnDetails");

        db.execSQL("DELETE FROM tblTransac");
        db.execSQL("DELETE FROM tblTmpInvoiceHeader");
        db.execSQL("DELETE FROM tblStoreProductMap");
        db.execSQL("DELETE FROM tblSchemeList");
        db.execSQL("DELETE FROM tblSchemeDetails");
        db.execSQL("DELETE FROM tblschemeStoreTypeMap");
        db.execSQL("DELETE FROM tblschemeProductMap");
        db.execSQL("DELETE FROM tblspForPDASchemeApplicableList");
        db.execSQL("DELETE FROM tblPDAIsSchemeApplicable");
        db.execSQL("DELETE FROM tblLastTransactionDetails");
        db.execSQL("DELETE FROM tblPDALastTranDateForSecondPage");
        db.execSQL("DELETE FROM tblStorTypeMstr");
        db.execSQL("DELETE FROM tblSyncSummuryDetails");

        db.execSQL("DELETE FROM tblSyncSummuryForProductDetails");
        db.execSQL("DELETE FROM tblStrachApplicableOnScheme");
        db.execSQL("DELETE FROM tblStrachOnSchemeDetails");
        db.execSQL("DELETE FROM tblOutLetInfoOnQuadVolumeCategoryBasis");
        db.execSQL("DELETE FROM tblSelectedStoreIDinChangeRouteCase");
        db.execSQL("DELETE FROM tblSysVisitID");
        db.execSQL("DELETE FROM tblDaySummaryNew");

        db.execSQL("DELETE FROM tblFirstOrderDetailsOnLastVisitDetailsActivity");
        db.execSQL("DELETE FROM tblSecondVisitDetailsOnLastVisitDetailsActivity");
        db.execSQL("DELETE FROM tblPDAGetLODQty");


        //db.execSQL("DELETE FROM tblPendingInvoices");
        db.execSQL("DELETE FROM tblInvoiceExecutionProductList");
        //db.execSQL("DELETE FROM tblProductWiseInvoice");
        //db.execSQL("DELETE FROM tblInvoiceButtonTransac");

        db.execSQL("DELETE FROM  tblPDAGetLastVisitDate");
        db.execSQL("DELETE FROM  tblPDAGetLastOrderDate");
        db.execSQL("DELETE FROM  tblPDAGetLastVisitDetails");
        db.execSQL("DELETE FROM  tblPDAGetLastOrderDetails");
        db.execSQL("DELETE FROM  tblPDAGetLastOrderDetailsTotalValues");
        db.execSQL("DELETE FROM  tblPDAGetExecutionSummary");
        db.execSQL("DELETE FROM  tblStoreSchemeFreeProQtyOtherDetails");



        db.execSQL("DELETE FROM  tblSchemeStoreMapping");
        db.execSQL("DELETE FROM  tblSchemeMstr");
        db.execSQL("DELETE FROM  tblSchemeSlabDetail");
        db.execSQL("DELETE FROM  tblSchemeSlabBucketDetails");
        db.execSQL("DELETE FROM  tblSchemeSlabBucketProductMapping");
        db.execSQL("DELETE FROM  tblSchemeSlabBenefitsBucketDetails");
        db.execSQL("DELETE FROM  tblSchemeSlabBenefitsProductMappingDetail");
        db.execSQL("DELETE FROM  tblSchemeSlabBenefitsValueDetail");
        db.execSQL("DELETE FROM  tblProductRelatedScheme");
        db.execSQL("DELETE FROM  tblTmpInvoiceDetails");
        db.execSQL("DELETE FROM  tblStoreProductAppliedSchemesBenifitsRecords");

        db.execSQL("DELETE FROM  tblStoreProductPhotoDetail");
        db.execSQL("DELETE FROM  tblStoreReturnDetail");


        db.execSQL("DELETE FROM  tblAlrtVal");
        db.execSQL("DELETE FROM  tblProductMappedWithSchemeSlabApplied");

        db.execSQL("DELETE FROM tblPOSMaterialMstr");
        db.execSQL("DELETE FROM tblStoreIDAndMaterialIDMap");
        db.execSQL("DELETE FROM  tblStoreMaterialDetail");
        db.execSQL("DELETE FROM  tblStoreMaterialPhotoDetail");


        Log.w(TAG, "Table re-creation completed..");
    }

    public static void refreshDataFromDB()
    {
        //db.execSQL("DELETE FROM tblProductListMaster");
        //db.execSQL("DELETE FROM tblPDAProductReturnMstr");
        //db.execSQL("DELETE FROM tblStoreProductMap");
        //db.execSQL("DELETE FROM tblSchemeList");
        //db.execSQL("DELETE FROM tblSchemeDetails");

        //db.execSQL("DELETE FROM tblschemeProductMap");
        //db.execSQL("DELETE FROM tblspForPDASchemeApplicableList");
        //db.execSQL("DELETE FROM tblLastTransactionDetails");
        //db.execSQL("DELETE FROM tblPDALastTranDateForSecondPage");
        //db.execSQL("DELETE FROM tblSyncSummuryForProductDetails");

    }

    // ---opens the database---
	/*public static PRJDatabase open() throws SQLException {
		db = DBHelper.getWritableDatabase();
		return this;
	}
*/
    // ---closes the database---
	/*public static void close() {
		DBHelper.close();
	}*/

    public static void Delete_tblProductList_for_refreshData()
    {
        db.execSQL("DELETE FROM tblProductListMaster");
        db.execSQL("DELETE FROM tblProductSegementMap");
        db.execSQL("DELETE FROM tblPriceApplyType");
        db.execSQL("Delete From tblUOMMaster");
        db.execSQL("Delete From tblUOMMapping");
    }

    public static void Delete_tblLastOutstanding_for_refreshData()
    {
        db.execSQL("DELETE FROM tblLastOutstanding");
        db.execSQL("DELETE FROM tblInvoiceLastVisitDetails");

    }

    //
    public static void Delete_tblCategory_for_refreshData()
    {
        db.execSQL("DELETE FROM tblCategoryMaster");
    }

    public static void Delete_tblStore_for_refreshData()
    {
        db.execSQL("DELETE FROM tblStoreList");
    }

    public static void Delete_tblStore_for_refreshDataButNotNewStore()
    {
        db.execSQL("DELETE FROM tblStoreList where ISNewStore<>1");
        db.execSQL("DELETE FROM tblNewAddedStoreLocationDetails where Sstat=4");
    }

    public static void Delete_tblMaterialAndStoreIDMap()
    {
        db.execSQL("DELETE FROM tblPOSMaterialMstr");

        db.execSQL("DELETE FROM tblStoreIDAndMaterialIDMap");
    }

    public static void Delete_tblStoreProductMap_for_refreshData()
    {
        db.execSQL("DELETE FROM tblSchemeStoreMapping");

        db.execSQL("DELETE FROM tblSchemeMstr");

        db.execSQL("DELETE FROM tblSchemeSlabDetail");

        db.execSQL("DELETE FROM tblSchemeSlabBucketDetails");

        db.execSQL("DELETE FROM tblSchemeSlabBucketProductMapping");

        db.execSQL("DELETE FROM tblSchemeSlabBenefitsBucketDetails");

        db.execSQL("DELETE FROM tblSchemeSlabBenefitsProductMappingDetail");

        db.execSQL("DELETE FROM tblSchemeSlabBenefitsValueDetail");

        db.execSQL("DELETE FROM tblProductRelatedScheme");
    }

    public static void Delete_tblSchemeList_for_refreshData()
    {
        db.execSQL("DELETE FROM tblSchemeList");
    }

    public static void Delete_tblSchemeDetails_for_refreshData()
    {
        db.execSQL("DELETE FROM tblLastTransactionDetails");
    }

    public static void Delete_tblschemeProductMap_for_refreshData()
    {
        db.execSQL("DELETE FROM tblschemeProductMap");
    }

    public static void Delete_tblspForPDASchemeApplicableList_for_refreshData()
    {
        db.execSQL("DELETE FROM tblspForPDASchemeApplicableList");
    }

    public static void Delete_tblLastTransactionDetails_for_refreshData()
    {
        db.execSQL("DELETE FROM tblLastTransactionDetails");
    }

    public static void Delete_tblPDALastTranDateForSecondPage_for_refreshData()
    {

        db.execSQL("DELETE FROM tblPDALastTranDateForSecondPage");
    }

    public static void Delete_tblSyncSummuryForProductDetails_for_refreshData()
    {
        db.execSQL("DELETE FROM tblSyncSummuryForProductDetails");
    }

    public static boolean doesDatabaseExist(ContextWrapper context, String dbName) {
        File dbFile = context.getDatabasePath(dbName);

        return dbFile.exists();
    }

    public static void dropAvailbUpdatedVersionTBL()
    {
        db.execSQL("DROP TABLE IF EXISTS tblAvailableVersion");

    }

    public static void createAvailbUpdatedVersionTBL()
    {
        try
        {
            db.execSQL(TABLE_tblAvailableVersionMstr_Definition);
        }
        catch (Exception e)
        {

        }

    }

    public static long insertTblDaySummaryNew(int TargetCalls,int ActualCallOnRoute, int ActualCallOffRoute, int ProdCallOnRoute, int ProdCallOffRoute, Double TargetSalesForDay,Double TotalSalesForDay,int CallsRemaining,Double TargetSalesMTD,Double AchievedSalesMTD,int ProdStoresMTD,Double RunRate)
    {
        ContentValues initialValues = new ContentValues();
        initialValues.put("TargetCalls",TargetCalls);
        initialValues.put("ActualCallOnRoute",ActualCallOnRoute);
        initialValues.put("ActualCallOffRoute", ActualCallOffRoute);
        initialValues.put("ProdCallOnRoute", ProdCallOnRoute);
        initialValues.put("ProdCallOffRoute", ProdCallOffRoute);
        initialValues.put("TargetSalesForDay", TargetSalesForDay);
        initialValues.put("TotalSalesForDay", TotalSalesForDay);
        initialValues.put("CallsRemaining", CallsRemaining);
        initialValues.put("TargetSalesMTD", TargetSalesMTD);
        initialValues.put("AchievedSalesMTD", AchievedSalesMTD);
        initialValues.put("ProdStoresMTD", ProdStoresMTD);
        initialValues.put("RunRate", RunRate);
        return db.insert(DATABASE_TABLE_SummaryDayTableSummaryNew, null, initialValues);
    }

    public static int getTargetCall()
    {
        int LoncolumnIndex = 0;
        int TargetCall = 0;


        Cursor cursor2 = db.rawQuery("SELECT TargetCalls FROM tblDaySummaryNew", null);
        try {
            if(cursor2.getCount()>0)
            {
                if (cursor2.moveToFirst())
                {

                    for (int i = 0; i < cursor2.getCount(); i++)
                    {

                        if (!cursor2.isNull(LoncolumnIndex))
                        {
                            if(Integer.parseInt(cursor2.getString(LoncolumnIndex).toString())>0)
                            {
                                TargetCall =Integer.parseInt(cursor2.getString(LoncolumnIndex).toString());
                                ////// // System.out.println("Summary Target Call :"+TargetCall);
                            }

                            //TotSalesValueStoreBasis =""+ Double.parseDouble(cursor2.getString(LoncolumnIndex).toString());
                            cursor2.moveToNext();
                        }


                    }

                }
            }

            return TargetCall;
        } finally {
            cursor2.close();
        }
    }

    public static int fnChkFlgTodayRoute(String CurrentRouteID)
    {
        int LoncolumnIndex = 0;
        int FchkFlgOnRoute = 0;
        Cursor cursor2 = db.rawQuery("SELECT Active FROM tblRouteListMaster where ID='"+CurrentRouteID+"'", null);
        try {
            if(cursor2.getCount()>0)
            {
                if (cursor2.moveToFirst())
                {
                    for (int i = 0; i < cursor2.getCount(); i++)
                    {

                        if (!cursor2.isNull(LoncolumnIndex))
                        {
                            FchkFlgOnRoute =Integer.parseInt(cursor2.getString(LoncolumnIndex).toString());
                            cursor2.moveToNext();
                        }
                    }
                }
            }

            return FchkFlgOnRoute;
        } finally {
            cursor2.close();
        }
    }

    public static int fnGetActualCallOnRouteFromSummaryTable()//If fnChkFlgTodayRoute=1 it will get added to Actual Call On Route Else get Added in Off Route
    {

        int LoncolumnIndex = 0;
        int ActualCall = 0;
        Cursor cursor2= db.rawQuery("SELECT ActualCallOnRoute FROM tblDaySummaryNew", null);
        try {
            if(cursor2.getCount()>0)
            {
                if (cursor2.moveToFirst())
                {
                    for (int i = 0; i < cursor2.getCount(); i++)
                    {

                        if (!cursor2.isNull(LoncolumnIndex))
                        {
                            ActualCall =Integer.parseInt(cursor2.getString(LoncolumnIndex).toString());
                            cursor2.moveToNext();
                        }
                    }
                }
            }

            return ActualCall;
        } finally {
            cursor2.close();
        }
    }

    public static int fnGetActualCallOffRouteFromSummaryTable()//If fnChkFlgTodayRoute=1 it will get added to Actual Call On Route Else get Added in Off Route
    {

        int LoncolumnIndex = 0;
        int ActualCall = 0;
        Cursor cursor2= db.rawQuery("SELECT ActualCallOffRoute FROM tblDaySummaryNew", null);
        try {
            if(cursor2.getCount()>0)
            {
                if (cursor2.moveToFirst())
                {
                    for (int i = 0; i < cursor2.getCount(); i++)
                    {

                        if (!cursor2.isNull(LoncolumnIndex))
                        {
                            ActualCall =Integer.parseInt(cursor2.getString(LoncolumnIndex).toString());
                            cursor2.moveToNext();
                        }
                    }
                }
            }

            return ActualCall;
        } finally {
            cursor2.close();
        }
    }

    public static int fnGetProductiveCallOnRoute()//If fnChkFlgTodayRoute=1 it will get added to Actual Call On Route Else get Added in Off Route
    {

        int LoncolumnIndex = 0;
        int ProductiveCall = 0;
        Cursor cursor2= db.rawQuery("SELECT ProdCallOnRoute FROM tblDaySummaryNew", null);
        try {
            if(cursor2.getCount()>0)
            {
                if (cursor2.moveToFirst())
                {
                    for (int i = 0; i < cursor2.getCount(); i++)
                    {

                        if (!cursor2.isNull(LoncolumnIndex))
                        {
                            ProductiveCall =Integer.parseInt(cursor2.getString(LoncolumnIndex).toString());
                            cursor2.moveToNext();
                        }
                    }
                }
            }

            return ProductiveCall;
        } finally {
            cursor2.close();
        }
    }

    public static int fnGetProductiveCallOffRoute()//If fnChkFlgTodayRoute=1 it will get added to Actual Call On Route Else get Added in Off Route
    {

        int LoncolumnIndex = 0;
        int ProductiveCall = 0;
        Cursor cursor2= db.rawQuery("SELECT ProdCallOffRoute FROM tblDaySummaryNew", null);
        try {
            if(cursor2.getCount()>0)
            {
                if (cursor2.moveToFirst())
                {
                    for (int i = 0; i < cursor2.getCount(); i++)
                    {

                        if (!cursor2.isNull(LoncolumnIndex))
                        {
                            ProductiveCall =Integer.parseInt(cursor2.getString(LoncolumnIndex).toString());
                            cursor2.moveToNext();
                        }
                    }
                }
            }

            return ProductiveCall;
        } finally {
            cursor2.close();
        }
    }

    public static int fnGetActualCallOnOffRoute()//If fnChkFlgTodayRoute=1 it will get added to Actual Call On Route Else get Added in Off Route
    {

        int LoncolumnIndex = 0;
        int ActualCall = 0;
        Cursor cursor2= db.rawQuery("SELECT Count(StoreID) FROM tblTmpInvoiceHeader", null);
        try {
            if(cursor2.getCount()>0)
            {
                if (cursor2.moveToFirst())
                {
                    for (int i = 0; i < cursor2.getCount(); i++)
                    {

                        if (!cursor2.isNull(LoncolumnIndex))
                        {
                            ActualCall =Integer.parseInt(cursor2.getString(LoncolumnIndex).toString());
                            cursor2.moveToNext();
                        }
                    }
                }
            }

            return ActualCall;
        } finally {
            cursor2.close();
        }
    }

    public static int fnGetProductiveCallOnOffRoute()//If fnChkFlgTodayRoute=1 it will get added to Productive Call On Route Else get Added in Off Route
    {

        int LoncolumnIndex = 0;
        int ActualProductiveCall = 0;
        Double TotInvoiceValCall = 0.00;
        Cursor cursor2 = db.rawQuery("SELECT Count(StoreID) FROM tblTmpInvoiceHeader where InvoiceVal>" + TotInvoiceValCall, null);
        try {
            if(cursor2.getCount()>0)
            {
                if (cursor2.moveToFirst())
                {
                    for (int i = 0; i < cursor2.getCount(); i++)
                    {

                        if (!cursor2.isNull(LoncolumnIndex))
                        {
                            ActualProductiveCall =Integer.parseInt(cursor2.getString(LoncolumnIndex).toString());
                            cursor2.moveToNext();
                        }
                    }
                }
            }

            return ActualProductiveCall;
        } finally {
            cursor2.close();
        }
    }

    public static double fnGetTargetSalesforDayRoute()
    {
        int LoncolumnIndex = 0;
        Double TargetSalesForDay = 0.00;
        Cursor cursor2 = db.rawQuery("SELECT TargetSalesForDay FROM tblDaySummaryNew", null);
        try {
            if(cursor2.getCount()>0)
            {
                if (cursor2.moveToFirst())
                {
                    for (int i = 0; i < cursor2.getCount(); i++)
                    {

                        if (!cursor2.isNull(LoncolumnIndex))
                        {
                            TargetSalesForDay =Double.parseDouble(cursor2.getString(LoncolumnIndex).toString());
                            cursor2.moveToNext();
                        }
                    }
                }
            }

            return TargetSalesForDay;
        } finally {
            cursor2.close();
        }
    }

    public static double fnGetTotalSalesforDay()
    {

        int LoncolumnIndex = 0;
        Double TotalSalesForDay =fnGetTotalSalesforDayRouteFromtblSummaryNew();// 0.00;
        String TotalSalesInvoice=fnGetTotalSales();
        ////// // System.out.println("Abhinav Raj Summary New TotSalesValue from function now: "+TotalSalesInvoice);
        Double OverAllSalesForDay=0.00;
        Double ckk11=Double.parseDouble(TotalSalesInvoice.replace(",", ""));
        //// // System.out.println("Abhinav Raj Summary New ckk11 from function now: "+ckk11);
        //// // System.out.println("Abhinav Raj Summary New OverAllSalesForDay from function now: "+TotalSalesForDay);

        OverAllSalesForDay=TotalSalesForDay+ckk11;


        //// // System.out.println("Abhinav Raj Summary New OverAllSalesForDay from function now: "+OverAllSalesForDay);
        //OverAllSalesForDay=Double.parseDouble(new DecimalFormat("##.##").format(OverAllSalesForDay));
        //OverAllSalesForDay=Double.parseDouble(decimalFormat.format(OverAllSalesForDay));
        ////// // System.out.println("Abhinav Raj Summary New OverAllSalesForDay from function 2 now: "+OverAllSalesForDay);
        return OverAllSalesForDay;

    }

    public static double fnGetTotalSalesforDayRouteFromtblSummaryNew()
    {
        int LoncolumnIndex = 0;
        Double TotalSalesForDay = 0.00;
        Cursor cursor2 = db.rawQuery("SELECT TotalSalesForDay FROM tblDaySummaryNew", null);
        try {
            if(cursor2.getCount()>0)
            {
                if (cursor2.moveToFirst())
                {
                    for (int i = 0; i < cursor2.getCount(); i++)
                    {

                        if (!cursor2.isNull(LoncolumnIndex))
                        {
                            TotalSalesForDay =Double.parseDouble(cursor2.getString(LoncolumnIndex).toString());
                            ////// System.out.println("Abhinav Raj Summary New TotalSalesForDay from function: "+TotalSalesForDay);
                            cursor2.moveToNext();
                        }
                    }
                }
            }

            return TotalSalesForDay;
        } finally {
            cursor2.close();
        }
    }

    public static double fnGetTargetSalesMTDforDayRouteFromtblSummaryNew()
    {
        int LoncolumnIndex = 0;
        Double TotalSalesForDay = 0.00;
        Cursor cursor2 = db.rawQuery("SELECT TargetSalesMTD FROM tblDaySummaryNew", null);
        try {
            if(cursor2.getCount()>0)
            {
                if (cursor2.moveToFirst())
                {
                    for (int i = 0; i < cursor2.getCount(); i++)
                    {

                        if (!cursor2.isNull(LoncolumnIndex))
                        {
                            TotalSalesForDay =Double.parseDouble(cursor2.getString(LoncolumnIndex).toString());
                            cursor2.moveToNext();
                        }
                    }
                }
            }

            return TotalSalesForDay;
        } finally {
            cursor2.close();
        }
    }

    public static double fnGetAchivedSalesMTDforDayRouteFromtblSummaryNew()
    {
        int LoncolumnIndex = 0;
        Double TotalSalesForDay = 0.00;
        Cursor cursor2 = db.rawQuery("SELECT AchievedSalesMTD FROM tblDaySummaryNew", null);
        try {
            if(cursor2.getCount()>0)
            {
                if (cursor2.moveToFirst())
                {
                    for (int i = 0; i < cursor2.getCount(); i++)
                    {

                        if (!cursor2.isNull(LoncolumnIndex))
                        {
                            TotalSalesForDay =Double.parseDouble(cursor2.getString(LoncolumnIndex).toString());
							/*////// System.out.println("Abhinav Raj Summary New TotalSalesForDay from function what 1 now: "+TotalSalesForDay);
							TotalSalesForDay=Double.parseDouble(decimalFormat.format(TotalSalesForDay));
							////// System.out.println("Abhinav Raj Summary New TotalSalesForDay from function what 2 now: "+TotalSalesForDay);*/
                            cursor2.moveToNext();
                        }
                    }
                }
            }

            return TotalSalesForDay;
        } finally {
            cursor2.close();
        }
    }

    public static double fnGetOverAllAchivedSalesMTD()
    {

        int LoncolumnIndex = 0;
        Double TotalSalesForDay =fnGetAchivedSalesMTDforDayRouteFromtblSummaryNew();// 0.00;
        String TotalSalesInvoice=fnGetTotalSales();
        Double OverAchivedSalesForDay=0.00;
        Double chk11=Double.parseDouble(TotalSalesInvoice);
        OverAchivedSalesForDay=TotalSalesForDay+chk11;
        //Sval= Double.parseDouble(new DecimalFormat("##.##").format(Sval));
        //OverAchivedSalesForDay=Double.parseDouble(decimalFormat.format(OverAchivedSalesForDay));
        //OverAchivedSalesForDay=Double.parseDouble(new DecimalFormat("###.##").format(OverAchivedSalesForDay));
        ////// System.out.println("Abhinav Raj Summary New What 3 OverAchivedSalesForDay:"+OverAchivedSalesForDay);
        return OverAchivedSalesForDay;

    }

    public static int fnGetProdStoresMTD()
    {

        int LoncolumnIndex = 0;
        int ProdStoresMTD = 0;
        Cursor cursor2 = db.rawQuery("SELECT ProdStoresMTD FROM tblDaySummaryNew", null);
        try {
            if(cursor2.getCount()>0)
            {
                if (cursor2.moveToFirst())
                {
                    for (int i = 0; i < cursor2.getCount(); i++)
                    {

                        if (!cursor2.isNull(LoncolumnIndex))
                        {
                            ProdStoresMTD =Integer.parseInt(cursor2.getString(LoncolumnIndex).toString());
                            cursor2.moveToNext();
                        }
                    }
                }
            }

            return ProdStoresMTD;
        } finally {
            cursor2.close();
        }
    }

    public static double fnGetRunRate()
    {

        int LoncolumnIndex = 0;
        Double RunRate = 0.00;
        Cursor cursor2 = db.rawQuery("SELECT RunRate FROM tblDaySummaryNew", null);
        try {
            if(cursor2.getCount()>0)
            {
                if (cursor2.moveToFirst())
                {
                    for (int i = 0; i < cursor2.getCount(); i++)
                    {

                        if (!cursor2.isNull(LoncolumnIndex))
                        {
                            RunRate =Double.parseDouble(cursor2.getString(LoncolumnIndex).toString());
                            cursor2.moveToNext();
                        }
                    }
                }
            }

            return RunRate;
        } finally {
            cursor2.close();
        }
    }

    public static HashMap<String,String> fetchHmapInvoiceOrderIDandStatus()
    {

        HashMap<String, String> hmapOrderIDandClickStatus=new HashMap<String, String>();
        //open();
        Cursor cursor = db.rawQuery("SELECT OrderID,Sstat FROM tblPendingInvoices", null);
        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i < cursor.getCount(); i++) {
                        hmapOrderIDandClickStatus.put((String) cursor.getString(0).toString(),(String) cursor.getString(1).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return hmapOrderIDandClickStatus;
        } finally {
            cursor.close();
           // close();
        }

    }

    public static String[] fnGetServerOrdersFlgWith1()
    {

        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT OrderID  FROM tblPendingInvoices Where ServerOrdersFlg=1", null);
        try {
            String allData[]=new String[cursor.getCount()];
            if (cursor.moveToFirst()) {

                for (int i = 0; i < cursor.getCount(); i++)
                {
                    ScodecolumnIndex = 1;
                    allData[i] = (String) cursor.getString(0).toString().trim();
                    //// System.out.println("Value inserting 231 fetching :"+allData[i]);
                    cursor.moveToNext();
                    // cursor.close();
                }

            }
            ////// System.out.println("value  of new store is in DBadapter"+ScodecolumnIndex);
            return allData;
        } finally {
            cursor.close();
        }
    }

    public static void fnDeletetblInvoiceExecutionProductList()
    {
        try
        {
            db.execSQL("DELETE FROM tblInvoiceExecutionProductList");
        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }

    }

    public static void fnAllServerOrdersFlgWith0()
    {
        try
        {
            //open();
            db.execSQL("Update tblPendingInvoices Set ServerOrdersFlg=1 where ServerOrdersFlg=0");
           // close();

        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }

    }

    public static void fnDeleteUnWantedSubmitedInvoiceOrders()
    {
        try
        {
            String[] arrOrdersServerOrdersFlg=fnGetServerOrdersFlgWith1();
            if(arrOrdersServerOrdersFlg.length>0)
            {
                for(int i=0;i<arrOrdersServerOrdersFlg.length;i++)
                {
                    db.execSQL("Delete from tblPendingInvoices where OrderID='"+arrOrdersServerOrdersFlg[i]+"'");
                    db.execSQL("Delete from tblProductWiseInvoice where OrderID='"+arrOrdersServerOrdersFlg[i]+"'");
                    db.execSQL("Delete from tblInvoiceButtonTransac where OrderID='"+arrOrdersServerOrdersFlg[i]+"'");
                }
            }

        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }

    }

    public static void fnDeletetblInvoiceSubmittedRecords(String OrderID)
    {
        try
        {
            db.execSQL("Delete from tblPendingInvoices where OrderID='"+OrderID+"'");
            db.execSQL("Delete from tblProductWiseInvoice where OrderID='"+OrderID+"'");
            db.execSQL("Delete from tblInvoiceButtonTransac where OrderID='"+OrderID+"'");
        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }

    }

    public static void reTruncateInvoiceButtonTable()
    {
        db.execSQL("DELETE FROM tblPendingInvoices");
        //db.execSQL("DELETE FROM tblInvoiceExecutionProductList");
        db.execSQL("DELETE FROM tblProductWiseInvoice");
        db.execSQL("DELETE FROM tblInvoiceButtonTransac");
    }

    public static int counttblCatagoryMstr()
    {
        Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblCategoryMaster", null);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    /*	public static int fnChkStoreIdExistInDaySumaryTbl(String StrID)//On Store Selection VisitStart Activity
	{
		int flgChkStatus=0;

		int LoncolumnIndex = 0;


		Cursor cursor2 = db.rawQuery("SELECT StoreID FROM  tblDaySummary where StoreID='"+ StrID + "'", null);
		try {


			if(cursor2.getCount()>0)
			{
				if (cursor2.moveToFirst()) {

					for (int i = 0; i < cursor2.getCount(); i++) {
						flgChkStatus = 1;
						cursor2.moveToNext();
						// cursor.close();
					}

				}
			}
			return flgChkStatus;
		} finally {
			cursor2.close();
		}
	}

	public static long fnInsertStoreIfNotExistIntblDaySummary(String StrID)//On Store Selection VisitStart Activity/Add Store Activity
	{
		//This function will get called if fnChkStoreIdExistInDaySumaryTbl returns 0.

		ContentValues initialValues = new ContentValues();


		initialValues.put("StoreID", StrID);
		initialValues.put("flgTarget", 0);
		initialValues.put("flgActualVisited", 0);
		initialValues.put("flgProductiveDay", 0);
		initialValues.put("flgProductiveMTD", 0);
		initialValues.put("DaySales", 0.00);
		initialValues.put("MTDSales", 0.00);

		//////// System.out.println("inserting records..");

		return db.insert(DATABASE_TABLE_Summarytable, null, initialValues);

	}

	public static void updatePDAStoreFlgActualVisitIntblDaySummary(String StrID) //On Store Selection VisitStart Activity
	{
		final ContentValues values = new ContentValues();
		values.put("flgActualVisited", 1);

		int affected = db.update(DATABASE_TABLE_Summarytable, values,"StoreID=?", new String[] { StrID });
		Log.w(TAG, "affected records: " + affected);

		Log.w(TAG, "UpdateStoreStartVisit Updated..");
	}

	public static void updatePDAStoreFlgProductiveDayVisitIntblDaySummary(String StrID,int flgProductiveDay,int flgProductiveMTD)
	{
		final ContentValues values = new ContentValues();
		values.put("flgProductiveDay", flgProductiveDay);
		values.put("flgProductiveMTD", flgProductiveMTD);

		int affected = db.update(DATABASE_TABLE_Summarytable, values,"StoreID=?", new String[] { StrID });
		Log.w(TAG, "affected records: " + affected);

		Log.w(TAG, "UpdateStoreStartVisit Updated..");
	}
	public static void updatePDAStoreProductiveDaySalesIntblDaySummary(String StrID,Double DaySales)
	{
		final ContentValues values = new ContentValues();
		values.put("DaySales", DaySales);


		int affected = db.update(DATABASE_TABLE_Summarytable, values,"StoreID=?", new String[] { StrID });
		Log.w(TAG, "affected records: " + affected);

		Log.w(TAG, "UpdateStoreStartVisit Updated..");
	}
	public static void updatePDAStoreProductiveMTDSalesIntblDaySummary(String StrID,Double MTDSales)
	{
		final ContentValues values = new ContentValues();
		values.put("MTDSales", MTDSales);


		int affected = db.update(DATABASE_TABLE_Summarytable, values,"StoreID=?", new String[] { StrID });
		Log.w(TAG, "affected records: " + affected);

		Log.w(TAG, "UpdateStoreStartVisit Updated..");
	}
	public static void fnChkStoreInvoiceUpdateProductiveFlgsAndSales(String StrID)//On Order Activity --Submit, Save, Save Exit
	{//TotInv=is the total invoice on activity create method will be one time when ever the Order Activity Starts
		//This should be done before deleting transaction table
		String flgChkStoreInvoiceStatusAmount="";
		flgChkStoreInvoiceStatusAmount=fnGetStoreBasiscTotalSalesForSummarytbl(StrID);
		if(Integer.parseInt(flgChkStoreInvoiceStatusAmount.split("^")[0])==1)//1= Means Sales is greater then 0
		{
			updatePDAStoreFlgProductiveDayVisitIntblDaySummary(StrID,1,1);
		}
		if(Integer.parseInt(flgChkStoreInvoiceStatusAmount.split("^")[0])==0)
		{
			updatePDAStoreFlgProductiveDayVisitIntblDaySummary(StrID,0,0);
		}
		updatePDAStoreProductiveDaySalesIntblDaySummary(StrID,0.00);
		String storeMTDSales="0.00";
		storeMTDSales=fnGetStoreBasiscMTDSalesInSummarytbl(StrID);
		Double dblTotInv=Double.parseDouble(decimalFormat.format(flgChkStoreInvoiceStatusAmount.split("^")[1]));
		Double dblstoreMTDSales=Double.parseDouble(decimalFormat.format(storeMTDSales));
		dblstoreMTDSales=dblstoreMTDSales-dblTotInv;
		dblstoreMTDSales=Double.parseDouble(decimalFormat.format(dblstoreMTDSales));
		updatePDAStoreProductiveMTDSalesIntblDaySummary(StrID,dblstoreMTDSales);
	}
	public static void fnUpdatetblSumrySalesColumn(String StrID)
	{//This will called after the Saving insertion of records in Transaction table
		String StoreNewTotInvoice="";
		StoreNewTotInvoice=fnGetStoreBasiscTotalSalesForSummarytbl(StrID);
		if(Integer.parseInt(StoreNewTotInvoice.split("^")[0])==1)//1= Means Sales is greater then 0
		{
			Double dblTotInv=Double.parseDouble(decimalFormat.format(StoreNewTotInvoice.split("^")[1]));
			updatePDAStoreProductiveDaySalesIntblDaySummary(StrID,dblTotInv);
			String storeMTDSales="0.00";
			storeMTDSales=fnGetStoreBasiscMTDSalesInSummarytbl(StrID);
			Double dblstoreMTDSales=Double.parseDouble(decimalFormat.format(storeMTDSales));
			dblstoreMTDSales=dblstoreMTDSales+dblTotInv;
			dblstoreMTDSales=Double.parseDouble(decimalFormat.format(dblstoreMTDSales));
			updatePDAStoreProductiveMTDSalesIntblDaySummary(StrID,dblstoreMTDSales);
		}


	}
	public static String fnGetStoreBasiscMTDSalesInSummarytbl(String StrID)
	{

		int LoncolumnIndex = 0;
		String TotMTDSalesStore = "0.00";


		Cursor cursor2 = db.rawQuery("SELECT MTDSales FROM tblDaySummary where StoreID'"+StrID+"'", null);
		try {
			if(cursor2.getCount()>0)
			{
				if (cursor2.moveToFirst())
				{

					for (int i = 0; i < cursor2.getCount(); i++)
					{

						if (!cursor2.isNull(LoncolumnIndex))
						{
							if(Integer.parseInt(cursor2.getString(LoncolumnIndex).toString())>0)
							{
								TotMTDSalesStore =""+ Double.parseDouble(cursor2.getString(LoncolumnIndex).toString());
							}

							//TotSalesValueStoreBasis =""+ Double.parseDouble(cursor2.getString(LoncolumnIndex).toString());
							cursor2.moveToNext();
						}


					}

				}
			}
			else
			{
				TotMTDSalesStore ="0.00";
				cursor2.moveToNext();
			}
			return TotMTDSalesStore;
		} finally {
			cursor2.close();
		}

	}

	public static String fnGetStoreBasiscTotalSalesForSummarytbl(String StrID)
	{
		int LoncolumnIndex = 0;
		String TotSalesValueStoreBasis = "0^0.00";


		Cursor cursor2 = db.rawQuery("SELECT SUM(InvoiceVal) FROM tblTmpInvoiceHeader where StoreID'"+StrID+"'", null);
		try {
			if(cursor2.getCount()>0)
			{
				if (cursor2.moveToFirst())
				{

					for (int i = 0; i < cursor2.getCount(); i++)
					{

						if (!cursor2.isNull(LoncolumnIndex))
						{
							if(Integer.parseInt(cursor2.getString(LoncolumnIndex).toString())>0)
							{
								TotSalesValueStoreBasis ="1^"+ Double.parseDouble(cursor2.getString(LoncolumnIndex).toString());
							}

							//TotSalesValueStoreBasis =""+ Double.parseDouble(cursor2.getString(LoncolumnIndex).toString());
							cursor2.moveToNext();
						}


					}

				}
			}
			else
			{
				TotSalesValueStoreBasis ="0^0.00";

			}
			return TotSalesValueStoreBasis;
		} finally {
			cursor2.close();
		}
	}


	public static String fnGetSummaryTargetCalls()//TargetCalls For Summary Activity
	{
		Cursor cursorE2 = db.rawQuery("SELECT Count(StoreID) FROM tblDaySummary where flgTarget=1", null);
		String TotalTargetCalls = "0";
		int ScodecolumnIndex = 0;
		try {
			if(cursorE2.getCount()>0)
			{
				if (cursorE2.moveToFirst()) {

					for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
						TotalTargetCalls = (String) cursorE2.getString(ScodecolumnIndex).toString();
						cursorE2.moveToNext();
					}
				}
			}
			return TotalTargetCalls;
		} finally {
			cursorE2.close();
		}
	}
	public static String fnGetActualCallsOnRoute()//ActualCallsOnRoute For Summary Activity
	{
		Cursor cursorE2 = db.rawQuery("SELECT Count(StoreID) FROM tblDaySummary where flgTarget=1 and flgActualVisited=1", null);
		String TotalTargetCalls = "0";
		int ScodecolumnIndex = 0;
		try {
			if(cursorE2.getCount()>0)
			{
				if (cursorE2.moveToFirst()) {

					for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
						TotalTargetCalls = (String) cursorE2.getString(ScodecolumnIndex).toString();
						cursorE2.moveToNext();
					}
				}
			}
			return TotalTargetCalls;
		} finally {
			cursorE2.close();
		}
	}

	public static String fnGetActualCallsOffRoute()//ActualCallsOffRoute For Summary Activity
	{
		Cursor cursorE2 = db.rawQuery("SELECT Count(StoreID) FROM tblDaySummary where flgTarget=0 and flgActualVisited=1", null);
		String TotalTargetCalls = "0";
		int ScodecolumnIndex = 0;
		try {
			if(cursorE2.getCount()>0)
			{
				if (cursorE2.moveToFirst()) {

					for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
						TotalTargetCalls = (String) cursorE2.getString(ScodecolumnIndex).toString();
						cursorE2.moveToNext();
					}
				}
			}
			return TotalTargetCalls;
		} finally {
			cursorE2.close();
		}
	}
	public static String fnGetProductiveCallsOnRoute()//ProductiveCallsOnRoute For Summary Activity
	{
		Cursor cursorE2 = db.rawQuery("SELECT Count(StoreID) FROM tblDaySummary where flgTarget=1 and flgActualVisited=1 and flgProductiveDay=1", null);
		String TotalTargetCalls = "0";
		int ScodecolumnIndex = 0;
		try {
			if(cursorE2.getCount()>0)
			{
				if (cursorE2.moveToFirst()) {

					for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
						TotalTargetCalls = (String) cursorE2.getString(ScodecolumnIndex).toString();
						cursorE2.moveToNext();
					}
				}
			}
			return TotalTargetCalls;
		} finally {
			cursorE2.close();
		}
	}
	public static String fnGetProductiveCallsOffRoute()//ProductiveCallsOffRoute For Summary Activity
	{
		Cursor cursorE2 = db.rawQuery("SELECT Count(StoreID) FROM tblDaySummary where flgTarget=0 and flgActualVisited=1 and flgProductiveDay=1", null);
		String TotalTargetCalls = "0";
		int ScodecolumnIndex = 0;
		try {
			if(cursorE2.getCount()>0)
			{
				if (cursorE2.moveToFirst()) {

					for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
						TotalTargetCalls = (String) cursorE2.getString(ScodecolumnIndex).toString();
						cursorE2.moveToNext();
					}
				}
			}
			return TotalTargetCalls;
		} finally {
			cursorE2.close();
		}
	}
	public static String fnGetTotalSalesValueForDay()//TotalSalesValueForDay For Summary Activity
	{
		Cursor cursorE2 = db.rawQuery("SELECT Sum(DaySales) FROM tblDaySummary", null);
		String TotalTargetCalls = "0";
		int ScodecolumnIndex = 0;
		try {
			if(cursorE2.getCount()>0)
			{
				if (cursorE2.moveToFirst()) {

					for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
						TotalTargetCalls = (String) cursorE2.getString(ScodecolumnIndex).toString();
						cursorE2.moveToNext();
					}
				}
			}
			return TotalTargetCalls;
		} finally {
			cursorE2.close();
		}
	}

	public static String fnGetAchievedSalesValueTillDate()//AchievedSalesValueTillDate For Summary Activity
	{
		Cursor cursorE2 = db.rawQuery("SELECT Sum(MTDSales) FROM tblDaySummary", null);
		String TotalTargetCalls = "0";
		int ScodecolumnIndex = 0;
		try {
			if(cursorE2.getCount()>0)
			{
				if (cursorE2.moveToFirst()) {

					for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
						TotalTargetCalls = (String) cursorE2.getString(ScodecolumnIndex).toString();
						cursorE2.moveToNext();
					}
				}
			}
			return TotalTargetCalls;
		} finally {
			cursorE2.close();
		}
	}
	*/
    public static int fnGetAutoIdStoreOnReturnPAge(String StoreID) {
        // int chkValue=fnChkStoreIdExistsInReturnMstr(StoreID);
        // ////// System.out.println("chkValue :" + chkValue);
        // int inAutoIdForInsert=1;
        // if(chkValue==0)
        // {
        // ////// System.out.println("inAutoIdForInsert before function call when chkValue is 0:"
        // + inAutoIdForInsert);
        // inAutoIdForInsert=fnGetMaxAutoIncrementForReturnMstr();
        // ////// System.out.println("inAutoIdForInsert after function call when chkvalue is 0:"
        // + inAutoIdForInsert);
        // insertPDAProductReturnMstr(inAutoIdForInsert,StoreID);
        // }
        /*
         * else { ////// System.out.println(
         * "inAutoIdForInsert before function call when chkValue is 1:" +
         * inAutoIdForInsert);
         * inAutoIdForInsert=fnGetMaxAutoIncrementForReturnMstr();
         * ////// System.out.println
         * ("inAutoIdForInsert after function call when chkvalue is 1:" +
         * inAutoIdForInsert);
         * insertPDAProductReturnMstr(inAutoIdForInsert,StoreID); }
         */
        int autoid = fnGetAutoIDReturnMstr(StoreID);
        ////// System.out.println("autoid :" + autoid);
        return autoid;
    }

    public static int fnGetMaxAutoIncrementForReturnMstr() {

        int LoncolumnIndex = 0;
        int strAutoReturnIdMstr = 1;
        String strAutoReturnMstrText;

        Cursor cursor2 = db.rawQuery(
                "SELECT Max(AutoReturnIdMstr) FROM  tblPDAProductReturnMstr",
                null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    // strAutoReturnMstrText= cursor2.getString(LoncolumnIndex);
                    // ////// System.out.println("strAutoReturnMstrText :"
                    // +strAutoReturnMstrText);
                    if (cursor2.getString(LoncolumnIndex) != null) {
                        strAutoReturnIdMstr = Integer.parseInt(cursor2
                                .getString(LoncolumnIndex)) + 1;
                    } else {
                        strAutoReturnIdMstr = 1;
                    }
                    // strAutoReturnIdMstr
                    // =Integer.parseInt(cursor2.getString(LoncolumnIndex));
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            ////// System.out.println("strAutoReturnIdMstr :" + strAutoReturnIdMstr);
            return strAutoReturnIdMstr;
        } finally {
            cursor2.close();
        }

    }

    public static int fnChkAutoIdMstrForReturnDetails(int ReturnIdMstr,String pdaOrderID,String TmpInvoiceCodePDA) {

        int LoncolumnIndex = 0;
        int strReturnIdDetails = 0;

        Cursor cursor2 = db
                .rawQuery(
                        "SELECT AutoReturnDetailsId FROM  tblPDAProductReturnDetails where ReturnIdMstr='"+ ReturnIdMstr +"'   AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strReturnIdDetails = 1;
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }

            return strReturnIdDetails;
        } finally {
            cursor2.close();
        }

    }

    /*public static int fnGetAutoIdStoreOnReturnPAgeMain(String StoreID,
			String Returndate, Double previousCreditAmt) {
		int chkValue = fnChkStoreIdExistsInReturnMstr(StoreID);
		////// System.out.println("chkValue :" + chkValue);
		int inAutoIdForInsert = 1;
		if (chkValue == 0) {
			inAutoIdForInsert = fnGetMaxAutoIncrementForReturnMstr();
			insertPDAProductReturnMstr(inAutoIdForInsert, StoreID, Returndate,
					previousCreditAmt);
		}

		int autoid = fnGetAutoIDReturnMstr(StoreID);
		////// System.out.println("autoid :" + autoid);
		return autoid;
	}*/
    public static void deletetblPDAProductReturnDetailsOnReturnIdMstr(int autoid) {

        db.execSQL("DELETE FROM tblPDAProductReturnDetails WHERE ReturnIdMstr ="
                + autoid);

    }

    public static String[] fnGetRecordsReturnDetails(int ReturnIdMstr) {

        /*
         * Cursor cursorALL = db.rawQuery("SELECT * FROM tblStoreList", null);
         *
         * ////// System.out.println("PrevDateChk - ALL Records Count: "+
         * cursorALL.getCount());
         */

        Cursor cursor = db
                .rawQuery(
                        "SELECT ReturnIdMstr, ProductId, ProdReturnQty, ProdReturnValue, ProdReturnReason, ProdReturnReasonDescr, ProdLastOrderDate, ProdLastOrderQyt, AdjustReturnQty, AdjustReturnValue FROM tblPDAProductReturnDetails WHERE ReturnIdMstr ="
                                + ReturnIdMstr, null);

        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        String mvalue = "NA";
                        if (i > 3 && i < 8) {
                            if (cursor.getString(i).equals(" ")
                                    || cursor.getString(i).isEmpty()
                                    || cursor.getString(i).equals("")) {
                                mvalue = "NA";
                            } else {
                                mvalue = cursor.getString(i);
                            }
                        }
                        CompleteResult[i] = cursor.getString(0) + "_"
                                + cursor.getString(1) + "_"
                                + cursor.getString(2) + "_"
                                + cursor.getString(3) + "_" + mvalue + "_"
                                + mvalue + "_" + mvalue + "_" + mvalue + "_"
                                + cursor.getString(8) + "_"
                                + cursor.getString(9);
                        ////// System.out.println("fnGetRecordsReturnDetails: "+ CompleteResult[i]);
                        cursor.moveToNext();
                    }
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public static int fnGetAutoIdStoreOnReturnDeatils() {
        int inReturnDetailsAutoIdForInsert = fnGetMaxAutoIncrementForReturnDetails();
        return inReturnDetailsAutoIdForInsert;
    }

    public static int fnGetMaxAutoIncrementForReturnDetails()

    {

        int LoncolumnIndex = 0;
        int strAutoReturnIdDetails = 1;
        String strAutoReturnDetailsText;

        Cursor cursor2 = db
                .rawQuery(
                        "SELECT Max(AutoReturnDetailsId) FROM  tblPDAProductReturnDetails",
                        null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    // strAutoReturnDetailsText=cursor2.getString(LoncolumnIndex);
                    if (cursor2.getString(LoncolumnIndex) != null) {
                        strAutoReturnIdDetails = Integer.parseInt(cursor2
                                .getString(LoncolumnIndex)) + 1;
                    } else {
                        strAutoReturnIdDetails = 1;
                    }
                    // strAutoReturnIdMstr
                    // =Integer.parseInt(cursor2.getString(LoncolumnIndex));
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }

            return strAutoReturnIdDetails;
        } finally {
            cursor2.close();
        }

    }

    public static long fninsertPDAProductReturnDetails(int AutoReturnIdMstr,
                                                int AutoReturnIdDetails, String strProductId,
                                                String strProdReturnQty, Double ProdRate, Double ProdReturnValue,
                                                int proSingleAdjQty, Double proSingleAdjAmt)
    {

        ContentValues initialValues = new ContentValues();

        ////// System.out.println("Saved AutoReturnIdMstr:" + AutoReturnIdMstr+ "Saved AutoReturnIdDetails:" + "" + AutoReturnIdDetails);

        initialValues.put("AutoReturnDetailsId", AutoReturnIdDetails);
        initialValues.put("ReturnIdMstr", AutoReturnIdMstr);
        initialValues.put("ProductId", strProductId.trim());
        initialValues.put("ProdReturnQty", strProdReturnQty.trim());
        initialValues.put("ProdRate", ProdRate);
        initialValues.put("ProdReturnValue", ProdReturnValue);

        initialValues.put("AdjustReturnQty", proSingleAdjQty);
        initialValues.put("AdjustReturnValue", proSingleAdjAmt);


        initialValues.put("ProdReturnReason", " ");
        initialValues.put("ProdReturnReasonDescr", " ");
        initialValues.put("ProdLastOrderDate", " ");
        initialValues.put("ProdLastOrderQyt", " ");

        /*
         * ////// System.out.println(
         * "fninsertPDAProductReturnDetails  proSingleReturnQty: "+
         * strProdReturnQty);
         * ////// System.out.println("fninsertPDAProductReturnDetails  proSingleRateQty: "
         * +ProdReturnValue);
         *
         * ////// System.out.println("fninsertPDAProductReturnDetails  proSingleAdjQty: "
         * + proSingleAdjQty);
         * ////// System.out.println("fninsertPDAProductReturnDetails  proSingleAdjAmt: "
         * +proSingleAdjAmt);
         */

        ////// System.out.println("inserting records..");

        return db.insert(DATABASE_TABLE_MAIN20, null, initialValues);
    }


    // tblPDAProductReturnDetails (AutoReturnDetailsId int null,ReturnIdMstr int null, ProductId text null,
    //ProdReturnQty text null, ProdRate real null, ProdReturnValue real null, ProdReturnReason text null,
    //ProdReturnReasonDescr text null, ProdLastOrderDate text null, ProdLastOrderQyt text null, Sstat integer null,
    //AdjustReturnQty integer null,AdjustReturnValue real null);";

    public static int fnGetAutoIDReturnMstr(String ReturnStoreId) {

        int LoncolumnIndex = 0;
        int strReturnIdMstr = 0;

        Cursor cursor2 = db.rawQuery(
                "SELECT AutoReturnIdMstr FROM  tblPDAProductReturnMstr where StoreID='"
                        + ReturnStoreId + "'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strReturnIdMstr = Integer.parseInt(cursor2
                            .getString(LoncolumnIndex));
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }

            return strReturnIdMstr;
        } finally {
            cursor2.close();
        }

    }

    public static void updatePDAProductReturnMstr(int AutoReturnIdMstr,
                                           String ReturnDate, String Comment, int TotalReturnQty,
                                           Double TotalReturnValue, int TotalAdjustQty,
                                           Double TotalAdujustValue, Double FinalBalanceAmount,
                                           Double LastCreditAmount) {

        String strAutoReturnIdMstr = "" + AutoReturnIdMstr;
        final ContentValues values = new ContentValues();
        values.put("ReturnDate", ReturnDate.trim());
        values.put("Comment", Comment);
        values.put("TotalReturnQty", TotalReturnQty);
        values.put("TotalReturnValue", TotalReturnValue);

        values.put("TotalAdjustQty", TotalAdjustQty);
        values.put("TotalAdjustValue", TotalAdujustValue);
        values.put("FinalBalanceAmount", FinalBalanceAmount);
        values.put("LastCreditAmount", LastCreditAmount);

        int affected = db.update("tblPDAProductReturnMstr", values,
                "AutoReturnIdMstr=?", new String[] { strAutoReturnIdMstr });
        Log.w(TAG, "affected records: " + affected);

        //Log.w(TAG, "UpdateStoreStartVisit Updated..");
    }
    //tblPDAProductReturnMstr (AutoReturnIdMstr int null,StoreID text null, ReturnDate text null, Comment text null,
    //TotalReturnQty int null, TotalReturnValue real null, Sstat integer null,TotalAdjustQty integer null,
    //TotalAdjustValue real null,FinalBalanceAmount real null,LastCreditAmount real null);";

    public static int fnGetStockAgainstProduct(String StoreID, String Pid) {

        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery(
                "SELECT Stock FROM tblTransac where StoreID='" + StoreID
                        + "' and ProdID ='" + Pid + "'", null);
        try {
            int strProdStockQty = 0;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    if (!cursor.isNull(ScodecolumnIndex)) {
                        strProdStockQty = Integer.parseInt(cursor.getString(
                                ScodecolumnIndex).toString());
                        cursor.moveToNext();
                    }

                }
            }
            return strProdStockQty;
        } finally {
            cursor.close();
        }
    }

    public static int fnChkStoreIdExistsInReturnMstr(String ReturnStoreId,String pdaOrderID,String TmpInvoiceCodePDA) {

        int LoncolumnIndex = 0;
        int strReturnIdMstr = 0;

        Cursor cursor2 = db.rawQuery(
                "SELECT AutoReturnIdMstr FROM  tblPDAProductReturnMstr where StoreID='"
                        + ReturnStoreId + "'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strReturnIdMstr = 1;
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }

            return strReturnIdMstr;
        } finally {
            cursor2.close();
        }

    }

    public static String[] fnGetRecordsReturnMaster(String strStoreID) {

        /*
         * Cursor cursorALL = db.rawQuery("SELECT * FROM tblStoreList", null);
         *
         * ////// System.out.println("PrevDateChk - ALL Records Count: "+
         * cursorALL.getCount());
         */

        Cursor cursor = db
                .rawQuery(
                        "SELECT Comment, TotalReturnQty, TotalReturnValue,TotalAdjustQty,TotalAdjustValue FROM tblPDAProductReturnMstr WHERE StoreID ='"
                                + strStoreID + "'", null);

        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i < cursor.getCount(); i++) {
                        CompleteResult[i] = cursor.getString(0) + "_"
                                + cursor.getString(1) + "_"
                                + cursor.getString(2) + "_"
                                + cursor.getString(3) + "_"
                                + cursor.getString(4);
                        // ////// System.out.println(cursor.getString(0) + "_" +
                        // cursor.getString(1)+ "_" + cursor.getString(2));
                        cursor.moveToNext();

                    }
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    /*public static long insertPDAProductDistributionDetails(int CatId,int ProductID, String Stock, String StoreID)
	{
		ContentValues initialValues = new ContentValues();


		initialValues.put("CatId",CatId);
		initialValues.put("ProductID",ProductID);
		initialValues.put("Stock", Stock.trim());
		initialValues.put("StoreID", StoreID.trim());


		//initialValues.put("StoreID", StoreID);

		initialValues.put("Sstat", 0);

		////// System.out.println("inserting records in Details  Stock..");
		////// System.out.println("inserting records..");

		return db.insert(DATABASE_TABLE_MAIN7, null, initialValues);
	}
	*/
    public static int fnGetAutoIDReturnMstr(String DistribtutionStoreId, String DistributionProductId)
    {

        int LoncolumnIndex = 0;
        int strReturnIdMstr = 0;

        Cursor cursor2 = db.rawQuery("SELECT AutoId FROM  tblReturnProductMstr where StoreID='"
                + DistribtutionStoreId + "' and ProductId='"+ DistributionProductId +"'", null);
        try
        {
            if (cursor2.moveToFirst())
            {

                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    strReturnIdMstr = Integer.parseInt(cursor2.getString(LoncolumnIndex));
                    cursor2.moveToNext();

                }

            }

            return strReturnIdMstr;
        }
        finally
        {
            cursor2.close();
        }

    }

    //tblDistributionStoreProductWiseDetails (CatId integer not null,ProductID integer not null,StoreID text not null,
    //Stock text null,ProductMfgDate text null,Sstat integer not null);";
	/* public static int counttblDistributionStoreProductWiseDetails()
		{
			int check=0;

			Cursor cursor2 = db.rawQuery("SELECT Count(*) FROM tblDistributionStoreProductWiseDetails", null);
			try {

				if (cursor2.getCount()>0)
				{

					check=1;

				}
				return check;
			} finally {
				cursor2.close();
			}
		}
	*/

    public static String[] FetcReturnProductIdOverAllStock(String StoreID)
    {
        int ScodecolumnIndex = 0;
        int ScodecolumnIndex1 = 1;

        Cursor cursor = db.rawQuery("SELECT ProductId, OverallStock FROM tblReturnProductMstr where StoreId='"+ StoreID +"'", null);
        try
        {
            String StoreProductIdStock[] = new String[cursor.getCount()];
            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    StoreProductIdStock[i] = (String) cursor.getString(ScodecolumnIndex).toString() + "_"+ (String) cursor.getString(ScodecolumnIndex1).toString();
                    ////// System.out.println("product short name :"+StoreProductIdStock[i]);
                    cursor.moveToNext();
                }
            }
            return StoreProductIdStock;
        }
        finally
        {
            cursor.close();
        }
    }

    public static String[] FetcReturnProductIdOverAllStockDetails(int AutoDistributionIdMstr)
    {
        int ScodecolumnIndex = 0;
        int ScodecolumnIndex1 = 1;

        Cursor cursor = db.rawQuery("SELECT Stock, ProductMfgDate FROM tblReturnStoreProductWiseDetails where AutoID=" + AutoDistributionIdMstr, null);
        try
        {
            String StoreProductIdStock[] = new String[cursor.getCount()];

            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    StoreProductIdStock[i] = (String) cursor.getString(ScodecolumnIndex).toString() + "_"+ (String) cursor.getString(ScodecolumnIndex1).toString();
                    ////// System.out.println("product tblReturnStoreProductWiseDetails :"+StoreProductIdStock[i]);
                    cursor.moveToNext();
                }
            }
            return StoreProductIdStock;
        }
        finally
        {
            cursor.close();
        }
    }

    public static int counttblOutLetInfoOnQuadVolumeCategoryBasis()
    {
        int check=0;

        Cursor cursor2 = db.rawQuery("SELECT Count(*) FROM tblOutLetInfoOnQuadVolumeCategoryBasis", null);
        try {

            ////// System.out.println("Sunil check data in table :"+cursor2.getCount());
            if (cursor2.getCount()>0)
            {

                check=1;

            }
            return check;
        } finally {
            cursor2.close();
        }
    }

    public static long saveOutLetInfoOnQuadVolumeCategoryBasis(String OutID,String OutletName, String OwnerName,String ContactNo,
                                                        String MarketAreaName,String Latitude,String Longitutde)
    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("OutID", OutID.trim());
        initialValues.put("OutletName", OutletName.trim());
        initialValues.put("OwnerName", OwnerName.trim());
        initialValues.put("ContactNo", ContactNo.trim());
        initialValues.put("MarketAreaName", MarketAreaName.trim());
        initialValues.put("Latitude", Latitude.trim());
        initialValues.put("Longitutde", Longitutde.trim());


        ////// System.out.println("jai data  stoe in teable 3");
        return db.insert(DATABASE_TABLE_MAIN91, null, initialValues);
    }

    public static String[] fetchParticularStoreInfo(String OutID)
    {

        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        int LoncolumnIndex2 = 2;
        int LoncolumnIndex3 = 3;
        int LoncolumnIndex4 = 4;
        int LoncolumnIndex5 = 5;

        //Latitude text null,Longitutde
        Cursor cursor2 = db.rawQuery("SELECT OutletName,OwnerName,ContactNo,MarketAreaName,Latitude,Longitutde  FROM tblOutLetInfoOnQuadVolumeCategoryBasis where OutID='"+OutID+"'", null);
        try
        {
            ////// System.out.println("ajay total Store cursor2.getCount() :"+cursor2.getCount());
            String UniqueProductShortName[] = new String[cursor2.getCount()];
            if (cursor2.moveToFirst())
            {

                for (int i = 0; i < cursor2.getCount(); i++)
                {

                    if (!cursor2.isNull(LoncolumnIndex))
                    {
                        UniqueProductShortName[i] =cursor2.getString(LoncolumnIndex).toString() + "^" +
                                cursor2.getString(LoncolumnIndex1).toString()+ "^" + cursor2.getString(LoncolumnIndex2).toString()+ "^"
                                + cursor2.getString(LoncolumnIndex3).toString()+ "^"
                                + cursor2.getString(LoncolumnIndex4).toString()+ "^"
                                + cursor2.getString(LoncolumnIndex5).toString();
                        ////// System.out.println("Sunil OutletName :"+cursor2.getString(LoncolumnIndex).toString());
                        ////// System.out.println("Sunil OwnerName :"+cursor2.getString(LoncolumnIndex1).toString());
                        ////// System.out.println("Sunil ContactNo :"+cursor2.getString(LoncolumnIndex1).toString());
                        ////// System.out.println("Sunil MarketAreaName :"+cursor2.getString(LoncolumnIndex1).toString());
                        ////// System.out.println("Sunil total :"+UniqueProductShortName[i]);
                        cursor2.moveToNext();
                    }

                }

            }
            return UniqueProductShortName;
        } finally {
            cursor2.close();
        }
    }

    public static String[] fetchStorelatLong()
    {

        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        int LoncolumnIndex2 = 2;
        int LoncolumnIndex3 = 3;
        ////// System.out.println("ajay one");
        //store_longitude text null,store_latitude text null
        //Cursor cursor21 = db.rawQuery("SELECT count(*) FROM tblOutLetInfoOnQuadVolumeCategoryBasis", null);
        ////// System.out.println("ajay two");
        Cursor cursor2 = db.rawQuery("SELECT Latitude,Longitutde,OutletName,OutID FROM tblOutLetInfoOnQuadVolumeCategoryBasis", null);


        //Cursor cursor2 = db.rawQuery("SELECT store_longitude,store_latitude,name,StoreID FROM tblOutLetInfoOnQuadVolumeCategoryBasis", null);
        ////// System.out.println("ajay three");
        try
        {
            ////// System.out.println("ajay total Store cursor2.getCount() :"+cursor2.getCount());
            //////// System.out.println("ajay total Store cursor21.getCount() :"+cursor21.getCount());
            String UniqueProductShortName[] = new String[cursor2.getCount()];
            if (cursor2.moveToFirst())
            {

                for (int i = 0; i < cursor2.getCount(); i++)
                {

                    if (!cursor2.isNull(LoncolumnIndex))
                    {
                        UniqueProductShortName[i] =cursor2.getString(LoncolumnIndex).toString() + "^" + cursor2.getString(LoncolumnIndex1).toString()+ "^" + cursor2.getString(LoncolumnIndex2).toString()+ "^" + cursor2.getString(LoncolumnIndex3).toString();
                        ////// System.out.println("ajay lat :"+cursor2.getString(LoncolumnIndex).toString());
                        ////// System.out.println("ajay lon :"+cursor2.getString(LoncolumnIndex1).toString());
                        ////// System.out.println("ajay OutletName :"+cursor2.getString(LoncolumnIndex1).toString());
                        ////// System.out.println("ajay OutID :"+cursor2.getString(LoncolumnIndex1).toString());
                        ////// System.out.println("ajay total :"+UniqueProductShortName[i]);
                        cursor2.moveToNext();
                    }

                }

            }
            return UniqueProductShortName;
        } finally {
            cursor2.close();
        }
    }

    public static void deleteAlertValueProduct(String storeId,String _schmAlrtId,String pdaOrderID,String TmpInvoiceCodePDA)
    {
        //open();
        Cursor cur=db.rawQuery("Select ProductID from tblAlrtVal where StoreId ='"+storeId+"' and schmAlrtId = '"+_schmAlrtId+"'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'",null );
        if(cur.getCount()>0)
        {
            db.delete(DATABASE_TABLE_Main214, "StoreID=? AND schmAlrtId=? AND TmpInvoiceCodePDA=? ",new String[] {storeId,_schmAlrtId,TmpInvoiceCodePDA});
        }

        //close();
    }

    public static void deleteProductOldSlab215(String storeId,String _schmId,String pdaOrderID,String TmpInvoiceCodePDA)
    {
        //open();
        //DATABASE_CREATE_TABLE_215 =tblProductMappedWithSchemeSlabApplied (StoreId,ProductID,schSlabId,schmIdMapped

        Cursor cur=db.rawQuery("Select ProductID from tblProductMappedWithSchemeSlabApplied where StoreId ='"+storeId+"'  and schmIdMapped ='"+_schmId+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'",null );
        if(cur.getCount()>0)
        {
            // System.out.println("DATABASE_TABLE_Main215 Delete : StoreId = "+storeId+" schmIdMapped = "+_schmId+" cur.getCount()= "+cur.getCount());
            db.delete(DATABASE_TABLE_Main215, "StoreId=? AND schmIdMapped=? AND  TmpInvoiceCodePDA=?",new String[] {storeId,_schmId,TmpInvoiceCodePDA});
        }

       // close();
    }

    public static void deleteProductSchemeType3(String storeId,String _productId,String pdaOrderID,String TmpInvoiceCodePDA)
    {
        //open();
        //DATABASE_CREATE_TABLE_215 =tblProductMappedWithSchemeSlabApplied (StoreId,ProductID,schSlabId,schmIdMapped

        Cursor cur=db.rawQuery("Select ProductID from tblProductMappedWithSchemeSlabApplied where StoreId ='"+storeId+"'  and ProductID='"+_productId+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'",null );
        if(cur.getCount()>0)
        {
            // System.out.println("DATABASE_TABLE_Main215 Delete : StoreId = "+storeId+" ProductID = "+_productId+" cur.getCount()= "+cur.getCount());
            db.delete(DATABASE_TABLE_Main215, "StoreId=? AND ProductID=? AND  TmpInvoiceCodePDA=?",new String[] {storeId,_productId,TmpInvoiceCodePDA});
        }

       // close();
    }

    public static void deleteAllStoreAlertValueProduct(String storeId,String pdaOrderID,String TmpInvoiceCodePDA)
    {
        //open();
        Cursor cur=db.rawQuery("Select ProductID from tblAlrtVal where StoreId ='"+storeId+"'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'",null );
        if(cur.getCount()>0)
        {
            db.delete(DATABASE_TABLE_Main214, "StoreID=?  AND TmpInvoiceCodePDA=?",new String[] {storeId,TmpInvoiceCodePDA});
        }

       // close();
    }

    public static void deleteProductBenifitSlabApplieddeleteProductBenifitSlabApplied(String storeId, String pdaOrderID,String TmpInvoiceCodePDA)
    {
        //open();
        Cursor cur=db.rawQuery("Select ProductID from tblProductMappedWithSchemeSlabApplied where StoreId ='"+storeId+"'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'",null );
        if(cur.getCount()>0)
        {
            db.delete(DATABASE_TABLE_Main215, "StoreID=? AND TmpInvoiceCodePDA=?",new String[] {storeId,TmpInvoiceCodePDA});


        }

        //close();
    }

    public static void deletetblOutLetInfoOnQuadVolumeCategoryBasis()
    {
        db.execSQL("DELETE FROM tblOutLetInfoOnQuadVolumeCategoryBasis ");

    }

    public static void dropRoutesTBL()
    {
        //db.execSQL("DROP TABLE IF EXISTS tblRouteListMaster");
        db.execSQL("DELETE FROM tblRouteListMaster");
        //db.execSQL("DROP TABLE IF EXISTS tblAvailableVersion");

    }

    public static void fnFinaldropRoutesTBL()
    {
        db.execSQL("DROP TABLE IF EXISTS tblRouteListMaster");
        //db.execSQL("DELETE FROM tblRouteListMaster");
        //db.execSQL("DROP TABLE IF EXISTS tblAvailableVersion");

    }

    public static String[] fnGetRouteIdsForDDL()
    {

        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT ID FROM tblRouteListMaster", null);
        try {
            String strLocationIDDetais[] = new String[cursor2.getCount()];
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strLocationIDDetais[i] = cursor2.getString(LoncolumnIndex);
                    ////// System.out.println("[ROUTE] Route Id : "+ cursor2.getString(LoncolumnIndex).toString().trim());
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strLocationIDDetais;
        } finally {
            cursor2.close();
        }

    }

    public static String[] fnGetRouteInfoForDDL() {

        int LoncolumnIndex = 0;
        Cursor cursor2 = db.rawQuery("SELECT Descr FROM tblRouteListMaster", null);
        try {
            String strLocationNameDetais[] = new String[cursor2.getCount()];
            ////// System.out.println("[Route] Count : " + cursor2.getCount());
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strLocationNameDetais[i] = cursor2
                            .getString(LoncolumnIndex);
                    ////// System.out.println("[Route] Route Name : "+ cursor2.getString(LoncolumnIndex).toString().trim());

                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strLocationNameDetais;
        } finally {
            cursor2.close();
        }

    }

    public static String[] FetchStorePDATargetQtyForSecondPage(String sID2Fetch) {

        // id = getAllEntries();

        int SnamecolumnIndex1 = 0;
        int SnamecolumnIndex2 = 1;

        // int Stock,int OrderQty, Double OrderVal, int FreeQty, Double DisVal

        Cursor cursor = db
                .rawQuery(
                        "SELECT SKUShortName, TargetQty  FROM tblPDATargetQtyForSecondPage WHERE StoreID ='"
                                + sID2Fetch + "'", null);
        try {

            String ProductTarget[] = new String[cursor.getCount()];
            ;

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                    ProductTarget[i] = (String) cursor.getString(
                            SnamecolumnIndex1).toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex2)
                            .toString();

                    cursor.moveToNext();
                    // cursor.close();

                }

            }
            return ProductTarget;
        } finally {
            cursor.close();
        }

    }

    public static String[] fnGetAllSchSlabDescbasedOnSchemeSlabID(String SchemeSlabID)
    {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT DISTINCT SchemeSlabDesc FROM tblSchemeSlabDetail WHERE SchemeSlabID ='"+ SchemeSlabID + "'", null);
        String AllSchemeSlabID[] = new String[cursorE2.getCount()];

        try {
            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst())
                {

                    for (int i = 0; i <= (cursorE2.getCount() - 1); i++)
                    {
                        AllSchemeSlabID[i] = (String) cursorE2.getString(0).toString();
                        cursorE2.moveToNext();
                        //cursor.moveToNext();
                    }
                }
            }
            return AllSchemeSlabID;
        } finally {
            cursorE2.close();
            //close();
        }

    }

    public static String[] fnGetAllBenifitDescrbasedOnSchemeSlabID(String SchemeSlabID)
    {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT DISTINCT BenifitDescr FROM tblSchemeSlabDetail WHERE SchemeSlabID ='"
                + SchemeSlabID + "'", null);
        String AllSchemeSlabID[] = new String[cursorE2.getCount()];

        try {
            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst())
                {

                    for (int i = 0; i <= (cursorE2.getCount() - 1); i++)
                    {
                        AllSchemeSlabID[i] = (String) cursorE2.getString(0).toString();
                        cursorE2.moveToNext();
                        //cursor.moveToNext();
                    }
                }
            }
            return AllSchemeSlabID;
        } finally {
            cursorE2.close();
            //close();
        }

    }

    public static String[] fnGetSchemeIdsAppliedOnStore(String strStoreID) {
        int ScodecolumnIndex = 0;
        Cursor cursor = db.rawQuery("SELECT SchemeID FROM tblSchemeStoreMapping Where StoreID='"+strStoreID+"'",null);
        try {
            String SchemeIds[] = new String[cursor.getCount()];
            ;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    SchemeIds[i] = (String)(cursor.getString(ScodecolumnIndex).toString());
                    ////// System.out.println("DB-ADAP: PROD RLP: "+ (String) cursor.getString(ScodecolumnIndex).toString());
                    cursor.moveToNext();
                }
            }
            return SchemeIds;
        } finally {
            cursor.close();
        }
    }

    public static String[] PrevPDASchemeApplicableSecondPage(String strStoreID) {


        String []strSchemeIds = fnGetSchemeIdsAppliedOnStore(strStoreID);
        String CompleteResult[]=new String[strSchemeIds.length];;
        if(strSchemeIds.length>=1)
        {
            String myQuery="SELECT SchemeID,SchemeName FROM tblSchemeMstr WHERE SchemeID in (" + makePlaceholders(strSchemeIds.length) + ")";
            Cursor cursor = db.rawQuery(myQuery, strSchemeIds);

            try {
                //CompleteResult = new String[cursor.getCount()];
                if (cursor.getCount() > 0) {

                    if (cursor.moveToFirst()) {

                        for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                            CompleteResult[i] = (String) cursor.getString(0).toString()+"_"+(String) cursor.getString(1).toString();
                            cursor.moveToNext();
                        }
                    }

                }


            } finally {
                cursor.close();
            }
        }

        return CompleteResult;
    }

    public static String makePlaceholders(int len) {
        if (len < 1) {
            // It will lead to an invalid query anyway ..
            throw new RuntimeException("No placeholders");
        } else {
            StringBuilder sb = new StringBuilder(len * 2 - 1);
            sb.append("?");
            for (int i = 1; i < len; i++) {
                sb.append(",?");
            }
            return sb.toString();
        }
    }

    public static String[] PrevPDASchemeApplicableSecondPageSpecialScheme(String strStoreID) {

        /*
         * Cursor cursorALL = db.rawQuery("SELECT * FROM tblStoreList", null);
         *
         * ////// System.out.println("PrevDateChk - ALL Records Count: "+
         * cursorALL.getCount());
         */
        String strMystoretype = "";
        strMystoretype = fnGetStoreTypeOnStoreIdBasis(strStoreID);
        Cursor cursor = db.rawQuery(
                "SELECT SchemeDesc FROM tblspForPDASchemeApplicableList WHERE StoreType ='"
                        + strMystoretype + "' and flgSpecialScheme=1", null);

        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = (String) cursor.getString(0)
                                .toString();
                        //// System.out.println("strMystoretype : " + strMystoretype);
                        ////// System.out.println("CompleteResult[i] : "+ CompleteResult[i].toString().trim());
                        cursor.moveToNext();
                    }
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public static String[] PrevPDALastTranDetForSecondPage(String strStoreID) {

        /*
         * Cursor cursorALL = db.rawQuery("SELECT * FROM tblStoreList", null);
         *
         * ////// System.out.println("PrevDateChk - ALL Records Count: "+
         * cursorALL.getCount());
         */

        Cursor cursor = db
                .rawQuery(
                        "SELECT SKUName, LastTransDate, Stock, OrderQty, FreeQty FROM tblPDALastTranDateForSecondPage WHERE StoreID ='"
                                + strStoreID + "'", null);

        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = (String) cursor.getString(0)
                                .toString()
                                + "_"
                                + (String) cursor.getString(1).toString()
                                + "_"
                                + (String) cursor.getString(2).toString()
                                + "_"
                                + (String) cursor.getString(3).toString()
                                + "_"
                                + (String) cursor.getString(4).toString();
                        cursor.moveToNext();
                    }
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public static String fnGetPDALastInvoiceDetlastDate(String strStoreID) {

        Cursor cursorE2 = db.rawQuery(
                "SELECT LastTransDate FROM tblPDALastInvoiceDet WHERE StoreID ='"
                        + strStoreID + "'", null);
        String LastTransDate = "";
        int ScodecolumnIndex = 0;
        try {

            if (cursorE2.moveToFirst()) {

                for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
                    LastTransDate = (String) cursorE2.getString(
                            ScodecolumnIndex).toString();
                    cursorE2.moveToNext();
                }
            }
            return LastTransDate;
        } finally {
            cursorE2.close();
        }

    }

    public static long insertPDAProductReturnMstr(int AutoReturnIdMstr,
                                           String StoreID, String ReturnDate, Double previousCreditAmt) {
        ContentValues initialValues = new ContentValues();

        ////// System.out.println("Saved AutoReturnIdMstr:" + AutoReturnIdMstr+ "Saved StoreID:" + "" + StoreID);

        initialValues.put("AutoReturnIdMstr", AutoReturnIdMstr);
        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("ReturnDate", ReturnDate.trim());
        initialValues.put("Comment", "Not Available");
        // initialValues.put(KEY_TotalReturnQty, 0);
        // initialValues.put(KEY_TotalReturnValue, 0.00);

        // initialValues.put(KEY_TotalAdjustQty, 0);
        // initialValues.put(KEY_TotalAdjustValue, 0.00);
        initialValues.put("FinalBalanceAmount", previousCreditAmt);
        // initialValues.put(KEY_LastCreditAmount, 0.00);

        ////// System.out.println("inserting records..");

        return db.insert(DATABASE_TABLE_MAIN19, null, initialValues);
    }
    //tblPDAProductReturnMstr (AutoReturnIdMstr int null,StoreID text null, ReturnDate text null, Comment text null,
    //TotalReturnQty int null, TotalReturnValue real null, Sstat integer null,TotalAdjustQty integer null,
    //TotalAdjustValue real null,FinalBalanceAmount real null,LastCreditAmount real null);";

    public static int getExistingPicNos(String StoreID) {

        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT Count(StoreID) FROM tblStoreMaterialPhotoDetail where StoreID='" + StoreID + "'", null);
        try {
            int strProdStockQty = 0;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    if (!cursor.isNull(ScodecolumnIndex)) {
                        strProdStockQty = Integer.parseInt(cursor.getString(ScodecolumnIndex).toString());
                        cursor.moveToNext();
                    }

                }
            }
            return strProdStockQty;
        } finally {
            cursor.close();
        }
    }

    public static Double fnGetDiscountValueOnRealSlabBasis(String strSchemeID, String SlabFrom) {
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        Double strSchemeIDFreeProductId = 0.00;
        Cursor cursor2 = db.rawQuery(
                "SELECT Discount FROM tblSchemeDetails where  SchemeID = '" + strSchemeID
                        + "' and SlabFrom='"+SlabFrom+"'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {

                    strSchemeIDFreeProductId = Double.parseDouble(cursor2
                            .getString(LoncolumnIndex));
                    //+ "_"
                    //+ cursor2.getString(LoncolumnIndex1);
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strSchemeIDFreeProductId;
        } finally {
            cursor2.close();
        }
    }

    public static int fnGetFreeQuantityOnRealSlabBasis(String strSchemeID, String SlabFrom) {
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        int strSchemeIDFreeProductId = 0;
        Cursor cursor2 = db.rawQuery(
                "SELECT FreeQuantity FROM tblSchemeDetails where  SchemeID = '" + strSchemeID
                        + "' and SlabFrom='"+SlabFrom+"'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {

                    strSchemeIDFreeProductId = Integer.parseInt(cursor2
                            .getString(LoncolumnIndex));
                    //+ "_"
                    //+ cursor2.getString(LoncolumnIndex1);
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strSchemeIDFreeProductId;
        } finally {
            cursor2.close();
        }
    }

    public static String fnGetFreeProdIDOnRealSlabBasis(String strSchemeID, String SlabFrom) {
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        String strSchemeIDFreeProductId = "";
        Cursor cursor2 = db.rawQuery(
                "SELECT FreeProductID FROM tblSchemeDetails where  SchemeID = '" + strSchemeID
                        + "' and SlabFrom='"+SlabFrom+"'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {

                    strSchemeIDFreeProductId = cursor2
                            .getString(LoncolumnIndex);
                    //+ "_"
                    //+ cursor2.getString(LoncolumnIndex1);
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strSchemeIDFreeProductId;
        } finally {
            cursor2.close();
        }
    }

    public static String fnGetMProdIDAccordingToSchemeID(String SchID)
    {
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        String strSchemeIDFreeProductId = "";
        Cursor cursor2 = db.rawQuery(
                "SELECT ProductID FROM tblschemeProductMap where SchemeID='"
                        + SchID + "' LIMIT 1", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {

                    strSchemeIDFreeProductId = cursor2
                            .getString(LoncolumnIndex);
                    //+ "_"
                    //+ cursor2.getString(LoncolumnIndex1);
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strSchemeIDFreeProductId;
        } finally {
            cursor2.close();
        }
    }

    public static String fnGetMaxSlabofProductAccordingToOrder(
            String strSchemType, String strSchemeID, int strOrderValue) {
        int LoncolumnIndex = 0;
        //////// System.out.println("strFPIDSlb strMaxSlb :" + strMaxSlb);
        String strProductSabFreeOrDiscount = "";

        if (Integer.parseInt(strSchemType) == 1
                || Integer.parseInt(strSchemType) == 2) {
            Cursor cursor2 = db.rawQuery(
                    "SELECT Max(SlabFrom) FROM tblSchemeDetails where SlabFrom<="
                            + strOrderValue + " and SchemeID = '" + strSchemeID
                            + "'", null);
            try {
                if (cursor2.moveToFirst()) {

                    for (int i = 0; i < cursor2.getCount(); i++) {
                        if (strProductSabFreeOrDiscount == "") {
                            strProductSabFreeOrDiscount = cursor2
                                    .getString(LoncolumnIndex);
                        }

                        cursor2.moveToNext();
                        // cursor.close();
                    }

                    strProductSabFreeOrDiscount = strProductSabFreeOrDiscount;

                }

            } finally {
                cursor2.close();
            }
        }
        if (Integer.parseInt(strSchemType) == 3) {
            Cursor cursor2 = db.rawQuery(
                    "SELECT Max(SlabFrom) FROM tblSchemeDetails where SlabFrom<="
                            + strOrderValue + " and SchemeID = '" + strSchemeID
                            + "'", null);
            try {
                if (cursor2.moveToFirst()) {

                    for (int i = 0; i < cursor2.getCount(); i++) {
                        if (strProductSabFreeOrDiscount == "") {
                            strProductSabFreeOrDiscount = cursor2
                                    .getString(LoncolumnIndex);
                        }

                        ////// System.out.println("Discount Abhinav = "+ strProductSabFreeOrDiscount);
                        cursor2.moveToNext();
                        // cursor.close();
                    }

                    strProductSabFreeOrDiscount = strProductSabFreeOrDiscount;

                }

            } finally {
                cursor2.close();
            }
        }
        return strProductSabFreeOrDiscount;
    }

    public static String fnGetSchemeTypeonSchemeIDBasis(String strSchemeID)
    {
        int LoncolumnIndex = 0;
        //////// System.out.println("strFPIDSlb strMaxSlb :" + strMaxSlb);
        String strProductSabFreeOrDiscount = "";

        Cursor cursor2 = db.rawQuery(
                "SELECT  SchemeType FROM tblSchemeList where SchemeID = '" + strSchemeID
                        + "'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    if (strProductSabFreeOrDiscount == "") {
                        strProductSabFreeOrDiscount = cursor2
                                .getString(LoncolumnIndex);
                    }

                    ////// System.out.println("Discount Abhinav = "+ strProductSabFreeOrDiscount);
                    cursor2.moveToNext();
                    // cursor.close();
                }

                strProductSabFreeOrDiscount = strProductSabFreeOrDiscount;

            }

        } finally {
            cursor2.close();
        }

        return strProductSabFreeOrDiscount;
    }

    // changes by sunil for Summary in Tab
    public static int fnCountDataIntblSyncSummuryForProductDetails()
    {


        Cursor cursorE2 = db.rawQuery("SELECT Count(SkuName) FROM tblSyncSummuryForProductDetails", null);

        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {
                for (int i = 0; i < cursorE2.getCount(); i++)
                {
                    if (!cursorE2.isNull(0))
                    {
                        chkI = Integer.parseInt(cursorE2.getString(0));
                    } else {
                        chkI = 0;
                    }
                    cursorE2.moveToNext();
                }

            }

        } finally {
            cursorE2.close();
        }
        //////////// System.out.println("fnCheckflgToShowStrachRowOrNot : " +chkI);
        return chkI;

    }

    public static int fnCountDataIntblStoreProdcutPurchaseDetails(int Sstat)
    {
        Cursor cursorE2 = db.rawQuery("SELECT DISTINCT ProductShortName FROM tblTmpInvoiceDetails where Sstat='"+Sstat+"' and  (OrderQty<>0 OR SampleQuantity<>0 OR FreeQty<>0)", null);

        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {
                for (int i = 0; i < cursorE2.getCount(); i++)
                {
                    if (!cursorE2.isNull(0))
                    {
                        chkI = cursorE2.getCount();
                    } else {
                        chkI = 0;
                    }
                    cursorE2.moveToNext();
                }

            }

        } finally {
            cursorE2.close();
        }
        //////////// System.out.println("fnCheckflgToShowStrachRowOrNot : " +chkI);
        return chkI;

    }

    public static int fnCountNumberOfSKUForBothServerAndPDATable()
    {
        int returnvalue=0;

        //int ServerTableCount=fnCountDataIntblSyncSummuryForProductDetails();
        //int PDATableCount=fnCountDataIntblStoreProdcutPurchaseDetails(4);




        Cursor	cursorE1 = db.rawQuery("SELECT DISTINCT SkuName FROM  tblSyncSummuryForProductDetails", null);


        try
        {
            // System.out.println("Number of row for Value from Server Table Data :"+cursorE1.getCount());
            if(cursorE1.getCount()>0)
            {
                returnvalue=cursorE1.getCount();
            }
        }
        finally
        {
            cursorE1.close();
        }


        //Cursor cursorE2;
        Cursor cursorE2 = db.rawQuery("SELECT DISTINCT ProductShortName FROM tblTmpInvoiceDetails where Sstat='"+4+"' and  (OrderQty<>0 OR SampleQuantity<>0 OR FreeQty<>0)", null);


        try
        {
            // System.out.println("Number of row for Value from PDA Table Data :"+cursorE2.getCount());
            if(cursorE2.getCount()>0)
            {
                returnvalue=returnvalue+cursorE2.getCount();
            }
        }
        finally
        {
            cursorE2.close();
        }



        Cursor cursorE3 = db.rawQuery("SELECT DISTINCT SkuName FROM tblSyncSummuryForProductDetails  a INNER JOIN tblTmpInvoiceDetails b ON a.SkuName = b.ProductShortName where b.Sstat='"+4+"' and  (b.OrderQty<>0 OR SampleQuantity<>0 OR b.FreeQty<>0)", null);


        try
        {
            // System.out.println("Number of row for Value from Common Table Data :"+cursorE3.getCount());
            if(cursorE3.getCount()>0)
            {
                returnvalue=returnvalue-cursorE3.getCount();
            }
        }
        finally
        {
            cursorE3.close();
        }

        return returnvalue;

    }

    public static HashMap<String,String> fnAllProductnameForShowingInTable()
    {

        HashMap<String, String> map = new HashMap<String, String>();

        Cursor	cursorE1 = db.rawQuery("SELECT DISTINCT SkuName FROM  tblSyncSummuryForProductDetails", null);

        try
        {
            if(cursorE1.getCount()>0)
            {
                if (cursorE1.moveToFirst())
                {

                    for (int i = 0; i < cursorE1.getCount(); i++)
                    {

                        // System.out.println("Ajeet and Amit row with Server Table Product Name"+ (String) cursorE1.getString(0).toString().trim() );
                        map.put((String) cursorE1.getString(0).toString().trim(), "1");
                        cursorE1.moveToNext();
                    }
                }
            }
        }
        finally
        {
            cursorE1.close();
        }

        Cursor cursorE2 = db.rawQuery("SELECT DISTINCT SkuName FROM tblSyncSummuryForProductDetails  a INNER JOIN tblTmpInvoiceDetails b ON a.SkuName = b.ProductShortName where b.Sstat='"+4+"' and  (b.OrderQty<>0 OR SampleQuantity<>0 OR b.FreeQty<>0)", null);


        try
        {
            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst())
                {

                    for (int i = 0; i < cursorE2.getCount(); i++)
                    {

                        // System.out.println("Ajeet and Amit row with Server Table Product Name Remove"+ (String) cursorE2.getString(0).toString().trim() );
                        map.remove((String) cursorE2.getString(0).toString().trim());
                        cursorE2.moveToNext();
                    }
                }
            }
        }
        finally
        {
            cursorE2.close();
        }


        //Cursor cursorE2;
        Cursor cursorE3 = db.rawQuery("SELECT DISTINCT ProductShortName FROM tblTmpInvoiceDetails where Sstat='"+4+"' and  (OrderQty<>0 OR SampleQuantity<>0 OR FreeQty<>0)", null);


        try
        {

            if(cursorE3.getCount()>0)
            {
                if (cursorE3.moveToFirst())
                {

                    for (int i = 0; i < cursorE3.getCount(); i++)
                    {
                        // System.out.println("Ajeet and Amit with PDA Table Product Name"+ (String) cursorE3.getString(0).toString().trim() );

                        map.put((String) cursorE3.getString(0).toString().trim(), "1");
                        cursorE3.moveToNext();
                    }
                }
            }
        }
        finally
        {
            cursorE3.close();
        }



				/*Cursor cursorE4 = db.rawQuery("SELECT DISTINCT SkuName FROM tblSyncSummuryForProductDetails  a INNER JOIN tblTmpInvoiceDetails b ON a.SkuName = b.ProductShortName where b.Sstat='"+4+"' and  (b.OrderQty<>0 OR SampleQuantity<>0 OR b.FreeQty<>0)", null);


				try
				{
					if(cursorE4.getCount()>0)
					{
						if (cursorE4.moveToFirst())
				         {

				             for (int i = 0; i < cursorE4.getCount(); i++)
				                 {

				            	 // System.out.println("Ajeet and Amit with PDA Table Product Name remove "+ (String) cursorE4.getString(0).toString().trim() );
						          map.remove((String) cursorE4.getString(0).toString().trim());
					                  cursorE4.moveToNext();
				                 }
			              }
					}
				}
				finally
				{
					cursorE4.close();
				}*/

        return map;

    }

    public static String fnGetTotalSales(int Sstat)
    {
        int LoncolumnIndex = 0;
        String TotSalesValue = "0.0";


        Cursor cursor2 = db.rawQuery("SELECT SUM(InvoiceVal) FROM tblTmpInvoiceHeader where Sstat='"+Sstat+"'", null);
        try {
            if (cursor2.moveToFirst())
            {

                for (int i = 0; i < cursor2.getCount(); i++)
                {

                    if (!cursor2.isNull(LoncolumnIndex))
                    {
                        TotSalesValue =""+ Double.parseDouble(cursor2.getString(LoncolumnIndex).toString());
                        ////// System.out.println("Abhinav Raj Summary New TotSalesValue from function: "+TotSalesValue);
                        cursor2.moveToNext();
                    }

                }

            }
            return TotSalesValue.replace(",", "");//(TotSalesValue, ",");
        } finally {
            cursor2.close();
        }
    }

    public static String fnGetTotalDiscount(int Sstat)
    {
        int LoncolumnIndex = 0;
        String TotDiscountValue = "0.0";


        Cursor cursor2 = db.rawQuery("SELECT SUM(TotalDis) FROM tblTmpInvoiceHeader where Sstat='"+Sstat+"'", null);
        try {
            if (cursor2.moveToFirst())
            {

                for (int i = 0; i < cursor2.getCount(); i++)
                {

                    if (!cursor2.isNull(LoncolumnIndex))
                    {
                        TotDiscountValue =""+ Double.parseDouble(cursor2.getString(LoncolumnIndex).toString());
                        cursor2.moveToNext();
                    }

                }

            }
            return TotDiscountValue;
        } finally {
            cursor2.close();
        }
    }

    public static String fnCalculateKGLitersForTabOne()
    {
        int Sstat=4;
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        int LoncolumnIndex2 = 2;
        String[] UniqueKgLiters;
        UniqueKgLiters=fnarrUniqueKgLiters();//fnarrUniqueKgLitersDisplayUnit();
        String val="";
        String totalKGSales="0.0";
        String totalSampleSalesKG="0.0";
        String totalFreeQtySalesKG="0.0";
        String totalLitersSales="0.0";
        String totalSampleSalesLT="0.0";
        String totalFreeQtySalesLT="0.0";
        String totalDiscountLT="0.0";
        String totalDiscountKG="0.0";


        String totalOverallKGSales="0.0";
        String totalOverallSampleSalesKG="0.0";
        String totalOverallFreeQtySalesKG="0.0";
        String totalOverallLitersSales="0.0";
        String totalOverallSampleSalesLT="0.0";
        String totalOverallFreeQtySalesLT="0.0";
        String totalOverallDiscountLT="0.0";
        String totalOverallDiscountKG="0.0";

        String FinalReturnValue="";
        String ppName="";
        String pDisplayUnit="";
        for (int kk = 0; kk < UniqueKgLiters.length; kk++)
        {
            StringTokenizer tokensUniqueKgLiters = new StringTokenizer(String.valueOf(UniqueKgLiters[kk]), "^");

            ppName= tokensUniqueKgLiters.nextToken().trim();

            val="";
            val=tokensUniqueKgLiters.nextToken().trim();//UniqueKgLiters[kk].toString().trim();

            // change by sunil
            //val="0";
            //// System.out.println("Abhi UniqueKgLiters[kk] :"+UniqueKgLiters[kk]);

            pDisplayUnit=tokensUniqueKgLiters.nextToken().trim();
            //// System.out.println("Abhi pDisplayUnit:" +pDisplayUnit);
            //if(val.contains("0g"))
            if(pDisplayUnit.contains("Kg"))
            {
                //// System.out.println("Abhi getting Kg");
                Cursor cursor2 = db.rawQuery("SELECT Sum(OrderQty),Sum(FreeQty),Sum(SampleQuantity),Sum(DisVal) FROM  tblTmpInvoiceDetails where ProductShortName='" + ppName + "' and Sstat='"+Sstat+"'", null);
                try
                {
                    //val=val.replace("g", "");
                    if (cursor2.getCount() > 0)
                    {


                        if (cursor2.moveToFirst())
                        {

                            for (int i = 0; i < cursor2.getCount(); i++)
                            {
                                totalKGSales="0.0";
                                totalFreeQtySalesKG="0.0";
                                totalSampleSalesKG="0.0";
                                if (!cursor2.isNull(LoncolumnIndex))
                                {
                                    totalKGSales ="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex)) * Integer.parseInt(val));
                                    //	cursor2.moveToNext();

                                    ////// System.out.println("AbhiSunil  Product Short Name:" +val +":-totalKGSales-:"+ totalKGSales);
                                }

                                if (!cursor2.isNull(LoncolumnIndex1))
                                {
                                    totalFreeQtySalesKG ="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex1)) * Integer.parseInt(val));
                                    //	cursor2.moveToNext();
                                    ////// System.out.println("AbhiSunil  Product Short Name:" +val +":-totalFreeQtySalesKG-:"+ totalFreeQtySalesKG);
                                }
                                if (!cursor2.isNull(LoncolumnIndex2))
                                {
                                    totalSampleSalesKG ="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex2)) * Integer.parseInt(val));

                                    ////// System.out.println("AbhiSunil  Product Short Name:" +val +":-totalSampleSalesKG-:"+ totalSampleSalesKG);
                                    //
                                }


                                //Write Here

                                totalOverallKGSales="" + (Double.parseDouble(totalOverallKGSales) + Double.parseDouble(totalKGSales));
                                //////// System.out.println("AbhiSunil  totalOverallKGSales-:"+ totalOverallKGSales);
                                totalOverallFreeQtySalesKG="" + (Double.parseDouble(totalOverallFreeQtySalesKG) + Double.parseDouble(totalFreeQtySalesKG));
                                //////// System.out.println("AbhiSunil  totalOverallFreeQtySalesKG-:"+ totalOverallFreeQtySalesKG);
                                totalOverallSampleSalesKG="" + (Double.parseDouble(totalOverallSampleSalesKG) + Double.parseDouble(totalSampleSalesKG));
                                cursor2.moveToNext();
                            }

                        }
                    }

                } finally {
                    cursor2.close();
                }

            }
            //if(val.contains("0ml"))
            if(pDisplayUnit.contains("Lt"))
            {
                //// System.out.println("Abhi getting Liter");

                Cursor cursor2 = db.rawQuery("SELECT Sum(OrderQty),Sum(FreeQty),Sum(SampleQuantity),Sum(DisVal) FROM  tblTmpInvoiceDetails where ProductShortName ='" + ppName + "' and Sstat='"+Sstat+"'", null);
                try {
                    //// System.out.println("Abhi  cursor2.getCount() :"+cursor2.getCount());
                    //val=val.replace("ml", "");
                    if (cursor2.getCount() > 0)
                    {


                        if (cursor2.moveToFirst())
                        {

                            for (int i = 0; i < cursor2.getCount(); i++)
                            {
                                totalLitersSales="0.0";
                                totalSampleSalesLT="0.0";
                                totalFreeQtySalesLT="0.0";

                                if (!cursor2.isNull(LoncolumnIndex))
                                {

                                    totalLitersSales ="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex)) * Integer.parseInt(val));
                                    //	////// System.out.println("totalLitersSales :"+totalLitersSales);
                                    totalOverallLitersSales="" + (Double.parseDouble(totalOverallLitersSales) + Double.parseDouble(totalLitersSales));

                                    //// System.out.println("Abhi  totalOverallLitersSales :"+totalOverallLitersSales +" index :"+LoncolumnIndex);
                                    //cursor2.moveToNext();
                                }

                                if (!cursor2.isNull(LoncolumnIndex1))
                                {
                                    totalFreeQtySalesLT ="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex1)) * Integer.parseInt(val));
                                    //////// System.out.println("totalFreeQtySalesLT :"+totalFreeQtySalesLT);
                                    totalOverallFreeQtySalesLT="" + (Double.parseDouble(totalOverallFreeQtySalesLT) + Double.parseDouble(totalFreeQtySalesLT));

                                    //// System.out.println("Abhi  totalOverallLitersSales :"+totalOverallLitersSales +" index :"+LoncolumnIndex);
                                    //cursor2.moveToNext();
                                }
                                if (!cursor2.isNull(LoncolumnIndex2))
                                {
                                    totalSampleSalesLT ="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex2)) * Integer.parseInt(val));
                                    totalOverallSampleSalesLT="" + (Double.parseDouble(totalOverallSampleSalesLT) + Double.parseDouble(totalSampleSalesLT));

                                    //// System.out.println("Abhi  totalOverallLitersSales :"+totalOverallLitersSales +" index :"+LoncolumnIndex);
                                    //	////// System.out.println("totalSampleSalesLT :"+totalSampleSalesLT);
                                }



                                cursor2.moveToNext();
                            }

                        }
                    }

                } finally {
                    cursor2.close();
                }


            }
        }

        //// System.out.println("Abhi Sunil  totalOverallKGSales Before:" +totalOverallKGSales);
        //// System.out.println("Abhi Sunil  totalOverallFreeQtySalesKG Before:" +totalOverallFreeQtySalesKG);
        //// System.out.println("Abhi Sunil  totalOverallSampleSalesKG Before:" +totalOverallSampleSalesKG);

        totalOverallKGSales= ConvertGramToKilo(totalOverallKGSales);

        totalOverallFreeQtySalesKG= ConvertGramToKilo(totalOverallFreeQtySalesKG);

        totalOverallSampleSalesKG= ConvertGramToKilo(totalOverallSampleSalesKG);

        //// System.out.println("Abhi Sunil  totalOverallKGSales After:" +totalOverallKGSales);
        //// System.out.println("Abhi Sunil  totalOverallFreeQtySalesKG After:" +totalOverallFreeQtySalesKG);
        //// System.out.println("Abhi Sunil  totalOverallSampleSalesKG After:" +totalOverallSampleSalesKG);

        totalOverallLitersSales=ConvertMLToLiters(totalOverallLitersSales);

        totalOverallFreeQtySalesLT=ConvertMLToLiters(totalOverallFreeQtySalesLT);

        totalOverallSampleSalesLT=ConvertMLToLiters(totalOverallSampleSalesLT);


        String strGettblSyncSummuryDetailsKGLitersDetails="";
        strGettblSyncSummuryDetailsKGLitersDetails=fnGettblSyncSummuryDetailsKGLitersDetails();

        StringTokenizer tokensGettblSyncSummuryDetailsKGLitersDetails = new StringTokenizer(String.valueOf(strGettblSyncSummuryDetailsKGLitersDetails), "_");

        totalOverallKGSales= "" + (Double.parseDouble(totalOverallKGSales) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));
        totalOverallFreeQtySalesKG= "" + (Double.parseDouble(totalOverallFreeQtySalesKG) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));
        totalOverallSampleSalesKG= "" + (Double.parseDouble(totalOverallSampleSalesKG) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));
        totalOverallLitersSales= "" + (Double.parseDouble(totalOverallLitersSales) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));
        totalOverallFreeQtySalesLT= "" + (Double.parseDouble(totalOverallFreeQtySalesLT) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));
        totalOverallSampleSalesLT= "" + (Double.parseDouble(totalOverallSampleSalesLT) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));


        Double DtotalOverallKGSales =  Double.parseDouble(totalOverallKGSales);
        DtotalOverallKGSales= Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallKGSales));

        Double DtotalOverallFreeQtySalesKG = Double.parseDouble(totalOverallFreeQtySalesKG);
        DtotalOverallFreeQtySalesKG= Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallFreeQtySalesKG));

        Double DtotalOverallSampleSalesKG = Double.parseDouble(totalOverallSampleSalesKG);
        DtotalOverallSampleSalesKG= Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallSampleSalesKG));

        Double DtotalOverallLitersSales =  Double.parseDouble(totalOverallLitersSales);
        DtotalOverallLitersSales= Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallLitersSales));

        Double DtotalOverallFreeQtySalesLT = Double.parseDouble(totalOverallFreeQtySalesLT);
        DtotalOverallFreeQtySalesLT= Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallFreeQtySalesLT));

        Double DtotalOverallSampleSalesLT =Double.parseDouble(totalOverallSampleSalesLT);
        DtotalOverallSampleSalesLT= Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallSampleSalesLT));


        //DtotalOverallKGSales = Double.parseDouble(decimalFormat.format(DtotalOverallKGSales));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallKGSales));
        FinalReturnValue= FinalReturnValue + DtotalOverallKGSales + " Units";

        // DtotalOverallFreeQtySalesKG =Double.parseDouble(decimalFormat.format(DtotalOverallFreeQtySalesKG));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallFreeQtySalesKG));
        FinalReturnValue= FinalReturnValue + "^" + DtotalOverallFreeQtySalesKG + " Units";

        // DtotalOverallSampleSalesKG =Double.parseDouble(decimalFormat.format(DtotalOverallSampleSalesKG));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallSampleSalesKG));
        FinalReturnValue= FinalReturnValue + "^" + DtotalOverallSampleSalesKG + " Units";

        // DtotalOverallLitersSales = Double.parseDouble(decimalFormat.format(DtotalOverallLitersSales));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallLitersSales));
        FinalReturnValue= FinalReturnValue + "^" + DtotalOverallLitersSales + " LT";

        // DtotalOverallFreeQtySalesLT = Double.parseDouble(decimalFormat.format(DtotalOverallFreeQtySalesLT));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallFreeQtySalesLT));
        FinalReturnValue= FinalReturnValue + "^" + DtotalOverallFreeQtySalesLT + " LT";

        //DtotalOverallSampleSalesLT = Double.parseDouble(decimalFormat.format(DtotalOverallSampleSalesLT));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallSampleSalesLT));
        FinalReturnValue= FinalReturnValue + "^" + DtotalOverallSampleSalesLT + " LT";


        //FinalReturnValue= "" + DtotalOverallKGSales + " KG" + "^" + DtotalOverallFreeQtySalesKG + " KG" + "^" + DtotalOverallSampleSalesKG + " KG" + "^" + DtotalOverallLitersSales + " LT" + "^" + DtotalOverallFreeQtySalesLT + " LT" + "^" + DtotalOverallSampleSalesLT + " LT";
        //// System.out.println("Abhi  FinalReturnValue :"+FinalReturnValue);
        return FinalReturnValue;

    }

    public static String[] fnarrUniqueProductsSaleSummry_NewWay(int Sstat)
    {

        Cursor cursor2 = db.rawQuery("SELECT DISTINCT ProductShortName FROM tblTmpInvoiceDetails where Sstat='"+Sstat+"' and  (OrderQty<>0 OR SampleQuantity<>0 OR Stock<>0 OR FreeQty<>0) ", null);
        //Cursor cursor2 = db.rawQuery("SELECT DISTINCT ProductShortName, KGLiter, DisplayUnit FROM tblProductListMaster", null);
        try
        {
            String UniqueProductShortName[] = new String[cursor2.getCount()];
            if (cursor2.moveToFirst())
            {

                for (int i = 0; i < cursor2.getCount(); i++)
                {

                    if (!cursor2.isNull(0))
                    {
                        UniqueProductShortName[i] =cursor2.getString(0).toString();
                        //// System.out.println("Anuj ProductShortName sunil: "+(String) cursor2.getString(LoncolumnIndex) + "  "+"KGLiter sunil: "+(String) cursor2.getString(LoncolumnIndex1));

                        String aa[]=fnarrUniqueKGLiterAndDisplayUnitBasedProductName(UniqueProductShortName[i]);
                        UniqueProductShortName[i]=UniqueProductShortName[i]+"^"+aa[0];

                        // System.out.println("Aajad ProductShortName sunil: "+UniqueProductShortName[i]);


                        cursor2.moveToNext();
                    }

                }

            }
            return UniqueProductShortName;
        } finally {
            cursor2.close();
        }
    }

    public static String[] fnarrUniqueKGLiterAndDisplayUnitBasedProductName(String ProductShortName)
    {

        Cursor cursor2 = db.rawQuery("SELECT  KGLiter, DisplayUnit FROM tblProductListMaster where ProductShortName= '"+ProductShortName+"' ", null);
        try
        {
            String UniqueProductShortName[] = new String[cursor2.getCount()];
            if (cursor2.moveToFirst())
            {

                for (int i = 0; i < cursor2.getCount(); i++)
                {

                    if (!cursor2.isNull(0))
                    {
                        UniqueProductShortName[i] =cursor2.getString(0).toString()+"^"+cursor2.getString(1).toString() ;
                        // System.out.println("Aajad123 ProductShortName sunil: "+UniqueProductShortName[i]);

                        cursor2.moveToNext();
                    }

                }

            }
            return UniqueProductShortName;
        } finally {
            cursor2.close();
        }
    }

    public static String fnCalculateKGLitersNotSync(int Sstat)
    {
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        int LoncolumnIndex2 = 2;
        String[] UniqueKgLiters;
        UniqueKgLiters=fnarrUniqueProductsSaleSummry_NewWay(Sstat);//fnarrUniqueKgLitersDisplayUnit();
        String val="";
        String totalKGSales="0.0";
        String totalSampleSalesKG="0.0";
        String totalFreeQtySalesKG="0.0";
        String totalLitersSales="0.0";
        String totalSampleSalesLT="0.0";
        String totalFreeQtySalesLT="0.0";
        String totalDiscountLT="0.0";
        String totalDiscountKG="0.0";


        String totalOverallKGSales="0.0";
        String totalOverallSampleSalesKG="0.0";
        String totalOverallFreeQtySalesKG="0.0";
        String totalOverallLitersSales="0.0";
        String totalOverallSampleSalesLT="0.0";
        String totalOverallFreeQtySalesLT="0.0";
        String totalOverallDiscountLT="0.0";
        String totalOverallDiscountKG="0.0";

        String FinalReturnValue="";
        String ppName="";
        String pDisplayUnit="";
        for (int kk = 0; kk < UniqueKgLiters.length; kk++)
        {
            StringTokenizer tokensUniqueKgLiters = new StringTokenizer(String.valueOf(UniqueKgLiters[kk]), "^");

            ppName= tokensUniqueKgLiters.nextToken().trim();

            val="";
            val=tokensUniqueKgLiters.nextToken().trim();//UniqueKgLiters[kk].toString().trim();

            // change by sunil
            //val="0";
            //// System.out.println("Abhi UniqueKgLiters[kk] :"+UniqueKgLiters[kk]);

            pDisplayUnit=tokensUniqueKgLiters.nextToken().trim();
            //// System.out.println("Abhi pDisplayUnit:" +pDisplayUnit);
            //if(val.contains("0g"))
            if(pDisplayUnit.contains("Kg"))
            {
                //// System.out.println("Abhi getting Kg");
                Cursor cursor2 = db.rawQuery("SELECT Sum(OrderQty),Sum(FreeQty),Sum(SampleQuantity),Sum(DisVal) FROM  tblTmpInvoiceDetails where ProductShortName='" + ppName + "' and Sstat='"+Sstat+"'", null);
                try
                {
                    //val=val.replace("g", "");
                    if (cursor2.getCount() > 0)
                    {


                        if (cursor2.moveToFirst())
                        {

                            for (int i = 0; i < cursor2.getCount(); i++)
                            {
                                totalKGSales="0.0";
                                totalFreeQtySalesKG="0.0";
                                totalSampleSalesKG="0.0";
                                if (!cursor2.isNull(LoncolumnIndex))
                                {
                                    totalKGSales ="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex)) * Integer.parseInt(val));
                                    //	cursor2.moveToNext();

                                    ////// System.out.println("AbhiSunil  Product Short Name:" +val +":-totalKGSales-:"+ totalKGSales);
                                }

                                if (!cursor2.isNull(LoncolumnIndex1))
                                {
                                    totalFreeQtySalesKG ="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex1)) * Integer.parseInt(val));
                                    //	cursor2.moveToNext();
                                    ////// System.out.println("AbhiSunil  Product Short Name:" +val +":-totalFreeQtySalesKG-:"+ totalFreeQtySalesKG);
                                }
                                if (!cursor2.isNull(LoncolumnIndex2))
                                {
                                    totalSampleSalesKG ="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex2)) * Integer.parseInt(val));

                                    ////// System.out.println("AbhiSunil  Product Short Name:" +val +":-totalSampleSalesKG-:"+ totalSampleSalesKG);
                                    //
                                }


                                //Write Here

                                totalOverallKGSales="" + (Double.parseDouble(totalOverallKGSales) + Double.parseDouble(totalKGSales));
                                //////// System.out.println("AbhiSunil  totalOverallKGSales-:"+ totalOverallKGSales);
                                totalOverallFreeQtySalesKG="" + (Double.parseDouble(totalOverallFreeQtySalesKG) + Double.parseDouble(totalFreeQtySalesKG));
                                //////// System.out.println("AbhiSunil  totalOverallFreeQtySalesKG-:"+ totalOverallFreeQtySalesKG);
                                totalOverallSampleSalesKG="" + (Double.parseDouble(totalOverallSampleSalesKG) + Double.parseDouble(totalSampleSalesKG));
                                cursor2.moveToNext();
                            }

                        }
                    }

                } finally {
                    cursor2.close();
                }

            }
            //if(val.contains("0ml"))
            if(pDisplayUnit.contains("Lt"))
            {
                //// System.out.println("Abhi getting Liter");

                Cursor cursor2 = db.rawQuery("SELECT Sum(OrderQty),Sum(FreeQty),Sum(SampleQuantity),Sum(DisVal) FROM  tblTmpInvoiceDetails where ProductShortName ='" + ppName + "' and Sstat='"+Sstat+"'", null);
                try {
                    //// System.out.println("Abhi  cursor2.getCount() :"+cursor2.getCount());
                    //val=val.replace("ml", "");
                    if (cursor2.getCount() > 0)
                    {


                        if (cursor2.moveToFirst())
                        {

                            for (int i = 0; i < cursor2.getCount(); i++)
                            {
                                totalLitersSales="0.0";
                                totalSampleSalesLT="0.0";
                                totalFreeQtySalesLT="0.0";

                                if (!cursor2.isNull(LoncolumnIndex))
                                {

                                    totalLitersSales ="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex)) * Integer.parseInt(val));
                                    //	////// System.out.println("totalLitersSales :"+totalLitersSales);
                                    totalOverallLitersSales="" + (Double.parseDouble(totalOverallLitersSales) + Double.parseDouble(totalLitersSales));

                                    //// System.out.println("Abhi  totalOverallLitersSales :"+totalOverallLitersSales +" index :"+LoncolumnIndex);
                                    //cursor2.moveToNext();
                                }

                                if (!cursor2.isNull(LoncolumnIndex1))
                                {
                                    totalFreeQtySalesLT ="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex1)) * Integer.parseInt(val));
                                    //////// System.out.println("totalFreeQtySalesLT :"+totalFreeQtySalesLT);
                                    totalOverallFreeQtySalesLT="" + (Double.parseDouble(totalOverallFreeQtySalesLT) + Double.parseDouble(totalFreeQtySalesLT));

                                    //// System.out.println("Abhi  totalOverallLitersSales :"+totalOverallLitersSales +" index :"+LoncolumnIndex);
                                    //cursor2.moveToNext();
                                }
                                if (!cursor2.isNull(LoncolumnIndex2))
                                {
                                    totalSampleSalesLT ="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex2)) * Integer.parseInt(val));
                                    totalOverallSampleSalesLT="" + (Double.parseDouble(totalOverallSampleSalesLT) + Double.parseDouble(totalSampleSalesLT));

                                    //// System.out.println("Abhi  totalOverallLitersSales :"+totalOverallLitersSales +" index :"+LoncolumnIndex);
                                    //	////// System.out.println("totalSampleSalesLT :"+totalSampleSalesLT);
                                }



                                cursor2.moveToNext();
                            }

                        }
                    }

                } finally {
                    cursor2.close();
                }


            }
        }

        //// System.out.println("Abhi Sunil  totalOverallKGSales Before:" +totalOverallKGSales);
        //// System.out.println("Abhi Sunil  totalOverallFreeQtySalesKG Before:" +totalOverallFreeQtySalesKG);
        //// System.out.println("Abhi Sunil  totalOverallSampleSalesKG Before:" +totalOverallSampleSalesKG);

        totalOverallKGSales= ConvertGramToKilo(totalOverallKGSales);

        totalOverallFreeQtySalesKG= ConvertGramToKilo(totalOverallFreeQtySalesKG);

        totalOverallSampleSalesKG= ConvertGramToKilo(totalOverallSampleSalesKG);

        //// System.out.println("Abhi Sunil  totalOverallKGSales After:" +totalOverallKGSales);
        //// System.out.println("Abhi Sunil  totalOverallFreeQtySalesKG After:" +totalOverallFreeQtySalesKG);
        //// System.out.println("Abhi Sunil  totalOverallSampleSalesKG After:" +totalOverallSampleSalesKG);

        totalOverallLitersSales=ConvertMLToLiters(totalOverallLitersSales);

        totalOverallFreeQtySalesLT=ConvertMLToLiters(totalOverallFreeQtySalesLT);

        totalOverallSampleSalesLT=ConvertMLToLiters(totalOverallSampleSalesLT);


        String strGettblSyncSummuryDetailsKGLitersDetails="0.0_0.0_0.0_0.0_0.0_0.0_0.0_0.0";
        //strGettblSyncSummuryDetailsKGLitersDetails=fnGettblSyncSummuryDetailsKGLitersDetails();

        StringTokenizer tokensGettblSyncSummuryDetailsKGLitersDetails = new StringTokenizer(String.valueOf(strGettblSyncSummuryDetailsKGLitersDetails), "_");

        totalOverallKGSales= "" + (Double.parseDouble(totalOverallKGSales) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));
        totalOverallFreeQtySalesKG= "" + (Double.parseDouble(totalOverallFreeQtySalesKG) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));
        totalOverallSampleSalesKG= "" + (Double.parseDouble(totalOverallSampleSalesKG) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));
        totalOverallLitersSales= "" + (Double.parseDouble(totalOverallLitersSales) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));
        totalOverallFreeQtySalesLT= "" + (Double.parseDouble(totalOverallFreeQtySalesLT) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));
        totalOverallSampleSalesLT= "" + (Double.parseDouble(totalOverallSampleSalesLT) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));


        Double DtotalOverallKGSales =  Double.parseDouble(totalOverallKGSales);
        DtotalOverallKGSales= Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallKGSales));

        Double DtotalOverallFreeQtySalesKG = Double.parseDouble(totalOverallFreeQtySalesKG);
        DtotalOverallFreeQtySalesKG= Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallFreeQtySalesKG));

        Double DtotalOverallSampleSalesKG = Double.parseDouble(totalOverallSampleSalesKG);
        DtotalOverallSampleSalesKG= Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallSampleSalesKG));

        Double DtotalOverallLitersSales =  Double.parseDouble(totalOverallLitersSales);
        DtotalOverallLitersSales= Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallLitersSales));

        Double DtotalOverallFreeQtySalesLT = Double.parseDouble(totalOverallFreeQtySalesLT);
        DtotalOverallFreeQtySalesLT= Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallFreeQtySalesLT));

        Double DtotalOverallSampleSalesLT =Double.parseDouble(totalOverallSampleSalesLT);
        DtotalOverallSampleSalesLT= Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallSampleSalesLT));


        //DtotalOverallKGSales = Double.parseDouble(decimalFormat.format(DtotalOverallKGSales));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallKGSales));
        FinalReturnValue= FinalReturnValue + DtotalOverallKGSales + " Units";

        // DtotalOverallFreeQtySalesKG =Double.parseDouble(decimalFormat.format(DtotalOverallFreeQtySalesKG));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallFreeQtySalesKG));
        FinalReturnValue= FinalReturnValue + "^" + DtotalOverallFreeQtySalesKG + " Units";

        // DtotalOverallSampleSalesKG =Double.parseDouble(decimalFormat.format(DtotalOverallSampleSalesKG));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallSampleSalesKG));
        FinalReturnValue= FinalReturnValue + "^" + DtotalOverallSampleSalesKG + " Units";

        // DtotalOverallLitersSales = Double.parseDouble(decimalFormat.format(DtotalOverallLitersSales));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallLitersSales));
        FinalReturnValue= FinalReturnValue + "^" + DtotalOverallLitersSales + " LT";

        // DtotalOverallFreeQtySalesLT = Double.parseDouble(decimalFormat.format(DtotalOverallFreeQtySalesLT));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallFreeQtySalesLT));
        FinalReturnValue= FinalReturnValue + "^" + DtotalOverallFreeQtySalesLT + " LT";

        //DtotalOverallSampleSalesLT = Double.parseDouble(decimalFormat.format(DtotalOverallSampleSalesLT));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallSampleSalesLT));
        FinalReturnValue= FinalReturnValue + "^" + DtotalOverallSampleSalesLT + " LT";


        //FinalReturnValue= "" + DtotalOverallKGSales + " KG" + "^" + DtotalOverallFreeQtySalesKG + " KG" + "^" + DtotalOverallSampleSalesKG + " KG" + "^" + DtotalOverallLitersSales + " LT" + "^" + DtotalOverallFreeQtySalesLT + " LT" + "^" + DtotalOverallSampleSalesLT + " LT";
        //// System.out.println("Abhi  FinalReturnValue :"+FinalReturnValue);
        return FinalReturnValue;

    }

    public static String[] fnCalculateProductsSaleSummryForSubmitAndNotSentToServer(int Sstat)
    {
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        int LoncolumnIndex2 = 2;
        String[] UniqueProductsSaleSummry;
        UniqueProductsSaleSummry=fnarrUniqueProductsSaleSummry_NewWay(Sstat);   // 121 Product will come


        // System.out.println("Check data 1 UniqueProductsSaleSummry :"+UniqueProductsSaleSummry.length);

        String val="";
        String SummryPName="";
        String SDisplayName="";
        String SDisplayUnit="";


        String SumOQty[]=new String[UniqueProductsSaleSummry.length];
        String SumFQty[]=new String[UniqueProductsSaleSummry.length];
        String SumSQty[]=new String[UniqueProductsSaleSummry.length];


        String SumOQtyKG[]=new String[UniqueProductsSaleSummry.length];
        String SumFQtyKG[]=new String[UniqueProductsSaleSummry.length];
        String SumSQtyKG[]=new String[UniqueProductsSaleSummry.length];


        String SummryProductName[]=new String[UniqueProductsSaleSummry.length];
        String SummryDisplayUnit[]=new String[UniqueProductsSaleSummry.length];

        String FinalReturnValue[]=new String[UniqueProductsSaleSummry.length];

        String LineSkuWise[]=new String[UniqueProductsSaleSummry.length];


        for (int kk = 0; kk < UniqueProductsSaleSummry.length; kk++)
        {
            val="";
            SummryPName="";
            SDisplayUnit="";
            String getVal="";
            getVal=UniqueProductsSaleSummry[kk].toString().trim();

            StringTokenizer tokens = new StringTokenizer(String.valueOf(getVal), "^");
            SummryPName=tokens.nextToken().trim();
            val=tokens.nextToken().trim();
            SDisplayUnit=tokens.nextToken().trim();


            SummryProductName[kk]=SummryPName;
            SummryDisplayUnit[kk]=SDisplayUnit;


            LineSkuWise[kk]=fnCalculateLinesSkuWise(SummryPName);

            // by sunil
            // Sstat = 3

            //if(val.contains("0g"))
            if(SDisplayUnit.contains("Kg"))
            {

                Cursor cursor2 = db.rawQuery("SELECT Sum(OrderQty),Sum(FreeQty),Sum(SampleQuantity) FROM  tblTmpInvoiceDetails where ProductShortName ='" + SummryPName + "' and Sstat='"+Sstat+"'", null);
                try {
                    //val=val.replace("g", "");
                    if (cursor2.getCount() > 0)
                    {


                        if (cursor2.moveToFirst())
                        {

                            for (int i = 0; i < cursor2.getCount(); i++)
                            {

                                if (!cursor2.isNull(LoncolumnIndex))
                                {
                                    SumOQty[kk]=""+ Integer.parseInt(cursor2.getString(LoncolumnIndex));
                                    //////////// System.out.println("SummryPName SumOQty[kk]"+SumOQty[kk]);
                                    String OrderKG=	"" + (Integer.parseInt(cursor2.getString(LoncolumnIndex)) * Integer.parseInt(val));
                                    //////////// System.out.println("SummryPName OrderKG"+OrderKG);
                                    SumOQtyKG[kk] =ConvertGramToKilo(OrderKG);
                                    //	cursor2.moveToNext();
                                }
                                else
                                {
                                    SumOQty[kk]=""+ "0";
                                    SumOQtyKG[kk] ="" +"0.0";
                                }

                                if (!cursor2.isNull(LoncolumnIndex1))
                                {
                                    SumFQty[kk] ="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex1)));
                                    String FreeKG="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex1)) * Integer.parseInt(val));

                                    SumFQtyKG[kk] =ConvertGramToKilo(FreeKG);

                                    //	cursor2.moveToNext();
                                }
                                else
                                {
                                    SumFQty[kk] ="" +"0";
                                    SumFQtyKG[kk] ="0.0";
                                }
                                if (!cursor2.isNull(LoncolumnIndex2))
                                {
                                    SumSQty[kk] ="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex2)));
                                    String SampleKG="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex2)) * Integer.parseInt(val));
                                    SumSQtyKG[kk] =ConvertGramToKilo(SampleKG);

                                }
                                else
                                {
                                    SumSQty[kk] ="0";
                                    SumSQtyKG[kk] ="0.0";
                                }
                                cursor2.moveToNext();
                            }

                        }
                    }

                } finally {
                    cursor2.close();
                }

            }
            //if(val.contains("0ml"))
            if(SDisplayUnit.contains("Lt"))
            {

                Cursor cursor2 = db.rawQuery("SELECT Sum(OrderQty),Sum(FreeQty),Sum(SampleQuantity) FROM  tblTmpInvoiceDetails where ProductShortName ='" + SummryPName + "' and Sstat='"+Sstat+"'", null);
                try {
                    //val=val.replace("ml", "");
                    if (cursor2.getCount() > 0)
                    {


                        if (cursor2.moveToFirst())
                        {

                            for (int i = 0; i < cursor2.getCount(); i++)
                            {

                                if (!cursor2.isNull(LoncolumnIndex))
                                {
                                    SumOQty[kk]=""+ Integer.parseInt(cursor2.getString(LoncolumnIndex));
                                    String OrderKG=	"" + (Integer.parseInt(cursor2.getString(LoncolumnIndex)) * Integer.parseInt(val));
                                    SumOQtyKG[kk] =ConvertMLToLiters(OrderKG);

                                }
                                else
                                {
                                    SumOQty[kk]=""+ "0";
                                    SumOQtyKG[kk] ="" +"0.0";
                                }

                                if (!cursor2.isNull(LoncolumnIndex1))
                                {
                                    SumFQty[kk] ="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex1)));
                                    String FreeKG="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex1)) * Integer.parseInt(val));
                                    SumFQtyKG[kk] =ConvertMLToLiters(FreeKG);

                                }
                                else
                                {
                                    SumFQty[kk] ="" +"0";
                                    SumFQtyKG[kk] ="0.0";
                                }
                                if (!cursor2.isNull(LoncolumnIndex2))
                                {
                                    SumSQty[kk] ="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex2)));
                                    String SampleKG="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex2)) * Integer.parseInt(val));
                                    SumSQtyKG[kk] =ConvertMLToLiters(SampleKG);

                                }
                                else
                                {
                                    SumSQty[kk] ="0";
                                    SumSQtyKG[kk] ="0.0";
                                }
                                cursor2.moveToNext();
                            }

                        }
                    }

                } finally {
                    cursor2.close();
                }

            }
        }


        for (int kk = 0; kk < UniqueProductsSaleSummry.length; kk++)
        {

            //////////// System.out.println("Sunil Check Line UniqueProductsSaleSummry :"+UniqueProductsSaleSummry[kk]);

            if(false)
            {}
            else
            {
                FinalReturnValue[kk]=SummryProductName[kk] + "^" + SumOQty[kk] + "^" + SumFQty[kk] + "^" + SumSQty[kk] + "^" + SumOQtyKG[kk] + "^" + SumFQtyKG[kk] + "^" + SumSQtyKG[kk]+ "^" + LineSkuWise[kk];
                //////////// System.out.println("FinalReturnValue[kk] :" + FinalReturnValue[kk]);
            }

        }


        return FinalReturnValue;

    }

    public static String fnGetFullSummryDetailsForSaleForTabTwoAndTabThree(int Sstat)
    {

        String FullSummryDetailsForSale;
        FullSummryDetailsForSale="";

        int TotActualCall=0;
        TotActualCall=fnGetActualCall();

        ////// System.out.println("TotActualCall: "	+ TotActualCall);

        int TotProductiveCall=0;
        TotProductiveCall=fnGetProductiveCall();

        ////// System.out.println("TotProductiveCall: "	+ TotProductiveCall);

        String TotSalesValue="0.00";
        TotSalesValue=fnGetTotalSales(Sstat);//fnGetTotalDiscount


        String TotDiscountValue="0.00";
        TotDiscountValue=fnGetTotalDiscount(Sstat);


        ////// System.out.println("TotSalesValue: "	+ TotSalesValue);
        ////// System.out.println("fnGetTotalDiscount: "	+ TotDiscountValue);
        //String strGettblSyncSummuryDetailsCallDetails="";
        //strGettblSyncSummuryDetailsCallDetails=fnGettblSyncSummuryDetailsCallDetails();
        ////// System.out.println("strGettblSyncSummuryDetailsCallDetails: "	+ strGettblSyncSummuryDetailsCallDetails);
        //StringTokenizer tokensGettblSyncSummuryDetailsCallDetails = new StringTokenizer(String.valueOf(strGettblSyncSummuryDetailsCallDetails), "_");

				/*TotActualCall= TotActualCall + Integer.parseInt(tokensGettblSyncSummuryDetailsCallDetails.nextToken().trim());
				TotProductiveCall= TotProductiveCall + Integer.parseInt(tokensGettblSyncSummuryDetailsCallDetails.nextToken().trim());
				TotSalesValue="" + (Double.parseDouble(TotSalesValue) + Double.parseDouble(tokensGettblSyncSummuryDetailsCallDetails.nextToken().trim()));
				TotDiscountValue="" + (Double.parseDouble(TotDiscountValue) + Double.parseDouble(tokensGettblSyncSummuryDetailsCallDetails.nextToken().trim()));
				*/
        FullSummryDetailsForSale =TotActualCall + "_" + TotProductiveCall + "_" + TotSalesValue + "_" + TotDiscountValue;


        ////// System.out.println("FullSummryDetailsForSale: "	+ FullSummryDetailsForSale);

        return FullSummryDetailsForSale;
    }

    public static String fnGetFullSummryDetailsForSaleForTabOne()
    {

        String FullSummryDetailsForSale;
        FullSummryDetailsForSale="";

        int TotActualCall=0;
        TotActualCall=fnGetActualCall();

        ////// System.out.println("TotActualCall: "	+ TotActualCall);

        int TotProductiveCall=0;
        TotProductiveCall=fnGetProductiveCall();

        ////// System.out.println("TotProductiveCall: "	+ TotProductiveCall);

        String TotSalesValue="0.00";
        TotSalesValue=fnGetTotalSales(4);//fnGetTotalDiscount


        String TotDiscountValue="0.00";
        TotDiscountValue=fnGetTotalDiscount(4);


        ////// System.out.println("TotSalesValue: "	+ TotSalesValue);
        ////// System.out.println("fnGetTotalDiscount: "	+ TotDiscountValue);
        String strGettblSyncSummuryDetailsCallDetails="";
        strGettblSyncSummuryDetailsCallDetails=fnGettblSyncSummuryDetailsCallDetails();
        ////// System.out.println("strGettblSyncSummuryDetailsCallDetails: "	+ strGettblSyncSummuryDetailsCallDetails);
        StringTokenizer tokensGettblSyncSummuryDetailsCallDetails = new StringTokenizer(String.valueOf(strGettblSyncSummuryDetailsCallDetails), "_");

        TotActualCall= TotActualCall + Integer.parseInt(tokensGettblSyncSummuryDetailsCallDetails.nextToken().trim());
        TotProductiveCall= TotProductiveCall + Integer.parseInt(tokensGettblSyncSummuryDetailsCallDetails.nextToken().trim());
        TotSalesValue="" + (Double.parseDouble(TotSalesValue) + Double.parseDouble(tokensGettblSyncSummuryDetailsCallDetails.nextToken().trim()));
        TotDiscountValue="" + (Double.parseDouble(TotDiscountValue) + Double.parseDouble(tokensGettblSyncSummuryDetailsCallDetails.nextToken().trim()));
        FullSummryDetailsForSale =TotActualCall + "_" + TotProductiveCall + "_" + TotSalesValue + "_" + TotDiscountValue;


        ////// System.out.println("FullSummryDetailsForSale: "	+ FullSummryDetailsForSale);

        return FullSummryDetailsForSale;
    }

    public static String[] fnCalculateProductsSaleSummryForTabOneNew()
    {
        int Sstat=4;
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        int LoncolumnIndex2 = 2;
        //String[] UniqueProductsSaleSummry;
        //UniqueProductsSaleSummry=fnarrUniqueProductsSaleSummry();


        int ServerTableCount=fnCountDataIntblSyncSummuryForProductDetails();
        int PDATableCount=fnCountDataIntblStoreProdcutPurchaseDetails(4);
        int noOfRow=0;

		/*// System.out.println("Testing Sunil Value by new function ServerTableCount :"+ServerTableCount);
		// System.out.println("Testing Sunil Value by new function PDATableCount :"+PDATableCount);*/

        if(ServerTableCount>0 && PDATableCount>0)
        {
            noOfRow=fnCountNumberOfSKUForBothServerAndPDATable();
        }
        else if(ServerTableCount>0)
        {
            noOfRow=fnCountDataIntblSyncSummuryForProductDetails();
        }
        else if(PDATableCount>0)
        {
            noOfRow=fnCountDataIntblStoreProdcutPurchaseDetails(4);
        }

        String SummryProductName[]=new String[noOfRow];

        // System.out.println("Checking the number of row "+noOfRow);

        HashMap<String, String> hmapProductName=new HashMap<String, String>();

        hmapProductName=fnAllProductnameForShowingInTable();
        // System.out.println("Ajeet and Amit row with Product name length"+ hmapProductName.size() );
        int ii=0;
        for( String s : hmapProductName.keySet() )
        {
            // System.out.println("Ajeet and Amit row with final  "+ s );
            SummryProductName[ii]=s;
            ii++;
        }


        String val="";
        String SummryPName="";
        String SDisplayName="";
        String SDisplayUnit="";


        String SumOQty[]=new String[noOfRow];
        String SumFQty[]=new String[noOfRow];
        String SumSQty[]=new String[noOfRow];
        String SumOVal[]=new String[noOfRow];
        String SumDVal[]=new String[noOfRow];




        String SummryDisplayUnit[]=new String[noOfRow];

        String FinalReturnValue[]=new String[noOfRow];

        String LineSkuWise[]=new String[noOfRow];


        for (int kk = 0; kk < noOfRow; kk++)
        {

            String SumOfOQtyValue="0";
            String SumOfFQtyValue="0";
            String SumOfSQtyValue="0";

            String ProductPrice="0";
            String SumOfOrderValue="0.0";
            String SumOfDiscountValue="0.0";


            Cursor cursor1 = db.rawQuery("SELECT Sum(OrderQty),Sum(FreeQty),Sum(SampleQuantity),ProductPrice,OrderVal,DisVal FROM  tblTmpInvoiceDetails where ProductShortName ='" + SummryProductName[kk] + "' and Sstat='"+Sstat+"'", null);
            try
            {
                if (cursor1.getCount() > 0)
                {
                    if (cursor1.moveToFirst())
                    {

                        for (int i = 0; i < cursor1.getCount(); i++)
                        {

                            if (!cursor1.isNull(0))
                            {
                                SumOfOQtyValue=""+ Integer.parseInt(cursor1.getString(0));
                            }


                            if (!cursor1.isNull(1))
                            {
                                SumOfFQtyValue=""+ Integer.parseInt(cursor1.getString(1));
                            }


                            if (!cursor1.isNull(2))
                            {
                                SumOfSQtyValue=""+ Integer.parseInt(cursor1.getString(2));
                            }
                            if (!cursor1.isNull(3))
                            {
                                ProductPrice=cursor1.getString(3).toString().trim();
                            }
                            if (!cursor1.isNull(4))
                            {
                                SumOfOrderValue=cursor1.getString(4).toString().trim();
                            }
                            if (!cursor1.isNull(5))
                            {
                                SumOfDiscountValue=cursor1.getString(5).toString().trim();
                            }

                            cursor1.moveToNext();
                        }

                    }
                }

            }
            finally
            {
                cursor1.close();
            }

            Cursor cursor2 = db.rawQuery("SELECT Sum(OrderQty),Sum(FreeQty),Sum(SampleQty),ProductPrice,OrderVal,DisVal FROM  tblSyncSummuryForProductDetails where SkuName ='" + SummryProductName[kk] + "'", null);
            try
            {
                if (cursor2.getCount() > 0)
                {
                    if (cursor2.moveToFirst())
                    {

                        for (int i = 0; i < cursor2.getCount(); i++)
                        {

                            if (!cursor2.isNull(0))
                            {

                                SumOfOQtyValue=""+ (Integer.parseInt(SumOfOQtyValue)+Integer.parseInt(cursor2.getString(0)));
                            }


                            if (!cursor2.isNull(1))
                            {
                                SumOfFQtyValue=""+ (Integer.parseInt(SumOfFQtyValue)+Integer.parseInt(cursor2.getString(1)));
                            }


                            if (!cursor2.isNull(LoncolumnIndex2))
                            {
                                SumOfSQtyValue=""+ (Integer.parseInt(SumOfSQtyValue)+Integer.parseInt(cursor2.getString(2)));
                            }
                            if (!cursor2.isNull(3))
                            {
                                ProductPrice=cursor2.getString(3).toString().trim();
                            }
                            if (!cursor2.isNull(4))
                            {
                                SumOfOrderValue=""+ (Double.parseDouble(SumOfOrderValue)+Double.parseDouble(cursor2.getString(4)));
                            }
                            if (!cursor2.isNull(5))
                            {
                                SumOfDiscountValue=""+ (Double.parseDouble(SumOfDiscountValue)+Double.parseDouble(cursor2.getString(5)));
                            }


                            cursor2.moveToNext();
                        }

                    }
                }

            }
            finally
            {
                cursor2.close();
            }

			/*String SumOfOQtyValue="0";
			String SumOfFQtyValue="0";
			String SumOfSQtyValue="0";

			String ProductPrice;
			String SumOfOrderValue="0";
			String SumOfDiscountValue="0";*/

            SumOQty[kk]=SumOfOQtyValue;
            SumFQty[kk]=SumOfFQtyValue;
            SumSQty[kk]=SumOfSQtyValue;
            SumOVal[kk]=SumOfOrderValue;
            SumDVal[kk]=SumOfDiscountValue;

            FinalReturnValue[kk]=SummryProductName[kk] + "^" + SumOQty[kk] + "^" + SumFQty[kk] + "^" + SumSQty[kk]  + "^" +ProductPrice+ "^" +SumOVal[kk]+ "^" +SumDVal[kk]+ "^"  + "0";



        }





        return FinalReturnValue;

    }

    public static void deleteAlrtProductWithSlab(String storeId,String _productID,String _schSlabId,String pdaOrderID,String TmpInvoiceCodePDA)
    {
        //open();
        Cursor cur=db.rawQuery("Select ProductID from tblAlrtVal where StoreId ='"+storeId+"' and ProductID = '"+_productID+"' and schSlabId = '"+_schSlabId+"'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'",null );
        if(cur.getCount()>0)
        {
            db.delete(DATABASE_TABLE_Main214, "StoreID=? AND ProductID=? AND schSlabId=? AND TmpInvoiceCodePDA=?",new String[] {storeId,_productID,_schSlabId,TmpInvoiceCodePDA});
        }

       // close();
    }

    public static void deleteAlertValueSlab(String storeId,String _schSlabId,String pdaOrderID,String TmpInvoiceCodePDA)
    {
        //open();
        Cursor cur=db.rawQuery("Select ProductID from tblAlrtVal where StoreId ='"+storeId+"'  and schSlabId = '"+_schSlabId+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'",null );
        if(cur.getCount()>0)
        {
            db.delete(DATABASE_TABLE_Main214, "StoreID=? AND schSlabId=? AND  TmpInvoiceCodePDA=?",new String[] {storeId,_schSlabId,TmpInvoiceCodePDA});
        }

        //close();
    }

    public static String fnGetMinSlabofSchemeID(String strSchemeID) {
        int LoncolumnIndex = 0;
        //////// System.out.println("strFPIDSlb strMaxSlb :" + strMaxSlb);
        String strProductSabFreeOrDiscount = "";

        Cursor cursor2 = db.rawQuery(
                "SELECT Min(SlabFrom) FROM tblSchemeDetails where SchemeID = '" + strSchemeID
                        + "'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    if (strProductSabFreeOrDiscount == "") {
                        strProductSabFreeOrDiscount = cursor2
                                .getString(LoncolumnIndex);
                    }

                    ////// System.out.println("Discount Abhinav = "+ strProductSabFreeOrDiscount);
                    cursor2.moveToNext();
                    // cursor.close();
                }

                strProductSabFreeOrDiscount = strProductSabFreeOrDiscount;

            }

        } finally {
            cursor2.close();
        }

        return strProductSabFreeOrDiscount;
    }

    public static void reTruncateRouteMstrTbl()
    {
        db.execSQL("DELETE FROM tblRouteListMaster");
    }

    public static String[] fnGetProductIDIDOnSchemeIdBasisNew(String SchemeID) {

        Cursor cursor = db.rawQuery("SELECT ProductID  FROM tblschemeProductMap where SchemeID='" + SchemeID + "'", null);

        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0)
            {

                if (cursor.moveToFirst())
                {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        CompleteResult[i] = cursor.getString(0) ;
                        ////// System.out.println("Abhi121 ProductID:" + CompleteResult[i].toString());
                        cursor.moveToNext();
                    }

                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public static String[] fnGetAllProductIDsAgainstSchemeIDsofClickedProductScheme(String AllSchmeIDs ) {

        Cursor cursor = db.rawQuery("SELECT ProductId FROM tblschemeProductMap where SchemeID  IN ("+AllSchmeIDs+")", null); // where FreeProductID IN ("+AllFreeProductgainstSchemeID+")
        ////// System.out.println("New Logic SELECT ProductId FROM tblschemeProductMap where SchemeID  IN ("+AllSchmeIDs+")");
        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0)
            {

                if (cursor.moveToFirst())
                {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        CompleteResult[i] = cursor.getString(0) ;
                        ////// System.out.println("Abhi121 fnGetAllProductIDsAgainstSchemeIDsofClickedProductScheme DISTINCT ProductID:" + CompleteResult[i].toString());
                        cursor.moveToNext();
                    }

                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public static String[] fnGetAllSchemeIDsAgainstCommonFreeIDsofClickedProductScheme(String AllFreeProductgainstSchemeID ) {

        Cursor cursor = db.rawQuery("SELECT DISTINCT SchemeID FROM tblSchemeDetails where FreeProductID IN ("+AllFreeProductgainstSchemeID+")", null); // where FreeProductID IN ("+AllFreeProductgainstSchemeID+")

        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0)
            {

                if (cursor.moveToFirst())
                {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        CompleteResult[i] = cursor.getString(0) ;
                        ////// System.out.println("Abhi121 fnGetAllSchemeIDsAgainstCommonFreeIDs DISTINCT SchemeID:" + CompleteResult[i].toString());
                        cursor.moveToNext();
                    }

                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public static String fnGetProdswithnewlogicNewNEw(String AllSchemeIds ) {

        Cursor cursor = db.rawQuery("SELECT DISTINCT FreeProductID FROM tblSchemeDetails where SchemeID IN ("+AllSchemeIds+")", null);

        try {
            String CompleteResult = "";
            if (cursor.getCount() > 0)
            {

                if (cursor.moveToFirst())
                {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        if(CompleteResult.equals(""))
                        {
                            CompleteResult = "'"+cursor.getString(0)+"'";
                        }
                        else
                        {
                            CompleteResult = CompleteResult+",'"+cursor.getString(0)+"'" ;
                        }


                        cursor.moveToNext();
                    }
                    ////// System.out.println("All Products Against All Schemes:" + CompleteResult);
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public static String fnGetFreeProductIDetailswithnewlogicNew(String AllSchemeIds ) {

        Cursor cursor = db.rawQuery("SELECT DISTINCT FreeProductID FROM tblSchemeDetails where SchemeID IN ("+AllSchemeIds+")", null);

        try {
            String CompleteResult = "";
            if (cursor.getCount() > 0)
            {

                if (cursor.moveToFirst())
                {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        if(CompleteResult.equals(""))
                        {
                            CompleteResult = "'"+cursor.getString(0)+"'";
                        }
                        else
                        {
                            CompleteResult = CompleteResult+",'"+cursor.getString(0)+"'" ;
                        }


                        cursor.moveToNext();
                    }
                    ////// System.out.println("All FreeProductID Against Scheme:" + CompleteResult);
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public static String[] fnGetDistinctFreeProductIDetails(String AllSchemeIds ) {

        Cursor cursor = db.rawQuery("SELECT DISTINCT FreeProductID FROM tblSchemeDetails where SchemeID IN ("+AllSchemeIds+")", null);

        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0)
            {

                if (cursor.moveToFirst())
                {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        CompleteResult[i] = cursor.getString(0) ;
                        ////// System.out.println("Abhi121 FreeProductID:" + CompleteResult[i].toString());
                        cursor.moveToNext();
                    }

                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public static String fnGetSchemeswithnewlogic(String AllFreeProductgainstSchemeID ) {

        Cursor cursor = db.rawQuery("SELECT DISTINCT SchemeID FROM tblSchemeDetails where FreeProductID IN ("+AllFreeProductgainstSchemeID+")", null);

        try {
            String CompleteResult = "";
            if (cursor.getCount() > 0)
            {

                if (cursor.moveToFirst())
                {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        if(CompleteResult.equals(""))
                        {
                            CompleteResult = "'"+cursor.getString(0)+"'";
                        }
                        else
                        {
                            CompleteResult = CompleteResult+",'"+cursor.getString(0)+"'" ;
                        }


                        cursor.moveToNext();
                    }
                    ////// System.out.println("All SchemeIDs Against FreeProducts:" + CompleteResult);
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public static String fnGetFreeProductIDetailswithnewlogic(String SchemeID ) {

        Cursor cursor = db.rawQuery("SELECT DISTINCT FreeProductID FROM tblSchemeDetails where SchemeID='" + SchemeID + "'", null);

        try {
            String CompleteResult = "";
            if (cursor.getCount() > 0)
            {

                if (cursor.moveToFirst())
                {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        if(CompleteResult.equals(""))
                        {
                            CompleteResult = "'"+cursor.getString(0)+"'";
                        }
                        else
                        {
                            CompleteResult = CompleteResult+",'"+cursor.getString(0)+"'" ;
                        }


                        cursor.moveToNext();
                    }
                    ////// System.out.println("All FreeProductID Against Scheme:" + CompleteResult);
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public static boolean countStockExists(String sID) {
        // int entryCount;
        Cursor cursorE2 = db.rawQuery(
                "SELECT SUM(Stock) FROM tblTransac WHERE StoreID ='" + sID
                        + "'", null);
        boolean chkI = false;
        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    ////// System.out.println("Stock prev.. entered!");

                    chkI = true;
                } else {
                    chkI = false;
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    public static String[] FetchStoreTransacFreeSampleQty(String sID2Fetch) {

        // id = getAllEntries();

        int SnamecolumnIndex1 = 0;

        // int Stock,int OrderQty, Double OrderVal, int FreeQty, Double DisVal

        Cursor cursor = db.rawQuery(
                "SELECT SampleQuantity  FROM tblTransac WHERE StoreID ='"
                        + sID2Fetch + "'", null);
        try {

            String StoreName[] = new String[cursor.getCount()];
            ;

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1)
                            .toString();

                    cursor.moveToNext();
                    // cursor.close();

                }

            }
            return StoreName;
        } finally {
            cursor.close();
        }

    }

    public static String[] FetchStoreInvoiceData(String sID2Fetch) {

        // id = getAllEntries();

        int SnamecolumnIndex1 = 0;
        int SnamecolumnIndex2 = 1;
        int SnamecolumnIndex3 = 2;
        int SnamecolumnIndex4 = 3;
        int SnamecolumnIndex5 = 4;
        int SnamecolumnIndex6 = 5;
        int SnamecolumnIndex7 = 6;
        int SnamecolumnIndex8 = 7;
        int SnamecolumnIndex9 = 8;
        int SnamecolumnIndex10 = 9;
        int SnamecolumnIndex11 = 10;
        int SnamecolumnIndex12 = 11;


        /*werewr
         * int SnamecolumnIndex11 = 10; int SnamecolumnIndex12 = 11; int
         * SnamecolumnIndex13 = 12;
         */

        // TotalBeforeTaxDis real not null, TaxAmt real not null, TotalDis real
        // not null, InvoiceVal real not null, FreeTotal integer not null);";

        // Cursor cursor =
        // db.rawQuery("SELECT TotalBeforeTaxDis, TaxAmt, TotalDis, InvoiceVal, FreeTotal, InvAfterDis, AddDis, AmtPrevDue, AmtColl, AmtOut, CreditAmt, InvoiceAfterCreditAmt, InvoiceOrginal FROM tblTmpInvoiceHeader WHERE StoreID ='"
        // + sID2Fetch + "'", null);
        Cursor cursor = db
                .rawQuery(
                        "SELECT TotalBeforeTaxDis, TaxAmt, TotalDis, InvoiceVal, FreeTotal, InvAfterDis, AddDis, AmtPrevDue, AmtColl, AmtOut, NoCoupon,TotalCoupunAmount FROM tblTmpInvoiceHeader WHERE StoreID ='" + sID2Fetch + "'", null);
        ////// System.out.println("FetchStoreInvoiceData store ............... called");
        try {

            String StoreName[] = new String[cursor.getCount()];


            if (cursor.moveToFirst()) {
                ////// System.out.println("FetchStoreInvoiceData store ............... cursor.getCount()" + cursor.getCount());
                for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1)
                            .toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex2)
                            .toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex3)
                            .toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex4)
                            .toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex5)
                            .toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex6)
                            .toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex7)
                            .toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex8)
                            .toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex9)
                            .toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex10)
                            .toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex11)
                            .toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex12)
                            .toString();// + "_" + (String)
                    // cursor.getString(SnamecolumnIndex11).toString()
                    // + "_" + (String)
                    // cursor.getString(SnamecolumnIndex12).toString()
                    // + "_" + (String)
                    // cursor.getString(SnamecolumnIndex13).toString();
                    ////// System.out.println("FetchStoreInvoiceData store ..............." + StoreName[i]);
                    cursor.moveToNext();
                    // cursor.close();

                }

            }
            return StoreName;
        } finally {
            cursor.close();
        }

    }

    public static String[] FetchStoreTransacData(String sID2Fetch) {

        // id = getAllEntries();

        int SnamecolumnIndex1 = 0;
        int SnamecolumnIndex2 = 1;
        int SnamecolumnIndex3 = 2;
        int SnamecolumnIndex4 = 3;
        int SnamecolumnIndex5 = 4;
        int SnamecolumnIndex6 = 5;

        // int Stock,int OrderQty, Double OrderVal, int FreeQty, Double DisVal

        Cursor cursor = db
                .rawQuery(
                        "SELECT Stock, OrderQty, OrderVal, FreeQty, DisVal, SampleQuantity  FROM tblTransac WHERE StoreID ='"
                                + sID2Fetch + "'", null);
        try {

            String StoreName[] = new String[cursor.getCount()];
            ;

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1)
                            .toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex2)
                            .toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex3)
                            .toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex4)
                            .toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex5)
                            .toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex6)
                            .toString();

                    cursor.moveToNext();
                    // cursor.close();

                }

            }
            return StoreName;
        } finally {
            cursor.close();
        }

    }

    public static String fnGetSchemeIdOnStoreTypeBasis(String strStoreType) {
        int LoncolumnIndex = 0;
        String strSchemeID = "";
        Cursor cursor2 = db.rawQuery(
                "SELECT SchemeID FROM tblschemeStoreTypeMap where StoreTypeID="
                        + Integer.parseInt(strStoreType), null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strSchemeID = cursor2.getString(LoncolumnIndex);
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strSchemeID;
        } finally {
            cursor2.close();
        }

        /*
         * Double myLons[] = new Double[cursor2.getCount()];; if
         * (cursor2.moveToFirst()) { for (int i = 0; i < cursor2.getCount();
         * i++) { myLons[i] = cursor2.getDouble(LoncolumnIndex);
         * cursor2.moveToNext(); //cursor2.close(); //third try } // second
         * tried here: cursor2.close(); } cursor2.close(); // Original location
         * for cursor2.close() //db.close();
         *
         * return myLons;
         */
    }

    public static String fnGetStoreTypeOnStoreIdBasis(String strStoreID) {

        Cursor cursorE2 = db.rawQuery("SELECT StoreType FROM tblStoreList WHERE StoreID ='"+ strStoreID + "'", null);
        String StoreType = "";
        int ScodecolumnIndex = 0;
        try {

            if (cursorE2.moveToFirst()) {

                for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
                    StoreType = (String) cursorE2.getString(ScodecolumnIndex)
                            .toString();
                    cursorE2.moveToNext();
                }
            }
            return StoreType;
        } finally {
            cursorE2.close();
        }

    }

    //public static String[] FetchLODqty(String ssStoreID,String CatID)
    public static HashMap<String,String> FetchLODqty(String ssStoreID)
    {

        int ScodecolumnIndex = 0;
        int SnamecolumnIndex = 1;

        //hmapCtgryPrdctDetail= key=prdctId,val=CategoryID
        HashMap<String, String> hmapCtgryPrdctDetail=new HashMap<String, String>();


        //open();
        //tblPDAGetLODQty(StoreID text null,Date text null,SKUID text  null,Qty integer null,SKUName text null);";

		/*Cursor cursor = db.rawQuery("SELECT LastTransDate, Quantity FROM tblLastTransactionDetails where StoreID= '"
								+ ssStoreID + "' and CategoryID='"+CatID+"'", null);*/
		/*Cursor cursor = db.rawQuery("SELECT LastTransDate, Quantity FROM tblLastTransactionDetails where StoreID= '"
				+ ssStoreID + "'", null);*/
        Cursor cursor = db.rawQuery("SELECT Date,Qty,SKUID FROM tblPDAGetLODQty where StoreID= '"
                + ssStoreID + "'", null);

        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i < cursor.getCount(); i++) {

                        if (cursor.getString(ScodecolumnIndex).toString().equals("NA"))
                        {
                            hmapCtgryPrdctDetail.put((String) cursor.getString(2).toString(),"NA"+ "-"+ (String) cursor.getString(SnamecolumnIndex).toString());

                        }
                        else
                        {
                            String fullDate;
                            String convertedTXTdate;
                            String exDay;
                            String exMonth;
                            //// System.out.println("Sunil Total else part: ");

                            SimpleDateFormat format1 = new SimpleDateFormat("dd-MMM-yyyy",Locale.ENGLISH);
                            //SimpleDateFormat format2 = new SimpleDateFormat("dd-MMM-yyyy",Locale.ENGLISH);

                            Date date;
                            fullDate = (String)cursor.getString(ScodecolumnIndex).toString();
                            fullDate=tViewDate(fullDate);

                            StringTokenizer tokens = new StringTokenizer(String.valueOf(fullDate), "-");

                            exDay = tokens.nextToken().trim();
                            exMonth = tokens.nextToken().trim();
                            hmapCtgryPrdctDetail.put((String) cursor.getString(2).toString(),exDay+"-"+exMonth+ "/"+(String)cursor.getString(SnamecolumnIndex).toString());
                            //StoreName[i] = exDay+"/"+exMonth+ "-"+(String)cursor.getString(SnamecolumnIndex).toString();

                        }
                        cursor.moveToNext();
                    }
                }
            }

		/*try {
			String StoreName[] = new String[cursor.getCount()];
			//// System.out.println("Sunil Total cursor.getCount() :"+cursor.getCount());

			if(cursor.getCount()>0)
			{
			if (cursor.moveToFirst()) {

				for (int i = 0; i <= (cursor.getCount() - 1); i++) {




					//// System.out.println("Sunil Total cursor :"+cursor.getString(ScodecolumnIndex).toString());

					try {
						} catch (Exception e) {
					}
						// TODO Auto-generated catch block
						e.printStackTrace();
					}

					cursor.moveToNext();
				}
			}
		}*/
            return hmapCtgryPrdctDetail;
        } finally {
            cursor.close();
            //close();
        }

    }

    public static String tViewDate(String PrevDate)
    {

        //// System.out.println("PrevDate :"+PrevDate);
        StringTokenizer tokennewPdate=new StringTokenizer(PrevDate, "-");
        String md1e=tokennewPdate.nextToken().trim();
        String md2e=tokennewPdate.nextToken().trim();
       /* if(md2e.toLowerCase().equals("Jan".toLowerCase()))
        {
            md2e="01";
        }
        if(md2e.toLowerCase().equals("Feb".toLowerCase()))
        {
            md2e="02";
        }
        if(md2e.toLowerCase().equals("Mar".toLowerCase()))
        {
            md2e="03";
        }
        if(md2e.toLowerCase().equals("Apr".toLowerCase()))
        {
            md2e="04";
        }
        if(md2e.toLowerCase().equals("May".toLowerCase()))
        {
            md2e="05";
        }
        if(md2e.toLowerCase().equals("Jun".toLowerCase()))
        {
            md2e="06";
        }
        if(md2e.toLowerCase().equals("Jul".toLowerCase()))
        {
            md2e="07";
        }
        if(md2e.toLowerCase().equals("Aug".toLowerCase()))
        {
            md2e="08";
        }
        if(md2e.toLowerCase().equals("Sep".toLowerCase()))
        {
            md2e="09";
        }
        if(md2e.toLowerCase().equals("Oct".toLowerCase()))
        {
            md2e="10";
        }
        if(md2e.toLowerCase().equals("Nov".toLowerCase()))
        {
            md2e="11";
        }
        if(md2e.toLowerCase().equals("Dec".toLowerCase()))
        {
            md2e="12";
        }*/
        String md3e=tokennewPdate.nextToken().trim();
        PrevDate=md1e +"-"+md2e+"-"+ md3e;

        return PrevDate;
    }

    /*public static String[] FetchRate() {

		// id = getAllEntries();

		int ScodecolumnIndex = 0;


		Cursor cursor = db.rawQuery("SELECT ProductRLP FROM tblProductListMaster",null);
		try {
			String StoreName[] = new String[cursor.getCount()];
			;
			if (cursor.moveToFirst()) {

				for (int i = 0; i <= (cursor.getCount() - 1); i++) {
					StoreName[i] = (String) cursor.getString(ScodecolumnIndex)
							.toString();
					////// System.out.println("DB-ADAP: PROD RLP: "+ (String) cursor.getString(ScodecolumnIndex).toString());
					cursor.moveToNext();
				}
			}
			return StoreName;
		} finally {
			cursor.close();
		}
	}*/
    public static Double fnGetLastCreditAmountFromLastInvoiceTable(String strStoreID) {

        int ScodecolumnIndex = 0;
        Double strLastBalanceAmt = 0.00;
        Cursor cursor = db.rawQuery(
                "SELECT CreditPreviousDue FROM tblPDALastInvoiceDet where StoreID='"
                        + strStoreID + "'", null);
        try {
            ////// System.out.println("Raja babu Abhivan Raj strLastBalanceAmt 1a :"+strLastBalanceAmt);
            if(cursor.getCount()>0)
            {
                ////// System.out.println("Raja babu Abhivan Raj strLastBalanceAmt 2a :"+strLastBalanceAmt);
                if (cursor.moveToFirst()) {
                    if(!cursor.getString(ScodecolumnIndex).toString().equals(""))
                    {
                        for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                            if (!cursor.isNull(ScodecolumnIndex)) {
                                strLastBalanceAmt = Double.parseDouble(cursor
                                        .getString(ScodecolumnIndex).toString());
                                ////// System.out.println("Raja babu Abhivan Raj strLastBalanceAmt 3a :"+strLastBalanceAmt);
                                cursor.moveToNext();
                            }

                        }
                    }


                }
            }
            ////// System.out.println("Raja babu Abhivan Raj strLastBalanceAmt 4a :"+strLastBalanceAmt);
            return strLastBalanceAmt;
        } finally {
            cursor.close();
        }
    }

    public static Double fnGetActualValueTotalReturnValue(String ReturnStoreId) {

        int LoncolumnIndex = 0;
        Double strActualValueTotalReturnValue = 0.00;

        Cursor cursor2 = db.rawQuery(
                "SELECT TotalReturnValue FROM  tblPDAProductReturnMstr where StoreID='"
                        + ReturnStoreId + "'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    if (!cursor2.isNull(LoncolumnIndex)) {
                        strActualValueTotalReturnValue = Double
                                .parseDouble(cursor2.getString(LoncolumnIndex));
                    }

                    cursor2.moveToNext();
                    // cursor.close();
                }

            }

            return strActualValueTotalReturnValue;
        } finally {
            cursor2.close();
        }

    }

    public static Double fnGetActualValueAdjAmt(String ReturnStoreId) {

        int LoncolumnIndex = 0;
        Double strActualValueTotalAdjAmt = 0.00;
        Cursor cursor2 = db.rawQuery(
                "SELECT TotalAdjustValue FROM  tblPDAProductReturnMstr where StoreID='"
                        + ReturnStoreId + "'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    if (!cursor2.isNull(LoncolumnIndex)) {
                        strActualValueTotalAdjAmt = Double.parseDouble(cursor2
                                .getString(LoncolumnIndex));
                    }

                    cursor2.moveToNext();
                    // cursor.close();
                }

            }

            return strActualValueTotalAdjAmt;
        } finally {
            cursor2.close();
        }

    }

    public static int fnCkhTotalReturnValue(String ReturnStoreId) {

        int LoncolumnIndex = 0;
        int strReturnIdMstr = 0;

        Cursor cursor2 = db.rawQuery(
                "SELECT TotalReturnValue FROM  tblPDAProductReturnMstr where StoreID='"
                        + ReturnStoreId + "'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strReturnIdMstr = 1;
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }

            return strReturnIdMstr;
        } finally {
            cursor2.close();
        }

    }

    public static Double fnGetAdjAmtProdReturns(String StoreID) {
        Double TotalAdjAmt = 0.00;
        int chkValue = fnCkhTotalReturnValue(StoreID);
        if (chkValue == 1) {
            TotalAdjAmt = fnGetActualValueAdjAmt(StoreID);

        }

        return TotalAdjAmt;
    }

    public static Double fnGetTotalReturnValueOnOrderPage(String StoreID) {
        Double TotalReturnValue = 0.00;
        int chkValue = fnCkhTotalReturnValue(StoreID);
        if (chkValue == 1) {
            TotalReturnValue = fnGetActualValueTotalReturnValue(StoreID);

        }

        return TotalReturnValue;
    }

    public static int fnCheckflgToShowStrachRowOrNot()
    {


        Cursor cursorE2 = db.rawQuery(
                "SELECT Sum(flgIsStrachApplicable) FROM tblStrachApplicableOnScheme", null);

        ////// System.out.println("SELECT Sum(flgIsStrachApplicable) FROM tblStrachApplicableOnScheme");
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {
                for (int i = 0; i < cursorE2.getCount(); i++)
                {
                    if (!cursorE2.isNull(0))
                    {
                        chkI = Integer.parseInt(cursorE2.getString(0));
                    } else {
                        chkI = 0;
                    }
                    cursorE2.moveToNext();
                }

            }

        } finally {
            cursorE2.close();
        }
        ////// System.out.println("fnCheckflgToShowStrachRowOrNot : " +chkI);
        return chkI;

    }

    public static int checkStoreIdForNewStore(String ssStoreID){
        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery(
                "SELECT *  FROM tblNewStoreListEntries where StoreID= '"
                        + ssStoreID + "'", null);
        try {
            if (cursor.moveToFirst()) {

                for (int i = 0; i < cursor.getCount(); i++) {
                    ScodecolumnIndex = 1;
                    cursor.moveToNext();
                    // cursor.close();
                }

            }
            ////// System.out.println("value  of new store is in DBadapter"+ScodecolumnIndex);
            return ScodecolumnIndex;
        } finally {
            cursor.close();
        }

    }

    public static String fnGetPDALastInvoiceDetDueAmt(String strStoreID) {

        Cursor cursorE2 = db.rawQuery(
                "SELECT BalanceAmount FROM tblPDALastInvoiceDet WHERE StoreID ='"
                        + strStoreID + "'", null);
        String StoreType = "0.0";
        int ScodecolumnIndex = 0;
        try {
            if (cursorE2.getCount()>0)
            {

                if (cursorE2.moveToFirst()) {
                    if(!cursorE2.getString(ScodecolumnIndex).toString().equals(""))
                    {
                        for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
                            StoreType = (String) cursorE2.getString(ScodecolumnIndex)
                                    .toString();
                            cursorE2.moveToNext();
                        }
                    }
                }
            }
            return StoreType;
        } finally {
            cursorE2.close();
        }

    }

    public static int fnGetStrachIDMinSlabQtyForCalculation(int strSchemeID)
    {
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        int LoncolumnIndex2 = 2;

        int strProductSabCardStrachIDQty = 0;


        Cursor cursor2 = db.rawQuery("SELECT Min(Slab) FROM tblStrachOnSchemeDetails where SchID = "+ strSchemeID , null);
        try {
            if (cursor2.moveToFirst())
            {
                if (!cursor2.isNull(LoncolumnIndex))
                {
                    for (int i = 0; i < cursor2.getCount(); i++)
                    {
                        if (strProductSabCardStrachIDQty == 0)
                        {
                            strProductSabCardStrachIDQty = Integer.parseInt(cursor2
                                    .getString(LoncolumnIndex));
                        }

                        cursor2.moveToNext();
                        // cursor.close();
                    }
                }




            }

        } finally {
            cursor2.close();
        }
        return strProductSabCardStrachIDQty;
    }

	/*public static Double[] FetchProdTaxAmt() {

		// id = getAllEntries();

		int ScodecolumnIndex = 0;

		Cursor cursor = db.rawQuery(
				"SELECT ProductTaxAmount FROM tblProductListMaster", null);
		try {
			Double StoreName[] = new Double[cursor.getCount()];
			;
			if (cursor.moveToFirst()) {

				for (int i = 0; i <= (cursor.getCount() - 1); i++) {
					StoreName[i] = (Double) cursor.getDouble(ScodecolumnIndex);
					cursor.moveToNext();
				}
			}
			return StoreName;
		} finally {
			cursor.close();
		}
	}*/

    public static String fnGetStrachIDSlabQtyForCalculation(int Slab, int strSchemeID)
    {
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        int LoncolumnIndex2 = 2;

        String strProductSabCardStrachIDQty = "";


        Cursor cursor2 = db.rawQuery("SELECT Slab,cardStrachID,Qty FROM tblStrachOnSchemeDetails where Slab="	+ Slab + " and SchID = "+ strSchemeID , null);
        try {
            if (cursor2.moveToFirst())
            {

                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    if (strProductSabCardStrachIDQty == "")
                    {
                        strProductSabCardStrachIDQty = cursor2
                                .getString(LoncolumnIndex) + "_"+  cursor2
                                .getString(LoncolumnIndex1)  + "_"+  cursor2
                                .getString(LoncolumnIndex2) ;
                    }

                    cursor2.moveToNext();
                    // cursor.close();
                }



            }

        } finally {
            cursor2.close();
        }
        return strProductSabCardStrachIDQty;
    }

    public static int fnGetStrachIDMaxSlabQtyForCalculation(int strSchemeID, int strOrderValue)
    {
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        int LoncolumnIndex2 = 2;

        int strProductSabCardStrachIDQty = 0;


        Cursor cursor2 = db.rawQuery("SELECT Max(Slab) FROM tblStrachOnSchemeDetails where Slab<="	+ strOrderValue + " and SchID = "+ strSchemeID , null);
        try {
            if (cursor2.moveToFirst())
            {
                if (!cursor2.isNull(LoncolumnIndex))
                {
                    for (int i = 0; i < cursor2.getCount(); i++)
                    {
                        if (strProductSabCardStrachIDQty == 0)
                        {
                            strProductSabCardStrachIDQty = Integer.parseInt(cursor2
                                    .getString(LoncolumnIndex));
                        }

                        cursor2.moveToNext();
                        // cursor.close();
                    }
                }




            }

        } finally {
            cursor2.close();
        }
        return strProductSabCardStrachIDQty;
    }

    public static String[] fnGetOtherProductIdForStrachCoupons(int strSchemID) {


        int ScodecolumnIndex = 0;
        Cursor cursor = db.rawQuery(
                "SELECT ProductId FROM tblSchemeProductMap where SchemeID='"
                        + strSchemID+"'", null);
        try {
            String ProductComboIds[] = new String[cursor.getCount()];
            ;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    ProductComboIds[i] = (String) cursor.getString(
                            ScodecolumnIndex).toString();
                    cursor.moveToNext();
                    //// System.out.println("fnGetOtherProductIdOfCombo : Product  Id  that Returns"+ ProductComboIds[i].trim());
                }
            }
            return ProductComboIds;
        } finally {
            cursor.close();
        }
    }

    public static int fnCheckIsStrachCardApplicableonSlabOrValue(int SchemeID)
    {

        int LoncolumnIndex = 0;
        Cursor cursorE2 = db.rawQuery("SELECT ProductValueOrSlabBased FROM tblStrachOnSchemeDetails where SchID="+ SchemeID, null);

        ////// System.out.println("fnCheckIsStrachCardApplicableonSlabOrValue : " +"SELECT ProductValueOrSlabBased FROM tblStrachOnSchemeDetails where SchID="+ SchemeID);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {


                chkI = Integer.parseInt(cursorE2.getString(LoncolumnIndex).toString());

                cursorE2.moveToNext();


            }

        } finally {
            cursorE2.close();
        }
        ////// System.out.println("fnCheckIsStrachCardApplicableonSlabOrValue : " +chkI);
        return chkI;

    }

    public static int fnCheckIsStrachCardApplicableonSchemeID(int SchemeID)
    {


        Cursor cursorE2 = db.rawQuery(
                "SELECT flgIsStrachApplicable FROM tblStrachApplicableOnScheme where SchID="+ SchemeID, null);

        ////// System.out.println("fnCheckIsStrachCardApplicableonSchemeID : " +"SELECT flgIsStrachApplicable FROM tblStrachApplicableOnScheme where SchID="+ SchemeID);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {
                for (int i = 0; i < cursorE2.getCount(); i++)
                {
                    if (!cursorE2.isNull(0))
                    {
                        chkI = 1;
                    } else
                    {
                        chkI = 0;
                    }
                    cursorE2.moveToNext();
                }

            }

        } finally {
            cursorE2.close();
        }
        ////// System.out.println("fnCheckIsStrachCardApplicableonSchemeID : " +chkI);
        return chkI;

    }

    public static String[] fnGetUniqueSchemeId()
    {
        int LoncolumnIndex = 0;



        Cursor cursor2 = db.rawQuery("SELECT DISTINCT SchID FROM tblStrachOnSchemeDetails", null);
        try {
            String UniqueSchemeId[] = new String[cursor2.getCount()];
            if (cursor2.moveToFirst())
            {

                for (int i = 0; i < cursor2.getCount(); i++)
                {

                    if (!cursor2.isNull(LoncolumnIndex))
                    {
                        UniqueSchemeId[i] =cursor2.getString(LoncolumnIndex).toString();
                        ////// System.out.println("abccc  :"+UniqueSchemeId[i]);
                        cursor2.moveToNext();
                    }

                }

            }
            return UniqueSchemeId;
        } finally {
            cursor2.close();
        }
    }

    public static String fnGetFreeProductNameOnProcutIdBasisCombo(String strProductId) {

        int ScodecolumnIndex = 0;


        Cursor cursor = db.rawQuery(
                "SELECT ProductShortName FROM tblProductListMaster where ProductID='"
                        + strProductId + "'", null);
        try {
            String ProductComboId = "";
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    ProductComboId = (String) cursor
                            .getString(ScodecolumnIndex).toString();

                    cursor.moveToNext();
                }
            }
            return ProductComboId;
        } finally {
            cursor.close();
        }
    }

    public static HashMap<String, String> checkForStoreIdSstat()
    {
        Cursor cursor=db.rawQuery("Select StoreID,Sstat from tblStoreList",null);// where Sstat in(1,3,4,5)
        HashMap<String, String> hmapStoreIDSstat=new HashMap<String, String>();
        if(cursor.getCount()>0)
        {
            if(cursor.moveToFirst())
            {
                for(int index=0;index<cursor.getCount();index++)
                {
                    hmapStoreIDSstat.put(cursor.getString(0), cursor.getString(1));
                    cursor.moveToNext();
                }
            }
        }
        return hmapStoreIDSstat;
    }

    public static HashMap<String, String> checkForPreAddedStoreIdSstat()
    {
        Cursor cursor=db.rawQuery("Select StoreID,Sstat from tblStoreList",null);// where Sstat in(1,3,4,5)
        HashMap<String, String> hmapStoreIDSstat=new HashMap<String, String>();
        if(cursor.getCount()>0)
        {
            if(cursor.moveToFirst())
            {
                for(int index=0;index<cursor.getCount();index++)
                {
                    hmapStoreIDSstat.put(cursor.getString(0), cursor.getString(1));
                    cursor.moveToNext();
                }
            }
        }
        return hmapStoreIDSstat;
    }
    public static HashMap<String, String> checkForStoreflgOrderType()
    {
        Cursor cursor=db.rawQuery("Select StoreID,flgOrderType from tblStoreList",null);// where Sstat in(1,3,4,5)
        HashMap<String, String> hmapflgOrderType=new HashMap<String, String>();
        if(cursor.getCount()>0)
        {
            if(cursor.moveToFirst())
            {
                for(int index=0;index<cursor.getCount();index++)
                {
                    hmapflgOrderType.put(cursor.getString(0), cursor.getString(1));
                    cursor.moveToNext();
                }
            }
        }
        return hmapflgOrderType;
    }

    public static String fnValueFreeQtyOrDiscountForCaculation(String strSchemType,
                                                        String strSchemeID, int MaxValue) {
        int LoncolumnIndex = 0;

        String strProductSabFreeOrDiscount = "";

        if (Integer.parseInt(strSchemType) == 1
                || Integer.parseInt(strSchemType) == 2) {
            Cursor cursor2 = db
                    .rawQuery(
                            "SELECT FreeQuantity FROM tblSchemeDetails where SlabFrom ="
                                    + MaxValue + " and SchemeID ='"
                                    + strSchemeID + "'", null);
            try {
                if (cursor2.moveToFirst()) {

                    for (int i = 0; i < cursor2.getCount(); i++) {
                        if (strProductSabFreeOrDiscount == "") {
                            strProductSabFreeOrDiscount = cursor2
                                    .getString(LoncolumnIndex);
                        }
                        ////// System.out.println("SabFree - called = "+ strProductSabFreeOrDiscount);
                        cursor2.moveToNext();
                        // cursor.close();

                    }

                    // strProductSabFreeOrDiscount =
                    // strProductSabFreeOrDiscount;

                }

            } finally {
                cursor2.close();
            }
        }
        if (Integer.parseInt(strSchemType) == 3) {
            Cursor cursor2 = db
                    .rawQuery(
                            "SELECT Discount FROM tblSchemeDetails where SlabFrom ="
                                    + MaxValue + " and SchemeID ='"
                                    + strSchemeID + "'", null);
            try {
                if (cursor2.moveToFirst()) {

                    for (int i = 0; i < cursor2.getCount(); i++) {
                        if (strProductSabFreeOrDiscount == "") {
                            strProductSabFreeOrDiscount = cursor2
                                    .getString(LoncolumnIndex);
                        }

                        ////// System.out.println("DiscountFree - called = "+ strProductSabFreeOrDiscount);
                        cursor2.moveToNext();
                        // cursor.close();

                    }

                    // strProductSabFreeOrDiscount = strProductSabFreeOrDiscount
                    // + "_" + strSchemType;

                }

            } finally {
                cursor2.close();
            }
        }
        return strProductSabFreeOrDiscount;
    }

    public static String fnGetSchemeDetailsOfProductOnSchemeTypeSchemeIDBasisNew(
            String strSchemType, String strSchemeID, String strFreeProductID,
            String strCombTypeID, String strSchemeName) {
        int LoncolumnIndex = 0;
        int LoncolumnIndex2 = 1;
        int LoncolumnIndex3 = 2;
        String strProductSabFreeOrDiscount = "";

        if (Integer.parseInt(strSchemType) == 1
                || Integer.parseInt(strSchemType) == 2) {
            ////// System.out.println("STR SCH TYPE: "+ Integer.parseInt(strSchemType)); //

            Cursor cursor2 = db.rawQuery(
                    "SELECT SlabFrom, SlabTo, FreeQuantity FROM tblSchemeDetails WHERE SchemeID ='"
                            + strSchemeID + "'", null);

            //// System.out.println("SELECT SlabFrom, SlabTo, FreeQuantity FROM tblSchemeDetails WHERE SchemeID ='"+ strSchemeID + "'");

            try {
                if (cursor2.moveToFirst()) {

                    for (int i = 0; i < cursor2.getCount(); i++) {
                        if (strProductSabFreeOrDiscount == "") {
                            if (Integer.parseInt(strCombTypeID) == 2) {
                                strProductSabFreeOrDiscount = "Combo :"
                                        + strSchemeName + "("
                                        + cursor2.getString(LoncolumnIndex)
                                        + "+"
                                        + cursor2.getString(LoncolumnIndex3);
                            } else {
                                strProductSabFreeOrDiscount = strSchemeName
                                        + "("
                                        + cursor2.getString(LoncolumnIndex)
                                        + "+"
                                        + cursor2.getString(LoncolumnIndex3);
                            }
                            //// System.out.println("strProductSabFreeOrDiscount4ab :"+ strProductSabFreeOrDiscount );


                        } else {
                            if (Integer.parseInt(strCombTypeID) == 2) {
                                strProductSabFreeOrDiscount = strProductSabFreeOrDiscount
                                        + ", "
                                        + cursor2.getString(LoncolumnIndex)
                                        + "+"
                                        + cursor2.getString(LoncolumnIndex3);
                            } else {
                                strProductSabFreeOrDiscount = strProductSabFreeOrDiscount
                                        + ", "
                                        + cursor2.getString(LoncolumnIndex)
                                        + "+"
                                        + cursor2.getString(LoncolumnIndex3);
                            }
                            //// System.out.println("strProductSabFreeOrDiscount5ab :"+ strProductSabFreeOrDiscount );


                        }

                        cursor2.moveToNext();
                        // cursor.close();
                    }
                    //// System.out.println("strProductSabFreeOrDiscount1ab :"+ strProductSabFreeOrDiscount );

                    if (strProductSabFreeOrDiscount == "") {
                        strProductSabFreeOrDiscount = "No Free Quantity Schemes Available_"
                                + strSchemType;
                    } else {
                        strProductSabFreeOrDiscount = strProductSabFreeOrDiscount
                                + ")_" + strSchemType;
                    }
                    //// System.out.println("strProductSabFreeOrDiscount2ab :"+ strProductSabFreeOrDiscount);

                }

            } finally {
                cursor2.close();
            }
        }
        if (Integer.parseInt(strSchemType) == 3) {
            ////// System.out.println("STR SCH TYPE: "+ Integer.parseInt(strSchemType)); //
            int flgDiscountType=0;
            flgDiscountType=fnGetDisType(strSchemeID,strSchemType);
            Cursor cursor2 = db.rawQuery(
                    "SELECT SlabFrom, SlabTo, Discount FROM tblSchemeDetails WHERE SchemeID ='"
                            + strSchemeID + "'", null);

            //// System.out.println("SELECT SlabFrom, SlabTo, Discount FROM tblSchemeDetails WHERE SchemeID ='"+ strSchemeID + "'");

            try {
                if (cursor2.moveToFirst()) {
                    ////// System.out.println("CURSOR2 COUNT SCH DIS: "+ cursor2.getCount());

                    for (int i = 0; i < cursor2.getCount(); i++) {
                        if(flgDiscountType==1)
                        {
                            if (strProductSabFreeOrDiscount == "") {
                                strProductSabFreeOrDiscount = strSchemeName
                                        + "("
                                        + cursor2.getString(LoncolumnIndex)
                                        + "+ Rs/-"
                                        + cursor2.getString(LoncolumnIndex3) + ")";
                            } else {
                                strProductSabFreeOrDiscount = strSchemeName
                                        + "("
                                        + cursor2.getString(LoncolumnIndex)
                                        + "+ Rs/-"
                                        + cursor2.getString(LoncolumnIndex3) + ")";
                            }
                        }
                        else if(flgDiscountType==2)
                        {
                            if (strProductSabFreeOrDiscount == "") {
                                strProductSabFreeOrDiscount = strSchemeName
                                        + "("
                                        + cursor2.getString(LoncolumnIndex)
                                        + "+ "
                                        + cursor2.getString(LoncolumnIndex3) + "%)";
                            } else {
                                strProductSabFreeOrDiscount = strSchemeName
                                        + "("
                                        + cursor2.getString(LoncolumnIndex)
                                        + "+ "
                                        + cursor2.getString(LoncolumnIndex3) + "%)";
                            }
                        }

                        ////// System.out.println("strProductSabFreeOrDiscount: "+ strProductSabFreeOrDiscount);

                        cursor2.moveToNext();
                        // cursor.close();
                    }
                    if (strProductSabFreeOrDiscount == "") {
                        strProductSabFreeOrDiscount = "No Discounts Available_"
                                + strSchemType;
                    } else {
                        strProductSabFreeOrDiscount = strProductSabFreeOrDiscount
                                + "_" + strSchemType;
                    }

                }

            } finally {
                cursor2.close();
            }
        }
        return strProductSabFreeOrDiscount;
    }

    public static String fnGetSchemeIDOnProductIDIdBasisNew(String strProductId) {
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        String strSchemeIDFreeProductId = "";
        Cursor cursor2 = db.rawQuery(
                "SELECT SchemeID FROM tblschemeProductMap where ProductID='"
                        + strProductId + "' and SchemeType<=3", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {

                    strSchemeIDFreeProductId = cursor2
                            .getString(LoncolumnIndex);
                    //+ "_"
                    //+ cursor2.getString(LoncolumnIndex1);
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strSchemeIDFreeProductId;
        } finally {
            cursor2.close();
        }
    }

    public static String fnGetAllSchemeDetailsOnProductNewClick(String strProductId)
    {

        String strSchemeIDFreePRoductId = "";
        String strSchemeID = fnGetSchemeIDOnProductIDIdBasisNew(strProductId);
        String strFreeProductID = "";
        String strSchemeTypeCombTypeIDSchemeName = "";
        strSchemeTypeCombTypeIDSchemeName = fnGetSchemTypeOnSchemIDIdBasis(strSchemeID);

        StringTokenizer tokensSchemeTypeCombTypeID = new StringTokenizer(
                String.valueOf(strSchemeTypeCombTypeIDSchemeName), "_");
        String strSchemeType = "";
        String strCombTypeID = "";
        String strSchemeName = "";
        strSchemeType = tokensSchemeTypeCombTypeID.nextToken().trim();
        strCombTypeID = tokensSchemeTypeCombTypeID.nextToken().trim();
        strSchemeName = tokensSchemeTypeCombTypeID.nextToken().trim();

        String strForAllScehmesAgainstProduct = "";
        strForAllScehmesAgainstProduct = fnGetSchemeDetailsOfProductOnSchemeTypeSchemeIDBasisNew(
                strSchemeType, strSchemeID, strFreeProductID, strCombTypeID,
                strSchemeName);


        return strForAllScehmesAgainstProduct;
    }

    public static String fnFreeQuantity(String strProductId, int MaxValue) {
        String strSchemeIDFreePRoductId = "";

        strSchemeIDFreePRoductId = fnGetSchemeIDOnProductIDIdBasis(strProductId);
        //StringTokenizer tokensSchemeIDFreePRoductId = new StringTokenizer(
        //	String.valueOf(strSchemeIDFreePRoductId), "_");
        String strSchemeID = "";
        String strFreeProductID = "";
        strSchemeID =strSchemeIDFreePRoductId;// tokensSchemeIDFreePRoductId.nextToken().trim();
        //strFreeProductID = tokensSchemeIDFreePRoductId.nextToken().trim();

        String strSchemeTypeCombTypeIDSchemeName = "";
        strSchemeTypeCombTypeIDSchemeName = fnGetSchemTypeOnSchemIDIdBasis(strSchemeID);

        StringTokenizer tokensSchemeTypeCombTypeID = new StringTokenizer(
                String.valueOf(strSchemeTypeCombTypeIDSchemeName), "_");
        String strSchemeType = "";
        String strCombTypeID = "";
        String strSchemeName = "";
        strSchemeType = tokensSchemeTypeCombTypeID.nextToken().trim();
        strCombTypeID = tokensSchemeTypeCombTypeID.nextToken().trim();
        strSchemeName = tokensSchemeTypeCombTypeID.nextToken().trim();

        String strValueFreeQtyOrDiscount = "";
        strValueFreeQtyOrDiscount = fnValueFreeQtyOrDiscountForCaculation(strSchemeType, strSchemeID, MaxValue);
        return strValueFreeQtyOrDiscount;
    }

    public static String fnGetSchemeDetailsOfProductOnSchemeTypeSchemeIDBasisForCaculation(
            String strSchemType, String strSchemeID, int strOrderValue) {
        int LoncolumnIndex = 0;
        //////// System.out.println("strFPIDSlb strMaxSlb :" + strMaxSlb);
        String strProductSabFreeOrDiscount = "";

        if (Integer.parseInt(strSchemType) == 1
                || Integer.parseInt(strSchemType) == 2) {
            Cursor cursor2 = db.rawQuery(
                    "SELECT Max(SlabFrom) FROM tblSchemeDetails where SlabFrom<="
                            + strOrderValue + " and SchemeID = '" + strSchemeID
                            + "'", null);
            try {
                if (cursor2.moveToFirst()) {

                    for (int i = 0; i < cursor2.getCount(); i++) {
                        if (strProductSabFreeOrDiscount == "") {
                            strProductSabFreeOrDiscount = cursor2
                                    .getString(LoncolumnIndex);
                        }

                        cursor2.moveToNext();
                        // cursor.close();
                    }

                    strProductSabFreeOrDiscount = strProductSabFreeOrDiscount
                            + "_" + strSchemType;

                }

            } finally {
                cursor2.close();
            }
        }
        if (Integer.parseInt(strSchemType) == 3) {
            Cursor cursor2 = db.rawQuery(
                    "SELECT Max(SlabFrom) FROM tblSchemeDetails where SlabFrom<="
                            + strOrderValue + " and SchemeID = '" + strSchemeID
                            + "'", null);
            try {
                if (cursor2.moveToFirst()) {

                    for (int i = 0; i < cursor2.getCount(); i++) {
                        if (strProductSabFreeOrDiscount == "") {
                            strProductSabFreeOrDiscount = cursor2
                                    .getString(LoncolumnIndex);
                        }

                        ////// System.out.println("Discount Abhinav = "+ strProductSabFreeOrDiscount);
                        cursor2.moveToNext();
                        // cursor.close();
                    }

                    strProductSabFreeOrDiscount = strProductSabFreeOrDiscount
                            + "_" + strSchemType;

                }

            } finally {
                cursor2.close();
            }
        }
        return strProductSabFreeOrDiscount;
    }

    public static String fnCallSchemeDetailsOfProductOnSchemeTypeSchemeIDBasisForCaculationOverAll(
            String strSchemeType, String strSchemeID, int strOrderValue) {
        String strForCalculation = "";
        strForCalculation = fnGetSchemeDetailsOfProductOnSchemeTypeSchemeIDBasisForCaculation(
                strSchemeType, strSchemeID, strOrderValue);
        return strForCalculation;
    }

    public static String fnGetSchemTypeOnSchemIDIdBasis(String strSchemID)
    {
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        int LoncolumnIndex2 = 2;
        String strSchemeTypeCombTypeIDSchemeName = "";
        Cursor cursor2 = db.rawQuery(
                "SELECT SchemeType, CombTypeID,SchemeName FROM tblSchemeList where SchemeID='"
                        + strSchemID + "'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strSchemeTypeCombTypeIDSchemeName = cursor2
                            .getString(LoncolumnIndex)
                            + "_"
                            + cursor2.getString(LoncolumnIndex1)
                            + "_"
                            + cursor2.getString(LoncolumnIndex2);
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strSchemeTypeCombTypeIDSchemeName;
        } finally {
            cursor2.close();
        }
    }

	/*public static String[] fnGetOtherProductIdOfCombo(String strSchemID) {

		// id = getAllEntries();

		int ScodecolumnIndex = 0;


		Cursor cursor = db.rawQuery(
				"SELECT ProductId FROM tblSchemeProductMap where SchemeID='"
						+ strSchemID + "'", null);
		try {
			String ProductComboIds[] = new String[cursor.getCount()];
			;
			if (cursor.moveToFirst()) {

				for (int i = 0; i <= (cursor.getCount() - 1); i++) {
					ProductComboIds[i] = (String) cursor.getString(
							ScodecolumnIndex).toString();
					cursor.moveToNext();
					//// System.out.println("fnGetOtherProductIdOfCombo : Product  Id  that Returns"+ ProductComboIds[i].trim());
				}
			}
			return ProductComboIds;
		} finally {
			cursor.close();
		}
	}*/

    public static String fnGetProductSchemeIDandComboTypeIdDetails(String strProductId) {
        String strSchemeIDFreePRoductId = "";

        strSchemeIDFreePRoductId = fnGetSchemeIDOnProductIDIdBasis(strProductId);
        String strSchemeID = "";
        strSchemeID = strSchemeIDFreePRoductId;

        String strSchemeTypeCombTypeIDSchemeName = "";
        strSchemeTypeCombTypeIDSchemeName = fnGetSchemTypeOnSchemIDIdBasis(strSchemeID);

        StringTokenizer tokensSchemeTypeCombTypeID = new StringTokenizer(
                String.valueOf(strSchemeTypeCombTypeIDSchemeName), "_");
        String strSchemeType = "";
        String strCombTypeID = "";
        String strSchemeName = "";
        strSchemeType = tokensSchemeTypeCombTypeID.nextToken().trim();
        strCombTypeID = tokensSchemeTypeCombTypeID.nextToken().trim();
        strSchemeName = tokensSchemeTypeCombTypeID.nextToken().trim();

        String strProductIdSchemeIDFreeProductIDSchemeTypeCombTypeID = strProductId
                + "_"
                + strSchemeID
                + "_"
                + strSchemeType + "_" + strCombTypeID;

        // String strForCalculation="";
        // strForCalculation=fnGetSchemeDetailsOfProductOnSchemeTypeSchemeIDBasisForCaculation(strSchemeType,strSchemeID,strOrderValue);
        return strProductIdSchemeIDFreeProductIDSchemeTypeCombTypeID;
    }

    public static String[] fnGetFreeProductIDetails(String SchemeID ) {

        Cursor cursor = db.rawQuery("SELECT DISTINCT FreeProductID FROM tblSchemeDetails where SchemeID='" + SchemeID + "'", null);

        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0)
            {

                if (cursor.moveToFirst())
                {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        CompleteResult[i] = cursor.getString(0) ;
                        ////// System.out.println("Abhi121 FreeProductID:" + CompleteResult[i].toString());
                        cursor.moveToNext();
                    }

                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public static String fnGetFreeProIdDefault(String strSchemeID, int strOrderValue) {
        int LoncolumnIndex = 0;
        //////// System.out.println("strFPIDSlb strMaxSlb :" + strMaxSlb);
        String strProductSabFreeOrDiscount = "";

        Cursor cursor2 = db.rawQuery(
                "SELECT FreeProductID FROM tblSchemeDetails where SchemeID = '" + strSchemeID
                        + "' LIMIT 1", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    if (strProductSabFreeOrDiscount == "") {
                        strProductSabFreeOrDiscount = cursor2
                                .getString(LoncolumnIndex);
                    }

                    ////// System.out.println("Discount Abhinav = "+ strProductSabFreeOrDiscount);
                    cursor2.moveToNext();
                    // cursor.close();
                }

                strProductSabFreeOrDiscount = strProductSabFreeOrDiscount;

            }

        } finally {
            cursor2.close();
        }

        return strProductSabFreeOrDiscount;
    }

    public static String fnGetSchemeIDOnProductIDIdBasis(String strProductId) {
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        String strSchemeIDFreeProductId = "";
        Cursor cursor2 = db.rawQuery(
                "SELECT SchemeID FROM tblschemeProductMap where ProductID='"
                        + strProductId + "' and SchemeType<=3", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {

                    strSchemeIDFreeProductId = cursor2
                            .getString(LoncolumnIndex);
                    //+ "_"
                    //+ cursor2.getString(LoncolumnIndex1);
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strSchemeIDFreeProductId;
        } finally {
            cursor2.close();
        }
    }

    public static String fnCheckIfSchemeApplicableOnProduct(String strProductId) {
        int LoncolumnIndex = 0;
        String strSchemeID = "";
        Cursor cursor2 = db.rawQuery(
                "SELECT SchemeID FROM tblschemeProductMap where ProductID= '"
                        + strProductId + "'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strSchemeID = cursor2.getString(LoncolumnIndex);
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strSchemeID;
        } finally {
            cursor2.close();
        }
    }

    public static String[] fnGetOtherSchemeIdBasedOnFreeProductId(
            String strFreeProductID) {

        // id = getAllEntries();

        int ScodecolumnIndex = 0;


        Cursor cursor = db
                .rawQuery(
                        "SELECT DISTINCT  SchemeID AS SchemeID FROM tblSchemeDetails  where FreeProductID='"
                                + strFreeProductID + "'", null);
        try {
            String ProductComboSchemeIds[] = new String[cursor.getCount()];
            ;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    ProductComboSchemeIds[i] = (String) cursor.getString(
                            ScodecolumnIndex).toString();
                    cursor.moveToNext();
                    //// System.out.println("fnGetOtherSchemeIdBasedOnFreeProductId : Scheme ID  that Returns"+ ProductComboSchemeIds[i].trim());
                }
            }
            return ProductComboSchemeIds;
        } finally {
            cursor.close();
        }
    }

    public static long saveStoreTransac(String IMEIno, String TransDate,
                                 String StoreID, String ProdID, int Stock, int OrderQty,
                                 Double OrderVal, int FreeQty, Double DisVal,
                                 String AppliedSchemeID, String AppliedSlab, String AppliedAbsVal,
                                 int selProdIDForSampleQty, String ProductShortName, Double ProductRate,String CatID ) {//String DisplayUnit

        String activeRid;
        activeRid = GetActiveRouteID();


        ContentValues initialValues = new ContentValues();

        initialValues.put("IMEIno", IMEIno.trim());
        initialValues.put("TransDate", TransDate.trim());
        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("ProdID", ProdID.trim());
        initialValues.put("Stock", Stock);
        initialValues.put("OrderQty", OrderQty);
        initialValues.put("OrderVal", OrderVal);
        initialValues.put("FreeQty", FreeQty);
        initialValues.put("DisVal", DisVal);

        initialValues.put("Sstat", 0);
        initialValues.put("SchemeID", AppliedSchemeID);
        initialValues.put("AppliedSlab", AppliedSlab);
        initialValues.put("AppliedAbsVal", AppliedAbsVal);
        initialValues.put("SampleQuantity", selProdIDForSampleQty);

        initialValues.put("ProductShortName", ProductShortName);

        initialValues.put("ProductPrice", ProductRate);
        initialValues.put("RouteID", Integer.parseInt(activeRid));
        initialValues.put("CatID", CatID.trim());

        //initialValues.put(Key_DisplayUnit, DisplayUnit);

        ////// System.out.println("inserting saveStoreTransac records..");

        return db.insert(DATABASE_TABLE_MAIN31, null, initialValues);
    }
    //tblTransac (IMEIno text not null, TransDate string not null, StoreID text not null, ProdID text not null,
    //Stock integer not null, OrderQty integer not null, OrderVal real not null, FreeQty integer not null,
    //DisVal real not null, SchemeID text null, AppliedSlab text null, AppliedAbsVal text null, Sstat integer not null,
    //SampleQuantity int null, ProductShortName text null, ProductPrice real null);";//, DisplayUnit text null

    public static long saveStoreInvoice(String IMEIno, String StoreID,String InvoiceDate, Double TotalBeforeTaxDis, Double TaxAmt,
                                 Double TotalDis, Double InvoiceVal, int FreeTotal,
                                 Double InvAfterDis, Double AddDis, Double AmtPrevDue,
                                 Double AmtColl, Double AmtOut, int NoOfCouponValue, Double TotalCoupunAmount,int Outstat,String OrderIDPDA,String TmpInvoiceCodePDA,String strFinalAllotedInvoiceIds)// , Double CreditAmt, Double
    // InvoiceAfterCreditAmt, Double
    // valInvoiceOrginal)
    {

        String activeRid;
        activeRid = GetActiveRouteID();




        ContentValues initialValues = new ContentValues();

        initialValues.put("IMEIno", IMEIno.trim());
        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("InvoiceDate", InvoiceDate.trim());
        initialValues.put("TotalBeforeTaxDis", TotalBeforeTaxDis);
        initialValues.put("TaxAmt", TaxAmt);
        initialValues.put("TotalDis", TotalDis);
        initialValues.put("InvoiceVal", InvoiceVal);
        initialValues.put("FreeTotal", FreeTotal);
        initialValues.put("InvAfterDis", InvAfterDis);
        initialValues.put("AddDis", AddDis);
        initialValues.put("Sstat", Outstat);

        initialValues.put("AmtPrevDue", AmtPrevDue);
        initialValues.put("AmtColl", AmtColl);
        initialValues.put("AmtOut", AmtOut);

        initialValues.put("NoCoupon", NoOfCouponValue);
        initialValues.put("TotalCoupunAmount", TotalCoupunAmount);
        initialValues.put("RouteID", Integer.parseInt(activeRid));
        initialValues.put("OrderIDPDA", OrderIDPDA);
        initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
        initialValues.put("FinalAllotedInvoiceIds", strFinalAllotedInvoiceIds);
        /*
         * initialValues.put(KEY_OrderCreditAmt, 0.00);
         * initialValues.put(KEY_OrderInvoiceAfterCreditAmt, 0.00);
         * initialValues.put(KEY_OrderInvoiceOriginal, 0.00);
         */

        ////// System.out.println("inserting saveStoreInvoice records..");

        return db.insert(DATABASE_TABLE_MAIN32, null, initialValues);
    }

    // table tblTmpInvoiceHeader (IMEIno text not null, StoreID text not null, InvoiceDate string not null, TotalBeforeTaxDis real not null, TaxAmt real not null,
    //TotalDis real not null, InvoiceVal real not null, FreeTotal integer not null, Sstat integer not null, InvAfterDis real not null, AddDis real not null,
    //AmtPrevDue real null, AmtColl real null, AmtOut real null, NoCoupon int null, TotalCoupunAmount real null);";

    public static void deleteOldStoreTransac(String sID2del) {
        // int entryCount;
        db.execSQL("DELETE FROM tblTransac WHERE StoreID ='" + sID2del + "'");


    }

    public static void deleteOldStoreInvoice(String sID2del,String OrderIDPDA,String TmpInvoiceCodePDA) {
        // int entryCount;
        //open();
        db.execSQL("DELETE FROM tblTmpInvoiceHeader WHERE StoreID ='" + sID2del + "'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'");//and OrderIDPDA='"+OrderIDPDA+"'
        //close();
        // Cursor cursorE2 =


    }

    public static long fninsertSchemeCouponSlab(int SchemeID,int CardSlabID,int Slab,int Qtny, int ProductValueOrSlabBased)
    {

        ContentValues initialValues = new ContentValues();


        initialValues.put("SchID", SchemeID);
        initialValues.put("cardStrachID", CardSlabID);
        initialValues.put("Slab", Slab);
        initialValues.put("Qty", Qtny);
        initialValues.put("ProductValueOrSlabBased", ProductValueOrSlabBased);
        ////// System.out.println("inserting records..");

        return db.insert(DATABASE_TABLE_MAIN82, null, initialValues);
    }

    //tblStrachOnSchemeDetails (SchID int null, cardStrachID int null, Slab int Null, Qty int null, ProductValueOrSlabBased int null);";

    public static long fninsertSchemeCoupon(int SchemeID,int IsCouponApplicable)
    {

        ContentValues initialValues = new ContentValues();


        initialValues.put("SchID", SchemeID);
        initialValues.put("IsCouponApplicable", IsCouponApplicable);
        ////// System.out.println("inserting records..");

        return db.insert(DATABASE_TABLE_MAIN81, null, initialValues);
    }

    // tblStrachApplicableOnScheme (SchID int null, flgIsStrachApplicable int null);";

    public static long SavetblSyncSummuryForProductDetails(String SkuName, String OrderQty, String FreeQty, String SampleQty,
                                                    String TotalOrderKgs, String TotalFreeKgs, String TotalSampleKgs, String TotalSales,int Lines)
    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("SkuName", SkuName.trim());
        initialValues.put("OrderQty", OrderQty.trim());
        initialValues.put("FreeQty", FreeQty.trim());
        initialValues.put("SampleQty", SampleQty.trim());
        initialValues.put("TotalOrderKgs", TotalOrderKgs.trim());
        initialValues.put("TotalFreeKgs", TotalFreeKgs.trim());
        initialValues.put("TotalSampleKgs", TotalSampleKgs.trim());
        initialValues.put("TotalSales", TotalSales.trim());
        initialValues.put("Lines", Lines);




        ////// System.out.println("inserting records..");

        return db.insert(DATABASE_TABLE_MAIN72, null, initialValues);
    }


    //tblSyncSummuryForProductDetails (SkuName text null,OrderQty text null, FreeQty text null, SampleQty text null, TotalOrderKgs text null,
    //TotalFreeKgs text null, TotalSampleKgs text null, TotalSales text null);";

    public static long SavetblSyncSummuryDetails(String ActualCalls, String ProductiveCalls, String TotSalesValue, String TotKGSales,
                                          String TotFreeQtyKGSales, String TotSampleKGSales, String TotLTSales,
                                          String TotFreeQtyLTSales, String TotSampleLTSales, String TotDiscountKGSales, String TotDiscountLTales,int Lines)
    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("ActualCalls", ActualCalls.trim());
        initialValues.put("ProductiveCalls", ProductiveCalls.trim());
        initialValues.put("TotSalesValue", TotSalesValue.trim());
        initialValues.put("TotKGSales", TotKGSales.trim());
        initialValues.put("TotFreeQtyKGSales", TotFreeQtyKGSales.trim());
        initialValues.put("TotSampleKGSales", TotSampleKGSales.trim());
        initialValues.put("TotLTSales", TotLTSales.trim());
        initialValues.put("TotFreeQtyLTSales", TotFreeQtyLTSales.trim());
        initialValues.put("TotSampleLTSales", TotSampleLTSales.trim());
        initialValues.put("TotDiscountKGSales", TotDiscountKGSales.trim());
        initialValues.put("TotDiscountLTales", TotDiscountLTales.trim());
        initialValues.put("Lines", Lines);



        ////// System.out.println("inserting records..");

        return db.insert(DATABASE_TABLE_MAIN71, null, initialValues);
    }

    // tblSyncSummuryDetails (ActualCalls int null,ProductiveCalls int null, TotSalesValue text null, TotKGSales text null, TotFreeQtyKGSales text null,
    //TotSampleKGSales text null, TotLTSales text null, TotFreeQtyLTSales text null, TotSampleLTSales text null, TotDiscountKGSales text null, TotDiscountLTales text null);";

    public static long SavePDAIsSchemeApplicable(int IsSchemeApplicable) {
        ContentValues initialValues = new ContentValues();
        initialValues.put("IsSchemeApplicable",IsSchemeApplicable);


        ////// System.out.println("inserting records..");

        return db.insert(DATABASE_TABLE_MAIN56, null, initialValues);
    }

    //tblPDAIsSchemeApplicable (IsSchemeApplicable int null);";

    public static long saveStoreTypeDetails(String SidType, String SidDesc) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("ID", SidType.trim());
        initialValues.put("Descr", SidDesc.trim());

        ////// System.out.println("inserting records..");

        return db.insert(DATABASE_TABLE_MAIN63, null, initialValues);
    }

    //private static final String DATABASE_CREATE_TABLE_63 = "create table tblStorTypeMstr(ID string null, Descr string null);";

    public static long saveSOAPdataPdaSchAppListForSecondPage(String SchemeID,
                                                       String StoreType, String SchemeDesc,int flgSpecialScheme) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("SchemeID", SchemeID.trim());
        initialValues.put("StoreType", StoreType.trim());
        initialValues.put("SchemeDesc", SchemeDesc.trim());
        initialValues.put("flgSpecialScheme", flgSpecialScheme);

        ////// System.out.println("inserting records..");

        return db.insert(DATABASE_TABLE_MAIN55, null, initialValues);
    }

    //tblspForPDASchemeApplicableList(SchemeID string null, StoreType string null, SchemeDesc string null);";

    public static long saveSOAPdataPdaLastTranDateForSecondPage(String StoreID,
                                                         String LastTransDate, String RetailerName, String SKUName,
                                                         String Stock, String OrderQty, String FreeQty) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("LastTransDate", LastTransDate.trim());
        initialValues.put("RetailerName", RetailerName.trim());
        initialValues.put("SKUName", SKUName.trim());
        initialValues.put("Stock", Stock.trim());
        initialValues.put("OrderQty", OrderQty.trim());
        initialValues.put("FreeQty", FreeQty.trim());
        ////// System.out.println("inserting records..");

        return db.insert(DATABASE_TABLE_MAIN62, null, initialValues);
    }


    //tblPDALastTranDateForSecondPage(StoreID text null, LastTransDate string null, RetailerName string null, SKUName string null, Stock string null, OrderQty string null, FreeQty string null);";

    public static long saveSOAPdataschemeProductMap(String InSchemeID,
                                             String InProductID, int strSchemeType) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("SchemeID", InSchemeID.toString().trim());
        initialValues.put("ProductID", InProductID.toString().trim());
        initialValues.put("SchemeType", strSchemeType);


        ////// System.out.println("inserting records..");

        return db.insert(DATABASE_TABLE_MAIN54, null, initialValues);
    }


    //tblschemeProductMap (SchemeID text not null, ProductID text not null, SchemeType int null);";

    public static long saveSOAPdataSchemeSchemeStoreTypeMap(String InSchemeID,
                                                     int InStoreTypeID) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("SchemeID", InSchemeID.toString().trim());
        initialValues.put("StoreTypeID", InStoreTypeID);

        ////// System.out.println("inserting records..");

        return db.insert(DATABASE_TABLE_MAIN53, null, initialValues);
    }


    //tblschemeStoreTypeMap (SchemeID text not null, StoreTypeID integer not null);";

    public static long saveSOAPdataLastTransactionDetails(String ltdetSCode,
                                                   String ltdetProdCode, String ltdetLTdate, int ltdetQTY,
                                                   int pSampleQty,int CategoryID) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("StoreID", ltdetSCode.trim());
        initialValues.put("ProductID", ltdetProdCode.trim());
        initialValues.put("LastTransDate", ltdetLTdate.trim());
        initialValues.put("Quantity", ltdetQTY);
        initialValues.put("SampleQuantity", pSampleQty);
        initialValues.put("CategoryID", CategoryID);

        ////// System.out.println("inserting records..");

        return db.insert(DATABASE_TABLE_MAIN61, null, initialValues);
    }


    //tblLastTransactionDetails (StoreID text not null, ProductID text not null, LastTransDate string not null, Quantity integer not null, SampleQuantity int null);";

    public static long saveSOAPdataSchemeDetails(String schdetDetCode,
                                          String schdetCode, int schdetSF, int schdetST, int schdetFQ,
                                          Double schdetDIS, String NewFreePrdID) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("SchemeDetID", schdetDetCode.trim());
        initialValues.put("SchemeID", schdetCode.trim());
        initialValues.put("SlabFrom", schdetSF);
        initialValues.put("SlabTo", schdetST);
        initialValues.put("FreeQuantity", schdetFQ);
        initialValues.put("Discount", schdetDIS);
        initialValues.put("FreeProductID", NewFreePrdID.toString().trim());

        ////// System.out.println("inserting records..");

        return db.insert(DATABASE_TABLE_MAIN52, null, initialValues);
    }


//tblSchemeDetails (SchemeDetID text not null, SchemeID text not null, SlabFrom integer not null, SlabTo integer not null, FreeQuantity integer not null,
    //Discount real not null, FreeProductID text null);";

    public static long saveSOAPdataSchemeList(String schCode, String schName,
                                       String schType, String SchListStoreType, int inCombTypeID,int flgDiscountType) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("SchemeID", schCode.trim());
        initialValues.put("SchemeName", schName.trim());
        initialValues.put("SchemeType", schType.trim());
        initialValues.put("StoreType", SchListStoreType.trim());
        initialValues.put("CombTypeID", inCombTypeID);
        initialValues.put("flgDiscountType", flgDiscountType);

        ////// System.out.println("inserting records..");

        return db.insert(DATABASE_TABLE_MAIN51, null, initialValues);
    }

    // tblSchemeList (SchemeID text not null, SchemeName string not null, SchemeType string not null, StoreType string null, CombTypeID integer null);";

    public static long saveSOAPdataStoreProductMap(String StoreID,String ProductID,
                                            Double ProductMRP, Double ProductRLP, Double ProductTaxAmount, Double DistributorPrice,int CategoryID)
    {
        ContentValues initialValues = new ContentValues();


		/*StoreID text  null,ProductID text  null, ProductMRP real  null, ProductRLP real  null,
		ProductTaxAmount real  null, KGLiter text null);";
*/

        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("ProductID", ProductID.trim());
        //initialValues.put(KEY_ProductShortName, ProductShortName.trim());
        initialValues.put("ProductMRP", ProductMRP);
        initialValues.put("ProductRLP", ProductRLP);
        initialValues.put("ProductTaxAmount", ProductTaxAmount);
        initialValues.put("DistributorPrice", DistributorPrice);
        initialValues.put("DistributorPrice", DistributorPrice);
        initialValues.put("CategoryID", CategoryID);


        ////// System.out.println("inserting records in ProductList..");

        return db.insert(DATABASE_TABLE_MAINStoreProductMap, null, initialValues);

    }

    //(StoreID text  null,ProductID text  null, ProductMRP real  null, ProductRLP real  null, ProductTaxAmount real  null, DistributorPrice real null);";

    public static long SavePDATargetQtyForSecondPage(
            String PDATargetQtyForSecondPageStoreID,
            String PDATargetQtyForSecondPageProductID,
            String PDATargetQtyForSecondPageSKUShortName,
            String PDATargetQtyForSecondPageTargetQty) {
        ContentValues initialValues = new ContentValues();
        initialValues.put("StoreID",
                PDATargetQtyForSecondPageStoreID.trim());
        initialValues.put("ProductID",
                PDATargetQtyForSecondPageProductID.trim());
        initialValues.put("SKUShortName",
                PDATargetQtyForSecondPageSKUShortName.trim());
        initialValues.put("TargetQty",
                PDATargetQtyForSecondPageTargetQty.trim());

        ////// System.out.println("inserting records..");

        return db.insert(DATABASE_TABLE_MAIN18, null, initialValues);
    }

// tblPDATargetQtyForSecondPage (StoreID text null, ProductID text null, SKUShortName text not null, TargetQty text null);";

    public static long SavePDALastInvoiceDet(String SID, String invID, String LTDate,
                                      String BalAmt, Double CreditPreviousDue) {
        ContentValues initialValues = new ContentValues();
        initialValues.put("StoreID", SID.trim());
        initialValues.put("InvoiceID", invID.trim());
        initialValues.put("LastTransDate", LTDate.trim());
        initialValues.put("BalanceAmount", BalAmt.trim());
        initialValues.put("CreditPreviousDue", CreditPreviousDue);

        ////// System.out.println("inserting records..");

        return db.insert(DATABASE_TABLE_MAIN17, null, initialValues);
    }

// tblPDALastInvoiceDet (StoreID text null, InvoiceID text null, LastTransDate text not null,
    //BalanceAmount text null,CreditPreviousDue real null);";

    //tblPDALastInvoiceDet (StoreID text null, InvoiceID text null, LastTransDate text not null,
    //BalanceAmount text null,CreditPreviousDue real null);";

    // start Table 10
    public static long saveVisibilityDetails(String storeID,String VisibilityID, String VisibilityStock,int Sstat)
    {

        ContentValues initialValues = new ContentValues();
        initialValues.put("storeID", storeID.trim());
        initialValues.put("VisibilityID", VisibilityID.trim());
        initialValues.put("VisibilityStock", VisibilityStock.trim());
        initialValues.put("Sstat", Sstat);

        ////// System.out.println("inserting records in table 10..");

        return db.insert(DATABASE_TABLE_MAIN10, null, initialValues);
    }

    public static void deleteVisibilityDetails(String StoreID) {
        // int entryCount;
        db.execSQL("DELETE FROM tblVisibilityDetails WHERE StoreID ='" + StoreID + "'");

    }

    public static int FetchVisibilityDetailsAvailable(String StoreID)
    {
        int columnIndex = 0;
        int columnIndex1 = 1;
        int check=0;

        Cursor cursor = db.rawQuery("SELECT VisibilityID,VisibilityStock FROM tblVisibilityDetails WHERE StoreID ='"+ StoreID  + "'", null);
        try
        {

            String OrderDetails[] = new String[cursor.getCount()];

            if (cursor.moveToFirst())
            {

                check=1;
                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    OrderDetails[i] = (String) cursor.getString(columnIndex).toString()+ "_"+ (String) cursor.getString(columnIndex1).toString();
                    cursor.moveToNext();

                }

            }
            return check;
        }
        finally
        {
            cursor.close();
        }

    }

    public static String[] FetchVisibilityDetails(String StoreID)
    {
        int columnIndex = 0;
        int columnIndex1 = 1;

        Cursor cursor = db.rawQuery("SELECT VisibilityID,VisibilityStock FROM tblVisibilityDetails WHERE StoreID ='"+ StoreID  + "'", null);
        try
        {

            String OrderDetails[] = new String[cursor.getCount()];

            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    OrderDetails[i] = (String) cursor.getString(columnIndex).toString()+ "_"+ (String) cursor.getString(columnIndex1).toString();
                    cursor.moveToNext();

                }

            }
            return OrderDetails;
        }
        finally
        {
            cursor.close();
        }

    }

    // start Table 9
    public static long saveVisibility(String VisibilityID, String VisibilityDescr)
    {

        ContentValues initialValues = new ContentValues();
        initialValues.put("VisibilityID", VisibilityID.trim());
        initialValues.put("VisibilityDescr", VisibilityDescr.trim());

        ////// System.out.println("inserting records in table 9..");

        return db.insert(DATABASE_TABLE_MAIN9, null, initialValues);
    }


    // end Table 10

    public static String[] FetchVisibilityDescr()
    {
        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT VisibilityDescr FROM tblVisibilityMstr",null);
        try
        {
            String VisibilityDescr[] = new String[cursor.getCount()];

            if (cursor.moveToFirst())
            {
                ////// System.out.println("CompetitionName Sunil Available");
                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    VisibilityDescr[i] = (String) cursor.getString(ScodecolumnIndex);
                    cursor.moveToNext();
                }
            }
            ////// System.out.println("CompetitionName Sunil: not");
            return VisibilityDescr;
        }
        finally
        {
            cursor.close();
        }
    }

    public static String FetchRouteType(String ID)
    {
        int ScodecolumnIndex = 0;
        String RouteType ="0";
		/* private static final String DATABASE_CREATE_TABLE_2 = "create table " +
		 		"tblRouteListMaster(ID string null,RouteType text null, Descr string null, Active integer null," +
		 		"flgTodayRoute integer null,RouteDate string null);";*/
        Cursor cursor = null;
        try
        {
            cursor = db.rawQuery("SELECT RouteType FROM tblRouteListMaster  WHERE ID='"+ ID +"' Limit 1",null);



            if (cursor.moveToFirst())
            {
                for (int i = 0; i < cursor.getCount(); i++)
                {
                    RouteType = (String) cursor.getString(ScodecolumnIndex);
                    cursor.moveToNext();
                }
            }

            return RouteType;
        }
        finally
        {
            cursor.close();


        }
    }

    public static String[] FetchVisibilityID()
    {
        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT VisibilityID FROM tblVisibilityMstr",null);
        try
        {
            String VisibilityID[] = new String[cursor.getCount()];

            if (cursor.moveToFirst())
            {
                ////// System.out.println("CompetitionID Sunil Available");
                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    VisibilityID[i] = (String) cursor.getString(ScodecolumnIndex);
                    cursor.moveToNext();
                }
            }
            ////// System.out.println("CompetitionID Sunil: not");
            return VisibilityID;
        }
        finally
        {
            cursor.close();
        }
    }

    public static String FetchStoreName(String storeID)
    {

        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT StoreName FROM tblStoreList WHERE StoreID ='"+ storeID + "'", null);
        try
        {

            String StoreName="NA";

            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    StoreName = (String) cursor.getString(ScodecolumnIndex).toString();
                    cursor.moveToNext();

                }

            }
            return StoreName;
        }
        finally
        {
            cursor.close();
        }



    }

    public static int fnGetDisType(String schID,String schType) {
        // int entryCount;
        Cursor cursorE2 = db.rawQuery(
                "SELECT flgDiscountType FROM tblSchemeList WHERE SchemeID ='" + schID + "' and SchemeType='" + schType + "'", null);
        int flgDiscountType = 0;
        try {
            if (cursorE2.moveToFirst()) {

                flgDiscountType=Integer.parseInt(cursorE2.getString(0).toString());
            }

        } finally {
            cursorE2.close();
        }
        return flgDiscountType;
    }
    //public static String[] FetchRate(String CatID)
	/*public static String[] FetchRate()
	{

		// id = getAllEntries();

		int ScodecolumnIndex = 0;
		//////// System.out.println("Fetching StoreID :" + ssStoreID);
		//Cursor cursor = db.rawQuery("SELECT ProductRLP FROM tblProductListMaster where CategoryID='"+CatID+"'", null);
		Cursor cursor = db.rawQuery("SELECT ProductRLP FROM tblProductListMaster where CategoryID='"+CatID+"'", null);
		try {
			////// System.out.println("Fetching cursor.getCount() :" + cursor.getCount());
			String StoreName[] = new String[cursor.getCount()];
			;
			if (cursor.moveToFirst()) {

				for (int i = 0; i <= (cursor.getCount() - 1); i++) {
					StoreName[i] = ""+(Double) cursor.getDouble(ScodecolumnIndex);
					//////// System.out.println("DB-ADAP: PROD RLP: "
					//		+ (String) cursor.getString(ScodecolumnIndex)
					//				.toString());
					////// System.out.println("Fetching Rate :" + StoreName[i]);
					cursor.moveToNext();
				}
			}
			return StoreName;
		} finally {
			cursor.close();
		}
	}*/


	/*public static Double[] FetchProductTax(String SID)
	{
		int ScodecolumnIndex = 0;

		Cursor cursor = db.rawQuery("SELECT ProductTaxAmount FROM tblProductListMaster where StoreID='"+SID+"'",null);
		try
		{
			Double TaxRate[] = new Double[cursor.getCount()];

			if (cursor.moveToFirst())
			{
				for (int i = 0; i <= (cursor.getCount() - 1); i++)
				{
					TaxRate[i] = (Double) cursor.getDouble(ScodecolumnIndex);
					//////// System.out.println("Tax Rate Sunil: "+ String.valueOf(cursor.getString(ScodecolumnIndex).toString()));
                    cursor.moveToNext();
				}
			}
			////// System.out.println("Tax Rate Sunil: not");
		return TaxRate;
		}
		finally
		{
			cursor.close();
		}
	}*/

    public static int countIfStoreTransacExists(String sID2del) {
        // int entryCount;
        Cursor cursorE2 = db.rawQuery(
                "SELECT COUNT(*) FROM tblTransac WHERE StoreID ='" + sID2del
                        + "'", null);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    public static String[] FetchOrderTransactionDetails(String IMEIno,String StoreID)
    {
        int columnIndex = 0;
        int columnIndex1 = 1;
        int columnIndex2 = 2;


        Cursor cursor = db.rawQuery("SELECT ProdID,OrderQty, OrderVal FROM tblTransac WHERE StoreID ='"+ StoreID + "' and IMEIno ='"+ IMEIno + "'", null);
        try
        {

            String OrderDetails[] = new String[cursor.getCount()];

            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    ////// System.out.println("CURSOR_FETCH: " + i);

                    OrderDetails[i] = (String) cursor.getString(columnIndex).toString()+ "_"+ (String) cursor.getString(columnIndex1).toString()+"_"+ (String) cursor.getString(columnIndex2).toString();
                    ////// System.out.println("Product Id: "+ String.valueOf(cursor.getString(columnIndex).toString())+"Total OrdQty: "+ String.valueOf(cursor.getString(columnIndex1).toString())+ " Total OrdVal: "+ String.valueOf(cursor.getString(columnIndex2).toString()));

                    cursor.moveToNext();
                    // cursor.close();

                }

            }
            return OrderDetails;
        }
        finally
        {
            cursor.close();
        }

    }

	/*public static String FetchProductName(String ProductID)
	{

        int ScodecolumnIndex = 0;

		Cursor cursor = db.rawQuery("SELECT ProductShortName FROM tblProductListMaster WHERE ProductID ='"+ ProductID + "'", null);
		try
		{

			String StoreName="NA";

			if (cursor.moveToFirst())
			{

				for (int i = 0; i <= (cursor.getCount() - 1); i++)
				{
					StoreName = (String) cursor.getString(ScodecolumnIndex).toString();


					////// System.out.println("fetch Product Name "+StoreName);
					cursor.moveToNext();

				}

			}
			////// System.out.println("fetch Product Name Not "+StoreName);
			return StoreName;
		}
		finally
		{
			cursor.close();
		}



	}*/

    public static String[] FetchOrderInvoiceDetails(String IMEIno,String StoreID)
    {
        int columnIndex = 0;
        int columnIndex1 = 1;
        int columnIndex2 = 2;
        int columnIndex3 = 3;
        int columnIndex4 = 4;
        //int columnIndex5 = 5;

        Cursor cursor = db.rawQuery("SELECT InvoiceVal,TaxAmt,GrossVal, AmtColl,AmtOut FROM tblTmpInvoiceHeader WHERE StoreID ='"+ StoreID + "' and IMEIno ='"+ IMEIno + "'", null);
        try
        {

            String InvoiceDetails[] = new String[cursor.getCount()];

            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    ////// System.out.println("CURSOR_FETCH: " + i);

                    InvoiceDetails[i] = (String) cursor.getString(columnIndex).toString()+ "_"+ (String) cursor.getString(columnIndex1).toString()+"_"+ (String) cursor.getString(columnIndex2).toString()+"_"+ (String) cursor.getString(columnIndex3).toString()+"_"+ (String) cursor.getString(columnIndex4).toString();
                    ////// System.out.println("Invoice Value: "+ String.valueOf(cursor.getString(columnIndex).toString())+"TaxAmount: "+ String.valueOf(cursor.getString(columnIndex1).toString())+ " Gross Invoce Value: "+ String.valueOf(cursor.getString(columnIndex2).toString())+"Amount Collected: "+ String.valueOf(cursor.getString(columnIndex3).toString())+"Amount OutStanding:  "+ String.valueOf(cursor.getString(columnIndex4).toString()));

                    cursor.moveToNext();
                    // cursor.close();

                }

            }
            return InvoiceDetails;
        }
        finally
        {
            cursor.close();
        }

    }

    public static void deleteOrderTransactionDetails(String storeID) {
        // int entryCount;
        db.execSQL("DELETE FROM tblTransac WHERE StoreID='"+ storeID +"'");

    }

    public static void deleteOrderInvoiceDetails(String storeID) {
        // int entryCount;
        db.execSQL("DELETE FROM tblTmpInvoiceHeader WHERE StoreID='"+ storeID +"'");

    }

    public static long saveOrderTransactionDetails(String IMEIno, String TransDate,String StoreID,String ProdID,
                                            int OrderQty ,Double OrderVal,Double ProductMRP,Double TaxRate)
    {

        ContentValues initialValues = new ContentValues();
        initialValues.put("IMEIno", IMEIno.trim());
        initialValues.put("TransDate", TransDate.trim());
        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("ProdID", ProdID.trim());
        initialValues.put("OrderQty", OrderQty);
        initialValues.put("OrderVal", OrderVal);
        initialValues.put("Sstat", 0);
        initialValues.put("ProductMRP", ProductMRP);
        initialValues.put("TaxRate", TaxRate);

        ////// System.out.println("inserting records..");

        return db.insert(DATABASE_TABLE_MAIN31, null, initialValues);
    }

    public static long saveOrderInvoiceDetails(String IMEIno,String StoreID, String InvoiceDate,Double TaxAmt,
                                        Double InvoiceVal,int Sstat,Double AmtColl,Double AmtOut,Double GrossVal,String TmpInvoiceCodePDA)
    {

        ContentValues initialValues = new ContentValues();
        initialValues.put("IMEIno", IMEIno.trim());
        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("InvoiceDate", InvoiceDate.trim());
        initialValues.put("TaxAmt", TaxAmt);
        initialValues.put("InvoiceVal", InvoiceVal);
        initialValues.put("GrossVal", GrossVal);
        initialValues.put("Sstat", Sstat);
        initialValues.put("AmtColl", AmtColl);
        initialValues.put("AmtOut", AmtOut);
        initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);

        ////// System.out.println("inserting records in table 32..");

        return db.insert(DATABASE_TABLE_MAIN32, null, initialValues);
    }


    public static String[] FetchCategoryDesc()
    {
        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT CategoryDescr FROM tblCategoryMaster",null);
        try
        {
            String TaxRate[] = new String[cursor.getCount()];

            if (cursor.moveToFirst())
            {
                ////// System.out.println("Category Sunil Available");
                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    TaxRate[i] = (String) cursor.getString(ScodecolumnIndex);
                    cursor.moveToNext();
                }
            }
            ////// System.out.println("Category Sunil: not");
            return TaxRate;
        }
        finally
        {
            cursor.close();
        }
    }

	/*public static long saveCategoryProductINformation(String CompetitionID,String ProductID,String Stock,int Sstat,String storeID )
	{

		ContentValues initialValues = new ContentValues();
		initialValues.put("CategoryID", CompetitionID.trim());
		//initialValues.put("CategoryID", CategoryID.trim());
		initialValues.put("Sstat", Sstat);
		initialValues.put("ProductID", ProductID.trim());
		initialValues.put("Stock", Stock.trim());
		initialValues.put("storeID", storeID.trim());



		////// System.out.println("inserting records in table 38..");

		return db.insert(DATABASE_TABLE_MAIN5, null, initialValues);
	}*/

	/*public static String[] FetchCategoryProductID(String CategoryID)
	{
        int columnIndex = 0;
        //int columnIndex1 = 1;

        Cursor cursor = db.rawQuery("SELECT ProductID FROM tblProductListMaster WHERE CategoryID ='"+ CategoryID  + "'", null);
		try
		{

			String OrderDetails[] = new String[cursor.getCount()];

			if (cursor.moveToFirst())
			{

				for (int i = 0; i <= (cursor.getCount() - 1); i++)
				{
					OrderDetails[i] = (String) cursor.getString(columnIndex).toString();
					cursor.moveToNext();
					// cursor.close();

				}

			}
			return OrderDetails;
		}
		finally
		{
			cursor.close();
		}

	}
	*/
	/*public static String[] FetchCatergoryProductDescription(String CompetitionID)
	{
        int columnIndex = 0;
        //int columnIndex1 = 1;

        Cursor cursor = db.rawQuery("SELECT ProductShortName FROM tblProductListMaster WHERE CategoryID ='"+ CompetitionID  + "'", null);
		try
		{

			String OrderDetails[] = new String[cursor.getCount()];

			if (cursor.moveToFirst())
			{

				for (int i = 0; i <= (cursor.getCount() - 1); i++)
				{
					OrderDetails[i] = (String) cursor.getString(columnIndex).toString();
					cursor.moveToNext();
					// cursor.close();

				}

			}
			return OrderDetails;
		}
		finally
		{
			cursor.close();
		}

	}*/

	/*public static String[] FetchCategoeyProductINformation(String CategoryID, String storeID)
	{
        int columnIndex = 0;
        int columnIndex1 = 1;

        Cursor cursor = db.rawQuery("SELECT ProductID,Stock FROM tblCategoryQuestionInformation WHERE CategoryID ='"+ CategoryID  + "' and StoreID='"+ storeID +"'", null);
		try
		{

			String OrderDetails[] = new String[cursor.getCount()];

			if (cursor.moveToFirst())
			{

				for (int i = 0; i <= (cursor.getCount() - 1); i++)
				{
					OrderDetails[i] = (String) cursor.getString(columnIndex).toString()+ "_"+ (String) cursor.getString(columnIndex1).toString();
					cursor.moveToNext();

				}

			}
			return OrderDetails;
		}
		finally
		{
			cursor.close();
		}

	}*/

    public static String[] FetchCategoryID()
    {
        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT CategoryID FROM tblCategoryMaster",null);
        try
        {
            String TaxRate[] = new String[cursor.getCount()];

            if (cursor.moveToFirst())
            {
                ////// System.out.println("CategoryID Sunil Available");
                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    TaxRate[i] = (String) cursor.getString(ScodecolumnIndex);
                    cursor.moveToNext();
                }
            }
            ////// System.out.println("CategoryID Sunil: not");
            return TaxRate;
        }
        finally
        {
            cursor.close();
        }
    }

    //tblProductListMaster (CategoryID text  null,ProductID text  null, ProductShortName text  null, DisplayUnit text null,
    //CalculateKilo real  null,ProductMRP real not null, ProductRLP real not null, ProductTaxAmount real not null,
    //KGLiter string nulll);";

	/*public static String[] FetchCategoryIDfromProduct()
	{
		int ScodecolumnIndex = 0;

		Cursor cursor = db.rawQuery("SELECT CategoryID FROM tblProductListMaster",null);
		try
		{
			String TaxRate[] = new String[cursor.getCount()];

			if (cursor.moveToFirst())
			{
				////// System.out.println("CategoryID Sunil Available");
				for (int i = 0; i <= (cursor.getCount() - 1); i++)
				{
					TaxRate[i] = (String) cursor.getString(ScodecolumnIndex);
					cursor.moveToNext();
				}
			}
			////// System.out.println("CategoryID Sunil: not");
		return TaxRate;
		}
		finally
		{
			cursor.close();
		}
	}*/

    public static boolean GetPrevDateChk() {

        Cursor cursorDateE = db.rawQuery("SELECT ForDate FROM tblStoreList",null);
        boolean ifApplicableToPassIntent=GetIfApplicableToForward();

        try {
            if (cursorDateE.getCount() > 0) {

                if(ifApplicableToPassIntent)
                {
                    return true;
                }
                else
                {
                    return false;
                }

            } else {
                return false;
            }

        } finally {
            cursorDateE.close();
        }

    }


    //public static String[] FetchPid(String CATID)
	/*public static String[] FetchPid()
	{
		int ScodecolumnIndex = 0;
		////// System.out.println("a");

		//Cursor cursor = db.rawQuery("SELECT ProductID FROM tblProductListMaster where CategoryID='"+CATID+"'",null);
		Cursor cursor = db.rawQuery("SELECT ProductID FROM tblProductListMaster",null);
		////// System.out.println("b");
		try
		{
			String StoreName[] = new String[cursor.getCount()];

			////// System.out.println("length of cursor count in DBAdapter1"+ cursor.getCount());
			////// System.out.println("c");
			if (cursor.moveToFirst())
			{
				////// System.out.println("d");
				for (int i = 0; i <= (cursor.getCount() - 1); i++)
				{
					////// System.out.println("e");
					StoreName[i] = (String) cursor.getString(ScodecolumnIndex).toString();

					////// System.out.println("Sunil ProductID FROM tblProductListMaster: "+ StoreName[i]);
					cursor.moveToNext();
				}
			}
		 ////// System.out.println("f");
		 return StoreName;
		}
		finally
		{
			cursor.close();
		}
	}
	*/

    //public static String[] FetchPName(String CATID)
	/*public static String[] FetchPName()
	{

		int ScodecolumnIndex = 0;

		//Cursor cursor = db.rawQuery("SELECT ProductShortName FROM tblProductListMaster where CategoryID='"+CATID+"'", null);
		Cursor cursor = db.rawQuery("SELECT ProductShortName FROM tblProductListMaster", null);
		try
		{
			String StoreName[] = new String[cursor.getCount()];
			if (cursor.moveToFirst())
			{

				for (int i = 0; i <= (cursor.getCount() - 1); i++)
				{
					StoreName[i] = (String) cursor.getString(ScodecolumnIndex)
							.toString();
					////// System.out.println("product short name :"+StoreName[i]);
					cursor.moveToNext();
				}
			}
		  return StoreName;
		}
		finally
		{
			cursor.close();
		}
	}
	*/

    /* public static boolean GetIfApplicableToForward() {

	  Cursor cursorDateE = db.rawQuery("SELECT IsSchemeApplicable FROM tblPDAIsSchemeApplicable",null);


	  try {
	   if (cursorDateE.getCount() > 0) {
	    // String date2Send = cursorDateE.getString(0);

	    ////// System.out.println("GetPrevDateChk - Records Count: "+ cursorDateE.getCount());
	    // ////// System.out.println("GetPrevDateChk - forDate: " +date2Send);
	    ////// System.out.println("returning GetPrevDateChk - true");
	    return true;
	   } else {
	    return false;
	   }

	  } finally {
	   cursorDateE.close();
	  }

	 }*/
    public static boolean GetIfApplicableToForward() {

        Cursor cursorDateE = db.rawQuery("SELECT IsSchemeApplicable FROM tblPDAIsSchemeApplicable",null);


        try {
            if (cursorDateE.getCount() > 0) {
                // String date2Send = cursorDateE.getString(0);

                ////// System.out.println("GetPrevDateChk - Records Count: "+ cursorDateE.getCount());
                // ////// System.out.println("GetPrevDateChk - forDate: " +date2Send);
                ////// System.out.println("returning GetPrevDateChk - true");
                return true;
            } else {
                //return false;
                return true;
            }

        } finally {
            cursorDateE.close();
        }

    }

    public static int CheckProductListPresentOrNot()
    {
        Cursor cursorE2 = null;
        int chkI = 0;

        try
        {
            //open();
            cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblProductListMaster", null);

            if (cursorE2.moveToFirst())
            {
                if (Integer.parseInt(cursorE2.getString(0)) > 0)
                {
                    chkI = 1;
                }
                else
                {
                    chkI = 0;
                }
            }

        }
        finally
        {
            if(cursorE2 != null)
            {
                cursorE2.close();
            }
            //close();
        }
        return chkI;
    }

    public static boolean PrevLocChk(String passedStoreID,String StoreVisitCode)
    {
        boolean abc = false;

        Cursor cursorLocE = db.rawQuery("SELECT ActualLatitude FROM tblStoreVisitMstr WHERE StoreID ='"+ passedStoreID + "' AND StoreVisitCode='"+StoreVisitCode+"'", null);

        ////// System.out.println("PrevLocChk - Checking for StoreID: "+ passedStoreID);
        try
        {
            if (cursorLocE.moveToFirst())
            {
                ////// System.out.println("cursorLocE count: " + cursorLocE.getCount());

                if ((cursorLocE.getString(0) == null) || (cursorLocE.getString(0).equals("0.0")) || (cursorLocE.getString(0).equals("0")))
                {
                    ////// System.out.println(" A 1 " + abc);
                    ////// System.out.println("PrevLocChk - Records Count: "+ cursorLocE.getCount());
                    ////// System.out.println("returning PrevLocChk - False");
                    abc = false;
                    ////// System.out.println(" A 2 " + abc);
                }
                else
                {
                    ////// System.out.println("returning PrevLocChk - True");
                    abc = true;
                    ////// System.out.println(" A 3 " + abc);
                }
            }

        }
        finally
        {
            cursorLocE.close();
        }
        return abc;
    }

    public static void UpdateStoreStartVisit(String StoreID, String strVisitStartTS)
    {




    }

    public static void UpdateStoreStoreClose(String StoreID, int StoreClose,String StoreVisitCode)
    {


        final ContentValues values = new ContentValues();
        values.put("StoreClose", StoreClose);

        int affected = db.update("tblStoreVisitMstr", values, "StoreID=? AND StoreVisitCode=?",new String[] { StoreID,StoreVisitCode });
     //   int affected1 = db.update("tblStoreList", values, "StoreID=?",new String[] { StoreID });
      // int affected21 = db.update("tblOutletQuestAnsMstr", values,"OutletID=?", new String[] { StoreID });

      //  int affected261 = db.update("tblNewAddedStoreLocationDetails", values,"StoreID=?", new String[] { StoreID });

    }

    public static void UpdateStoreSstat(String StoreID, int Sstat,String StoreVisitCode)
    {


        final ContentValues values = new ContentValues();
        values.put("Sstat", Sstat);

        int affected = db.update("tblStoreVisitMstr", values, "StoreID=? AND StoreVisitCode=?",new String[] { StoreID,StoreVisitCode });
        int affected22 = db.update("tblStoreOrderVisitDayActivity", values, "StoreID=? AND StoreVisitCode=?",new String[] { StoreID,StoreVisitCode });
        int affected1 = db.update("tblStoreList", values, "StoreID=?",new String[] { StoreID });
        int affected21 = db.update("tblOutletQuestAnsMstr", values,"OutletID=?", new String[] { StoreID });

        int affected261 = db.update("tblNewAddedStoreLocationDetails", values,"StoreID=?", new String[] { StoreID });

    }

    public static void deleteStoreTblsRecordsInCaseCancelOrderInOrderBooking(String StoreID,int flag,String pdaOrderID,String TmpInvoiceCodePDA)
    {
        db.execSQL("DELETE FROM tblTmpInvoiceDetails WHERE StoreID='"+ StoreID +"'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'");
        db.execSQL("DELETE FROM tblTmpInvoiceHeader WHERE StoreID='"+ StoreID +"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'");
        db.execSQL("DELETE FROM tblStoreProductAppliedSchemesBenifitsRecords WHERE StoreID='"+ StoreID +"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'");
        db.execSQL("DELETE FROM tblStoreReturnDetail WHERE StoreID='"+ StoreID +"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'");
        if(flag==1)
        {
            db.execSQL("DELETE FROM tblStoreProductPhotoDetail WHERE StoreID='"+ StoreID +"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'");
        }




    }

    public static void UpdateStoreStoreReturnDetail(String StoreID, String Sstat,String pdaOrderID,String TmpInvoiceCodePDA) {
        final ContentValues values = new ContentValues();
        values.put("Sstat", Sstat);
        int affected = db.update("tblStoreReturnDetail", values,"StoreID=?  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"' and Sstat is not null",new String[] { StoreID });
    }

    public static void UpdateStoreProductAppliedSchemesBenifitsRecords(String StoreID, String Sstat,String pdaOrderID,String TmpInvoiceCodePDA) {
        final ContentValues values = new ContentValues();
        values.put("Sstat", Sstat);
        int affected = db.update("tblStoreProductAppliedSchemesBenifitsRecords", values,"StoreID=? AND TmpInvoiceCodePDA=? and Sstat is not null",
                new String[] { StoreID,TmpInvoiceCodePDA });
    }

    public static void UpdateStoreEndVisit(String StoreID, String strVisitEndTS) {
      /*  final ContentValues values = new ContentValues();
        values.put("VisitEndTS", strVisitEndTS);
        int affected = db.update("tblStoreList", values,"StoreID=? and VisitStartTS is not null",new String[] { StoreID });*/
    }

    public static String[] FetchStoreStatus(String rID)
    {

        int ScodecolumnIndex = 0;

        //Cursor cursor = db.rawQuery("SELECT Sstat,ISNewStore FROM tblStoreList ORDER BY DistanceNear", null);
        Cursor cursor = db.rawQuery("SELECT Sstat, ISNewStore FROM tblStoreList where StoreRouteID='"+ rID +"'   ORDER BY DistanceNear", null);

        try
        {
            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    StoreName[i] = cursor.getString(ScodecolumnIndex).toString()+"~"+cursor.getString(1).toString();
                    cursor.moveToNext();
                }
            }
            return StoreName;
        }
        finally
        {
            cursor.close();
        }
    }

/*	public static void UpdateStoreCloseNextDay(String StoreID, int outStat) {

		final ContentValues values = new ContentValues();
		values.put("Sstat", outStat);

		int affected = db.update("tblStoreList", values,"StoreID=? and (StoreClose=1 or  StoreNextDay=1) and Sstat=0",
				new String[] { StoreID });
		Log.w(TAG, "affected records: " + affected);

		Log.w(TAG, "UpdateStoreEndVisit Updated..");
	}*/

    public static String[] FetchStoreList(String rID)
    {
        int ScodecolumnIndex = 0;
        int SnamecolumnIndex = 1;

        //Cursor cursor = db.rawQuery("SELECT StoreID, StoreName FROM tblStoreList   ORDER BY DistanceNear", null); //where StoreRouteID='"+ rID +"'
        Cursor cursor = db.rawQuery("SELECT StoreID, StoreName FROM tblStoreList where StoreRouteID='"+ rID +"'  ORDER BY DistanceNear", null); //where StoreRouteID='"+ rID +"'

        try
        {
            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst())
            {
                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    StoreName[i] = (String) cursor.getString(ScodecolumnIndex).toString()+ "_"+ (String) cursor.getString(SnamecolumnIndex).toString();
                    cursor.moveToNext();
                }

            }
            return StoreName;
        }
        finally
        {
            cursor.close();
        }
    }

    //Cursor cursorLocE = db.rawQuery("SELECT ActualLatitude FROM tblStoreList WHERE StoreID ='"+ passedStoreID + "'", null);

    public static String[] ProcessStoreReq()
    {
        int LoncolumnIndex = 0;
        int LoncolumnIndex2 = 1;

        //Cursor cursor2 = db.rawQuery("SELECT StoreID, StoreName FROM tblStoreList WHERE (Sstat = 1  OR StoreNextDay = 1) and Sstat<>4  and Sstat<>5 and Sstat<>6",null);//OR StoreClose = 1
        Cursor cursor2 = db.rawQuery("SELECT DISTINCT tblStoreVisitMstr.StoreID, tblStoreList.StoreName FROM tblStoreVisitMstr inner join tblStoreList On tblStoreVisitMstr.StoreID=tblStoreList.StoreID WHERE (tblStoreVisitMstr.VisitTypeStatus ='2' OR tblStoreVisitMstr.VisitTypeStatus='4'  OR tblStoreVisitMstr.StoreNextDay = 1 ) and tblStoreList.Sstat<>4  and tblStoreList.Sstat<>5 and tblStoreList.Sstat<>6",null);//OR StoreClose = 1
        try
        {
            String strAreaIdsDetais[] = new String[cursor2.getCount()];
            ////// System.out.println("records count[ProcessStoreReq]: "+cursor2.getCount());
            if (cursor2.moveToFirst())
            {
                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    strAreaIdsDetais[i] = (String) cursor2.getString(LoncolumnIndex)+ "%"+ (String) cursor2.getString(LoncolumnIndex2);
                    ////// System.out.println("VAL1: "+(String) cursor2.getString(LoncolumnIndex) + "  "+"VAL2: "+(String) cursor2.getString(LoncolumnIndex2));
                    cursor2.moveToNext();
                }
            }
            return strAreaIdsDetais;
        }
        finally
        {
            cursor2.close();
        }

    }

    public static boolean GetLeftStoresChk()
    {

        Cursor cursorDateE = db.rawQuery("SELECT DISTINCT tblStoreVisitMstr.StoreID, tblStoreList.StoreName FROM tblStoreVisitMstr inner join tblStoreList On tblStoreVisitMstr.StoreID=tblStoreList.StoreID WHERE (tblStoreList.Sstat = 3  OR tblStoreVisitMstr.StoreClose = 1 OR tblStoreVisitMstr.StoreNextDay = 1) AND tblStoreList.Sstat<>4 AND tblStoreList.Sstat<>5 AND tblStoreList.Sstat<>6",null);

        try
        {
            if (cursorDateE.getCount() > 0)
            {
                ////// System.out.println("GetLeftStoresChk - Records Count: "+ cursorDateE.getCount());
                ////// System.out.println("returning GetLeftStoresChk - true");
                return true;
            }
            else
            {
                return false;
            }

        }
        finally
        {
            cursorDateE.close();
        }

    }

    public static long insertTblSelectedStoreIDinChangeRouteCase(String StorID)
    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("StoreID", StorID);

        return db.insert(DATABASE_TABLE_MAIN92, null, initialValues);
    }

    public static String[] getStoreIDTblSelectedStoreIDinChangeRouteCase() {

        int SnamecolumnIndex1 = 0;

        //Cursor cursor = db.rawQuery("SELECT OutId FROM tblOutletPicMstr WHERE OutId IN (SELECT StoreId FROM tblStoreList WHERE Sstat IN (1, 3))", null);

        Cursor cursor = db.rawQuery("SELECT StoreID FROM tblSelectedStoreIDinChangeRouteCase", null);
        try {

            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1)
                            .toString();
                    ////// System.out.println("STORE ID 4 Pic: "+cursor.getString(SnamecolumnIndex1).toString());

                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }

    }

    public static void UpdateStoreFlagAtDayEndOrChangeRoute(String sID, int flag2set)
    {

        try
        {

            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);

            int affected24 = db.update("tblStoreOrderBillAddressDetails", values, "StoreID=?",new String[] { sID });
            int affected25 = db.update("tblStoreSalesOrderPaymentDetails", values, "StoreId=?",new String[] { sID });
            int affected26 = db.update("tblRateDistribution", values,"StoreId=?", new String[] { sID });
            // int affected27 = db.update("tableImage", values,"StoreID=?", new String[] { sID });

            //tblNewStoreSalesQuotePaymentDetails (StoreId text null,PymtStageId text null,Sstat text null);";
            int affected23 = db.update("tblNewStoreSalesQuotePaymentDetails", values,"StoreId=?", new String[] { sID });

            //tblOutletQuestAnsMstr
            ////// System.out.println("Updating Status for Store ID: " + sID);
            int affected = db.update("tblStoreList", values, "StoreID=?",new String[] { sID });
            //int affected2 = db.update("tblTransac", values, "StoreID=?",new String[] { sID });

            int affected4 = db.update("tblNewStoreListEntries", values,"StoreID=?", new String[] { sID });

            //int affected4 = db.update("tblDistributionStoreProductWiseDetails", values, "StoreID=?",new String[] { sID });
            //int affected5 = db.update("tblDistributionStoreProductMstr", values, "StoreID=?",new String[] { sID });

            int affected9 = db.update("tblNewStoreEntries", values,"StoreID=?", new String[] { sID });
            int affected10 = db.update("tblTemp", values,"StoreID=?", new String[] { sID });

           // int affected3 = db.update("tblTmpInvoiceHeader", values, "StoreID=? ",new String[] { sID });

            //int affected4 = db.update("tblDistributionStoreProductWiseDetails", values, "StoreID=?",new String[] { sID });
            //int affected5 = db.update("tblDistributionStoreProductMstr", values, "StoreID=?",new String[] { sID });
            int affected5 = db.update("tblPDAProductReturnMstr", values,
                    "StoreID=? ", new String[] { sID });

         //   int affected7 = db.update("tblTmpInvoiceDetails", values,"StoreID=?  ", new String[] { sID });
            int affected8 = db.update("tblStoreProductAppliedSchemesBenifitsRecords", values,"StoreID=? ", new String[] { sID });



            int affected11 = db.update("tblStoreReturnDetail", values,"StoreID=? ", new String[] { sID });

            //int affected12 = db.update("tblStoreReturnDetail", values,"StoreID=?", new String[] { sID });
            int affected13 = db.update("tblProductMappedWithSchemeSlabApplied", values,"StoreId=? ", new String[] { sID });
            //StoreId text null,ProductID text null,schSlabId text null,schmIdMapped text null,Sstat int null);";
            int affected14 = db.update("tblStoreProductPhotoDetail", values,"StoreID=? ", new String[] { sID });

            int affected21 = db.update("tblOutletQuestAnsMstr", values,"OutletID=?", new String[] { sID });

            int affected261 = db.update("tblNewAddedStoreLocationDetails", values,"StoreID=?", new String[] { sID });
            int affected17 = db.update("tblSalesQuotePersonMeetMstr", values,"StoreId=?", new String[] { sID });

           // int affected171 = db.update("tblAllCollectionData", values,"StoreID=?", new String[] { sID });

            // int affected19 = db.update("tblDsrRegDetails", values, "StoreID=?",new String[] { sID });

            db.execSQL("UPDATE tblDsrRegDetails SET Sstat="+flag2set);

            LinkedHashMap<String, String> hmapDistinctSalesQuotePersonMeetMstr= fngetDistinctSalesQuotePersonMeetMstrForSstatUpdate(sID);


            Iterator it11new = hmapDistinctSalesQuotePersonMeetMstr.entrySet().iterator();

            while (it11new.hasNext()) {
                Entry pair = (Entry)it11new.next();
                if(hmapDistinctSalesQuotePersonMeetMstr.containsKey(pair.getKey().toString())){
                    //crntPID	=pair.getKey().toString();
                    int affected18 = db.update("tblSalesQuoteProductsMstr", values,"SalesQuoteId=?", new String[] { pair.getKey().toString() });
                }

            }


            int chkValue = fnChkStoreIdExistsInReturnMstrDayEndChangeRoute(sID);

            if (chkValue == 1)
            {
                int productreturnmstrid = fnGetAutoIdStoreOnReturnPAge(sID);

                int chkValueReturnDetails = fnChkAutoIdMstrForReturnDetailsChangeRouteDayEnd(productreturnmstrid);
                if (chkValueReturnDetails == 1)
                {
                    int affected6 = db.update("tblPDAProductReturnDetails",
                            values, "ReturnIdMstr=? ", new String[] { ""
                                    + productreturnmstrid });
                }
            }

            Log.w(TAG, "affected records: " + affected);

            Log.w(TAG, "Record(s) Updated..");

        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }

    }


    public static void UpdatetblStoreClosedPhotoDetail(String sID, int flag2set)
    {

        try
        {
             final ContentValues values = new ContentValues();
             values.put("Sstat", flag2set);

            int affected28 = db.update("tblStoreClosedPhotoDetail", values,"Sstat=?", new String[] { "3" });
        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }

    }

    public static void UpdateStoreImage(String sID, int flag2set)
    {

        try
        {

            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);

            int affected27 = db.update("tableImage", values,"Sstat=?", new String[] { "3" });
            int affected28 = db.update("tblStoreClosedPhotoDetail", values,"Sstat=?", new String[] { "3" });



        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }

    }

    public static int fnChkAutoIdMstrForReturnDetailsChangeRouteDayEnd(int ReturnIdMstr) {

        int LoncolumnIndex = 0;
        int strReturnIdDetails = 0;

        Cursor cursor2 = db
                .rawQuery(
                        "SELECT AutoReturnDetailsId FROM  tblPDAProductReturnDetails where ReturnIdMstr='"+ ReturnIdMstr +"'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strReturnIdDetails = 1;
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }

            return strReturnIdDetails;
        } finally {
            cursor2.close();
        }

    }

    public static int fnChkStoreIdExistsInReturnMstrDayEndChangeRoute(String ReturnStoreId) {

        int LoncolumnIndex = 0;
        int strReturnIdMstr = 0;

        Cursor cursor2 = db.rawQuery(
                "SELECT AutoReturnIdMstr FROM  tblPDAProductReturnMstr where StoreID='"
                        + ReturnStoreId + "'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strReturnIdMstr = 1;
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }

            return strReturnIdMstr;
        } finally {
            cursor2.close();
        }

    }

    public static void UpdateStoreFlag(String sID, int flag2set)
    {

        try
        {

            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);

            if(flag2set==3)
            {
                int affected4 = db.update("tblsameLocationForStoreRestartDone", values,"CrntStoreID=?", new String[] { sID });
            }

            int affected3 = db.update("tblLatLongDetails", values,"StoreID=?", new String[] { sID });
            // int affected41 = db.update("tableImage", values,"StoreID=?", new String[] { sID });

           // int affected42 = db.update("tblAllCollectionData", values,"StoreID=?", new String[] { sID });

            int affected211 = db.update("tblActualVisitStock", values, "StoreID=?",new String[] { sID });


            int affected = db.update("tblStoreList", values, "StoreID=?",new String[] { sID });
            int affected62 = db.update("tblStoreCheckInPic", values, "StoreID=?",new String[] { sID });
          //  int affected1 = db.update("tblLatLongDetails", values, "StoreID=?",new String[] { sID });

            int affected26 = db.update("tblRateDistribution", values,"StoreId=?", new String[] { sID });


            int affected4 = db.update("tblNewStoreListEntries", values,"StoreID=?", new String[] { sID });
            int affected9 = db.update("tblNewStoreEntries", values,"StoreID=?", new String[] { sID });
            int affected10 = db.update("tblTemp", values,"StoreID=?", new String[] { sID });

            int affected15 = db.update("tblStoreMaterialDetail", values,"StoreID=?", new String[] { sID });
            int affected16 = db.update("tblStoreMaterialPhotoDetail", values,"StoreID=?", new String[] { sID });
            int affected17 = db.update("tblSalesQuotePersonMeetMstr", values,"StoreId=?", new String[] { sID });
            int affected21 = db.update("tblOutletQuestAnsMstr", values,"OutletID=?", new String[] { sID });

            int affected261 = db.update("tblNewAddedStoreLocationDetails", values,"StoreID=?", new String[] { sID });

            int affected23 = db.update("tblNewStoreSalesQuotePaymentDetails", values,"StoreId=?", new String[] { sID });

            int affected24 = db.update("tblStoreOrderBillAddressDetails", values, "StoreID=?",new String[] { sID });
            int affected25 = db.update("tblStoreSalesOrderPaymentDetails", values, "StoreId=?",new String[] { sID });


            LinkedHashMap<String, String> hmapDistinctSalesQuotePersonMeetMstr= fngetDistinctSalesQuotePersonMeetMstrForSstatUpdate(sID);
            Iterator it11new = hmapDistinctSalesQuotePersonMeetMstr.entrySet().iterator();
            while (it11new.hasNext()) {
                Entry pair = (Entry)it11new.next();
                if(hmapDistinctSalesQuotePersonMeetMstr.containsKey(pair.getKey().toString())){
                    int affected18 = db.update("tblSalesQuoteProductsMstr", values,"SalesQuoteId=?", new String[] { pair.getKey().toString() });
                }

            }



        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }

    }

    public static void UpdateStoreOtherMainTablesFlag(String sID, int flag2set,String pdaOrderID,String TmpInvoiceCodePDA)
    {

        try
        {

            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);


         //   int affected3 = db.update("tblTmpInvoiceHeader", values, "StoreID=? AND TmpInvoiceCodePDA=?",new String[] { sID,TmpInvoiceCodePDA });

            //int affected4 = db.update("tblDistributionStoreProductWiseDetails", values, "StoreID=?",new String[] { sID });
            //int affected5 = db.update("tblDistributionStoreProductMstr", values, "StoreID=?",new String[] { sID });
            int affected5 = db.update("tblPDAProductReturnMstr", values,
                    "StoreID=? AND TmpInvoiceCodePDA=?", new String[] { sID,TmpInvoiceCodePDA });

         //   int affected7 = db.update("tblTmpInvoiceDetails", values,"StoreID=? AND TmpInvoiceCodePDA=?", new String[] { sID,TmpInvoiceCodePDA });
            int affected8 = db.update("tblStoreProductAppliedSchemesBenifitsRecords", values,"StoreID=? AND TmpInvoiceCodePDA=?", new String[] { sID,TmpInvoiceCodePDA });



            int affected11 = db.update("tblStoreReturnDetail", values,"StoreID=? AND TmpInvoiceCodePDA=?", new String[] { sID,TmpInvoiceCodePDA });

            //int affected12 = db.update("tblStoreReturnDetail", values,"StoreID=?", new String[] { sID });
            int affected13 = db.update("tblProductMappedWithSchemeSlabApplied", values,"StoreId=? AND TmpInvoiceCodePDA=?", new String[] { sID,TmpInvoiceCodePDA });
            //StoreId text null,ProductID text null,schSlabId text null,schmIdMapped text null,Sstat int null);";
            int affected14 = db.update("tblStoreProductPhotoDetail", values,"StoreID=? AND TmpInvoiceCodePDA=?", new String[] { sID,TmpInvoiceCodePDA });

            int affected290 = db.update("tblStoreSalesOrderPaymentDetails", values,"StoreId=? AND TmpInvoiceCodePDA=?", new String[] { sID,TmpInvoiceCodePDA });
            //int affected291 = db.update("tblAllCollectionData", values,"StoreID=? AND TmpInvoiceCodePDA=?", new String[] { sID,TmpInvoiceCodePDA });


            int chkValue = fnChkStoreIdExistsInReturnMstr(sID,pdaOrderID,TmpInvoiceCodePDA);

            if (chkValue == 1)
            {
                int productreturnmstrid = fnGetAutoIdStoreOnReturnPAge(sID);

                int chkValueReturnDetails = fnChkAutoIdMstrForReturnDetails(productreturnmstrid,pdaOrderID,TmpInvoiceCodePDA);
                if (chkValueReturnDetails == 1)
                {
                    int affected6 = db.update("tblPDAProductReturnDetails",
                            values, "ReturnIdMstr=? AND TmpInvoiceCodePDA=?", new String[] { ""
                                    + productreturnmstrid,TmpInvoiceCodePDA });
                }
            }
            //

            //Log.w(TAG, "affected records: " + affected);

            Log.w(TAG, "Record(s) Updated..");

        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }

    }

    public static void UpdateStoreVisitBatt(String StoreID, String vBatt) {

      /*  final ContentValues values = new ContentValues();
        values.put("BateryLeftStatus", vBatt);
        int affected = db.update("tblStoreVisitMstr", values, "StoreID=?",
                new String[] { StoreID });
        Log.w(TAG, "affected records: " + affected);*/

    }

    public static void UpdateStoreVisitBattVisitWise(String StoreID, String vBatt,String StoreVisitCode) {
//open();
        final ContentValues values = new ContentValues();
        values.put("BateryLeftStatus", vBatt);
        int affected = db.update("tblStoreVisitMstr", values, "StoreID=? AND StoreVisitCode=?",
                new String[] { StoreID,StoreVisitCode });
        //close();
        Log.w(TAG, "affected records: " + affected);

    }

    // ---insert XML data into the database---
    public static void createRouteTBL() {
        try {

            db.execSQL(TABLE_tblRouteListMaster_Definition);
            //db.execSQL(DATABASE_CREATE_TABLE_2);
        } catch (Exception e) {
            Log.e(TAG, "Error: onUpgrade db");
        }

    }

   /* public static void UpdateStoreActualLatLongi(String StoreID,
                                          String ActualLatitude, String ActualLongitude, String Accuracy,
                                          String LocProvider, int flgLocationServicesOnOff, int flgGPSOnOff, int flgNetworkOnOff, int flgFusedOnOff, int flgInternetOnOffWhileLocationTracking, int flgRestart, int flgStoreOrder)
    {
        //open();
        final ContentValues values = new ContentValues();
        values.put("ActualLatitude", ActualLatitude);
        values.put("ActualLongitude", ActualLongitude);
        values.put("Accuracy", Accuracy);
        values.put("LocProvider", LocProvider);


        values.put("flgLocationServicesOnOff", flgLocationServicesOnOff);
        values.put("flgGPSOnOff", flgGPSOnOff);
        values.put("flgNetworkOnOff", flgNetworkOnOff);
        values.put("flgFusedOnOff", flgFusedOnOff);
        values.put("flgInternetOnOffWhileLocationTracking", flgInternetOnOffWhileLocationTracking);
        values.put("flgRestart", flgRestart);


        int affected = db.update("tblStoreList", values, "StoreID=?",new String[] { StoreID });
        close();
        Log.w(TAG, "affected records: " + affected);


    }*/


    // ---insert sample data into the database---
    //

    public static void fnSetAllRouteActiveStatus() {

        try {



            db.execSQL("UPDATE tblRouteListMaster SET flgTodayRoute= 0" );
            /* */


        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }


    // tblRouteListMaster(ID string null, Descr string null, Active int null);";

    public static void updateActiveRoute(String sID, int flag2set) {

        try {


            final ContentValues values = new ContentValues();
            values.put("flgTodayRoute", flag2set);

            int affected = db.update("tblRouteListMaster", values, "ID=?",
                    new String[] { sID });



        } catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }

    }

    public static String GetRouteNameBasedOnRouteID(String ID) {

        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT Descr FROM tblRouteListMaster WHERE ID='"+ ID +"' Limit 1", null);
        try {
            //String strLocationIDDetais[] = new String[cursor2.getCount()];
            String activeRouteID = "NA";
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    activeRouteID = cursor2.getString(LoncolumnIndex);
                    ////// System.out.println("active Route Id : "+ cursor2.getString(LoncolumnIndex).toString().trim());
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return activeRouteID;
        } finally {
            cursor2.close();
        }

    }

    public static String GetRouteDateBasedOnRouteID(String ID) {

        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT RouteDate FROM tblRouteListMaster WHERE ID='"+ ID +"'", null);
        try {
            //String strLocationIDDetais[] = new String[cursor2.getCount()];
            String activeRouteID = "NA";
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    activeRouteID = cursor2.getString(LoncolumnIndex);
                    ////// System.out.println("active Route Id : "+ cursor2.getString(LoncolumnIndex).toString().trim());
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return activeRouteID;
        } finally {
            cursor2.close();
        }

    }

    public static String GetActiveRouteIDForToday(String fDate) {

        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT ID FROM tblRouteListMaster WHERE RouteDate='"+ fDate +"' and Active = 1 Limit 1", null);
        try {
            //String strLocationIDDetais[] = new String[cursor2.getCount()];
            String activeRouteID = "NA";
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    activeRouteID = cursor2.getString(LoncolumnIndex);
                    ////// System.out.println("active Route Id : "+ cursor2.getString(LoncolumnIndex).toString().trim());
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return activeRouteID;
        } finally {
            cursor2.close();
        }

    }

    public static String GetActiveRouteIDForTomorrow(String fDate) {

        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT ID FROM tblRouteListMaster WHERE RouteDate='"+ fDate +"' Limit 1", null);
        try {
            //String strLocationIDDetais[] = new String[cursor2.getCount()];
            String activeRouteID = "NA";
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    activeRouteID = cursor2.getString(LoncolumnIndex);
                    ////// System.out.println("active Route Id : "+ cursor2.getString(LoncolumnIndex).toString().trim());
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return activeRouteID;
        } finally {
            cursor2.close();
        }

    }

    //StoreID ='"+ StoreID + "'"

    public static String GetAllActiveRouteDescr()
    {
        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT Descr FROM tblRouteListMaster WHERE flgTodayRoute = 1", null);
        try
        {
            String activeRouteID = "NA";
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    if(i ==0)
                    {
                        activeRouteID = cursor2.getString(LoncolumnIndex);
                    }
                    else
                    {
                        activeRouteID = activeRouteID+"^"+cursor2.getString(LoncolumnIndex);
                    }
                    activeRouteID = cursor2.getString(LoncolumnIndex);
                    cursor2.moveToNext();

                }

            }
            return activeRouteID;
        } finally {
            cursor2.close();
        }

    }

    public static String GetAllActiveRouteID()
    {
        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT ID FROM tblRouteListMaster WHERE flgTodayRoute=1", null);
        try
        {
            String activeRouteID = "NA";
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    if(i ==0)
                    {
                        activeRouteID = cursor2.getString(LoncolumnIndex);
                    }
                    else
                    {
                        activeRouteID = activeRouteID+"^"+cursor2.getString(LoncolumnIndex);
                    }
                    activeRouteID = cursor2.getString(LoncolumnIndex);
                    cursor2.moveToNext();

                }

            }
            return activeRouteID;
        } finally {
            cursor2.close();
        }

    }

    public static String GetActiveRouteID()
    {
        int LoncolumnIndex = 0;
        String activeRouteID = "0";
        Cursor cursor2=null;
        cursor2 = db.rawQuery("SELECT ID FROM tblRouteListMaster WHERE flgTodayRoute = 1 Limit 1", null);

        try
        {

            if (cursor2.moveToFirst())
            {

                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    activeRouteID = cursor2.getString(LoncolumnIndex);
                    cursor2.moveToNext();

                }
            }
            if(activeRouteID.equals("0"))
            {
                activeRouteID=fnGetRouteIDWhilePurshase();
            }
            if(!CommonInfo.ActiveRouteSM.equals("0"))
            {
                activeRouteID= CommonInfo.ActiveRouteSM;
            }

        } finally {
            if(cursor2!=null) {
                cursor2.close();
            }
            return activeRouteID;
        }
    }

    public static String GetNOActiveRouteIDSunil()
    {
        int LoncolumnIndex = 0;

        //open();
        Cursor cursor2 = null;
        try
        {
            //cursor2 = db.rawQuery("SELECT ID FROM tblRouteListMaster WHERE flgTodayRoute = 1 Limit 1", null);
            cursor2 = db.rawQuery("SELECT ID FROM tblRouteListMaster WHERE flgTodayRoute = 0 Limit 1", null);


            String activeRouteID = "0";
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    activeRouteID = cursor2.getString(LoncolumnIndex);
                    cursor2.moveToNext();

                }

            }
            return activeRouteID;
        } finally {
            cursor2.close();
            //close();
        }

    }

    public static String GetNotActiveRouteID()
    {
        int LoncolumnIndex = 0;
        String activeRouteID = "0";
        Cursor cursor2 = db.rawQuery("SELECT ID FROM tblRouteListMaster Limit 1", null);
        try
        {

            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    activeRouteID = cursor2.getString(LoncolumnIndex);
                    cursor2.moveToNext();

                }

            }

        } finally {
            cursor2.close();
            return activeRouteID;
        }

    }

    public static String GetActiveRouteIDSunil()
    {
        int LoncolumnIndex = 0;

        //open();
        Cursor cursor2 = null;
        try
        {
            cursor2 = db.rawQuery("SELECT ID FROM tblRouteListMaster WHERE flgTodayRoute = 1 Limit 1", null);

            String activeRouteID = "0";
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    activeRouteID = cursor2.getString(LoncolumnIndex);
                    cursor2.moveToNext();

                }

            }
            if(!CommonInfo.ActiveRouteSM.equals("0"))
            {
                activeRouteID= CommonInfo.ActiveRouteSM;
            }
            return activeRouteID;
        } finally {
            cursor2.close();
            //close();
        }

    }

    public static String GetCurrentDayActiveRouteID()
    {
        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT ID FROM tblRouteListMaster WHERE Active=1 Limit 1", null);
        try
        {
            String activeRouteID = "NA";
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    activeRouteID = cursor2.getString(LoncolumnIndex);
                    cursor2.moveToNext();

                }

            }
            return activeRouteID;
        } finally {
            cursor2.close();
        }

    }

    public static int GetActiveRouteIDForRadioButton()
    {
        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT Active FROM tblRouteListMaster WHERE flgTodayRoute = 1 Limit 1", null);
        try
        {
            int activeRouteID = 0;
            if (cursor2.moveToFirst()) {


                activeRouteID = Integer.parseInt(cursor2.getString(LoncolumnIndex));



            }
            return activeRouteID;
        } finally {
            cursor2.close();
        }

    }

    public static long savetblPOSMaterialMstr(String POSMaterialID, String POSMaterialDescr)
    {

        ContentValues initialValues = new ContentValues();
        initialValues.put("POSMaterialID", POSMaterialID.trim());
        initialValues.put("POSMaterialDescr", POSMaterialDescr.trim());


        return db.insert(DATABASE_TABLE_MAIN161, null, initialValues);

    }

    public static long savetblStoreIDAndMaterialIDMap(String StoreID, String VisitID,String MaterialID,String CurrentStockQty)
    {

        ContentValues initialValues = new ContentValues();
        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("VisitID", VisitID.trim());
        initialValues.put("MaterialID", MaterialID.trim());
        initialValues.put("CurrentStockQty", CurrentStockQty.trim());



        return db.insert(DATABASE_TABLE_MAIN162, null, initialValues);
    }

    public static long savetblSchemeStoreMapping(String StoreID, String SchemeID)
    {

        ContentValues initialValues = new ContentValues();
        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("SchemeID", SchemeID.trim());

        // System.out.println("Ajay Data Save in table 201");


        return db.insert(DATABASE_TABLE_MAIN201, null, initialValues);

    }

    public static long savetblSchemeMstr(String SchemeID, String SchemeName,String SchemeApplicationID,String SchemeAppliedRule)
    {

        ContentValues initialValues = new ContentValues();
        initialValues.put("SchemeID", SchemeID.trim());
        initialValues.put("SchemeName", SchemeName.trim());
        initialValues.put("SchemeApplicationID", SchemeApplicationID.trim());
        initialValues.put("SchemeAppliedRule", SchemeAppliedRule.trim());



        // System.out.println("Ajay Data Save in table 202");


        return db.insert(DATABASE_TABLE_MAIN202, null, initialValues);
    }

    public static long savetblSchemeSlabDetail(String SchemeID, String SchemeSlabID,String SchemeSlabDesc,String BenifitDescr)
    {

        ContentValues initialValues = new ContentValues();
        initialValues.put("SchemeID", SchemeID.trim());
        initialValues.put("SchemeSlabID", SchemeSlabID.trim());
        initialValues.put("SchemeSlabDesc", SchemeSlabDesc.trim());
        initialValues.put("BenifitDescr", BenifitDescr.trim());

        // System.out.println("Ajay Data Save in table 203");
        return db.insert(DATABASE_TABLE_MAIN203, null, initialValues);
    }

    public static long savetblSchemeSlabBucketDetails(String RowID, String SchemeID,String SchemeSlabID,
                                               String BucketID,String SubBucketID,String SlabSubBucketType,String SlabSubBucketValue,String SubBucketValType)
    {

        ContentValues initialValues = new ContentValues();
        initialValues.put("RowID", RowID.trim());
        initialValues.put("SchemeID", SchemeID.trim());
        initialValues.put("SchemeSlabID", SchemeSlabID.trim());
        initialValues.put("BucketID", BucketID.trim());

        initialValues.put("SubBucketID", SubBucketID.trim());
        initialValues.put("SlabSubBucketType", SlabSubBucketType.trim());
        initialValues.put("SlabSubBucketValue", SlabSubBucketValue.trim());
        initialValues.put("SubBucketValType", SubBucketValType.trim());

        // System.out.println("Ajay Data Save in table 204");
        return db.insert(DATABASE_TABLE_MAIN204, null, initialValues);
    }

    public static long savetblSchemeSlabBucketProductMapping(String RowID, String ProductID)
    {

        ContentValues initialValues = new ContentValues();
        initialValues.put("RowID", RowID.trim());
        initialValues.put("ProductID", ProductID.trim());

        // System.out.println("Ajay Data Save in table 205");
        return db.insert(DATABASE_TABLE_MAIN205, null, initialValues);
    }


    //tblSchemeSlabBucketProductMapping (RowID text null,ProductID text null);";

    public static long savetblSchemeSlabBenefitsBucketDetails(String RowID, String SchemeID,String SchemeSlabID,
                                                       String BucketID,String SubBucketID,String BenSubBucketType,String BenDiscApplied,String CouponCode
            ,String BenSubBucketValue,String per,String UOM,int ProRata)
    {

        ContentValues initialValues = new ContentValues();
        initialValues.put("RowID", RowID.trim());
        initialValues.put("SchemeID", SchemeID.trim());
        initialValues.put("SchemeSlabID", SchemeSlabID.trim());
        initialValues.put("BucketID", BucketID.trim());
        initialValues.put("SubBucketID", SubBucketID.trim());
        initialValues.put("BenSubBucketType", BenSubBucketType.trim());
        initialValues.put("BenDiscApplied", BenDiscApplied.trim());
        initialValues.put("CouponCode", CouponCode.trim());
        initialValues.put("BenSubBucketValue", BenSubBucketValue.trim());
        initialValues.put("Per", Double.parseDouble(per));
        if(Double.parseDouble(per)==1000.00)
        {
            // System.out.println("NDTV"+Double.parseDouble(per));
        }
        initialValues.put("UOM", Double.parseDouble(UOM));
        initialValues.put("ProRata", ProRata);


        // System.out.println("Ajay Data Save in table 206");
        return db.insert(DATABASE_TABLE_MAIN206, null, initialValues);
    }

	/* dbengine.savetblSchemeSlabBenefitsBucketDetails(RowID,SchemeID,SchemeSlabID,BucketID,
     		SubBucketID,BenSubBucketType,BenDiscApplied,CouponCode,BenSubBucketValue);
     */

    public static long savetblSchemeSlabBenefitsProductMappingDetail(String RowID, String ProductID)
    {

        ContentValues initialValues = new ContentValues();
        initialValues.put("RowID", RowID.trim());
        initialValues.put("ProductID", ProductID.trim());

        // System.out.println("Ajay Data Save in table 207");
        return db.insert(DATABASE_TABLE_MAIN207, null, initialValues);
    }

    public static long savetblSchemeSlabBenefitsValueDetail(String RowID, String BenValue,String Remarks,String Type)
    {

        ContentValues initialValues = new ContentValues();
        initialValues.put("RowID", RowID.trim());
        initialValues.put("BenValue", BenValue.trim());
        initialValues.put("Remarks", Remarks.trim());
        initialValues.put("Type", Type.trim());

        // System.out.println("Ajay Data Save in table 208");
        return db.insert(DATABASE_TABLE_MAIN208, null, initialValues);
    }

    //tblSchemeSlabBenefitsValueDetail (RowID text null,BenValue text null,Remarks text null,Type text null);";

    public static long savetblProductRelatedScheme(String ProductID, String PrdString)
    {

        ContentValues initialValues = new ContentValues();
        initialValues.put("ProductID", ProductID.trim());
        initialValues.put("PrdString", PrdString.trim());

        // System.out.println("Ajay Data Save in table 209");
        return db.insert(DATABASE_TABLE_MAIN209, null, initialValues);
    }

    //tblProductRelatedScheme (ProductID text null,PrdString text null);";

    public static long saveRoutesInfo(String ID,String RouteType, String Descr,int ActiveFlg,int flgTodayRoute,String RouteDate)
    {

        ContentValues initialValues = new ContentValues();
        initialValues.put("ID", ID.trim());
        initialValues.put("RouteType", RouteType.trim());
        initialValues.put("Descr", Descr.trim());
        initialValues.put("Active", ActiveFlg);
        initialValues.put("flgTodayRoute", flgTodayRoute);
        initialValues.put("RouteDate", RouteDate);


        return db.insert(TABLE_tblRouteListMaster_Define, null, initialValues);
    }

    public static int fncheckStoreIsNewOrOld(String StoreID)
    {
        //open();
        Cursor cursor = db.rawQuery("SELECT ISNewStore FROM tblStoreList WHERE StoreID='"+StoreID+"'" , null);
        try {
            int ISNewStore =0;
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    ISNewStore = Integer.parseInt(cursor.getString(0).toString());

                }
            }
            return ISNewStore;

        } finally {
            if(cursor!=null) {
                cursor.close();
            }
            //close();
        }

    }

    //(StoreID text not null, StoreType string not null, StoreName string not null, StoreLatitude real not null,
    //StoreLongitude real not null, LastVisitDate string not null, LastTransactionDate string not null, Sstat integer not null,
    //ForDate string not null, ActualLatitude text null, ActualLongitude text null, VisitStartTS text null, VisitEndTS text null,
    //AutoIdStore int null, LocProvider text null, Accuracy text null, BateryLeftStatus text null,StoreClose integer null,
    //StoreNextDay integer null,chainID integer null);";


	/*private static final String DATABASE_CREATE_TABLE_13 = "create table tblStoreList " +
	(StoreID text not null, StoreType string not null, StoreName string not null, StoreLatitude real not null,
   StoreLongitude real not null, LastVisitDate string not null, LastTransactionDate string not null,
   Sstat integer not null, ForDate string not null, ActualLatitude text null, ActualLongitude text null,
   VisitStartTS text null, VisitEndTS text null, ISNewStore int null, AutoIdStore int null, LocProvider text null,
   Accuracy text null, BateryLeftStatus text null,StoreRouteID text null);";
*/

    public static int fncheckStoreIsNewStoreDataCompleteSaved(String StoreID)
    {
        //open();
        Cursor cursor = db.rawQuery("SELECT IsNewStoreDataCompleteSaved FROM tblStoreList WHERE StoreID='"+StoreID+"'" , null);
        try {
            int IsNewStoreDataCompleteSaved =0;
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    IsNewStoreDataCompleteSaved = Integer.parseInt(cursor.getString(0).toString());

                }
            }
            return IsNewStoreDataCompleteSaved;

        } finally {
            if(cursor!=null) {
                cursor.close();
            }
            //close();
        }

    }


    public static int getFwdPgIdonNextBtnClick(String StoreID, String PgId, String ChainId)
    {
        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT fwdSeq FROM tblStorePgSeqFlow WHERE storeID="+ StoreID +" and pgId=" + PgId + " and chainID="+ChainId, null);
        try
        {
            int strFwdPgIdonNextBtnClick = 0;
            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    if (!cursor.isNull(ScodecolumnIndex))
                    {
                        strFwdPgIdonNextBtnClick = Integer.parseInt(cursor.getString(ScodecolumnIndex).toString());
                        ////// System.out.println("Store Page PgId = "+ PgId +" and strFwdPgIdonNextBtnClick :"+strFwdPgIdonNextBtnClick);
                        cursor.moveToNext();
                    }

                }
            }
            return strFwdPgIdonNextBtnClick;
        }
        finally
        {
            cursor.close();
        }
    }

    public static int getFwdPgIdonBackBtnClick(String StoreID, String PgId, String ChainId)
    {
        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT bckSeq FROM tblStorePgSeqFlow WHERE storeID="+ StoreID +" and pgId=" + PgId + " and chainID="+ChainId, null);
        try
        {
            int strFwdPgIdonBackBtnClick = 0;
            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    if (!cursor.isNull(ScodecolumnIndex))
                    {
                        strFwdPgIdonBackBtnClick = Integer.parseInt(cursor.getString(ScodecolumnIndex).toString());
                        ////// System.out.println("Store Page PgId = "+ PgId +" and strFwdPgIdonBackBtnClick :"+strFwdPgIdonBackBtnClick);
                        cursor.moveToNext();
                    }

                }
            }
            return strFwdPgIdonBackBtnClick;
        }
        finally
        {
            cursor.close();
        }
    }

    public static String getCustomPGid(int pgID) {

        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT pgName FROM tblStorePgSeqFlow WHERE pgId = "+ pgID, null);
        try {
            String strProdStockQty="";
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    if (!cursor.isNull(ScodecolumnIndex)) {
                        strProdStockQty = cursor.getString(ScodecolumnIndex).toString();	//Integer.parseInt(cursor.getString(ScodecolumnIndex).toString());
                        cursor.moveToNext();
                    }

                }
            }
            return strProdStockQty;
        } finally {
            cursor.close();
        }
    }

    public static String[] checkStoreCloseOrNextMethod(String StoreID)
    {

        int columnIndex1 = 0;
        int columnIndex2 = 1;
        Cursor cursor2 = db.rawQuery("SELECT StoreClose FROM tblStoreVisitMstr WHERE StoreID ='"+ StoreID + "'", null);
        //Cursor cursorLocE = db.rawQuery("SELECT ActualLatitude FROM tblStoreList WHERE StoreID ='"+ passedStoreID + "'", null);

        try
        {
            String checkStoreCloseOrNextDetials[] = new String[cursor2.getCount()];

            ////// System.out.println("records count[ProcessStoreReq]: "+cursor2.getCount());

            if (cursor2.moveToFirst())
            {

                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    checkStoreCloseOrNextDetials[i] = (String) cursor2.getString(columnIndex1);//+ "_"+ (String) cursor2.getString(columnIndex2);

                    //////// System.out.println("VAL1: "+(String) cursor2.getString(LoncolumnIndex) + "  "+"VAL2: "+(String) cursor2.getString(LoncolumnIndex2));
                    cursor2.moveToNext();
                }

            }
            return checkStoreCloseOrNextDetials;
        }
        finally
        {
            cursor2.close();
        }

    }

    public static int getChainIDBasedOnStoreID(String StoreID)
    {
        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT chainID FROM tblStorePgSeqFlow WHERE storeID="+ StoreID, null);
        try
        {
            int strChainID = 0;
            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    if (!cursor.isNull(ScodecolumnIndex))
                    {
                        strChainID = Integer.parseInt(cursor.getString(ScodecolumnIndex).toString());
                        ////// System.out.println("Store StoreID = '"+ StoreID +"' and strChainID :"+strChainID);
                        cursor.moveToNext();
                    }

                }
            }
            return strChainID;
        }
        finally
        {
            cursor.close();
        }
    }

    public static String[] FetchStoreStoreNextDayStatus()
    {

        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT StoreNextDay FROM tblStoreList ORDER BY DistanceNear", null);
        try {
            String StoreName[] = new String[cursor.getCount()];
            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    StoreName[i] = (String) cursor.getString(ScodecolumnIndex).toString();
                    cursor.moveToNext();
                }
            }
            return StoreName;
        }
        finally
        {
            cursor.close();
        }
    }

    public static void updateCloseflg(String sID, int StoreClose)
    {
        try
        {
            ContentValues values = new ContentValues();
            values.put("StoreClose", StoreClose);
            int affected = db.update("tblStoreVisitMstr", values, "StoreID= ?",new String[] { sID });
            Log.w(TAG, "affected records: " + affected);
            Log.w(TAG, "Record(s) Updated..");

        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }

    }

    public static void updateNextDayflg(String sID,int StoreNextDay)
    {
        try
        {
            ContentValues values = new ContentValues();
            values.put("StoreNextDay", StoreNextDay);
            ////// System.out.println("nextday: "+StoreNextDay);
            int affected = db.update("tblStoreVisitMstr", values, "StoreID= ?",new String[] { sID });

            Log.w(TAG, "affected records: " + affected);

            Log.w(TAG, "Record(s) Updated..");

        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }

    }

    public static String[] FetchStoreStoreCloseStatus(String rID)
    {
        int ScodecolumnIndex = 0;

        //Cursor cursor = db.rawQuery("SELECT StoreClose FROM tblStoreList ORDER BY DistanceNear", null);
        Cursor cursor = db.rawQuery("SELECT StoreClose FROM tblStoreList where StoreRouteID='"+ rID +"'   ORDER BY DistanceNear", null);

        try {
            String StoreName[] = new String[cursor.getCount()];
            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    StoreName[i] = (String) cursor.getString(ScodecolumnIndex).toString();
                    cursor.moveToNext();
                }
            }
            return StoreName;
        }
        finally
        {
            cursor.close();
        }
    }

    public static int getRouteId()
    {
        int LoncolumnIndex = 0;

        int strRouteIdMstr=0;
        Cursor cursor2 = db.rawQuery("SELECT ID FROM  tblRouteListMaster where flgTodayRoute=1", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strRouteIdMstr = Integer.parseInt(cursor2
                            .getString(LoncolumnIndex));
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }

            return strRouteIdMstr;
        } finally {
            cursor2.close();
        }
    }

	/*public static void deleteCategroyProductINformation(String CategoryId, String storeID) {
		// int entryCount;
		db.execSQL("DELETE FROM tblCategoryQuestionInformation WHERE CategoryID ='" + CategoryId + "' and StoreID='"+ storeID +"'");

	}*/

    public static String[] fnarrUniqueProductsSaleSummry()
    {
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        int LoncolumnIndex2 = 2;

        //ProductID text not null, ProductShortName

        //Cursor cursor2 = db.rawQuery("SELECT DISTINCT ProductShortName, KGLiter, DisplayUnit FROM tblProductListMaster", null);
        Cursor cursor2 = db.rawQuery("SELECT DISTINCT ProductShortName, KGLiter, DisplayUnit FROM tblProductListMaster", null);
        try {
            String UniqueProductShortName[] = new String[cursor2.getCount()];
            if (cursor2.moveToFirst())
            {

                for (int i = 0; i < cursor2.getCount(); i++)
                {

                    if (!cursor2.isNull(LoncolumnIndex))
                    {
                        UniqueProductShortName[i] =cursor2.getString(LoncolumnIndex).toString() + "^" + cursor2.getString(LoncolumnIndex1).toString() + "^" + cursor2.getString(LoncolumnIndex2).toString();
                        //// System.out.println("Anuj ProductShortName sunil: "+(String) cursor2.getString(LoncolumnIndex) + "  "+"KGLiter sunil: "+(String) cursor2.getString(LoncolumnIndex1));

                        cursor2.moveToNext();
                    }

                }

            }
            return UniqueProductShortName;
        } finally {
            cursor2.close();
        }
    }

    public static String fnCalculateLinesSkuWise(String PSName)
    {
        String LineValue="0";
        int LoncolumnIndex = 0;


        //ProductID text not null, ProductShortName

        Cursor cursor2 = db.rawQuery("SELECT Count(DISTINCT StoreID) FROM tblTmpInvoiceDetails WHERE OrderQty>0 and ProductShortName ='" + PSName + "'", null);
        try {
            if(cursor2.getCount()>0)
            {
                if (cursor2.moveToFirst())
                {

                    for (int i = 0; i < cursor2.getCount(); i++)
                    {
                        if (!cursor2.isNull(LoncolumnIndex))
                        {
                            LineValue =cursor2.getString(LoncolumnIndex).toString();
                            cursor2.moveToNext();
                        }

                    }

                }
            }

        } finally {
            cursor2.close();
        }

        return LineValue;
    }

    public static String[] fnCalculateProductsSaleSummry()
    {
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        int LoncolumnIndex2 = 2;
        String[] UniqueProductsSaleSummry;
        UniqueProductsSaleSummry=fnarrUniqueProductsSaleSummry();
        String val="";
        String SummryPName="";
        String SDisplayName="";
        String SDisplayUnit="";


        String SumOQty[]=new String[UniqueProductsSaleSummry.length];
        String SumFQty[]=new String[UniqueProductsSaleSummry.length];
        String SumSQty[]=new String[UniqueProductsSaleSummry.length];
        //String DisplaySQty[]=new String[UniqueProductsSaleSummry.length];

        String SumOQtyKG[]=new String[UniqueProductsSaleSummry.length];
        String SumFQtyKG[]=new String[UniqueProductsSaleSummry.length];
        String SumSQtyKG[]=new String[UniqueProductsSaleSummry.length];
        //String DisplaySKG[]=new String[UniqueProductsSaleSummry.length];

        String SummryProductName[]=new String[UniqueProductsSaleSummry.length];
        String SummryDisplayUnit[]=new String[UniqueProductsSaleSummry.length];

        String FinalReturnValue[]=new String[UniqueProductsSaleSummry.length];

        String LineSkuWise[]=new String[UniqueProductsSaleSummry.length];


        for (int kk = 0; kk < UniqueProductsSaleSummry.length; kk++)
        {
            val="";
            SummryPName="";
            SDisplayUnit="";
            String getVal="";
            getVal=UniqueProductsSaleSummry[kk].toString().trim();

            StringTokenizer tokens = new StringTokenizer(String.valueOf(getVal), "^");
            SummryPName=tokens.nextToken().trim();
            val=tokens.nextToken().trim();
            SDisplayUnit=tokens.nextToken().trim();
            //SDisplayName=tokens.nextToken().trim();
            //////////// System.out.println("SummryPName"+SummryPName);
            //////////// System.out.println("SDisplayUnit"+SDisplayUnit);

            SummryProductName[kk]=SummryPName;
            SummryDisplayUnit[kk]=SDisplayUnit;
            ////////////// System.out.println("SummryProductName[kk]"+SummryProductName[kk]);
            //////////// System.out.println("SummryProductName val"+val);


            LineSkuWise[kk]=fnCalculateLinesSkuWise(SummryPName);

            //if(val.contains("0g"))
            if(SDisplayUnit.contains("Kg"))
            {

                Cursor cursor2 = db.rawQuery("SELECT Sum(OrderQty),Sum(FreeQty),Sum(SampleQuantity) FROM  tblTmpInvoiceDetails where ProductShortName ='" + SummryPName + "'", null);
                try {
                    //val=val.replace("g", "");
                    if (cursor2.getCount() > 0)
                    {


                        if (cursor2.moveToFirst())
                        {

                            for (int i = 0; i < cursor2.getCount(); i++)
                            {

                                if (!cursor2.isNull(LoncolumnIndex))
                                {
                                    SumOQty[kk]=""+ Integer.parseInt(cursor2.getString(LoncolumnIndex));
                                    //////////// System.out.println("SummryPName SumOQty[kk]"+SumOQty[kk]);
                                    String OrderKG=	"" + (Integer.parseInt(cursor2.getString(LoncolumnIndex)) * Integer.parseInt(val));
                                    //////////// System.out.println("SummryPName OrderKG"+OrderKG);
                                    SumOQtyKG[kk] =ConvertGramToKilo(OrderKG);
                                    //	cursor2.moveToNext();
                                }
                                else
                                {
                                    SumOQty[kk]=""+ "0";
                                    SumOQtyKG[kk] ="" +"0.0";
                                }

                                if (!cursor2.isNull(LoncolumnIndex1))
                                {
                                    SumFQty[kk] ="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex1)));
                                    String FreeKG="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex1)) * Integer.parseInt(val));

                                    SumFQtyKG[kk] =ConvertGramToKilo(FreeKG);

                                    //	cursor2.moveToNext();
                                }
                                else
                                {
                                    SumFQty[kk] ="" +"0";
                                    SumFQtyKG[kk] ="0.0";
                                }
                                if (!cursor2.isNull(LoncolumnIndex2))
                                {
                                    SumSQty[kk] ="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex2)));
                                    String SampleKG="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex2)) * Integer.parseInt(val));
                                    SumSQtyKG[kk] =ConvertGramToKilo(SampleKG);

                                }
                                else
                                {
                                    SumSQty[kk] ="0";
                                    SumSQtyKG[kk] ="0.0";
                                }
                                cursor2.moveToNext();
                            }

                        }
                    }

                } finally {
                    cursor2.close();
                }

            }
            //if(val.contains("0ml"))
            if(SDisplayUnit.contains("Lt"))
            {

                Cursor cursor2 = db.rawQuery("SELECT Sum(OrderQty),Sum(FreeQty),Sum(SampleQuantity) FROM  tblTmpInvoiceDetails where ProductShortName ='" + SummryPName + "'", null);
                try {
                    //val=val.replace("ml", "");
                    if (cursor2.getCount() > 0)
                    {


                        if (cursor2.moveToFirst())
                        {

                            for (int i = 0; i < cursor2.getCount(); i++)
                            {

                                if (!cursor2.isNull(LoncolumnIndex))
                                {
                                    SumOQty[kk]=""+ Integer.parseInt(cursor2.getString(LoncolumnIndex));
                                    String OrderKG=	"" + (Integer.parseInt(cursor2.getString(LoncolumnIndex)) * Integer.parseInt(val));
                                    SumOQtyKG[kk] =ConvertMLToLiters(OrderKG);

                                }
                                else
                                {
                                    SumOQty[kk]=""+ "0";
                                    SumOQtyKG[kk] ="" +"0.0";
                                }

                                if (!cursor2.isNull(LoncolumnIndex1))
                                {
                                    SumFQty[kk] ="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex1)));
                                    String FreeKG="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex1)) * Integer.parseInt(val));
                                    SumFQtyKG[kk] =ConvertMLToLiters(FreeKG);

                                }
                                else
                                {
                                    SumFQty[kk] ="" +"0";
                                    SumFQtyKG[kk] ="0.0";
                                }
                                if (!cursor2.isNull(LoncolumnIndex2))
                                {
                                    SumSQty[kk] ="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex2)));
                                    String SampleKG="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex2)) * Integer.parseInt(val));
                                    SumSQtyKG[kk] =ConvertMLToLiters(SampleKG);

                                }
                                else
                                {
                                    SumSQty[kk] ="0";
                                    SumSQtyKG[kk] ="0.0";
                                }
                                cursor2.moveToNext();
                            }

                        }
                    }

                } finally {
                    cursor2.close();
                }

            }
        }



        String strGettblSyncSummuryDetailsKGLitersDetails[];//="";
        strGettblSyncSummuryDetailsKGLitersDetails=fnGettblSyncProductWiseDetailsKGLitersDetails();

        //////////// System.out.println("strGettblSyncSummuryDetailsKGLitersDetails :"+ strGettblSyncSummuryDetailsKGLitersDetails.length);




        for (int kk = 0; kk < UniqueProductsSaleSummry.length; kk++)
        {

            //////////// System.out.println("Sunil Check Line UniqueProductsSaleSummry :"+UniqueProductsSaleSummry[kk]);

            if(strGettblSyncSummuryDetailsKGLitersDetails.length>0)
            {
                for (int in = 0; in < strGettblSyncSummuryDetailsKGLitersDetails.length; in++)
                {
//////////// System.out.println("Sunil Check LinestrGettblSyncSummuryDetailsKGLitersDetails :"+strGettblSyncSummuryDetailsKGLitersDetails[in]);

                    String SumOQtyofTable="";
                    String SumFQtyofTable="";
                    String SumSQtyofTable="";

                    String SumOQtyKGofTable="";
                    String SumFQtyKGofTable="";
                    String SumSQtyKGofTable="";
                    String SummryPNameofTable="";
                    String LineCountSKUWiseFromServer="";

                    StringTokenizer tokensofTable = new StringTokenizer(String.valueOf(strGettblSyncSummuryDetailsKGLitersDetails[in]), "^");
                    SummryPNameofTable=tokensofTable.nextToken().trim();
                    SumOQtyofTable=tokensofTable.nextToken().trim();
                    SumFQtyofTable=tokensofTable.nextToken().trim();
                    SumSQtyofTable=tokensofTable.nextToken().trim();
                    SumOQtyKGofTable=tokensofTable.nextToken().trim();
                    SumFQtyKGofTable=tokensofTable.nextToken().trim();
                    SumSQtyKGofTable=tokensofTable.nextToken().trim();
                    tokensofTable.nextToken().trim();

                    LineCountSKUWiseFromServer=tokensofTable.nextToken().trim();//For Line Count SKU Wise

                    // System.out.println("Sunil Check Line Server Parsing :"+Integer.parseInt(LineCountSKUWiseFromServer));


                    //SumOQtyKGofTable=Double.parseDouble(new DecimalFormat("##.##").format(SumOQtyKGofTable));
                    //SumFQtyKGofTable=Double.parseDouble(new DecimalFormat("##.##").format(SumFQtyKGofTable));
                    //	SumSQtyKGofTable=Double.parseDouble(new DecimalFormat("##.##").format(SumSQtyKGofTable));


                    //////////// System.out.println("SummryProductName[kk].toString().trim() :" +SummryProductName[kk].toString().trim());
                    //////////// System.out.println("SummryPNameofTable.trim() :"+ SummryPNameofTable.trim());
                    if(SummryProductName[kk].toString().trim().equals(SummryPNameofTable.trim()))
                    {
                        //////////// System.out.println("Condition matched");
                        SumOQty[kk]=""+(Integer.parseInt(SumOQty[kk])+Integer.parseInt(SumOQtyofTable));
                        SumFQty[kk]= ""+(Integer.parseInt(SumFQty[kk])+Integer.parseInt(SumFQtyofTable));
                        SumSQty[kk]= ""+(Integer.parseInt(SumSQty[kk])+Integer.parseInt(SumSQtyofTable));
                        // System.out.println("Sunil Check Line PDA :"+Integer.parseInt(LineSkuWise[kk]));
                        // System.out.println("Sunil Check Line Server :"+Integer.parseInt(LineCountSKUWiseFromServer));

                        LineSkuWise[kk]=""+(Integer.parseInt(LineSkuWise[kk])+Integer.parseInt(LineCountSKUWiseFromServer));//For Line Count SKU Wise

                        if(SummryDisplayUnit[kk].toString().contains("Kg"))
                        {
                            Double SumOQtyKGofTable11=Double.parseDouble(SumOQtyKG[kk]) + Double.parseDouble(SumOQtyKGofTable);
                            String a1=""+Double.parseDouble(new DecimalFormat("##.##").format(SumOQtyKGofTable11));

                            Double SumFQtyKGofTable11= Double.parseDouble(SumFQtyKG[kk]) + Double.parseDouble(SumFQtyKGofTable);
                            String a2=""+Double.parseDouble(new DecimalFormat("##.##").format(SumFQtyKGofTable11));

                            Double SumSQtyKGofTable11=Double.parseDouble(SumSQtyKG[kk]) + Double.parseDouble(SumSQtyKGofTable);
                            String a3=""+Double.parseDouble(new DecimalFormat("##.##").format(SumSQtyKGofTable11));
                            SumOQtyKG[kk]= ""+ a1 + " Kg";
                            SumFQtyKG[kk]= ""+ a2 + " Kg";
                            SumSQtyKG[kk]= ""+ a3 + " Kg";
                        }

                        if(SummryDisplayUnit[kk].toString().contains("Lt"))
                        {

                            Double SumOQtyKGofTable11=Double.parseDouble(SumOQtyKG[kk]) + Double.parseDouble(SumOQtyKGofTable);
                            String a1=""+Double.parseDouble(new DecimalFormat("##.##").format(SumOQtyKGofTable11));

                            Double SumFQtyKGofTable11= Double.parseDouble(SumFQtyKG[kk]) + Double.parseDouble(SumFQtyKGofTable);
                            String a2=""+Double.parseDouble(new DecimalFormat("##.##").format(SumFQtyKGofTable11));

                            Double SumSQtyKGofTable11=Double.parseDouble(SumSQtyKG[kk]) + Double.parseDouble(SumSQtyKGofTable);
                            String a3=""+Double.parseDouble(new DecimalFormat("##.##").format(SumSQtyKGofTable11));
                            SumOQtyKG[kk]= ""+ a1 + " Lt";
                            SumFQtyKG[kk]= ""+ a2 + " Lt";
                            SumSQtyKG[kk]= ""+ a3 + " Lt";
                        }

                        FinalReturnValue[kk]=SummryProductName[kk] + "^" + SumOQty[kk] + "^" + SumFQty[kk] + "^" + SumSQty[kk] + "^" + SumOQtyKG[kk] + "^" + SumFQtyKG[kk] + "^" + SumSQtyKG[kk]+ "^" + LineSkuWise[kk];
                        // System.out.println("Sunil Check Line return FinalReturnValue[kk] :" + FinalReturnValue[kk]);
                        break;

                    }
                }
            }
            else
            {
                FinalReturnValue[kk]=SummryProductName[kk] + "^" + SumOQty[kk] + "^" + SumFQty[kk] + "^" + SumSQty[kk] + "^" + SumOQtyKG[kk] + "^" + SumFQtyKG[kk] + "^" + SumSQtyKG[kk]+ "^" + LineSkuWise[kk];
                //////////// System.out.println("FinalReturnValue[kk] :" + FinalReturnValue[kk]);
            }

        }


        return FinalReturnValue;

    }

    public static String[] fnGettblSyncProductWiseDetailsKGLitersDetails() {

        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        int LoncolumnIndex2 = 2;
        int LoncolumnIndex3 = 3;
        int LoncolumnIndex4 = 4;
        int LoncolumnIndex5 = 5;
        int LoncolumnIndex6 = 6;
        int LoncolumnIndex7 = 7;
        int LoncolumnIndex8 = 8;


        Cursor cursor = db.rawQuery("SELECT * from tblSyncSummuryForProductDetails", null);

        try {
            String CompleteResult[] =new String[cursor.getCount()];// "0.0_0.0_0.0_0.0_0.0_0.0";

            ////// System.out.println("cursor.getCount() :"+cursor.getCount());
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {


                    for (int i = 0; i < cursor.getCount(); i++)
                    {

                        if (!cursor.isNull(LoncolumnIndex))
                        {
                            CompleteResult[i] =cursor.getString(LoncolumnIndex).toString() + "^" + cursor.getString(LoncolumnIndex1).toString() + "^" + cursor.getString(LoncolumnIndex2).toString() + "^" + cursor.getString(LoncolumnIndex3).toString() + "^" + cursor.getString(LoncolumnIndex4).toString() + "^" + cursor.getString(LoncolumnIndex5).toString() + "^" + cursor.getString(LoncolumnIndex6).toString() + "^" + cursor.getString(LoncolumnIndex7).toString()+ "^" + cursor.getString(LoncolumnIndex8).toString(); // the 8th one is for Line;
                            ////// System.out.println("ProductDetails sunil: "+(String) cursor.getString(LoncolumnIndex) + "  "+"Product sunil: "+(String) cursor.getString(LoncolumnIndex1));

                            cursor.moveToNext();
                        }

                    }


                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public static String ConvertGramToKilo(String strGrams)
    {
        //1 gram = 0.001 kilogram;
        String kilogram="";

        Double gram = Double.parseDouble(strGrams);
        kilogram ="" + (gram * 0.001);
        return kilogram;
    }

    public static String ConvertMLToLiters(String strML)
    {
        //1 gram = 0.001 kilogram;
        String Lt="";

        Double ML = Double.parseDouble(strML);
        Lt ="" + (ML * 0.001);
        return Lt;
    }

    public static String fnGetFullSummryDetailsForSale()
    {

        String FullSummryDetailsForSale;
        FullSummryDetailsForSale="";

        int TotActualCall=0;
        TotActualCall=fnGetActualCall();

        ////// System.out.println("TotActualCall: "	+ TotActualCall);

        int TotProductiveCall=0;
        TotProductiveCall=fnGetProductiveCall();

        ////// System.out.println("TotProductiveCall: "	+ TotProductiveCall);

        String TotSalesValue="0.00";
        TotSalesValue=fnGetTotalSales();//fnGetTotalDiscount


        String TotDiscountValue="0.00";
        TotDiscountValue=fnGetTotalDiscount();


        ////// System.out.println("TotSalesValue: "	+ TotSalesValue);
        ////// System.out.println("fnGetTotalDiscount: "	+ TotDiscountValue);
        String strGettblSyncSummuryDetailsCallDetails="";
        strGettblSyncSummuryDetailsCallDetails=fnGettblSyncSummuryDetailsCallDetails();
        ////// System.out.println("strGettblSyncSummuryDetailsCallDetails: "	+ strGettblSyncSummuryDetailsCallDetails);
        StringTokenizer tokensGettblSyncSummuryDetailsCallDetails = new StringTokenizer(String.valueOf(strGettblSyncSummuryDetailsCallDetails), "_");

        TotActualCall= TotActualCall + Integer.parseInt(tokensGettblSyncSummuryDetailsCallDetails.nextToken().trim());
        TotProductiveCall= TotProductiveCall + Integer.parseInt(tokensGettblSyncSummuryDetailsCallDetails.nextToken().trim());
        TotSalesValue="" + (Double.parseDouble(TotSalesValue) + Double.parseDouble(tokensGettblSyncSummuryDetailsCallDetails.nextToken().trim()));
        TotDiscountValue="" + (Double.parseDouble(TotDiscountValue) + Double.parseDouble(tokensGettblSyncSummuryDetailsCallDetails.nextToken().trim()));
        FullSummryDetailsForSale =TotActualCall + "_" + TotProductiveCall + "_" + TotSalesValue + "_" + TotDiscountValue;


        ////// System.out.println("FullSummryDetailsForSale: "	+ FullSummryDetailsForSale);

        return FullSummryDetailsForSale;
    }

    public static int fnGetActualCall()
    {

        int LoncolumnIndex = 0;
        int TotActualCall = 0;
        Cursor cursor2 = db.rawQuery("SELECT Count (StoreID) FROM tblTmpInvoiceHeader", null);
        try {
            if (cursor2.moveToFirst())
            {

                for (int i = 0; i < cursor2.getCount(); i++)
                {

                    if (!cursor2.isNull(LoncolumnIndex))
                    {
                        TotActualCall = Integer.parseInt(cursor2.getString(LoncolumnIndex).toString());
                        cursor2.moveToNext();
                    }

                }

            }
            return TotActualCall;
        } finally {
            cursor2.close();
        }
    }

    public static int fnGetProductiveCall()
    {
        int LoncolumnIndex = 0;
        int TotProductiveCall = 0;

        Double TotInvoiceValCall = 0.00;
        Cursor cursor2 = db.rawQuery("SELECT Count (StoreID) FROM tblTmpInvoiceHeader where InvoiceVal >" + TotInvoiceValCall, null);
        try {
            if (cursor2.moveToFirst())
            {

                for (int i = 0; i < cursor2.getCount(); i++)
                {

                    if (!cursor2.isNull(LoncolumnIndex))
                    {
                        TotProductiveCall = Integer.parseInt(cursor2.getString(LoncolumnIndex).toString());
                        cursor2.moveToNext();
                    }

                }

            }
            return TotProductiveCall;
        } finally {
            cursor2.close();
        }
    }

    public static String fnGetTotalSales()
    {
        int LoncolumnIndex = 0;
        String TotSalesValue = "0.0";


        Cursor cursor2 = db.rawQuery("SELECT SUM(InvoiceVal) FROM tblTmpInvoiceHeader", null);
        try {
            if (cursor2.moveToFirst())
            {

                for (int i = 0; i < cursor2.getCount(); i++)
                {

                    if (!cursor2.isNull(LoncolumnIndex))
                    {
                        TotSalesValue =""+ Double.parseDouble(cursor2.getString(LoncolumnIndex).toString());
                        ////// System.out.println("Abhinav Raj Summary New TotSalesValue from function: "+TotSalesValue);
                        cursor2.moveToNext();
                    }

                }

            }
            return TotSalesValue.replace(",", "");//(TotSalesValue, ",");
        } finally {
            cursor2.close();
        }
    }

    public static String fnGetTotalDiscount()
    {
        int LoncolumnIndex = 0;
        String TotDiscountValue = "0.0";


        Cursor cursor2 = db.rawQuery("SELECT SUM(TotalDis) FROM tblTmpInvoiceHeader", null);
        try {
            if (cursor2.moveToFirst())
            {

                for (int i = 0; i < cursor2.getCount(); i++)
                {

                    if (!cursor2.isNull(LoncolumnIndex))
                    {
                        TotDiscountValue =""+ Double.parseDouble(cursor2.getString(LoncolumnIndex).toString());
                        cursor2.moveToNext();
                    }

                }

            }
            return TotDiscountValue;
        } finally {
            cursor2.close();
        }
    }

    public static String fnGettblSyncSummuryDetailsCallDetails() {

        Cursor cursor = db.rawQuery("SELECT ActualCalls, ProductiveCalls, TotSalesValue, TotDiscountKGSales from tblSyncSummuryDetails", null);

        try {
            String CompleteResult = "0_0_0.0_0.0";
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    CompleteResult = (String) cursor.getString(0).toString()
                            + "_"
                            + (String) cursor.getString(1).toString()
                            + "_"
                            + (String) cursor.getString(2).toString()
                            + "_"
                            + (String) cursor.getString(3).toString();

                    cursor.moveToNext();

                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public static String fnCalculateKGLiters()
    {
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        int LoncolumnIndex2 = 2;
        String[] UniqueKgLiters;
        UniqueKgLiters=fnarrUniqueKgLiters();//fnarrUniqueKgLitersDisplayUnit();
        String val="";
        String totalKGSales="0.0";
        String totalSampleSalesKG="0.0";
        String totalFreeQtySalesKG="0.0";
        String totalLitersSales="0.0";
        String totalSampleSalesLT="0.0";
        String totalFreeQtySalesLT="0.0";
        String totalDiscountLT="0.0";
        String totalDiscountKG="0.0";


        String totalOverallKGSales="0.0";
        String totalOverallSampleSalesKG="0.0";
        String totalOverallFreeQtySalesKG="0.0";
        String totalOverallLitersSales="0.0";
        String totalOverallSampleSalesLT="0.0";
        String totalOverallFreeQtySalesLT="0.0";
        String totalOverallDiscountLT="0.0";
        String totalOverallDiscountKG="0.0";

        String FinalReturnValue="";
        String ppName="";
        String pDisplayUnit="";
        for (int kk = 0; kk < UniqueKgLiters.length; kk++)
        {
            StringTokenizer tokensUniqueKgLiters = new StringTokenizer(String.valueOf(UniqueKgLiters[kk]), "^");

            ppName= tokensUniqueKgLiters.nextToken().trim();

            val="";
            val=tokensUniqueKgLiters.nextToken().trim();//UniqueKgLiters[kk].toString().trim();

            // change by sunil
            //val="0";
            //// System.out.println("Abhi UniqueKgLiters[kk] :"+UniqueKgLiters[kk]);

            pDisplayUnit=tokensUniqueKgLiters.nextToken().trim();
            //// System.out.println("Abhi pDisplayUnit:" +pDisplayUnit);
            //if(val.contains("0g"))
            if(pDisplayUnit.contains("Kg"))
            {
                //// System.out.println("Abhi getting Kg");
                Cursor cursor2 = db.rawQuery("SELECT Sum(OrderQty),Sum(FreeQty),Sum(SampleQuantity),Sum(DisVal) FROM  tblTmpInvoiceDetails where ProductShortName='" + ppName + "'", null);
                try {
                    //val=val.replace("g", "");
                    if (cursor2.getCount() > 0)
                    {


                        if (cursor2.moveToFirst())
                        {

                            for (int i = 0; i < cursor2.getCount(); i++)
                            {
                                totalKGSales="0.0";
                                totalFreeQtySalesKG="0.0";
                                totalSampleSalesKG="0.0";
                                if (!cursor2.isNull(LoncolumnIndex))
                                {
                                    totalKGSales ="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex)) * Integer.parseInt(val));
                                    //	cursor2.moveToNext();

                                    ////// System.out.println("AbhiSunil  Product Short Name:" +val +":-totalKGSales-:"+ totalKGSales);
                                }

                                if (!cursor2.isNull(LoncolumnIndex1))
                                {
                                    totalFreeQtySalesKG ="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex1)) * Integer.parseInt(val));
                                    //	cursor2.moveToNext();
                                    ////// System.out.println("AbhiSunil  Product Short Name:" +val +":-totalFreeQtySalesKG-:"+ totalFreeQtySalesKG);
                                }
                                if (!cursor2.isNull(LoncolumnIndex2))
                                {
                                    totalSampleSalesKG ="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex2)) * Integer.parseInt(val));

                                    ////// System.out.println("AbhiSunil  Product Short Name:" +val +":-totalSampleSalesKG-:"+ totalSampleSalesKG);
                                    //
                                }


                                //Write Here

                                totalOverallKGSales="" + (Double.parseDouble(totalOverallKGSales) + Double.parseDouble(totalKGSales));
                                //////// System.out.println("AbhiSunil  totalOverallKGSales-:"+ totalOverallKGSales);
                                totalOverallFreeQtySalesKG="" + (Double.parseDouble(totalOverallFreeQtySalesKG) + Double.parseDouble(totalFreeQtySalesKG));
                                //////// System.out.println("AbhiSunil  totalOverallFreeQtySalesKG-:"+ totalOverallFreeQtySalesKG);
                                totalOverallSampleSalesKG="" + (Double.parseDouble(totalOverallSampleSalesKG) + Double.parseDouble(totalSampleSalesKG));
                                cursor2.moveToNext();
                            }

                        }
                    }

                } finally {
                    cursor2.close();
                }

            }
            //if(val.contains("0ml"))
            if(pDisplayUnit.contains("Lt"))
            {
                //// System.out.println("Abhi getting Liter");

                Cursor cursor2 = db.rawQuery("SELECT Sum(OrderQty),Sum(FreeQty),Sum(SampleQuantity),Sum(DisVal) FROM  tblTmpInvoiceDetails where ProductShortName ='" + ppName + "'", null);
                try {
                    //// System.out.println("Abhi  cursor2.getCount() :"+cursor2.getCount());
                    //val=val.replace("ml", "");
                    if (cursor2.getCount() > 0)
                    {


                        if (cursor2.moveToFirst())
                        {

                            for (int i = 0; i < cursor2.getCount(); i++)
                            {
                                totalLitersSales="0.0";
                                totalSampleSalesLT="0.0";
                                totalFreeQtySalesLT="0.0";

                                if (!cursor2.isNull(LoncolumnIndex))
                                {

                                    totalLitersSales ="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex)) * Integer.parseInt(val));
                                    //	////// System.out.println("totalLitersSales :"+totalLitersSales);
                                    totalOverallLitersSales="" + (Double.parseDouble(totalOverallLitersSales) + Double.parseDouble(totalLitersSales));

                                    //// System.out.println("Abhi  totalOverallLitersSales :"+totalOverallLitersSales +" index :"+LoncolumnIndex);
                                    //cursor2.moveToNext();
                                }

                                if (!cursor2.isNull(LoncolumnIndex1))
                                {
                                    totalFreeQtySalesLT ="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex1)) * Integer.parseInt(val));
                                    //////// System.out.println("totalFreeQtySalesLT :"+totalFreeQtySalesLT);
                                    totalOverallFreeQtySalesLT="" + (Double.parseDouble(totalOverallFreeQtySalesLT) + Double.parseDouble(totalFreeQtySalesLT));

                                    //// System.out.println("Abhi  totalOverallLitersSales :"+totalOverallLitersSales +" index :"+LoncolumnIndex);
                                    //cursor2.moveToNext();
                                }
                                if (!cursor2.isNull(LoncolumnIndex2))
                                {
                                    totalSampleSalesLT ="" + (Integer.parseInt(cursor2.getString(LoncolumnIndex2)) * Integer.parseInt(val));
                                    totalOverallSampleSalesLT="" + (Double.parseDouble(totalOverallSampleSalesLT) + Double.parseDouble(totalSampleSalesLT));

                                    //// System.out.println("Abhi  totalOverallLitersSales :"+totalOverallLitersSales +" index :"+LoncolumnIndex);
                                    //	////// System.out.println("totalSampleSalesLT :"+totalSampleSalesLT);
                                }



                                cursor2.moveToNext();
                            }

                        }
                    }

                } finally {
                    cursor2.close();
                }


            }
        }

        //// System.out.println("Abhi Sunil  totalOverallKGSales Before:" +totalOverallKGSales);
        //// System.out.println("Abhi Sunil  totalOverallFreeQtySalesKG Before:" +totalOverallFreeQtySalesKG);
        //// System.out.println("Abhi Sunil  totalOverallSampleSalesKG Before:" +totalOverallSampleSalesKG);

        totalOverallKGSales= ConvertGramToKilo(totalOverallKGSales);

        totalOverallFreeQtySalesKG= ConvertGramToKilo(totalOverallFreeQtySalesKG);

        totalOverallSampleSalesKG= ConvertGramToKilo(totalOverallSampleSalesKG);

        //// System.out.println("Abhi Sunil  totalOverallKGSales After:" +totalOverallKGSales);
        //// System.out.println("Abhi Sunil  totalOverallFreeQtySalesKG After:" +totalOverallFreeQtySalesKG);
        //// System.out.println("Abhi Sunil  totalOverallSampleSalesKG After:" +totalOverallSampleSalesKG);
        totalOverallLitersSales=ConvertMLToLiters(totalOverallLitersSales);

        totalOverallFreeQtySalesLT=ConvertMLToLiters(totalOverallFreeQtySalesLT);
        //// System.out.println("Abhi Sunil totalOverallFreeQtySalesLT : "+totalOverallFreeQtySalesLT);
        totalOverallSampleSalesLT=ConvertMLToLiters(totalOverallSampleSalesLT);

        String strGettblSyncSummuryDetailsKGLitersDetails="";
        strGettblSyncSummuryDetailsKGLitersDetails=fnGettblSyncSummuryDetailsKGLitersDetails();

        StringTokenizer tokensGettblSyncSummuryDetailsKGLitersDetails = new StringTokenizer(String.valueOf(strGettblSyncSummuryDetailsKGLitersDetails), "_");

        totalOverallKGSales= "" + (Double.parseDouble(totalOverallKGSales) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));
        totalOverallFreeQtySalesKG= "" + (Double.parseDouble(totalOverallFreeQtySalesKG) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));
        totalOverallSampleSalesKG= "" + (Double.parseDouble(totalOverallSampleSalesKG) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));
        totalOverallLitersSales= "" + (Double.parseDouble(totalOverallLitersSales) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));
        totalOverallFreeQtySalesLT= "" + (Double.parseDouble(totalOverallFreeQtySalesLT) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));
        totalOverallSampleSalesLT= "" + (Double.parseDouble(totalOverallSampleSalesLT) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));


        Double DtotalOverallKGSales =  Double.parseDouble(totalOverallKGSales);
        DtotalOverallKGSales= Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallKGSales));

        Double DtotalOverallFreeQtySalesKG = Double.parseDouble(totalOverallFreeQtySalesKG);
        DtotalOverallFreeQtySalesKG= Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallFreeQtySalesKG));

        Double DtotalOverallSampleSalesKG = Double.parseDouble(totalOverallSampleSalesKG);
        DtotalOverallSampleSalesKG= Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallSampleSalesKG));

        Double DtotalOverallLitersSales =  Double.parseDouble(totalOverallLitersSales);
        DtotalOverallLitersSales= Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallLitersSales));

        Double DtotalOverallFreeQtySalesLT = Double.parseDouble(totalOverallFreeQtySalesLT);
        DtotalOverallFreeQtySalesLT= Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallFreeQtySalesLT));

        Double DtotalOverallSampleSalesLT =Double.parseDouble(totalOverallSampleSalesLT);
        DtotalOverallSampleSalesLT= Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallSampleSalesLT));


        //DtotalOverallKGSales = Double.parseDouble(decimalFormat.format(DtotalOverallKGSales));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallKGSales));
        FinalReturnValue= FinalReturnValue + DtotalOverallKGSales + " Units";

        // DtotalOverallFreeQtySalesKG =Double.parseDouble(decimalFormat.format(DtotalOverallFreeQtySalesKG));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallFreeQtySalesKG));
        FinalReturnValue= FinalReturnValue + "^" + DtotalOverallFreeQtySalesKG + " Units";

        // DtotalOverallSampleSalesKG =Double.parseDouble(decimalFormat.format(DtotalOverallSampleSalesKG));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallSampleSalesKG));
        FinalReturnValue= FinalReturnValue + "^" + DtotalOverallSampleSalesKG + " Units";

        // DtotalOverallLitersSales = Double.parseDouble(decimalFormat.format(DtotalOverallLitersSales));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallLitersSales));
        FinalReturnValue= FinalReturnValue + "^" + DtotalOverallLitersSales + " LT";

        // DtotalOverallFreeQtySalesLT = Double.parseDouble(decimalFormat.format(DtotalOverallFreeQtySalesLT));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallFreeQtySalesLT));
        FinalReturnValue= FinalReturnValue + "^" + DtotalOverallFreeQtySalesLT + " LT";

        //DtotalOverallSampleSalesLT = Double.parseDouble(decimalFormat.format(DtotalOverallSampleSalesLT));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallSampleSalesLT));
        FinalReturnValue= FinalReturnValue + "^" + DtotalOverallSampleSalesLT + " LT";


        //FinalReturnValue= "" + DtotalOverallKGSales + " KG" + "^" + DtotalOverallFreeQtySalesKG + " KG" + "^" + DtotalOverallSampleSalesKG + " KG" + "^" + DtotalOverallLitersSales + " LT" + "^" + DtotalOverallFreeQtySalesLT + " LT" + "^" + DtotalOverallSampleSalesLT + " LT";
        //// System.out.println("Abhi  FinalReturnValue :"+FinalReturnValue);
        return FinalReturnValue;

    }

    public static String[] fnarrUniqueKgLiters()
    {
        int LoncolumnIndex = 0;



        Cursor cursor2 = db.rawQuery("SELECT DISTINCT ProductShortName,KGLiter,DisplayUnit FROM tblProductListMaster", null);
        try {
            String UniqueKgLiters[] = new String[cursor2.getCount()];
            if (cursor2.moveToFirst())
            {

                for (int i = 0; i < cursor2.getCount(); i++)
                {

                    if (!cursor2.isNull(LoncolumnIndex))
                    {
                        UniqueKgLiters[i] =cursor2.getString(LoncolumnIndex).toString()+"^"+cursor2.getString(1).toString()+"^"+cursor2.getString(2).toString();
                        cursor2.moveToNext();
                    }

                }

            }
            return UniqueKgLiters;
        } finally {
            cursor2.close();
        }
    }

    public static String fnGettblSyncSummuryDetailsKGLitersDetails() {



        Cursor cursor = db.rawQuery("SELECT TotKGSales,TotFreeQtyKGSales,TotSampleKGSales,TotLTSales,TotFreeQtyLTSales,TotSampleLTSales,TotDiscountKGSales,TotDiscountLTales from tblSyncSummuryDetails", null);

        try {
            String CompleteResult = "0.0_0.0_0.0_0.0_0.0_0.0_0.0_0.0";
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    CompleteResult = (String) cursor.getString(0).toString()
                            + "_"
                            + (String) cursor.getString(1).toString()
                            + "_"
                            + (String) cursor.getString(2).toString()
                            + "_"
                            + (String) cursor.getString(3).toString()
                            + "_"
                            + (String) cursor.getString(4).toString()
                            + "_"
                            + (String) cursor.getString(5).toString()
                            + "_"
                            + (String) cursor.getString(6).toString()
                            + "_"
                            + (String) cursor.getString(7).toString();

                    cursor.moveToNext();

                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public static void deleteAllSubmitDataToServer(int Sstat)
    {
        //open();
        db.execSQL("DELETE FROM tblTransac WHERE Sstat ="+ Sstat);
        db.execSQL("DELETE FROM tblTmpInvoiceHeader WHERE Sstat ="+ Sstat);
        db.execSQL("DELETE FROM tblStoreList WHERE Sstat ="+ Sstat);

        db.execSQL("DELETE FROM tblNewStoreListEntries WHERE Sstat ="+ Sstat);
        db.execSQL("DELETE FROM tblStoreProductAppliedSchemesBenifitsRecords WHERE Sstat ="+ Sstat);
        db.execSQL("DELETE FROM tblTmpInvoiceDetails WHERE Sstat ="+ Sstat);


        db.execSQL("DELETE FROM tblNewStoreEntries WHERE Sstat ="+ Sstat);
        db.execSQL("DELETE FROM tblOutletQuestAnsMstr WHERE Sstat ="+ Sstat);


        db.execSQL("DELETE FROM tblStoreMaterialDetail WHERE Sstat ="+ Sstat);

        db.execSQL("DELETE FROM tblStoreMaterialPhotoDetail WHERE Sstat ="+ Sstat);
        db.execSQL("DELETE FROM tblStoreReturnDetail WHERE Sstat ="+ Sstat);
        db.execSQL("DELETE FROM tblStoreProductPhotoDetail WHERE Sstat ="+ Sstat);



       // close();
    }

    public static void updateRecordsSyncStoreProductReturn() {
        try {
            final ContentValues values = new ContentValues();
            values.put("Sstat", "4");
            int affected = db.update("tblStoreReturnDetail", values, "Sstat=?",
                    new String[] { "3" });
            int affected1 = db.update("tblStoreProductPhotoDetail", values, "Sstat=?",
                    new String[] { "3" });

        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }
    }

    public static void updateRecordsSyncd(int Sstat) {

        try {
            // ////// System.out.println("No. of non-synced records: " +
            // countNonSynced());

            // if (countNonSynced() > 0) {

            Log.w(TAG, "Updating Synced Records..");

            final ContentValues values = new ContentValues();
            values.put("Sstat", Sstat);

            if(Sstat==4) {
                int affected71 = db.update("tblStoreCloseLocationDetails", values, "Sstat=?",
                        new String[] { "3" });
                int affected72 = db.update("tblStoreClosedPhotoDetail", values, "Sstat=?",
                        new String[] { "3" });
                int affected73 = db.update("tblStoreCloseReasonSaving", values, "Sstat=?",
                        new String[] { "3" });

            }


            int affected = db.update("tblTransac", values, "Sstat=?",
                    new String[] { "5" });
          //  int affected2 = db.update("tblTmpInvoiceHeader", values, "Sstat=?",
          //          new String[] { "5" });
            int affected3 = db.update("tblStoreList", values, "Sstat=?",
                    new String[] { "5" });
            int affected4 = db.update("tblNewStoreListEntries", values,
                    "Sstat=?", new String[] { "5" });


            int affected7 = db.update("tblStoreProductAppliedSchemesBenifitsRecords", values,
                    "Sstat=?", new String[] { "5" });
        //    int affected8 = db.update("tblTmpInvoiceDetails", values,
         //           "Sstat=?", new String[] { "5" });


            int affected9 = db.update("tblNewStoreEntries", values,
                    "Sstat=?", new String[] { "5" });


            int affected10 = db.update("tblTemp", values,
                    "Sstat=?", new String[] { "5" });

            int affected11 = db.update("tblProductMappedWithSchemeSlabApplied", values,
                    "Sstat=?", new String[] { "5" });

            int affected12 = db.update("tblOutletQuestAnsMstr", values,"Sstat=?", new String[] { "3" });
            int affected121 = db.update("tblNewAddedStoreLocationDetails", values, "Sstat=?", new String[] { "3" });
            int affected13 = db.update("tblStoreMaterialDetail", values,"Sstat=?", new String[] { "5" });

            int affected14 = db.update("tblStoreMaterialPhotoDetail", values,"Sstat=?", new String[] { "5" });


            int affected15 = db.update("tblNoVisitStoreDetails", values,"Sstat=?", new String[] { "5" });

            int affected16 = db.update("tblPDANotificationMaster", values,
                    "Sstat=?", new String[] { "5" });

            int affected17 = db.update("tblAllCollectionData", values,
                    "Sstat=?", new String[] { "5" });





            Log.w(TAG, "affected records: " + affected + " in 1st Table, "
                   + " in 2nd table, " + affected3
                    //+ " in 3rd table(tblStoreList)" + affected4
						/*+ " in 4th table(tblNewStoreListEntries)" + affected5
						+ " in 5th table(tblPDAProductReturnMstr)" + affected6*/
                    + " in 6th table(tblPDAProductReturnDetails)");

            Log.w(TAG, "Synced Records Updated..");
            // } else {
            // Log.w(TAG, "Non-Synced Records not Found..");
            // }

        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }

    public static void AddNewStore(String strNewAddedStoreIDFlg, String RetailerName,
                            String OwnerName, String Address, String StoreType,String fDate,String phoneSendValue,String ActualLatitude, String ActualLongitude, String Accuracy,
                            String LocProvider,String BateryLevel)
    {/*
			if (Integer.parseInt(strNewAddedStoreIDFlg) == 0)
			{
				int MaxAutoStore = 0;
				int cntTotStore=0;
				cntTotStore=fnGetCountForNewStore();
				String strGetMaxIDForNewStore="0";
				String activeRid;
				activeRid = GetActiveRouteID();
				if(cntTotStore>0)
				{
				MaxAutoStore = fnGetMaxAutoStoreIncrementForNewStore();
				MaxAutoStore = MaxAutoStore + 1;
				strGetMaxIDForNewStore = fnGetMaxIdWithIncrementForNewStore(MaxAutoStore);
				}
				else
				{
					MaxAutoStore=0;
					MaxAutoStore = MaxAutoStore + 1;

					strGetMaxIDForNewStore = "-000^" + (1) + "$"
							+ MaxAutoStore;

				}
				////// System.out.println("MaxAutoStore.. " + MaxAutoStore);


				////// System.out.println("MaxAutoStore. After Increment . "+ MaxAutoStore);


				////// System.out.println("New Added Store Name . "+ strGetMaxIDForNewStore);

				if (!strGetMaxIDForNewStore.equals("")
						|| !strGetMaxIDForNewStore.equals(null)) {

					////// System.out.println("fDate vlaue by sunil"+fDate);
					////// System.out.println("strGetMaxIDForNewStore.trim() vlaue by sunil"+strGetMaxIDForNewStore.trim());
					////// System.out.println("StoreType vlaue by sunil"+StoreType.trim());

					////// System.out.println("RetailerName vlaue by sunil"+RetailerName.trim());

					////// System.out.println("MaxAutoStore vlaue by sunil"+MaxAutoStore);


					saveSOAPdataStoreListNewStore(strGetMaxIDForNewStore.trim(), StoreType.trim(), RetailerName.trim(), Double.parseDouble(ActualLatitude), Double.parseDouble(ActualLongitude), "", "", fDate, MaxAutoStore,1,Accuracy,LocProvider,activeRid,BateryLevel); // in last parameter Fdate

					fnUpdateFlgForNewSoreInMainStoreTable(strGetMaxIDForNewStore);
					//fnInsertStoreIfNotExistIntblDaySummary(strGetMaxIDForNewStore);//On Store Selection VisitStart Activity
					////// System.out.println("strGetMaxIDForNewStore"+strGetMaxIDForNewStore.trim());
					////// System.out.println("RetailerName"+RetailerName.toString().trim());

					////// System.out.println("OwnerName"+OwnerName.toString().trim());

					////// System.out.println("Address"+Address.toString().trim());

					////// System.out.println("PinCode"+PinCode.toString().trim());

					////// System.out.println("StoreType"+StoreType.toString().trim());

					////// System.out.println("Location"+Location.toString().trim());

					////// System.out.println("Area"+Area.toString().trim());

					saveSOAPdataStoreListDetailsInNewTable(strGetMaxIDForNewStore.trim(), RetailerName.toString().trim(), OwnerName.toString().trim(), Address.toString().trim(),phoneSendValue,ActualLatitude,ActualLongitude,Accuracy,LocProvider,activeRid);

				}
			}
		*/}

    public static int fnGetMaxAutoStoreIncrementForNewStore() {

        int LoncolumnIndex = 0;
        int strAutoIdStore = 0;

        Cursor cursor2 = db.rawQuery(
                "SELECT Max(AutoIdStore) FROM tblStoreList", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strAutoIdStore = Integer.parseInt(cursor2
                            .getString(LoncolumnIndex));
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strAutoIdStore;
        } finally {
            cursor2.close();
        }

    }

    public static int fnGetCountForNewStore() {

        int LoncolumnIndex = 0;
        int strStore = 0;

        Cursor cursor2 = db.rawQuery(
                "SELECT Count(*) FROM tblStoreList", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strStore = Integer.parseInt(cursor2
                            .getString(LoncolumnIndex));
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strStore;
        } finally {
            cursor2.close();
        }

    }

    public static String fnGetMaxIdWithIncrementForNewStore(int MaxAutoStore) {

        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        String strLastMaxStoreId = "0";
        String nn = "";
        // String strLastMaxAutoStoreId="0";

        Cursor cursor2 = db
                .rawQuery(
                        "SELECT StoreID FROM tblStoreList order by AutoIdStore Desc Limit 1",
                        null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strLastMaxStoreId = cursor2.getString(LoncolumnIndex);
                    // strLastMaxAutoStoreId=
                    // cursor2.getString(LoncolumnIndex1);
                    cursor2.moveToNext();
                    // cursor.close();
                }
                strLastMaxStoreId = strLastMaxStoreId.replace("-", "");

                if (strLastMaxStoreId.contains("^")) {
                    StringTokenizer tokensSchstrLastMaxStoreIdNew = new StringTokenizer(
                            String.valueOf(strLastMaxStoreId), "^");
                    nn = tokensSchstrLastMaxStoreIdNew.nextToken().trim();
                    strLastMaxStoreId = tokensSchstrLastMaxStoreIdNew
                            .nextToken().trim();
                }
                if (strLastMaxStoreId.contains("$")) {
                    StringTokenizer tokensSchstrLastMaxStoreId = new StringTokenizer(
                            String.valueOf(strLastMaxStoreId), "$");

                    strLastMaxStoreId = tokensSchstrLastMaxStoreId.nextToken()
                            .trim();
                }

                strLastMaxStoreId = "-000^" + (strLastMaxStoreId) + "$"
                        + MaxAutoStore;
            }
            return strLastMaxStoreId;
        } finally {
            cursor2.close();
        }

    }

    public static long saveSOAPdataStoreListNewStore(String sCode, String sType, String sName,
                                              Double sLat, Double sLon, String LVdate, String LTdate,
                                              String sForDate, int AutoIdStore, int newStat, String Accuracy, String LocProvider,
                                              String activeRid,String BateryLevel,int IsNewStoreDataCompleteSaved,String fetchAddress,
                                              String PaymentStage,int flgHasQuote,int flgAllowQuotation,int flgSubmitFromQuotation
            ,String flgGSTCapture,String flgGSTCompliance,String GSTNumber,int flgGSTRecordFromServer, int flgLocationServicesOnOff, int flgGPSOnOff, int flgNetworkOnOff, int flgFusedOnOff, int flgInternetOnOffWhileLocationTracking, int flgRestart, int flgStoreOrder, String StoreCity,String StorePinCode, String StoreState,String DBR,String OwnerName,String StoreContactNo,String StoreCatType,int flgRuleTaxVal,int flgTransType,String SalesPersonName,String  SalesPersonContactNo,int IsComposite,int StoreStateID,int  StoreCityID) {


        int flgIfStoreHasRecords=0;
        try {
            flgIfStoreHasRecords=CheckTotalStoreCount();
        }
        catch (Exception ex)
        {

        }

        ContentValues initialValues = new ContentValues();
        ////// System.out.println("Saved code:" + sCode + "Saved name:" + "" + sName);
        long syncTIMESTAMP = System.currentTimeMillis();
        Date dateobj = new Date(syncTIMESTAMP);
        SimpleDateFormat df = new SimpleDateFormat("dd-MMM-yyyy HH:mm:ss",Locale.ENGLISH);
        String startTS = df.format(dateobj);

        activeRid = GetActiveRouteID();
        String RouteNodeType=FetchRouteType(activeRid);

        initialValues.put("IMEINumber", CommonInfo.imei);
        initialValues.put("StoreID", sCode.trim());

        initialValues.put("OwnerName", OwnerName);
        initialValues.put("StoreContactNo", StoreContactNo);
        initialValues.put("StoreCatType", StoreCatType);

        initialValues.put("OutStanding", "0.00");
        initialValues.put("OverDue", "0.00");
        initialValues.put("flgRuleTaxVal", flgRuleTaxVal);

        initialValues.put("SalesPersonName", SalesPersonName);
        initialValues.put("SalesPersonContact", SalesPersonContactNo);


        initialValues.put("chainID", 1);


        initialValues.put("StoreType", sType);
        initialValues.put("StoreName", sName.trim());
       // initialValues.put("ActualLatitude", ""+sLat);
       // initialValues.put("ActualLongitude",""+ sLon);
        initialValues.put("StoreLatitude", sLat);
        initialValues.put("StoreLongitude", sLon);
        initialValues.put("LastVisitDate", "NA");
        initialValues.put("LastTransactionDate","NA");
        initialValues.put("Sstat", newStat);
        initialValues.put("ISNewStore", 1);
       initialValues.put("StoreClose", 0);
        //initialValues.put("StoreNextDay", 0);
        // System.out.println("DateTimeNitish fnDBkenya saveSOAPdataStoreListNewStore = "+startTS);
      //  initialValues.put("VisitStartTS", startTS);
       // initialValues.put("VisitEndTS", startTS);
        //initialValues.put("LocProvider", LocProvider);
        //initialValues.put("Accuracy", Accuracy);
        //initialValues.put("BateryLeftStatus", BateryLevel);
        // initialValues.put(KEY_snxtday, 0);
        // initialValues.put(KEY_sDone, 0);
       // initialValues.put("ForDate", sForDate.trim());
        //initialValues.put("AutoIdStore", AutoIdStore);
        initialValues.put("StoreRouteID", activeRid);
        initialValues.put("RouteNodeType", RouteNodeType);
        initialValues.put("StoreCatNodeId", 0);
        initialValues.put("IsNewStoreDataCompleteSaved", IsNewStoreDataCompleteSaved);
       // initialValues.put("flgFromWhereSubmitStatus", 0);
        initialValues.put("StoreAddress", fetchAddress);
        initialValues.put("PaymentStage", PaymentStage);
        initialValues.put("flgHasQuote", flgHasQuote);
        initialValues.put("flgAllowQuotation", flgAllowQuotation);
      // initialValues.put("flgSubmitFromQuotation", flgSubmitFromQuotation);

        initialValues.put("flgGSTCapture", flgGSTCapture);
        initialValues.put("flgGSTCompliance", flgGSTCompliance);
        initialValues.put("GSTNumber", GSTNumber);
        initialValues.put("flgGSTRecordFromServer", flgGSTRecordFromServer);
        initialValues.put("DistanceNear", 1000);



      /*  initialValues.put("flgLocationServicesOnOff", flgLocationServicesOnOff);
        initialValues.put("flgGPSOnOff", flgGPSOnOff);
        initialValues.put("flgNetworkOnOff", flgNetworkOnOff);
        initialValues.put("flgFusedOnOff", flgFusedOnOff);
        initialValues.put("flgInternetOnOffWhileLocationTracking", flgInternetOnOffWhileLocationTracking);
        initialValues.put("flgRestart", flgRestart);*/

        initialValues.put("flgStoreOrder", (flgIfStoreHasRecords+1));

        initialValues.put("StoreCity", StoreCity.trim());
        initialValues.put("StorePinCode", StorePinCode.trim());
        initialValues.put("StoreState", StoreState.trim());

       // initialValues.put("flgRetailerCreditBalnce", 1);
        initialValues.put("DBR", DBR);
        initialValues.put("IsComposite", IsComposite);
        initialValues.put("StoreStateID", StoreStateID);
        initialValues.put("StoreCityID", StoreCityID);
        initialValues.put("flgOrderType", 0);



        checkNumberOfStore++;

        ////// System.out.println("inserting records..");

        return db.insert(DATABASE_TABLE_MAIN13, null, initialValues);
    }


//	saveSOAPdataStoreList

    public static int CheckTotalStoreCount()
    {

        int chkI = 0;
        Cursor cursorE2=null;
        ////open();
        try
        {
            cursorE2 = db.rawQuery("SELECT flgStoreOrder from tblStoreList order by flgStoreOrder limit 1", null);
            if(cursorE2.getCount()>0) {
                if (cursorE2.moveToFirst()) {

                    if (cursorE2.getInt(0) > 0) {
                        chkI = cursorE2.getInt(0);
                    } else {
                        chkI = 0;
                    }
                }
            }

        } finally
        {
            if(cursorE2!=null) {
                cursorE2.close();
            }
            //close();
        }
        return chkI;
    }

    public static void fnUpdateFlgForNewSoreInMainStoreTable(
            String strGetMaxIDForNewStore) {
        final ContentValues values = new ContentValues();
        values.put("ISNewStore", "1");

        int affected = db.update("tblStoreList", values, "StoreID=?",
                new String[] { strGetMaxIDForNewStore });
        Log.w(TAG, "affected records: " + affected);

        Log.w(TAG, "fnUpdateFlgForNewSoreInMainStoreTable Updated..");

    }

    public static long saveSOAPdataStoreListDetailsInNewTable(String StoreID, String StoreCity,
                                                       String StorePinCode, String StoreState,int Sstat)
    {

        ContentValues initialValues = new ContentValues();
        String activeRid = GetActiveRouteID();

        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("StoreCity", StoreCity.trim());
        initialValues.put("StorePinCode", StorePinCode.trim());
        initialValues.put("StoreState", StoreState.trim());
        initialValues.put("ActiveRouteID", activeRid.trim());
        initialValues.put("Sstat", Sstat);

        return db.insert(DATABASE_TABLE_MAIN16, null, initialValues);
    }

    public static String fnGetOptionDescrFromtblGetPDAQuestOptionMstr(String QuestID,String AnsValue)
    {

        Cursor cursor =null;
        String DDlStringCity="";
        try
        {
            //open();
            cursor= db.rawQuery("SELECT OptionDescr FROM tblGetPDAQuestOptionMstr WHERE  QuestID ='"+ QuestID.trim() + "' and OptID='"+AnsValue.trim()+"'", null);
            if (cursor.getCount() > 0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        DDlStringCity=cursor.getString(0).toString().trim();

                        cursor.moveToNext();
                    }
                }

            }


        } catch (Exception e) {
            System.out.println("shivam query = "+e.toString());
        }
        finally {
            //cursor.close();
            //close();

        }
        return DDlStringCity;
    }

    public static LinkedHashMap isMstrQuestToHide()
    {
        LinkedHashMap<String,String> hmapMstrQstOptId=new LinkedHashMap<String,String>();
        //open();

        String channelOptId=getChannelGroupIdOptId();
        String channelkey =getChannelGroupIdKey();
        if(!channelOptId.equals("0-0-0"))
        {
            hmapMstrQstOptId.put(channelkey,channelOptId);
        }
        else
        {
            hmapMstrQstOptId.put(channelkey,"0");
        }
        //close();
        return hmapMstrQstOptId;
    }

    public static String GetPrevDate() {

        Cursor cursorDateE = db.rawQuery( "SELECT DISTINCT ForDate FROM tblStoreList", null);
        String returnDate = "";
        String date2Send = "";

        try {
            if (cursorDateE.getCount() > 0) {
                ////// System.out.println("GetPrevDate - Records Count: "+ cursorDateE.getCount());

                if (cursorDateE.moveToFirst()) {
                    date2Send = cursorDateE.getString(0);
                    // chk here
                    ////// System.out.println("GetPrevDate - forDate: " + date2Send);

                } else {
                    ////// System.out.println("moveToFirst <- GetPrevDate - FALSE!");
                }
                // ////// System.out.println("returning GetPrevDate - true");
                returnDate = date2Send;
            }

        }

        finally {
            cursorDateE.close();
        }
        return returnDate;
    }

    public static void AddNewStore(String strNewAddedStoreIDFlg, String RetailerName,
                            String OwnerName, String Address, String StoreType,String fDate,String phoneSendValue,String ActualLatitude, String ActualLongitude, String Accuracy,
                            String LocProvider)
    {/*
			if (Integer.parseInt(strNewAddedStoreIDFlg) == 0)
			{
				int MaxAutoStore = 0;
				int cntTotStore=0;
				cntTotStore=fnGetCountForNewStore();
				String strGetMaxIDForNewStore="0";
				String activeRid;
				activeRid = GetActiveRouteID();
				if(cntTotStore>0)
				{
				MaxAutoStore = fnGetMaxAutoStoreIncrementForNewStore();
				MaxAutoStore = MaxAutoStore + 1;
				strGetMaxIDForNewStore = fnGetMaxIdWithIncrementForNewStore(MaxAutoStore);
				}
				else
				{
					MaxAutoStore=0;
					MaxAutoStore = MaxAutoStore + 1;

					strGetMaxIDForNewStore = "-000^" + (1) + "$"
							+ MaxAutoStore;

				}
				////// System.out.println("MaxAutoStore.. " + MaxAutoStore);


				////// System.out.println("MaxAutoStore. After Increment . "+ MaxAutoStore);


				////// System.out.println("New Added Store Name . "+ strGetMaxIDForNewStore);

				if (!strGetMaxIDForNewStore.equals("")
						|| !strGetMaxIDForNewStore.equals(null)) {



					saveSOAPdataStoreListNewStore(strGetMaxIDForNewStore.trim(), StoreType.trim(), RetailerName.trim(), Double.parseDouble(ActualLatitude), Double.parseDouble(ActualLongitude), "", "", fDate, MaxAutoStore,1,Accuracy,LocProvider,activeRid,IsNewStoreDataCompleteSaved); // in last parameter Fdate

					fnUpdateFlgForNewSoreInMainStoreTable(strGetMaxIDForNewStore);
					////// System.out.println("strGetMaxIDForNewStore"+strGetMaxIDForNewStore.trim());
					////// System.out.println("RetailerName"+RetailerName.toString().trim());

					////// System.out.println("OwnerName"+OwnerName.toString().trim());

					////// System.out.println("Address"+Address.toString().trim());

					////// System.out.println("PinCode"+PinCode.toString().trim());

					////// System.out.println("StoreType"+StoreType.toString().trim());

					////// System.out.println("Location"+Location.toString().trim());

					////// System.out.println("Area"+Area.toString().trim());

					saveSOAPdataStoreListDetailsInNewTable(strGetMaxIDForNewStore.trim(), RetailerName.toString().trim(), OwnerName.toString().trim(), Address.toString().trim(),phoneSendValue,ActualLatitude,ActualLongitude,Accuracy,LocProvider,activeRid,IsNewStoreDataCompleteSaved);

				}
			}
		*/}

    public static String[] FetcDistinctProductWhichHaveAnySchemesOrderEntry()
    {
        int ScodecolumnIndex = 0;
        int ScodecolumnIndex1 = 1;

        Cursor cursor = db.rawQuery("SELECT Distinct ProductId FROM tblschemeProductMap", null);
        try
        {
            String DistinctProductIdStock[] = new String[cursor.getCount()];
            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    DistinctProductIdStock[i] = (String) cursor.getString(ScodecolumnIndex).toString();
                    ////// System.out.println("product short name :"+StoreProductIdStock[i]);
                    cursor.moveToNext();
                }
            }
            return DistinctProductIdStock;
        }
        finally
        {
            cursor.close();
        }
    }
	/*	public static long saveSOAPdataStoreListNewStore(String sCode, String sType, String sName,
				Double sLat, Double sLon, String LVdate, String LTdate,
				String sForDate, int AutoIdStore, int newStat, String Accuracy, String LocProvider,String activeRid) {
			ContentValues initialValues = new ContentValues();

			////// System.out.println("Saved code:" + sCode + "Saved name:" + "" + sName);
			long syncTIMESTAMP = System.currentTimeMillis();
			Date dateobj = new Date(syncTIMESTAMP);
			SimpleDateFormat df = new SimpleDateFormat(
					"dd-MM-yyyy HH:mm:ss");
			String startTS = df.format(dateobj);


			initialValues.put("StoreID", sCode.trim());
			initialValues.put("StoreType", "0");
			initialValues.put("StoreName", sName.trim());
			initialValues.put("ActualLatitude", ""+sLat);
			initialValues.put("ActualLongitude",""+ sLon);
			initialValues.put("StoreLatitude", sLat);
			initialValues.put("StoreLongitude", sLon);
			initialValues.put("LastVisitDate", LVdate.trim());
			initialValues.put("LastTransactionDate", LTdate.trim());
			initialValues.put("Sstat", newStat);
			initialValues.put("ISNewStore", 1);
			initialValues.put("StoreClose", 0);
			initialValues.put("StoreNextDay", 0);
			initialValues.put("VisitStartTS", startTS);
			initialValues.put("VisitEndTS", startTS);
			initialValues.put("LocProvider", LocProvider);
			initialValues.put("Accuracy", Accuracy);
			initialValues.put("BateryLeftStatus", "0");

			// initialValues.put(KEY_snxtday, 0);
			// initialValues.put(KEY_sDone, 0);
			initialValues.put("ForDate", sForDate.trim());
			initialValues.put("AutoIdStore", AutoIdStore);
			initialValues.put("StoreRouteID", activeRid);
			checkNumberOfStore++;

			////// System.out.println("inserting records..");

			return db.insert(DATABASE_TABLE_MAIN2, null, initialValues);
		}*/

    public static String[] fnSchemeIDFreePRodQtyDetails()
    {

        Cursor cursor = db.rawQuery("SELECT tblSchemeList.SchemeID,tblSchemeList.SchemeType, " +
                " tblSchemeList.CombTypeID,tblSchemeList.flgDiscountType,tblSchemeDetails.FreeProductID from tblSchemeList Inner JOIN tblSchemeDetails" +
                "  ON tblSchemeList.SchemeID=tblSchemeDetails.SchemeID", null);
        try
        {
            String[] SchemeIDFreePRodQtyDetails= new String[cursor.getCount()];
            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    SchemeIDFreePRodQtyDetails[i] = (String) cursor.getString(0).toString() + "^"+(String) cursor.getString(1).toString() + "^"+(String) cursor.getString(2).toString() + "^"+(String) cursor.getString(3).toString() + "^"+(String) cursor.getString(4).toString();
                    // System.out.println("product short name Abhinav Raj :"+SchemeIDFreePRodQtyDetails[i]);
                    cursor.moveToNext();
                }
            }
            return SchemeIDFreePRodQtyDetails;
        }
        finally
        {
            cursor.close();
        }
    }

    public static int fnCheckIfStoreExistInStoreSchemeFreeProQtyOtherDetails(String StoreID)
    {
        Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblStoreSchemeFreeProQtyOtherDetails WHERE StoreID ='" + StoreID + "'", null);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    public static void fnChkandInsertIfNotPresentInStoreSchemeFreeProQtyOtherDetails(String StoreID)
    {
        int chkI=fnCheckIfStoreExistInStoreSchemeFreeProQtyOtherDetails(StoreID);
        int GetStoreType=fnGetStoreTypeOnStoreID(StoreID);
        if(chkI==0)
        {
            String[] SchemeIDFreePRodQtyDetails=fnSchemeIDFreePRodQtyDetails();
            fnInsertStoreRecordsInStoreSchemeFreeProQtyOtherDetailsIfNotPresent(SchemeIDFreePRodQtyDetails,StoreID,""+GetStoreType);

        }

    }

    public static void fnInsertStoreRecordsInStoreSchemeFreeProQtyOtherDetailsIfNotPresent(String SchemeIDFreePRodQtyDetails[],String StoreID,String StoreType) {

        for(int cnt=0;cnt<SchemeIDFreePRodQtyDetails.length;cnt++)
        {
            StringTokenizer token = new StringTokenizer(String.valueOf(SchemeIDFreePRodQtyDetails[cnt]), "^");
            //// System.out.println("product short name Abhinav Raj In Loop :"+SchemeIDFreePRodQtyDetails[cnt]);
            ContentValues initialValues = new ContentValues();
            initialValues.put("StoreID", StoreID.trim());
            initialValues.put("StoreType", StoreType.trim());
            initialValues.put("SchemeID",token.nextToken().trim());
            initialValues.put("SchemeType",token.nextToken().trim());
            initialValues.put("CombTypeID", token.nextToken().trim());
            initialValues.put("flgDiscountType", token.nextToken().trim());
            initialValues.put("FreeProductID", token.nextToken().trim());
            initialValues.put("FreeProductQty", "0");
            initialValues.put("Discount", "0.00");

            db.insert("tblStoreSchemeFreeProQtyOtherDetails", null, initialValues);
        }

    }

    public static void deleteStoreRecordFromtblStoreSchemeFreeProQtyOtherDetailsOnceSubmitted(String storeID)
    {
        db.execSQL("DELETE FROM tblStoreSchemeFreeProQtyOtherDetails WHERE StoreID='"+ storeID +"'");
    }

    public static String fnGetFreeQtyFromStoreSchemeFreeProQtyOtherDetails(String storeID,String SchID,String SchemeType,String CombTypeID,String FreeProductID)
    {

        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        String strSchemeIDFreeProductId = "";
        String Statement="";
        if(SchemeType.equals("1") || SchemeType.equals("2"))
        {
            Statement="SELECT FreeProductQty FROM tblStoreSchemeFreeProQtyOtherDetails where SchemeID='"
                    + SchID + "' and StoreID='"+storeID+"' and SchemeType='"+SchemeType+"' and CombTypeID='"+CombTypeID+"' and FreeProductID='"+FreeProductID+"'";

        }
        else
        {
            Statement="SELECT Discount FROM tblStoreSchemeFreeProQtyOtherDetails where SchemeID='"
                    + SchID + "' and StoreID='"+storeID+"' and SchemeType='"+SchemeType+"' and CombTypeID='"+CombTypeID+"' and FreeProductID='"+FreeProductID+"'";
        }
        Cursor cursor2 = db.rawQuery("SELECT FreeProductQty FROM tblStoreSchemeFreeProQtyOtherDetails where SchemeID='"
                + SchID + "' and StoreID='"+storeID+"' and SchemeType='"+SchemeType+"' and CombTypeID='"+CombTypeID+"' and FreeProductID='"+FreeProductID+"'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {

                    strSchemeIDFreeProductId = cursor2
                            .getString(LoncolumnIndex);
                    //+ "_"
                    //+ cursor2.getString(LoncolumnIndex1);
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strSchemeIDFreeProductId;
        } finally {
            cursor2.close();
        }
    }

    public static void UpdateInvoiceButtonStoreFlag(String storeID,String SchID,String SchemeType,String CombTypeID,String FreeProductID,String FreeProductQty,String Discount)
    {
        if(SchemeType.equals("1") || SchemeType.equals("2"))
        {
            try
            {
                final ContentValues values = new ContentValues();
                values.put("Discount", FreeProductQty);
                int affected = db.update("tblStoreSchemeFreeProQtyOtherDetails", values, "StoreID=? AND SchemeID=? AND SchemeType=? AND CombTypeID=? AND FreeProductID=?",new String[] { storeID,SchID,SchemeType,CombTypeID,FreeProductID });
            }
            catch (Exception ex)
            {
                Log.e(TAG, ex.toString());
            }
        }
        else if(SchemeType.equals("3"))
        {
            try
            {
                final ContentValues values = new ContentValues();
                values.put("FreeProductQty", FreeProductQty);
                int affected = db.update("tblStoreSchemeFreeProQtyOtherDetails", values, "StoreID=? AND SchemeID=? AND SchemeType=? AND CombTypeID=? AND FreeProductID=?",new String[] { storeID,SchID,SchemeType,CombTypeID,FreeProductID });
            }
            catch (Exception ex)
            {
                Log.e(TAG, ex.toString());
            }
        }
    }

    public static int fnGetStoreTypeOnStoreID(String StoreID) {

        int LoncolumnIndex = 0;
        int strStoreType = 0;

        Cursor cursor2 = db.rawQuery(
                "SELECT StoreType FROM tblStoreList Where StoreID='"+StoreID+"'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strStoreType = Integer.parseInt(cursor2
                            .getString(LoncolumnIndex));
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strStoreType;
        } finally {
            cursor2.close();
        }

    }

    public static ArrayList<HashMap<String, String>> fetch_catgry_prdctsData(String storeID,int BusinessSegmentId) {

        //open();
        ArrayList<HashMap<String, String>> totalProductDetail=new ArrayList<HashMap<String, String>>();
        //hmapCtgryPrdctDetail= key=prdctId,val=CategoryID
        LinkedHashMap<String, String> hmapCtgryPrdctDetail=new LinkedHashMap<String, String>();
        //hmapCtgryPrdctDetail= key=prdctId,val=Volume^Rate^TaxAmount
        HashMap<String, String> hmapPrdctVolRatTax=new HashMap<String, String>();
        //hmapCtgryPrdctDetail= key=prdctId,val=OrderQty
        HashMap<String, String> hmapPrdctOdrQty=new HashMap<String, String>();
        //hmapCtgryPrdctDetail= key=prdctId,val=ProductSample
        HashMap<String, String> hmapPrdctSmpl=new HashMap<String, String>();
        //hmapCtgryPrdctDetail= key=prdctId,val=ProductFreeQty
        HashMap<String, String> hmapPrdctFreeQty=new HashMap<String, String>();
        //hmapCtgryPrdctDetail= key=prdctId,val=ProductName
        HashMap<String, String> hmapPrdctIdPrdctName=new HashMap<String, String>();
        //hmapCtgryPrdctDetail= key=prdctId,val=ProductDiscount
        HashMap<String, String> hmapPrdctIdPrdctDscnt=new HashMap<String, String>();

        //hmapProductRetailerMarginPercentage= key =ProductID         value=RetailerMarginPercentage
        HashMap<String, String> hmapProductRetailerMarginPercentage=new HashMap<String, String>();

        //hmapProductVatTaxPerventage= key =ProductID         value=VatTaxPercentage
        HashMap<String, String> hmapProductVatTaxPerventage=new HashMap<String, String>();

        //hmapProductVatTaxPerventage= key =ProductID         value=ProductMRP
        HashMap<String, String> hmapProductMRP=new HashMap<String, String>();

        //hmapProductVatTaxPerventage= key =ProductID         value=DiscountPercentageGivenOnProduct
        HashMap<String, String> hmapProductDiscountPercentageGive=new HashMap<String, String>();

        //hmapProductVolumePer= key =ProductID         value=Per
        HashMap<String, String> hmapProductVolumePer=new HashMap<String, String>();

        //hmapProductVolumePer= key =ProductID         value=TaxValue
        HashMap<String, String> hmapProductTaxValue=new HashMap<String, String>();

        //hmapProductVolumePer= key =ProductID         value=LODQty
        HashMap<String, String> hmapProductLODQty=new HashMap<String, String>();

        //hmapProductVolumePer= key =ProductID         value=LODQty
        HashMap<String, String> hmapProductIdOrdrVal=new HashMap<String, String>();

        //hmapProductStandardRate= key =ProductID         value=StandardRate
        HashMap<String, String> hmapProductStandardRate=new HashMap<String, String>();

        //hmapProductStandardRateBeforeTax= key =ProductID         value=StandardRateBeforeTax
        HashMap<String, String> hmapProductStandardRateBeforeTax=new HashMap<String, String>();

        //hmapProductStandardTax= key =ProductID         value=StandardTax
        HashMap<String, String> hmapProductStandardTax=new HashMap<String, String>();

        //hmapProductStock= key =ProductID         value=Stock
        HashMap<String, String> hmapProductStock=new HashMap<String, String>();

        //hmapProductStock= key =ProductID         value=flgPriceAva
        HashMap<String, String> hmapProductflgPriceAva=new HashMap<String, String>();

        //hmapProductStock= key =ProductID         value=flgPriceAva
        HashMap<String, String> hmapflgWholeSellApplicable=new HashMap<String, String>();

        //hmapProductStock= key =ProductID         value=flgPriceAva
        HashMap<String, String> hmapPriceRangeWholeSellApplicable=new HashMap<String, String>();

        //hmapProductStock= key =ProductID         value=flgPriceAva
        HashMap<String, String> hmapStandardRateWholeSale=new HashMap<String, String>();
//hmapProductStock= key =ProductID         value=flgPriceAva
        HashMap<String, String> hmapStandardRateBeforeTaxWholeSell=new HashMap<String, String>();

        //hmapProductStock= key =ProductID         value=flgPriceAva
        HashMap<String, String> hmapStandardTaxWholeSale=new HashMap<String, String>();

        //hmapProductStock= key =ProductID         value=ProductSelectedUOMId
        HashMap<String, String> hmapProductSelectedUOMId=new HashMap<String, String>();

        //hmapProductStock= key =ProductID         value=LineValBfrTxAftrDscnt
        HashMap<String, String> hmapLineValBfrTxAftrDscnt=new HashMap<String, String>();

        //hmapProductStock= key =ProductID         value=LineValAftrTxAftrDscnt
        HashMap<String, String> hmapLineValAftrTxAftrDscnt=new HashMap<String, String>();

        //hmapProductStock= key =ProductID         value=LineValAftrTxAftrDscnt

        HashMap<String, String> hmapProductExtraOrder=new HashMap<String, String>();

        Cursor cursor=null;
        if(CommonInfo.hmapAppMasterFlags.get("flgControlStock")==1) {
            cursor = db.rawQuery("SELECT tblProductListMaster.ProductID,tblProductListMaster.CategoryID,tblProductListMaster.ProductShortName,tblProductListMaster.KGLiter ||'^'||tblProductSegementMap.ProductRLP||'^'||tblProductSegementMap.ProductTaxAmount AS ProductVolumeRateTax,'NA/0' As LODQty,0 AS SampleQty,0 AS ProductFreeQty,0 AS ProductOrderQty,0.00 As PrdctDiscount,tblProductSegementMap.RetMarginPer,tblProductSegementMap.VatTax,tblProductSegementMap.ProductMRP,0.00 AS DiscountPercentageGivenOnProduct,0 AS Per,0.00 AS TaxValue,0.00 AS OrderValue,tblProductSegementMap.StandardRate,tblProductSegementMap.StandardRateBeforeTax,tblProductSegementMap.StandardTax,0 As Stock,tblProductSegementMap.flgPriceAva,tblProductSegementMap.flgWholeSellApplicable,tblProductSegementMap.PriceRangeWholeSellApplicable,tblProductSegementMap.StandardRateWholeSale,tblProductSegementMap.StandardRateBeforeTaxWholeSell,tblProductSegementMap.StandardTaxWholeSale,'0' AS UOMID,'0.00' AS LineValBfrTxAftrDscnt,'0.00' AS LineValAftrTxAftrDscnt,0 AS ProductExtraOrder  FROM tblProductListMaster inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID inner join tblDistributorProductStock on tblProductListMaster.ProductID=tblDistributorProductStock.PrdctId  order by tblProductListMaster.CategoryID,tblProductListMaster.PrdOrdr", null);//Where tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"
        }
        else
        {
            cursor = db.rawQuery("SELECT tblProductListMaster.ProductID,tblProductListMaster.CategoryID,tblProductListMaster.ProductShortName,tblProductListMaster.KGLiter ||'^'||tblProductSegementMap.ProductRLP||'^'||tblProductSegementMap.ProductTaxAmount AS ProductVolumeRateTax,'NA/0' As LODQty,0 AS SampleQty,0 AS ProductFreeQty,0 AS ProductOrderQty,0.00 As PrdctDiscount,tblProductSegementMap.RetMarginPer,tblProductSegementMap.VatTax,tblProductSegementMap.ProductMRP,0.00 AS DiscountPercentageGivenOnProduct,0 AS Per,0.00 AS TaxValue,0.00 AS OrderValue,tblProductSegementMap.StandardRate,tblProductSegementMap.StandardRateBeforeTax,tblProductSegementMap.StandardTax,0 As Stock,tblProductSegementMap.flgPriceAva,tblProductSegementMap.flgWholeSellApplicable,tblProductSegementMap.PriceRangeWholeSellApplicable,tblProductSegementMap.StandardRateWholeSale,tblProductSegementMap.StandardRateBeforeTaxWholeSell,tblProductSegementMap.StandardTaxWholeSale,'0' AS UOMID,'0.00' AS LineValBfrTxAftrDscnt,'0.00' AS LineValAftrTxAftrDscnt,0 AS ProductExtraOrder  FROM tblProductListMaster inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID order by tblProductListMaster.CategoryID,tblProductListMaster.PrdOrdr", null);//Where tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"
        }
       // Cursor cursor = db.rawQuery("SELECT tblProductListMaster.ProductID,tblProductListMaster.CategoryID,tblProductListMaster.ProductShortName,tblProductListMaster.KGLiter ||'^'||tblProductSegementMap.ProductRLP||'^'||tblProductSegementMap.ProductTaxAmount AS ProductVolumeRateTax,'NA/0' As LODQty,0 AS SampleQty,0 AS ProductFreeQty,0 AS ProductOrderQty,0.00 As PrdctDiscount,tblProductSegementMap.RetMarginPer,tblProductSegementMap.VatTax,tblProductSegementMap.ProductMRP,0.00 AS DiscountPercentageGivenOnProduct,0 AS Per,0.00 AS TaxValue,0.00 AS OrderValue,tblProductSegementMap.StandardRate,tblProductSegementMap.StandardRateBeforeTax,tblProductSegementMap.StandardTax,0 As Stock,tblProductSegementMap.flgPriceAva,tblProductSegementMap.flgWholeSellApplicable,tblProductSegementMap.PriceRangeWholeSellApplicable,tblProductSegementMap.StandardRateWholeSale,tblProductSegementMap.StandardRateBeforeTaxWholeSell,tblProductSegementMap.StandardTaxWholeSale,'0' AS UOMID,'0.00' AS LineValBfrTxAftrDscnt,'0.00' AS LineValAftrTxAftrDscnt,0 AS ProductExtraOrder  FROM tblProductListMaster inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID  order by tblProductListMaster.CategoryID,tblProductListMaster.PrdOrdr",null);//Where tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"

        //tblProductListMaster.ProductID------------->0
        //tblProductListMaster.CategoryID------------>1
        //tblProductListMaster.ProductShortName------>2
        //tblProductListMaster.KGLiter ||'^'||tblProductSegementMap.ProductRLP||'^'||tblProductSegementMap.ProductTaxAmount AS ProductVolumeRateTax
        //'NA/0' As LODQty---------------------->4
        //0 AS SampleQty------------------------>5
        //0 AS ProductFreeQty------------------->6
        //0 AS ProductOrderQty------------------>7
        //0.00 As PrdctDiscount----------------->8
        //tblProductSegementMap.RetMarginPer---->9
        //tblProductSegementMap.VatTax---------->10
        //tblProductSegementMap.ProductMRP-------->11
        //0.00 AS DiscountPercentageGivenOnProduct----->12
        //0 AS Per------------------------------->13
        //0.00 AS TaxValue----------------------->14
        //0.00 AS OrderValue--------------------->15
        //tblProductSegementMap.StandardRate----->16
        //tblProductSegementMap.StandardRateBeforeTax----->17
        //tblProductSegementMap.StandardTax------->18
        //0 As Stock------------------------------>19
        //FROM tblProductListMaster inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID Where tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"  order by tblProductListMaster.CategoryID,tblProductListMaster.ProductID",null);
        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i < cursor.getCount(); i++)
                    {
                        hmapCtgryPrdctDetail.put(cursor.getString(0), cursor.getString(1));
                        hmapPrdctVolRatTax.put(cursor.getString(0), cursor.getString(3));
                        hmapPrdctOdrQty.put(cursor.getString(0), cursor.getString(7));
                        hmapPrdctSmpl.put(cursor.getString(0), cursor.getString(5));
                        hmapPrdctFreeQty.put(cursor.getString(0), cursor.getString(6));
                        hmapPrdctIdPrdctName.put(cursor.getString(0), cursor.getString(2));
                        hmapPrdctIdPrdctDscnt.put(cursor.getString(0), cursor.getString(8));
                        hmapProductRetailerMarginPercentage.put(cursor.getString(0), cursor.getString(9));
                        hmapProductVatTaxPerventage.put(cursor.getString(0), cursor.getString(10));
                        hmapProductMRP.put(cursor.getString(0), cursor.getString(11));
                        hmapProductDiscountPercentageGive.put(cursor.getString(0), cursor.getString(12));
                        hmapProductVolumePer.put(cursor.getString(0), cursor.getString(13));
                        hmapProductTaxValue.put(cursor.getString(0), cursor.getString(14));
                        hmapProductLODQty.put(cursor.getString(0), cursor.getString(4));
                        hmapProductIdOrdrVal.put(cursor.getString(0), cursor.getString(15));

                        hmapProductStandardRate.put(cursor.getString(0), cursor.getString(16));

                        hmapProductStandardRateBeforeTax.put(cursor.getString(0), cursor.getString(17));

                        hmapProductStandardTax.put(cursor.getString(0), cursor.getString(18));
                        hmapProductStock.put(cursor.getString(0), cursor.getString(19));
                        hmapProductflgPriceAva.put(cursor.getString(0), cursor.getString(20));
                        hmapflgWholeSellApplicable.put(cursor.getString(0), cursor.getString(21));
                        hmapPriceRangeWholeSellApplicable.put(cursor.getString(0), cursor.getString(22));
                        hmapStandardRateWholeSale.put(cursor.getString(0), cursor.getString(23));
                        hmapStandardRateBeforeTaxWholeSell.put(cursor.getString(0), cursor.getString(24));
                        hmapStandardTaxWholeSale.put(cursor.getString(0), cursor.getString(25));

                        hmapProductSelectedUOMId.put(cursor.getString(0), cursor.getString(26));
                        hmapLineValBfrTxAftrDscnt.put(cursor.getString(0), cursor.getString(27));
                        hmapLineValAftrTxAftrDscnt.put(cursor.getString(0), cursor.getString(28));
                        hmapProductExtraOrder.put(cursor.getString(0), cursor.getString(29));
                        cursor.moveToNext();
                        // cursor.close();
                    }
                    totalProductDetail.add(hmapCtgryPrdctDetail);
                    totalProductDetail.add(hmapPrdctVolRatTax);
                    totalProductDetail.add(hmapPrdctOdrQty);
                    totalProductDetail.add(hmapPrdctSmpl);
                    totalProductDetail.add(hmapPrdctFreeQty);
                    totalProductDetail.add(hmapPrdctIdPrdctName);
                    totalProductDetail.add(hmapPrdctIdPrdctDscnt);
                    totalProductDetail.add(hmapProductRetailerMarginPercentage);
                    totalProductDetail.add(hmapProductVatTaxPerventage);
                    totalProductDetail.add(hmapProductMRP);
                    totalProductDetail.add(hmapProductDiscountPercentageGive);
                    totalProductDetail.add(hmapProductVolumePer);
                    totalProductDetail.add(hmapProductTaxValue);
                    totalProductDetail.add(hmapProductLODQty);
                    totalProductDetail.add(hmapProductIdOrdrVal);
                    totalProductDetail.add(hmapProductStandardRate);
                    totalProductDetail.add(hmapProductStandardRateBeforeTax);
                    totalProductDetail.add(hmapProductStandardTax);
                    totalProductDetail.add(hmapProductStock);
                    totalProductDetail.add(hmapProductflgPriceAva);
                    totalProductDetail.add(hmapflgWholeSellApplicable);
                    totalProductDetail.add(hmapPriceRangeWholeSellApplicable);
                    totalProductDetail.add(hmapStandardRateWholeSale);
                    totalProductDetail.add(hmapStandardRateBeforeTaxWholeSell);
                    totalProductDetail.add(hmapStandardTaxWholeSale);

                    totalProductDetail.add(hmapProductSelectedUOMId);
                    totalProductDetail.add(hmapLineValBfrTxAftrDscnt);
                    totalProductDetail.add(hmapLineValAftrTxAftrDscnt);
                    totalProductDetail.add(hmapProductExtraOrder);

                    //

                }
            }


            return totalProductDetail;
        } finally {
            cursor.close();

           // close();
        }


    }

	/*	public static ArrayList<HashMap<String, String>> fetch_catgry_prdctsData(String storeID,int BusinessSegmentId) {

			//open();
			ArrayList<HashMap<String, String>> totalProductDetail=new ArrayList<HashMap<String, String>>();
			//hmapCtgryPrdctDetail= key=prdctId,val=CategoryID
			LinkedHashMap<String, String> hmapCtgryPrdctDetail=new LinkedHashMap<String, String>();
			//hmapCtgryPrdctDetail= key=prdctId,val=Volume^Rate^TaxAmount
			HashMap<String, String> hmapPrdctVolRatTax=new HashMap<String, String>();
			//hmapCtgryPrdctDetail= key=prdctId,val=OrderQty
			HashMap<String, String> hmapPrdctOdrQty=new HashMap<String, String>();
			//hmapCtgryPrdctDetail= key=prdctId,val=ProductSample
			HashMap<String, String> hmapPrdctSmpl=new HashMap<String, String>();
			//hmapCtgryPrdctDetail= key=prdctId,val=ProductFreeQty
			HashMap<String, String> hmapPrdctFreeQty=new HashMap<String, String>();
			//hmapCtgryPrdctDetail= key=prdctId,val=ProductName
			HashMap<String, String> hmapPrdctIdPrdctName=new HashMap<String, String>();
			//hmapCtgryPrdctDetail= key=prdctId,val=ProductDiscount
			HashMap<String, String> hmapPrdctIdPrdctDscnt=new HashMap<String, String>();

			 //hmapProductRetailerMarginPercentage= key =ProductID         value=RetailerMarginPercentage
			   HashMap<String, String> hmapProductRetailerMarginPercentage=new HashMap<String, String>();

			 //hmapProductVatTaxPerventage= key =ProductID         value=VatTaxPercentage
			   HashMap<String, String> hmapProductVatTaxPerventage=new HashMap<String, String>();

			 //hmapProductVatTaxPerventage= key =ProductID         value=ProductMRP
			   HashMap<String, String> hmapProductMRP=new HashMap<String, String>();

			 //hmapProductVatTaxPerventage= key =ProductID         value=DiscountPercentageGivenOnProduct
			   HashMap<String, String> hmapProductDiscountPercentageGive=new HashMap<String, String>();

			 //hmapProductVolumePer= key =ProductID         value=Per
			   HashMap<String, String> hmapProductVolumePer=new HashMap<String, String>();

			 //hmapProductVolumePer= key =ProductID         value=TaxValue
			   HashMap<String, String> hmapProductTaxValue=new HashMap<String, String>();

			 //hmapProductVolumePer= key =ProductID         value=LODQty
			   HashMap<String, String> hmapProductLODQty=new HashMap<String, String>();

			 //hmapProductVolumePer= key =ProductID         value=LODQty
			   HashMap<String, String> hmapProductIdOrdrVal=new HashMap<String, String>();

			   //hmapProductStandardRate= key =ProductID         value=StandardRate
			   HashMap<String, String> hmapProductStandardRate=new HashMap<String, String>();

			   //hmapProductStandardRateBeforeTax= key =ProductID         value=StandardRateBeforeTax
			   HashMap<String, String> hmapProductStandardRateBeforeTax=new HashMap<String, String>();

			   //hmapProductStandardTax= key =ProductID         value=StandardTax
			   HashMap<String, String> hmapProductStandardTax=new HashMap<String, String>();

			   //hmapProductStock= key =ProductID         value=Stock
			   HashMap<String, String> hmapProductStock=new HashMap<String, String>();

			//hmapProductStock= key =ProductID         value=flgPriceAva
			HashMap<String, String> hmapProductflgPriceAva=new HashMap<String, String>();


			 //Cursor cursor = db.rawQuery("SELECT ProductID,CategoryID,ProductShortName,KGLiter ||'^'||ProductRLP||'^'||ProductTaxAmount AS ProductVolumeRateTax,'NA/0' As LODQty,0 AS SampleQty,0 AS ProductFreeQty,0 AS ProductOrderQty,0.00 As PrdctDiscount,RetMarginPer,VatTax,ProductMRP,0.00 AS DiscountPercentageGivenOnProduct,0 AS Per,0.00 AS TaxValue,0.00 AS OrderValue,StandardRate,StandardRateBeforeTax,StandardTax,0 As Stock  FROM tblProductListMaster order by CategoryID,ProductID",null);
			   Cursor cursor = db.rawQuery("SELECT tblProductListMaster.ProductID,tblProductListMaster.CategoryID,tblProductListMaster.ProductShortName,tblProductListMaster.KGLiter ||'^'||tblProductSegementMap.ProductRLP||'^'||tblProductSegementMap.ProductTaxAmount AS ProductVolumeRateTax,'NA/0' As LODQty,0 AS SampleQty,0 AS ProductFreeQty,0 AS ProductOrderQty,0.00 As PrdctDiscount,tblProductSegementMap.RetMarginPer,tblProductSegementMap.VatTax,tblProductSegementMap.ProductMRP,0.00 AS DiscountPercentageGivenOnProduct,0 AS Per,0.00 AS TaxValue,0.00 AS OrderValue,tblProductSegementMap.StandardRate,tblProductSegementMap.StandardRateBeforeTax,tblProductSegementMap.StandardTax,0 As Stock,tblProductSegementMap.flgPriceAva  FROM tblProductListMaster inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID  order by tblProductListMaster.CategoryID,tblProductListMaster.PrdOrdr",null);//Where tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"

			   //tblProductListMaster.ProductID------------->0
			   //tblProductListMaster.CategoryID------------>1
			   //tblProductListMaster.ProductShortName------>2
			   //tblProductListMaster.KGLiter ||'^'||tblProductSegementMap.ProductRLP||'^'||tblProductSegementMap.ProductTaxAmount AS ProductVolumeRateTax
			   //'NA/0' As LODQty---------------------->4
			   //0 AS SampleQty------------------------>5
			   //0 AS ProductFreeQty------------------->6
			   //0 AS ProductOrderQty------------------>7
			   //0.00 As PrdctDiscount----------------->8
			   //tblProductSegementMap.RetMarginPer---->9
			   //tblProductSegementMap.VatTax---------->10
			   //tblProductSegementMap.ProductMRP-------->11
			   //0.00 AS DiscountPercentageGivenOnProduct----->12
			   //0 AS Per------------------------------->13
			   //0.00 AS TaxValue----------------------->14
			   //0.00 AS OrderValue--------------------->15
			   //tblProductSegementMap.StandardRate----->16
			   //tblProductSegementMap.StandardRateBeforeTax----->17
			   //tblProductSegementMap.StandardTax------->18
			   //0 As Stock------------------------------>19
			   //FROM tblProductListMaster inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID Where tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"  order by tblProductListMaster.CategoryID,tblProductListMaster.ProductID",null);
			   try
			{
				if(cursor.getCount()>0)
				{
					if (cursor.moveToFirst()) {

						for (int i = 0; i < cursor.getCount(); i++)
						{
							hmapCtgryPrdctDetail.put(cursor.getString(0), cursor.getString(1));
							hmapPrdctVolRatTax.put(cursor.getString(0), cursor.getString(3));
							hmapPrdctOdrQty.put(cursor.getString(0), cursor.getString(7));
							hmapPrdctSmpl.put(cursor.getString(0), cursor.getString(5));
							hmapPrdctFreeQty.put(cursor.getString(0), cursor.getString(6));
							hmapPrdctIdPrdctName.put(cursor.getString(0), cursor.getString(2));
							hmapPrdctIdPrdctDscnt.put(cursor.getString(0), cursor.getString(8));
							hmapProductRetailerMarginPercentage.put(cursor.getString(0), cursor.getString(9));
							hmapProductVatTaxPerventage.put(cursor.getString(0), cursor.getString(10));
							hmapProductMRP.put(cursor.getString(0), cursor.getString(11));
							hmapProductDiscountPercentageGive.put(cursor.getString(0), cursor.getString(12));
							hmapProductVolumePer.put(cursor.getString(0), cursor.getString(13));
							hmapProductTaxValue.put(cursor.getString(0), cursor.getString(14));
							hmapProductLODQty.put(cursor.getString(0), cursor.getString(4));
							hmapProductIdOrdrVal.put(cursor.getString(0), cursor.getString(15));

							hmapProductStandardRate.put(cursor.getString(0), cursor.getString(16));

							hmapProductStandardRateBeforeTax.put(cursor.getString(0), cursor.getString(17));

							hmapProductStandardTax.put(cursor.getString(0), cursor.getString(18));
							hmapProductStock.put(cursor.getString(0), cursor.getString(19));
							hmapProductflgPriceAva.put(cursor.getString(0), cursor.getString(20));
							cursor.moveToNext();
							// cursor.close();
						}
						totalProductDetail.add(hmapCtgryPrdctDetail);
						totalProductDetail.add(hmapPrdctVolRatTax);
						totalProductDetail.add(hmapPrdctOdrQty);
						totalProductDetail.add(hmapPrdctSmpl);
						totalProductDetail.add(hmapPrdctFreeQty);
						totalProductDetail.add(hmapPrdctIdPrdctName);
						totalProductDetail.add(hmapPrdctIdPrdctDscnt);
						totalProductDetail.add(hmapProductRetailerMarginPercentage);
						totalProductDetail.add(hmapProductVatTaxPerventage);
						totalProductDetail.add(hmapProductMRP);
						totalProductDetail.add(hmapProductDiscountPercentageGive);
						totalProductDetail.add(hmapProductVolumePer);
						totalProductDetail.add(hmapProductTaxValue);
						totalProductDetail.add(hmapProductLODQty);
						totalProductDetail.add(hmapProductIdOrdrVal);
						totalProductDetail.add(hmapProductStandardRate);
						totalProductDetail.add(hmapProductStandardRateBeforeTax);
						totalProductDetail.add(hmapProductStandardTax);
						totalProductDetail.add(hmapProductStock);
						totalProductDetail.add(hmapProductflgPriceAva);
					}
				}


				return totalProductDetail;
			} finally {
				cursor.close();

				//close();
			}


		}
	*/

    public static long savetblPriceApplyType(int DiscountLevelType,double cutoffvalue)
    {
        ContentValues initialValues = new ContentValues();
        initialValues.put("DiscountLevelType", DiscountLevelType);
        initialValues.put("cutoffvalue", cutoffvalue);
        return db.insert(DATABASE_TABLE_tblPriceApplyType, null, initialValues);
    }


    public static int fnGettblPriceApplyDiscountLevelType(String storeID)
    {
        //open();
        int PriceApplyDiscountLevelType=0;
        Cursor cursor=db.rawQuery("Select DiscountLevelType from tblPriceApplyType",null);

        if(cursor.getCount()>0)
        {
            if(cursor.moveToFirst())
            {
                PriceApplyDiscountLevelType=Integer.parseInt(cursor.getString(0));
            }
        }
        if(cursor!=null) {
            cursor.close();
        }
       // close();
        return PriceApplyDiscountLevelType;
    }

    public static LinkedHashMap<String, String> fetch_Category_List_Return(String StoreID)
    {
        //open();
        // System.out.println("Abhinav Raj is 1");
        LinkedHashMap<String, String> hmapCatgry = new LinkedHashMap<String, String>();
        Cursor cursor = db.rawQuery("SELECT CategoryID,CategoryDescr FROM tblCategoryMaster inner join tblTmpInvoiceDetails on tblCategoryMaster.CategoryID=tblTmpInvoiceDetails.CatID Where Stock>0 and tblTmpInvoiceDetails.StoreID='"+StoreID+"'",null);
        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        if(i==0)
                        {
                            hmapCatgry.put("All","0");
                        }
                        hmapCatgry.put(cursor.getString(1).toString(),cursor.getString(0).toString());
                        cursor.moveToNext();
                    }
                }

            }

            else
            {
                hmapCatgry.put("No Category", "0");
            }
            // System.out.println("Abhinav Raj is 3");
            return hmapCatgry;
        }
        finally
        {
            cursor.close();
            //close();
        }
    }

    public static LinkedHashMap<String, String> fetch_Category_List()
    {
        //open();
        LinkedHashMap<String, String> hmapCatgry = new LinkedHashMap<String, String>();
        Cursor cursor = db.rawQuery("SELECT CategoryID,CategoryDescr FROM tblCategoryMaster Order by CatOrdr",null);
        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        hmapCatgry.put(cursor.getString(1).toString(),cursor.getString(0).toString());
                        cursor.moveToNext();
                    }
                }

            }

            else
            {
                hmapCatgry.put("No Category", "0");
            }
            return hmapCatgry;
        }
        finally
        {
            cursor.close();
            //close();
        }
    }

    public static LinkedHashMap<String, String> fetch_MaterialMstr_List(String storeID)
    {
        //open();
        LinkedHashMap<String, String> hmapMaterial = new LinkedHashMap<String, String>();
        Cursor cursor = db.rawQuery("SELECT POSMaterialID,POSMaterialDescr FROM tblPOSMaterialMstr Order by POSMaterialID",null);
        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        //hmapMaterial.put(cursor.getString(1).toString(),cursor.getString(0).toString());
                        hmapMaterial.put(cursor.getString(0).toString(),cursor.getString(1).toString());
                        cursor.moveToNext();
                    }
                }

            }

            else
            {
                hmapMaterial.put("No Category", "0");
            }
            return hmapMaterial;
        }
        finally
        {
            cursor.close();
            //close();
        }
    }

    //tblSchemeSlabBucketProductMapping
    public static HashMap<String, HashMap<String, HashMap<String, String>>> fnProductWiseAppliedScehmeSlabDetails(String StorID)
    {
        String StorIDnew="1";//StorID;
        //open();
        String[] uniqueProdSchemeList=fnUniqueProdSchemeList();

        String productId;
        String schemeId = null;
        int countProductId=0;
        int countSchemeId=0;

						/*Cursor cursor2 = db.rawQuery("SELECT tblSchemeSlabBucketProductMapping.ProductID FROM tblSchemeSlabBucketProductMapping inner join tblSchemeSlabBucketDetails on tblSchemeSlabBucketProductMapping.RowID=tblSchemeSlabBucketDetails.RowID", null);
			if(cursor2.getCount()>0)
			{

			}*/
        // Key=productId,Value=hmapSchemeIdSlab
        HashMap<String, String> hmapSlabIdSlabDscrptnBnftDscrptn=null;
        HashMap<String, HashMap<String, String>> hmapSchemeIdSlab = null;
        HashMap<String, HashMap<String, HashMap<String, String>>> hmapPrdctIdScheme=new HashMap<String, HashMap<String, HashMap<String, String>>>();
        //			0						1						2							3							4
        Cursor cursor = db.rawQuery("SELECT tblSchemeSlabBucketProductMapping.ProductID,tblSchemeMstr.SchemeID,tblSchemeMstr.SchemeName,tblSchemeSlabDetail.SchemeSlabId,tblSchemeSlabDetail.SchemeSlabDesc,tblSchemeSlabDetail.BenifitDescr FROM tblSchemeSlabBucketProductMapping inner join tblSchemeSlabBucketDetails on tblSchemeSlabBucketProductMapping.RowID=tblSchemeSlabBucketDetails.RowID inner join tblSchemeSlabDetail on tblSchemeSlabBucketDetails.SchemeID=tblSchemeSlabDetail.SchemeID inner Join tblSchemeMstr on tblSchemeSlabDetail.SchemeID=tblSchemeMstr.SchemeID inner join tblSchemeStoreMapping on tblSchemeMstr.SchemeID=tblSchemeStoreMapping.SchemeID Where tblSchemeStoreMapping.StoreID='"+StorIDnew+"' Order by tblSchemeSlabBucketProductMapping.ProductID", null);
        if(cursor.moveToFirst());
        {
            for(int index=0;index<cursor.getCount();index++)
            {

                int length=uniqueProdSchemeList.length;
                if(uniqueProdSchemeList[countProductId].toString().equals(cursor.getString(0)))
                {
                    if(index==0)
                    {
                        hmapSchemeIdSlab=new HashMap<String, HashMap<String, String>>();
                        hmapSlabIdSlabDscrptnBnftDscrptn=new HashMap<String, String>();
                        schemeId=cursor.getString(1).toString();
                    }
                    if(schemeId.equals(cursor.getString(1)))
                    {
                        hmapSlabIdSlabDscrptnBnftDscrptn.put(cursor.getString(3), cursor.getString(4)+"^"+cursor.getString(5));
                        // System.out.println("Astix SlabId="+cursor.getString(3));
                    }
                    else
                    {


                        hmapSchemeIdSlab.put(schemeId, hmapSlabIdSlabDscrptnBnftDscrptn);
                        hmapSlabIdSlabDscrptnBnftDscrptn=new HashMap<String, String>();
                        // System.out.println("Astix SchemeId="+cursor.getString(1));
                        schemeId=cursor.getString(1).toString();
                        hmapSlabIdSlabDscrptnBnftDscrptn.put(cursor.getString(3), cursor.getString(4)+"^"+cursor.getString(5));
                        // System.out.println("Astix NewScheme SlabId="+cursor.getString(3));

                    }


                }
                else
                {
                    hmapPrdctIdScheme.put(uniqueProdSchemeList[countProductId], hmapSchemeIdSlab);
                    hmapSchemeIdSlab=new HashMap<String, HashMap<String, String>>();
                    // System.out.println("Betu HashMapProduct = "+hmapPrdctIdScheme);
                    // System.out.println("Astix ProductID="+uniqueProdSchemeList[countProductId]);



                    hmapSlabIdSlabDscrptnBnftDscrptn.put(cursor.getString(3), cursor.getString(4)+"^"+cursor.getString(5));
                    // System.out.println("Astix NewProduct SlabId="+cursor.getString(3));
                    schemeId=cursor.getString(1).toString();

                    countProductId++;

                }

                cursor.moveToNext();
            }

            //// System.out.println("Betu HashMapProduct = "+hmapPrdctIdScheme);
        }

        //close();
        return hmapPrdctIdScheme;
    }

    public static String[] fnUniqueProdSchemeList()
    {

        Cursor cursor = db.rawQuery("SELECT Distinct ProductID from tblSchemeSlabBucketProductMapping Order by ProductID", null);
        try
        {
            String[] SchemeIDFreePRodQtyDetails= new String[cursor.getCount()];
            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    SchemeIDFreePRodQtyDetails[i] = (String) cursor.getString(0).toString();
                    //// System.out.println("Astix short name Abhinav Raj :"+SchemeIDFreePRodQtyDetails[i]);
                    cursor.moveToNext();
                }
            }
            return SchemeIDFreePRodQtyDetails;
        }
        finally
        {
            cursor.close();
        }
    }

    public static HashMap<String, String> fnGetSchemeIdSchemeDescptn(String schemeId)
    {
        //open();

        Cursor cursor = db.rawQuery("Select SchemeID , SchemeName from tblSchemeMstr where SchemeID'"+schemeId+"'", null);
        try
        {
            HashMap<String, String> hmapSchemeIDSchemeDes= new HashMap<String, String>();
            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    hmapSchemeIDSchemeDes.put((cursor.getString(0).toString()),(cursor.getString(1).toString()));

                    cursor.moveToNext();
                }
            }
            return hmapSchemeIDSchemeDes;
        }
        finally
        {
            cursor.close();
            //close();
        }
    }

    public static String[] fectProductIDMappedInSchSlbSubBukRowId(int schSlbSubRowID)
    {
        ////open();
        Cursor cursor = db.rawQuery("SELECT ProductID FROM tblSchemeSlabBucketProductMapping WHERE RowID ="+ schSlbSubRowID , null);
        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = (String) cursor.getString(0).toString();
                        cursor.moveToNext();
                    }
                }
            }
            return CompleteResult;

        } finally {
            cursor.close();
            // close();
        }

    }

    public static HashMap<String, String> fnProductRelatedSchemesList()
    {
        //open();
        Cursor cursor = db.rawQuery("SELECT Distinct ProductID,PrdString from tblProductRelatedScheme", null);
        try
        {
            HashMap<String, String> SchemeIDFreePRodQtyDetails= new HashMap<String, String>();
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        SchemeIDFreePRodQtyDetails.put(cursor.getString(0).toString(), cursor.getString(1).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return SchemeIDFreePRodQtyDetails;
        }
        finally
        {
            cursor.close();
            //close();
        }
    }

    public static String[] fectProductIDBenifitsListOnPurchase(int schId,int schSlabId,int schSlbBuckId)
    {
        //open();
        Cursor cursor = db.rawQuery("SELECT RowID AS BenifitRowID,BenSubBucketType,BenDiscApplied,CouponCode,BenSubBucketValue,Per, UOM,ProRata FROM tblSchemeSlabBenefitsBucketDetails WHERE SchemeID ="+ schId +" and SchemeSlabID="+schSlabId +" and BucketID="+schSlbBuckId , null);
        try {
            String PerBen;
            String UOMBen;

            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        if(cursor.getString(5)==null)
                        {
                            PerBen="0.0";
                            UOMBen="0.0";
                        }
                        else
                        {
                            PerBen=cursor.getString(5);
                            UOMBen=cursor.getString(6);
                        }
                        {
                            CompleteResult[i] = cursor.getString(0)+"^"+cursor.getString(1)+"^"+cursor.getString(2)+"^"+ cursor.getString(3)+"^"+cursor.getString(4)+"^"+PerBen+"^"+UOMBen+"^"+cursor.getString(7);
                            cursor.moveToNext();
                        }
                    }
                }


            }
            return CompleteResult;
        }finally {
            cursor.close();
            //close();
        }

    }

    public static HashMap<String, String> fectProductIDMappedInSchSlbSubBukBenifits(int BenifitRowID)
    {	 //open();
        Cursor cursor = db.rawQuery("SELECT tblSchemeSlabBenefitsProductMappingDetail.ProductID,tblProductListMaster.ProductShortName FROM tblSchemeSlabBenefitsProductMappingDetail inner join tblProductListMaster on tblSchemeSlabBenefitsProductMappingDetail.ProductID=tblProductListMaster.ProductID  WHERE RowID ="+ BenifitRowID , null);
        try {
            HashMap<String, String> CompleteResult = new HashMap<String, String>();
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult.put(cursor.getString(1).toString(), cursor.getString(0).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return CompleteResult;

        } finally {
            cursor.close();
           // close();
        }
    }

    public static String[] fectStatusIfBeniftRowIdExistsInSchemeSlabBenefitsValueDetail(int BenifitRowID,int toMultiply,Double defaultValue,int BenSubBucketType)
    {

        //open();
        Cursor cursor2 = db.rawQuery("SELECT BenValue FROM tblSchemeSlabBenefitsValueDetail where RowID="+BenifitRowID, null);
        if(BenSubBucketType==2 || BenSubBucketType==6 || BenSubBucketType==8)
        {
            toMultiply=1;
        }
        //////////// System.out.println("SELECT Sum(flgIsStrachApplicable) FROM tblStrachApplicableOnScheme");
        String[] chkI;
        try {
            if(cursor2.getCount()>0)
            {
                chkI=new String[cursor2.getCount()+1];
                if (cursor2.moveToFirst()) {
                    for (int i = 0; i < cursor2.getCount(); i++)
                    {
                        if(i==0)
                        {
                            chkI[i]=String.valueOf(defaultValue*toMultiply);

                        }

                        chkI[i+1]=String.valueOf((Integer.parseInt(cursor2.getString(0))*toMultiply));

                        cursor2.moveToNext();
                    }

                }
            }
            else
            {
                chkI=new String[1];
                chkI[0]=String.valueOf(defaultValue*toMultiply);
            }

        } finally {
            cursor2.close();
            //close();
        }
        //////////// System.out.println("fnCheckflgToShowStrachRowOrNot : " +chkI);
        return chkI;
    }

    public static String[] fnGetEarlierFreeProductIDandQtyonSchemeSlabBuckIDTypeBasis(String StoreID,int productID,int schId,int schSlabId,int schSlbBuckId,int BenifitRowID)
    {
        Cursor cursor = db.rawQuery("SELECT FreeProductID,BenifitAssignedValue From tblFreeProductIDandQtyonSchemeSlabBuckIDTypeBasis where StoreID='"+StoreID+"' and ProductID="+productID+" and schId="+schId+" and schSlabId="+schSlabId+" and schSlbBuckId="+schSlbBuckId+" and BenifitRowID="+BenifitRowID , null);
        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = (String) cursor.getString(0).toString();
                        cursor.moveToNext();
                    }
                }
            }
            return CompleteResult;

        } finally {
            cursor.close();
        }
    }

    public static String fectStatusIfBeniftRowIdExistsInSchemeSlabBenefitsPercentageDetail(int BenifitRowID)
    {

        Cursor cursor2 = db.rawQuery("SELECT RowID,BenValue,Type FROM tblSchemeSlabBenefitsValueDetail where RowID="+BenifitRowID, null);

        //////////// System.out.println("SELECT Sum(flgIsStrachApplicable) FROM tblStrachApplicableOnScheme");
        String chkI = "";
        try {
            if(cursor2.getCount()>0)
            {
                if (cursor2.moveToFirst()) {
                    for (int i = 0; i < cursor2.getCount(); i++)
                    {
                        if (!cursor2.isNull(0))
                        {
                            chkI = cursor2.getString(0).toString()+"_"+cursor2.getString(1).toString()+"_"+cursor2.getString(2).toString();
                        }
                        cursor2.moveToNext();
                    }
                }
            }

        } finally {
            cursor2.close();
        }
        //////////// System.out.println("fnCheckflgToShowStrachRowOrNot : " +chkI);
        return chkI;
    }

    public static String fectStatusIfBeniftRowIdExistsInSchemeSlabBenefitsFlatAmtDetail(int BenifitRowID)
    {

        Cursor cursor2 = db.rawQuery("SELECT RowID,BenValue,Type FROM tblSchemeSlabBenefitsValueDetail where RowID="+BenifitRowID, null);

        //////////// System.out.println("SELECT Sum(flgIsStrachApplicable) FROM tblStrachApplicableOnScheme");
        String chkI = "";
        try {
            if(cursor2.getCount()>0)
            {
                if (cursor2.moveToFirst()) {
                    for (int i = 0; i < cursor2.getCount(); i++)
                    {
                        if (!cursor2.isNull(0))
                        {
                            chkI = cursor2.getString(0).toString()+"_"+cursor2.getString(1).toString()+"_"+cursor2.getString(2).toString();
                        }
                        cursor2.moveToNext();
                    }

                }
            }

        } finally {
            cursor2.close();
        }
        //////////// System.out.println("fnCheckflgToShowStrachRowOrNot : " +chkI);
        return chkI;
    }

    public static HashMap<String, String> fnSchemeIDandDescr()
    {
        //open();
        Cursor cursor = db.rawQuery("SELECT SchemeID,SchemeName from tblSchemeMstr", null);
        try
        {
            HashMap<String, String> SchemeIDSchemeName= new HashMap<String, String>();
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        SchemeIDSchemeName.put(cursor.getString(0).toString(), cursor.getString(1).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return SchemeIDSchemeName;
        }
        finally
        {
            cursor.close();
            //close();
        }
    }

    public static String[] fnGetProductPurchaseList(String StoreID,String pdaOrderID,String TmpInvoiceCodePDA)
    {
        //open();
        Cursor cursor = db.rawQuery("SELECT ProdID,0 AS Stock,OrderQty,LineValAftrTxAftrDscnt AS OrderVal,FreeQty,DisVal,SampleQuantity,ProductPrice,UOMId,LineValBfrTxAftrDscnt,LineValAftrTxAftrDscnt,ProductExtraOrder From tblTmpInvoiceDetails where StoreID='"+StoreID+"'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'" , null);
        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = (String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString()+"^"+(String) cursor.getString(2).toString()+"^"+(String) cursor.getString(3).toString()+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(5).toString()+"^"+(String) cursor.getString(6).toString()+"^"+(String) cursor.getString(7).toString()+"^"+(String) cursor.getString(8).toString()+"^"+(String) cursor.getString(9).toString()+"^"+(String) cursor.getString(10).toString()+"^"+(String) cursor.getString(11).toString();
                        cursor.moveToNext();
                    }
                }
            }
            return CompleteResult;

        } finally {
            cursor.close();
           // close();
        }
    }

    public static String fngetOrderIDAganistStore(String StoreID,String TmpInvoiceCodePDA)
    {
        // System.out.println("Abhinav Nitish Ankit New While Fetching Records Store Id:"+StoreID);
        //open();
        // Cursor cursorE2 = db.rawQuery("SELECT Distinct OrderIDPDA FROM tblTmpInvoiceHeader WHERE StoreID ='" + StoreID + "' and (Sstat=1 or Sstat=2)", null);
        Cursor cursorE2 = db.rawQuery("SELECT Distinct TmpInvoiceCodePDA FROM tblTmpInvoiceHeader WHERE StoreID ='" + StoreID + "' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"' and (Sstat=1 or Sstat=2)", null);
        String chkI = "0";
        try {
            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst()) {


                    chkI = (String) cursorE2.getString(0).toString();

                }
            }
        } finally {
            cursorE2.close();
            //close();
        }
        return chkI;
    }

    public static int fnCheckIfStoreExistInStoreProdcutPurchaseDetails(String StoreID,String TmpInvoiceCodePDA)
    {
        // System.out.println("Abhinav Nitish Ankit New While Fetching Records Store Id:"+StoreID);
        //open();
        //Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblTmpInvoiceDetails WHERE StoreID ='" + StoreID + "' and (Sstat=1 or Sstat=2)", null);
        Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblTmpInvoiceDetails WHERE StoreID ='" + StoreID + "' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'", null);
        int chkI = 0;
        try {
            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst()) {

                    if (cursorE2.getInt(0) > 0) {
                        chkI = 1;
                    } else {
                        chkI = 0;
                    }
                }
            }
        } finally {
            cursorE2.close();
            //close();
        }
        return chkI;
    }

    public static int fnCheckIfStoreExistInStoreProdcutInvoiceDetails(String StoreID,String TmpInvoiceCodePDA)
    {
        //open();
        // Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblTmpInvoiceHeader WHERE StoreID ='" + StoreID + "' and (Sstat=1 or Sstat=2)", null);
        Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblTmpInvoiceHeader WHERE StoreID ='" + StoreID + "' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'", null);
        int chkI = 0;
        try {
            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst()) {

                    if (cursorE2.getInt(0) > 0) {
                        chkI = 1;
                    } else {
                        chkI = 0;
                    }
                }
            }
        } finally {
            cursorE2.close();
            //close();
        }
        return chkI;
    }

    public static String[] fnGetOnProductQtyChangeApplyApplicableDiscounts(String StoreID,String ProductIdOnClicked)
    {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT BenSubBucketType,BenifitAssignedValue,BenifitDiscountApplied FROM tblStoreProductAppliedSchemesBenifitsRecords WHERE StoreID ='"+ StoreID + "' and ProductID="+ Integer.parseInt(ProductIdOnClicked) +" and BenSubBucketType in(6,7)", null);
        String[] chkI = new String[cursorE2.getCount()];
        try {
            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        chkI[i] = (String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString()+"^"+(String) cursor.getString(2).toString();
                    }
                }
            }

        } finally {
            cursorE2.close();
           // close();
        }
        return chkI;
    }

    public static int fnCheckIfPrdRelatedDataExisitIntblStoreProductAppliedSchemesBenifitsRecords(String StoreID,String ProductIdOnClicked)
    {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblStoreProductAppliedSchemesBenifitsRecords WHERE StoreID ='"+ StoreID + "' and ProductID="+ Integer.parseInt(ProductIdOnClicked), null);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
            //close();
        }
        return chkI;
    }

    /*public static String[] fnGetDistinctSchIdsAgainstStoreProduct(String StoreID,String ProductIdOnClicked,int schId)
		   {
		    //open();
		    Cursor cursor = db.rawQuery("SELECT BenSubBucketType,FreeProductID,BenifitAssignedValue,BenifitDiscountApplied,IFNULL(BenifitCouponCode,0),schId,schSlbRowId,SchTypeId,ProductID FROM tblStoreProductAppliedSchemesBenifitsRecords WHERE StoreID ='"+ StoreID + "' and  schId="+schId+" and BenSubBucketType in(1,5,2,6,3,7,10)", null);
		    String[] chkI = new String[cursor.getCount()];
		    try {
		     if(cursor.getCount()>0)
		     {

		      if (cursor.moveToFirst()) {

		        for (int i = 0; i <= (cursor.getCount() - 1); i++)
		        {
		         if(cursor.getString(0)!=null && cursor.getString(1)!=null && cursor.getString(2)!=null && cursor.getString(3)!=null)
		          {
		          chkI[i] = cursor.getString(0)+"^"+cursor.getString(1)+"^"+cursor.getString(2)+"^"+cursor.getString(3)+"^"+cursor.getString(4)+"^"+ cursor.getString(5)+"^"+ cursor.getString(6)+"^"+ cursor.getString(7)+"^"+ cursor.getString(8);
		         }
		         cursor.moveToNext();
		        }
		      }
		     }

		    } finally {
		     cursor.close();
		     close();
		    }
		    return chkI;*/
    public static String fnGetDistinctSchIdsAgainstStoreProduct(String StoreID,String ProductIdOnClicked,int schId)
    {
        //open();
        Cursor cursor = db.rawQuery("SELECT schSlbRowId,SchTypeId FROM tblStoreProductAppliedSchemesBenifitsRecords WHERE StoreID ='"+ StoreID + "' and  schId="+schId+" and BenSubBucketType in(1,5,2,6,3,7,10) and ProductID="+Integer.parseInt(ProductIdOnClicked), null);
        String chkI = "";
        try {
            if(cursor.getCount()>0)
            {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        if(cursor.getString(0)!=null && cursor.getString(1)!=null)
                        {
                            chkI = cursor.getString(0)+"^"+cursor.getString(1);
                        }
                        cursor.moveToNext();
                    }
                }
            }

        } finally {
            cursor.close();
            //close();
        }
        return chkI;
    }

    public static void fnDeleteRecordsAllRecordsForClickedProdoductId(String StoreID,String ProductIdOnClicked,String pdaOrderID,String TmpInvoiceCodePDA)
    {
        //open();
        db.execSQL("DELETE FROM tblStoreProductAppliedSchemesBenifitsRecords WHERE StoreID ='"+ StoreID + "'  and ProductID="+ Integer.parseInt(ProductIdOnClicked)+" AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'");
        //close();
    }

    public static void fnDeleteProductDetailsFromReturnTables(String StoreID,String ProductIdOnClicked,String pdaOrderID,String TmpInvoiceCodePDA)
    {

        //open();
        try
        {
            db.execSQL("DELETE FROM tblStoreProductPhotoDetail WHERE StoreID ='"+ StoreID + "'  and ProductID="+ Integer.parseInt(ProductIdOnClicked)+" and TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'");
            db.execSQL("DELETE FROM tblTmpInvoiceDetails WHERE StoreID ='"+ StoreID + "'  and ProdID='"+ ProductIdOnClicked+"' and TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'");
            db.execSQL("DELETE FROM tblStoreReturnDetail WHERE StoreID ='"+ StoreID + "' and  ReturnProductID="+ Integer.parseInt(ProductIdOnClicked)+" and TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'");
        }
        catch(Exception e)
        {

        }
        finally {
          //  close();
        }

    }

    public static long fnsaveStoreProdcutPurchaseDetails(String IMEIno,String StoreID,String CatID,String ProdID, String TransDate,
                                                  int Stock, int OrderQty,
                                                  Double OrderVal, int FreeQty, Double DisVal,
                                                  int selProdIDForSampleQty, String ProductShortName, Double ProductRate,int Outstat,Double TaxRate,Double TaxValue, int StoreCatNodeId,String OrderIDPDA,int flgIsQuoteRateApplied,String distibutorID,int flgWholeSellApplicable,String TmpInvoiceCodePDA,String strFinalAllotedInvoiceIds) {//String DisplayUnit

        String activeRid;
        activeRid = GetActiveRouteID();


        ContentValues initialValues = new ContentValues();

        initialValues.put("IMEIno", IMEIno.trim());
        initialValues.put("TransDate", TransDate.trim());
        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("ProdID", ProdID.trim());
        initialValues.put("Stock", Stock);
        initialValues.put("OrderQty", OrderQty);
        initialValues.put("OrderVal", OrderVal);
        initialValues.put("FreeQty", FreeQty);
        initialValues.put("DisVal", DisVal);

        initialValues.put("Sstat", Outstat);

        initialValues.put("SampleQuantity", selProdIDForSampleQty);

        initialValues.put("ProductShortName", ProductShortName);

        initialValues.put("ProductPrice", ProductRate);
        initialValues.put("RouteID", Integer.parseInt(activeRid));
        initialValues.put("CatID", CatID.trim());
        initialValues.put("TaxRate", TaxRate);
        initialValues.put("TaxValue", TaxValue);
        initialValues.put("StoreCatNodeId", StoreCatNodeId);
        initialValues.put("OrderIDPDA", OrderIDPDA);
        initialValues.put("flgIsQuoteRateApplied", flgIsQuoteRateApplied);
        initialValues.put("distibutorID", distibutorID);
        initialValues.put("flgWholeSellApplicable", flgWholeSellApplicable);
        initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
        initialValues.put("FinalAllotedInvoiceIds", strFinalAllotedInvoiceIds);
//TmpInvoiceCodePDA
        //initialValues.put(Key_DisplayUnit, DisplayUnit);

        ////// System.out.println("inserting saveStoreTransac records..");
    /*// System.out.println("Abhinav Nitish Ankit New Printing Insert Store Id :"+StoreID);
    // System.out.println("Abhinav Nitish Ankit New Printing Insert ProdID Id :"+ProdID);
    // System.out.println("Abhinav Nitish Ankit New Printing Insert OrderQty :"+OrderQty);*/
        return db.insert(DATABASE_TABLE_MAIN210, null, initialValues);
    }

		/* public static long fnsaveStoreProdcutPurchaseDetails(String IMEIno,String StoreID,String CatID,String ProdID, String TransDate,
			      int Stock, int OrderQty,
			    Double OrderVal, int FreeQty, Double DisVal,
			    int selProdIDForSampleQty, String ProductShortName, Double ProductRate,int Outstat,Double TaxRate,Double TaxValue, int StoreCatNodeId,String OrderIDPDA,int flgIsQuoteRateApplied,String distibutorID) {//String DisplayUnit

			   String activeRid;
			   activeRid = GetActiveRouteID();


			   ContentValues initialValues = new ContentValues();

			   initialValues.put("IMEIno", IMEIno.trim());
			   initialValues.put("TransDate", TransDate.trim());
			   initialValues.put("StoreID", StoreID.trim());
			   initialValues.put("ProdID", ProdID.trim());
			   initialValues.put("Stock", Stock);
			   initialValues.put("OrderQty", OrderQty);
			   initialValues.put("OrderVal", OrderVal);
			   initialValues.put("FreeQty", FreeQty);
			   initialValues.put("DisVal", DisVal);

			   initialValues.put("Sstat", Outstat);

			   initialValues.put("SampleQuantity", selProdIDForSampleQty);

			   initialValues.put("ProductShortName", ProductShortName);

			   initialValues.put("ProductPrice", ProductRate);
			   initialValues.put("RouteID", Integer.parseInt(activeRid));
			   initialValues.put("CatID", CatID.trim());
			   initialValues.put("TaxRate", TaxRate);
			   initialValues.put("TaxValue", TaxValue);
			   initialValues.put("StoreCatNodeId", StoreCatNodeId);
			   initialValues.put("OrderIDPDA", OrderIDPDA);
			   initialValues.put("flgIsQuoteRateApplied", flgIsQuoteRateApplied);
			 initialValues.put("distibutorID", distibutorID);

			   //initialValues.put(Key_DisplayUnit, DisplayUnit);

			   ////// System.out.println("inserting saveStoreTransac records..");
				// System.out.println("Abhinav Nitish Ankit New Printing Insert Store Id :"+StoreID);
				// System.out.println("Abhinav Nitish Ankit New Printing Insert ProdID Id :"+ProdID);
				// System.out.println("Abhinav Nitish Ankit New Printing Insert OrderQty :"+OrderQty);*//*
			   return db.insert(DATABASE_TABLE_MAIN210, null, initialValues);
			  }*/

    public static void deleteStoreRecordFromtblStorePurchaseDetailsFromProductTrsaction(String storeID,String pdaOrderID,String TmpInvoiceCodePDA)
    {
        //open();
        db.execSQL("DELETE FROM tblTmpInvoiceDetails WHERE StoreID='"+ storeID +"'  and TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'");
       // close();
    }

    public static void deleteStoreRecordFromtblStorePurchaseDetailsFromProductTrsactionSingleProduct(String storeID,String pdaOrderID,String getPIdToremove,String TmpInvoiceCodePDA)
    {
        //open();
        db.execSQL("DELETE FROM tblTmpInvoiceDetails WHERE StoreID='"+ storeID +"'  and ProdID='"+getPIdToremove+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'");
       // close();
    }

    public static long fnsavetblStoreProductAppliedSchemesBenifitsRecords(String StoreID,int ProdID,int schId, int schSlabId,int schSlbBuckId, double schSlabSubBucketValue,int schSubBucketValType,
                                                                   int schSlabSubBucketType, int BenifitRowID, int BenSubBucketType,
                                                                   int FreeProductID, double BenifitSubBucketValue, double BenifitMaxValue, double BenifitAssignedValue, double BenifitAssignedValueType, int BenifitDiscountApplied, String BenifitCouponCode,double per,double UOM,int WhatFinallyApplied,int schSlbRowId, int SchTypeId,String pdaOrderID,String TmpInvoiceCodePDA){
        //StoreID text not null,ProductID int not null,schId int not null,schSlabId integer not null,schSlbBuckId integer not null,schSlabSubBucketValue real not null,
        //schSubBucketValType integer not null,schSlabSubBucketType int not null,BenifitRowID integer not null,BenSubBucketType int null,FreeProductID int null,
        //BenifitSubBucketValue real null,BenifitMaxValue real null,BenifitAssignedValue real null,BenifitAssignedValueType int null,BenifitDiscountApplied int null,
        //BenifitCouponCode text null
        String activeRid;
        // activeRid = GetActiveRouteID();


        ContentValues initialValues = new ContentValues();

        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("ProductID", ProdID);
        initialValues.put("schId", schId);
        initialValues.put("schSlabId", schSlabId);
        initialValues.put("schSlbBuckId", schSlbBuckId);
        initialValues.put("schSlabSubBucketValue", schSlabSubBucketValue);
        initialValues.put("schSubBucketValType", schSubBucketValType);
        initialValues.put("schSlabSubBucketType", schSlabSubBucketType);
        initialValues.put("BenifitRowID", BenifitRowID);

        initialValues.put("BenSubBucketType", BenSubBucketType);

        initialValues.put("FreeProductID", FreeProductID);

        initialValues.put("BenifitSubBucketValue", BenifitSubBucketValue);

        initialValues.put("BenifitMaxValue", BenifitMaxValue);
        initialValues.put("BenifitAssignedValue", BenifitAssignedValue);
        initialValues.put("BenifitAssignedValueType", BenifitAssignedValueType);

        initialValues.put("BenifitDiscountApplied", BenifitDiscountApplied);
        initialValues.put("BenifitCouponCode", BenifitCouponCode);

        initialValues.put("PER", per);
        initialValues.put("UOM", UOM);
        initialValues.put("Sstat", 0);
        initialValues.put("schSlbRowId", schSlbRowId);
        initialValues.put("SchTypeId", SchTypeId);
        initialValues.put("WhatFinallyApplied", WhatFinallyApplied);
        initialValues.put("OrderIDPDA", pdaOrderID);
        initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);

        // System.out.println("Save Data Save in Table 211");
        //open();
        long xyx= db.insert(DATABASE_TABLE_Main211, null, initialValues);
        //close();
        return xyx;
    }

    public static String fnctnGetMaxAssignedBen8DscntApld1(String storeId,String pdaOrderID,String TmpInvoiceCodePDA)
    {
        String discountValOnBen8apld1="";
        //open();
        try
        {
            Cursor cursor=db.rawQuery("Select Max(BenifitAssignedValue),BenifitRowID  from tblStoreProductAppliedSchemesBenifitsRecords where StoreID='"+storeId+"' and  BenSubBucketType='"+8+"' and BenifitDiscountApplied ='"+1+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"' Limit 1", null);

            if(cursor.getCount()>0)
            {
                if(cursor.moveToFirst())
                {
                    if(cursor.getString(0)==null)
                    {
                        discountValOnBen8apld1="";
                    }
                    else
                    {
                        discountValOnBen8apld1=cursor.getString(0)+"^"+cursor.getString(1);
                    }

                }
            }

            //close();
        }
        catch(Exception e)
        {
            //close();
        }
        return discountValOnBen8apld1;
    }

    public static String fnctnGetMaxAssignedBen8DscntApld2(String storeId,String pdaOrderID,String TmpInvoiceCodePDA)
    {
        String discountValOnBen8apld1="";
        try
        {
            //open();

            Cursor cursor=db.rawQuery("Select Max(BenifitAssignedValue),BenifitRowID  from tblStoreProductAppliedSchemesBenifitsRecords where StoreID='"+storeId+"'  and BenSubBucketType='"+8+"' and BenifitDiscountApplied='"+2+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+" Limit 1", null);

            if(cursor.getCount()>0)
            {
                if(cursor.moveToFirst())
                {
                    //discountValOnBen8apld1=cursor.getString(0)+"^"+cursor.getString(1);
                    if(cursor.getString(0)==null)
                    {
                        discountValOnBen8apld1="";
                    }
                    else
                    {
                        discountValOnBen8apld1=cursor.getString(0)+"^"+cursor.getString(1);
                    }

                }
            }

           // close();
        }
        catch(Exception e)
        {
           // close();
        }
        return discountValOnBen8apld1;
    }

    public static String fnctnGetMaxAssignedBen9DscntApld1(String storeId,String pdaOrderID,String TmpInvoiceCodePDA)
    {
        String discountValOnBen8apld1="";
        //open();
        try
        {
            Cursor cursor=db.rawQuery("Select Max(BenifitAssignedValue),BenifitRowID  from tblStoreProductAppliedSchemesBenifitsRecords where StoreID='"+storeId+"'  and BenSubBucketType='"+9+"' and BenifitDiscountApplied ='"+1+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"' Limit 1", null);

            if(cursor.getCount()>0)
            {
                if(cursor.moveToFirst())
                {
                    //discountValOnBen8apld1=cursor.getString(0)+"^"+cursor.getString(1);
                    if(cursor.getString(0)==null)
                    {
                        discountValOnBen8apld1="";
                    }
                    else
                    {
                        discountValOnBen8apld1=cursor.getString(0)+"^"+cursor.getString(1);
                    }
                }
            }

           // close();
        }
        catch(Exception e)
        {
           // close();
        }
        return discountValOnBen8apld1;
    }

    public static String fnctnGetMaxAssignedBen9DscntApld2(String storeId,String pdaOrderID,String TmpInvoiceCodePDA)
    {
        String discountValOnBen8apld1="";
        try
        {
            //open();

            Cursor cursor=db.rawQuery("Select Max(BenifitAssignedValue),BenifitRowID  from tblStoreProductAppliedSchemesBenifitsRecords where StoreID='"+storeId+"'  and BenSubBucketType='"+9+"' and BenifitDiscountApplied ='"+2+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"' Limit 1", null);

            if(cursor.getCount()>0)
            {
                if(cursor.moveToFirst())
                {
                    // discountValOnBen8apld1=cursor.getString(0)+"^"+cursor.getString(1);
                    if(cursor.getString(0)==null)
                    {
                        discountValOnBen8apld1="";
                    }
                    else
                    {
                        discountValOnBen8apld1=cursor.getString(0)+"^"+cursor.getString(1);
                    }
                }
            }


            //close();
        }
        catch(Exception e)
        {
            //close();
        }
        return discountValOnBen8apld1;
    }

    public static String fnctnGetHighestDiscount(String freeProductId,String storeId,String benSubBucketType)
    {
        String highestDiscount="";
        try
        {
            //open();

            Cursor cursor=db.rawQuery("Select Distinct FreeProductID,Max(BenifitAssignedValue),BenSubBucketType from tblStoreProductAppliedSchemesBenifitsRecords where StoreID='"+storeId+"' and FreeProductID='"+freeProductId+"' and BenSubBucketType ='"+benSubBucketType+"' Limit 1", null);
            if(cursor.getCount()>0)
            {
                if(cursor.moveToFirst())
                {
                    highestDiscount=cursor.getString(0)+"^"+cursor.getString(1)+"^"+cursor.getString(2);
                }
            }

            //close();
        }
        catch(Exception e)
        {
           // close();
        }
        return highestDiscount;
    }

    public static HashMap<String, String> fnctnSchemeStoreID(String storeID)
    {
        //open();
        //hmapSchemeStoreID= key = SchemeId  value=StoreId
        HashMap<String, String> hmapSchemeStoreID=new HashMap<String, String>();
        //tblSchemeStoreMapping=StoreID text null,SchemeID text null
        Cursor cursor=db.rawQuery("Select StoreID,SchemeID from tblSchemeStoreMapping where  StoreID ='"+storeID+"'",null);

        if(cursor.getCount()>0)
        {
            if(cursor.moveToFirst())
            {
                for(int index=0;index<cursor.getCount();index++)
                {
                    hmapSchemeStoreID.put(cursor.getString(1), cursor.getString(0));

                    cursor.moveToNext();
                }
            }
        }
       // close();
        return hmapSchemeStoreID;
    }

    public static ArrayList<HashMap<String, String>> fnctnSchemeSlabIdSchmVal()
    {
        //open();
        // tblSchemeSlabDetail (SchemeID text null,SchemeSlabID text null,SchemeSlabDesc text null,BenifitDescr text null);";

        ArrayList<HashMap<String, String>> arrayListSchemeSlabDteail=new ArrayList<HashMap<String,String>>();

        //hmapSchmeSlabIdSchemeId= key =SchemeSlabId         value=SchemeID
        HashMap<String, String> hmapSchmeSlabIdSchemeId=new HashMap<String, String>();
        //hmapSchmeSlabIdSchemeId= key =SchemeSlabId         value=SchemeSlabDes
        HashMap<String, String> hmapSchmeSlabIdSlabDes=new HashMap<String, String>();
        //hmapSchmeSlabIdSchemeId= key = SchemeSlabId        value=BenifitDescription
        HashMap<String, String> hmapSchmeSlabIdBenifitDes=new HashMap<String, String>();
        Cursor cursor=db.rawQuery("Select * from tblSchemeSlabDetail", null);
        if(cursor.getCount()>0)
        {
            if(cursor.moveToFirst())
            {
                for(int i=0;i<cursor.getCount();i++)
                {
                    hmapSchmeSlabIdSchemeId.put(cursor.getString(1), cursor.getString(0));
                    hmapSchmeSlabIdSlabDes.put(cursor.getString(1), cursor.getString(2));
                    hmapSchmeSlabIdBenifitDes.put(cursor.getString(1), cursor.getString(3));

                    cursor.moveToNext();
                }

                arrayListSchemeSlabDteail.add(hmapSchmeSlabIdSchemeId);
                arrayListSchemeSlabDteail.add(hmapSchmeSlabIdSlabDes);
                arrayListSchemeSlabDteail.add(hmapSchmeSlabIdBenifitDes);

            }
        }
       // close();
        return arrayListSchemeSlabDteail;
    }

    public static String fnctnGetHighestDiscountPercentge(String freeProductId,String storeId,String TmpInvoiceCodePDA)
    {
        //open();
        String highestDiscount="";
        Cursor cursor=db.rawQuery("Select  Max(BenifitAssignedValue),BenifitRowID from tblStoreProductAppliedSchemesBenifitsRecords where StoreID='"+storeId+"' and FreeProductID='"+freeProductId+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"' and BenSubBucketType in (2,6) Limit 1", null);
        try {
            if(cursor.getCount()>0)
            {
                if(cursor.moveToFirst())
                {
                    //highestDiscount=cursor.getString(0)+"^"+cursor.getString(1);
                    if(cursor.getString(0)==null)
                    {
                        highestDiscount="";
                    }
                    else
                    {
                        highestDiscount=cursor.getString(0)+"^"+cursor.getString(1);
                    }
                }
            }
           // close();
        } catch (Exception ex) {
            //close();
            Log.e(TAG, ex.toString());
        }


        return highestDiscount;
    }

    public static String[] fnGetAllSchSlabbasedOnSchemeID(String SchemeID)
    {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT DISTINCT SchemeSlabID FROM tblSchemeSlabDetail WHERE SchemeID ='"
                + SchemeID + "'", null);
        String AllSchemeSlabID[] = new String[cursorE2.getCount()];

        try {
            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst())
                {

                    for (int i = 0; i <= (cursorE2.getCount() - 1); i++)
                    {
                        AllSchemeSlabID[i] = (String) cursorE2.getString(0).toString();
                        cursorE2.moveToNext();
                        //cursor.moveToNext();
                    }
                }
            }
            return AllSchemeSlabID;
        } finally {
            cursorE2.close();
            //close();
        }

    }

    public static String fnctnGetHighestDiscountAmount(String freeProductId,String storeId,String TmpInvoiceCodePDA)
    {
        //open();
        String highestDiscount="";
        Cursor cursor=db.rawQuery("Select  Max(BenifitAssignedValue),BenifitRowID from tblStoreProductAppliedSchemesBenifitsRecords where StoreID='"+storeId+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"' and ProductID='"+freeProductId+"' and BenSubBucketType in (3,7,10) Limit 1", null);
        try {
            if(cursor.getCount()>0)
            {
                if(cursor.moveToFirst())
                {
                    //highestDiscount=cursor.getString(0)+"^"+cursor.getString(1);
                    if(cursor.getString(0).equals(null))
                    {
                        highestDiscount="";
                    }
                    else
                    {
                        highestDiscount=cursor.getString(0)+"^"+cursor.getString(1);
                    }
                }
            }
           // close();
        } catch (Exception ex) {
            //close();
            Log.e(TAG, ex.toString());
        }



        return highestDiscount;
    }

    public static void updatewhatAppliedFlag(int flag,String storeId,int benifitrRowId,String pdaOrderID,String TmpInvoiceCodePDA) {

        try {
            //open();


            final ContentValues values = new ContentValues();
            values.put("WhatFinallyApplied", flag);
            int affected = db.update(DATABASE_TABLE_Main211, values, "StoreID=? AND BenifitRowID=? AND  TmpInvoiceCodePDA=? ",new String[] { storeId,""+benifitrRowId,TmpInvoiceCodePDA });

            //close();


        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }

    public static String fnctnGetfreePerUnitVol(String freeProductId,String storeId,String TmpInvoiceCodePDA)
    {
        //open();
        String perUnit="";
        Cursor cursor=db.rawQuery("Select  Per,UOM from tblStoreProductAppliedSchemesBenifitsRecords where StoreID='"+storeId+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"' and ProductID='"+freeProductId+"' and BenSubBucketType = '"+10+"' ", null);
        if(cursor.getCount()>0)
        {
            if(cursor.moveToFirst())
            {
                //highestDiscount=cursor.getString(0)+"^"+cursor.getString(1);
                if(cursor.getString(0)==null)
                {
                    perUnit="";
                }
                else
                {
                    perUnit=cursor.getString(0)+"^"+cursor.getString(1);
                }
            }
        }

        //close();
        return perUnit;
    }

    public static String[] fnGetProductsAgainstBenifitTable(String StoreID,String ProdId)
    {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT FreeProductID FROM  tblStoreProductAppliedSchemesBenifitsRecords where StoreID='"+StoreID+"' and ProductID='"+ProdId+"'", null);
        String AllSchemeSlabID[] = new String[cursorE2.getCount()];

        try {
            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst())
                {

                    for (int i = 0; i <= (cursorE2.getCount() - 1); i++)
                    {
                        AllSchemeSlabID[i] = (String) cursorE2.getString(0).toString();
                        cursorE2.moveToNext();
                        //cursor.moveToNext();
                    }
                }
            }
            return AllSchemeSlabID;
        } finally {
            cursorE2.close();
           // close();
        }

    }

    public static int fnGetSlabIdBasedOnPrdIDSchmId(String StoreID,String ProdId,int SchID)
    {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT schSlabId FROM  tblStoreProductAppliedSchemesBenifitsRecords where StoreID='"+StoreID+"' and ProductID='"+ProdId+"' and schId="+SchID, null);
        int AllSchemeSlabID = 0;

        try {
            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst())
                {


                    AllSchemeSlabID = (Integer.parseInt(cursorE2.getString(0).toString()));


                }
            }
            return AllSchemeSlabID;
        } finally {
            cursorE2.close();
            //close();
        }

    }

    public static int fnGetStoreCatNodeId(String StoreID)
    {
        Cursor cursorE2 = db.rawQuery("SELECT StoreType FROM  tblStoreList where StoreID='"+StoreID+"'", null);
        int StoreCatNodeId = 0;
        ////open();
        try {
            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst())
                {


                    StoreCatNodeId = (Integer.parseInt(cursorE2.getString(0).toString()));


                }
            }
            return StoreCatNodeId;
        } finally {
            cursorE2.close();
            //  close();

        }

    }

    public static int fnGetRowIDBasedOnSchIDAndSlabID(int SchID,int slabSchmId)
    {
        //tblSchemeSlabBenefitsBucketDetails
        // [11:23:51 PM] Abhinav Raj: RowID
        //[11:23:58 PM] Abhinav Raj: SchemeID text null,SchemeSlabID
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT BenifitRowID FROM  tblSchemeSlabBenefitsBucketDetails where  SchemeID='"+SchID+"' and SchemeSlabID="+slabSchmId, null);
        int AllSchemeSlabID = 0;

        try {
            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst())
                {


                    AllSchemeSlabID = (Integer.parseInt(cursorE2.getString(0).toString()));


                }
            }
            return AllSchemeSlabID;
        } finally {
            cursorE2.close();
           // close();
        }

    }

    public static String[] fnGetProductsSchIdSlabRow(String StoreID,int RowID,String pdaOrderID,String TmpInvoiceCodePDA)
    {//tblSchemeSlabBenefitsProductMappingDetail (RowID text null,ProductID text null)
        //open();//schId
        // Cursor cursorE2 = db.rawQuery("SELECT ProductID FROM  tblStoreProductAppliedSchemesBenifitsRecords where schSlbRowId="+RowID, null);
        Cursor cursorE2 = db.rawQuery("SELECT ProductID FROM  tblStoreProductAppliedSchemesBenifitsRecords where schSlbRowId="+RowID +" AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'  and StoreID='"+StoreID+"'", null);
        String AllProductInSlab[] = new String[cursorE2.getCount()];

        try {
            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst())
                {

                    for (int i = 0; i <= (cursorE2.getCount() - 1); i++)
                    {
                        AllProductInSlab[i] = (String) cursorE2.getString(0).toString();
                        cursorE2.moveToNext();
                        //cursor.moveToNext();
                    }
                }
            }
            return AllProductInSlab;
        } finally {
            cursorE2.close();
            //close();
        }

    }

    public static String[] fnGetProductsSchIds(String StoreID,int schID,String pdaOrderID,String TmpInvoiceCodePDA)
    {//tblSchemeSlabBenefitsProductMappingDetail (RowID text null,ProductID text null)
        //open();//schIdsd
        //  ssd
        // Cursor cursorE2 = db.rawQuery("SELECT ProductID FROM  tblStoreProductAppliedSchemesBenifitsRecords where schSlbRowId="+RowID, null);
        Cursor cursorE2 = db.rawQuery("SELECT ProductID,schSlbRowId,BenifitAssignedValue,FreeProductID FROM  tblStoreProductAppliedSchemesBenifitsRecords where schId="+schID +" AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'  and StoreID='"+StoreID+"' ", null);
        String AllProductInSlab[] = new String[cursorE2.getCount()];

        try {
            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst())
                {

                    for (int i = 0; i <= (cursorE2.getCount() - 1); i++)
                    {
                        AllProductInSlab[i] = (String) cursorE2.getString(0).toString()+"^"+(String) cursorE2.getString(1).toString()+"^"+(String) cursorE2.getString(2).toString()+"^"+(String) cursorE2.getString(3).toString();
                        cursorE2.moveToNext();
                        //cursor.moveToNext();
                    }
                }
            }
            return AllProductInSlab;
        } finally {
            cursorE2.close();
            //close();
        }

    }

    public static void fnDeleteOldSchemeRowIdRecords(String StoreID,int RowID,String pdaOrderID,String TmpInvoiceCodePDA)
    {
        //open();
        db.execSQL("DELETE FROM tblStoreProductAppliedSchemesBenifitsRecords where  StoreID='"+StoreID+"'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"' and schSlbRowId="+RowID);
       // close();
    }

    public static void fnDeleteOldStoreProductAppliedSchemesBenifitsRecordsWhileSubmit(String StoreID,String pdaOrderID)
    {
        //open();
        db.execSQL("DELETE FROM tblStoreProductAppliedSchemesBenifitsRecords where OrderIDPDA='"+pdaOrderID+"'  and StoreID='"+StoreID+"'");
       // close();
    }

    public static String[] fnGetRowsIDsAgainstProdIs(String StoreID,int schId)
    {//tblSchemeSlabBenefitsProductMappingDetail (RowID text null,ProductID text null)
        //open();//schId
        // Cursor cursorE2 = db.rawQuery("SELECT ProductID FROM  tblStoreProductAppliedSchemesBenifitsRecords where schSlbRowId="+RowID, null);
        Cursor cursorE2 = db.rawQuery("SELECT BenifitRowID,BenSubBucketType,schSlbRowId,BenifitAssignedValue,FreeProductID,SchTypeId,ProductID FROM  tblStoreProductAppliedSchemesBenifitsRecords where  StoreID='"+StoreID+"' and schId="+schId, null);
        String AllProductInSlab[] = new String[cursorE2.getCount()];

        try {
            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst())
                {

                    for (int i = 0; i <= (cursorE2.getCount() - 1); i++)
                    {
                        AllProductInSlab[i] = (String) cursorE2.getString(0).toString()+"^" +(String) cursorE2.getString(1).toString() +"^"+(String) cursorE2.getString(2).toString()+"^" +(String) cursorE2.getString(3).toString()+"^" +(String) cursorE2.getString(4).toString()+"^" +(String) cursorE2.getString(5).toString()+"^" +(String) cursorE2.getString(6).toString();
                        cursorE2.moveToNext();
                        //cursor.moveToNext();
                    }
                }
            }
            return AllProductInSlab;
        } finally {
            cursorE2.close();
            //close();
        }

    }

    public static String dbfunctiongetProdMapedWithBenifitRowID(int benifitRowID,int ClickedProID)
    {//tblSchemeSlabBenefitsProductMappingDetail (RowID text null,ProductID text null)
        //open();//schId
        //tblSchemeSlabBenefitsProductMappingDetail (RowID text null,ProductID text null)
        // Cursor cursorE2 = db.rawQuery("SELECT ProductID FROM  tblStoreProductAppliedSchemesBenifitsRecords where schSlbRowId="+RowID, null);
        Cursor cursorE2 = db.rawQuery("SELECT tblStoreProductAppliedSchemesBenifitsRecords.ProductID,tblStoreProductAppliedSchemesBenifitsRecords.FreeProductID FROM  tblSchemeSlabBenefitsProductMappingDetail inner join tblStoreProductAppliedSchemesBenifitsRecords on tblSchemeSlabBenefitsProductMappingDetail.RowID=tblStoreProductAppliedSchemesBenifitsRecords.BenifitRowID  where  tblSchemeSlabBenefitsProductMappingDetail.RowID='"+benifitRowID+"'", null);
        String AllProductInSlab = "";
        try {
            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst())
                {

                    for (int i = 0; i <= (cursorE2.getCount() - 1); i++)
                    {
                        AllProductInSlab = (String) cursorE2.getString(0).toString()+"^"+(String) cursorE2.getString(1).toString();
                        cursorE2.moveToNext();
                        //cursor.moveToNext();
                    }
                }
            }
            return AllProductInSlab;
        } finally {
            cursorE2.close();
            //close();
        }

    }

    public static String dbfunctiongetProdMapedWithBenifitRowID2(int benifitRowID,int ClickedProID)
    {//tblSchemeSlabBenefitsProductMappingDetail (RowID text null,ProductID text null)
        //open();//schId
        //tblSchemeSlabBenefitsProductMappingDetail (RowID text null,ProductID text null)
        // Cursor cursorE2 = db.rawQuery("SELECT ProductID FROM  tblStoreProductAppliedSchemesBenifitsRecords where schSlbRowId="+RowID, null);
        Cursor cursorE2 = db.rawQuery("SELECT ProductID,FreeProductID FROM  tblStoreProductAppliedSchemesBenifitsRecords where BenifitRowID='"+benifitRowID+"'", null);
        String AllProductInSlab = "";
        try {
            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst())
                {

                    for (int i = 0; i <= (cursorE2.getCount() - 1); i++)
                    {
                        AllProductInSlab = (String) cursorE2.getString(0).toString()+"^"+(String) cursorE2.getString(1).toString();
                        cursorE2.moveToNext();
                        //cursor.moveToNext();
                    }
                }
            }
            return AllProductInSlab;
        } finally {
            cursorE2.close();
           // close();
        }

    }

    public static String[] fnGetDistinctProductIdAgainstStoreProduct(String StoreID,String schmIdForProductsavdInRecord,String pdaOrderID,String TmpInvoiceCodePDA)
    {
        //open();
        Cursor cursor = db.rawQuery("SELECT BenSubBucketType,ProductID,BenifitAssignedValue,BenifitDiscountApplied,IFNULL(BenifitCouponCode,0),schId,schSlbRowId,SchTypeId FROM tblStoreProductAppliedSchemesBenifitsRecords WHERE StoreID ='"+ StoreID + "' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'  and  schId="+ schmIdForProductsavdInRecord +" and BenSubBucketType in(10)", null);
        String[] chkI = new String[cursor.getCount()];
        try {
            if(cursor.getCount()>0)
            {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        if(cursor.getString(0)!=null && cursor.getString(1)!=null && cursor.getString(2)!=null && cursor.getString(3)!=null)
                        {
                            chkI[i] = cursor.getString(0)+"^"+cursor.getString(1)+"^"+cursor.getString(2)+"^"+cursor.getString(3)+"^"+cursor.getString(4)+"^"+ cursor.getString(5)+"^"+ cursor.getString(6)+"^"+ cursor.getString(7);
                        }
                        cursor.moveToNext();
                    }
                }
            }

        } finally {
            cursor.close();
            //close();
        }
        return chkI;
    }

    public static String[] fnctnGetBensubBucket10Column(String schmId,String storeId,String pdaOrderID,String TmpInvoiceCodePDA)
    {
        //open();
        Cursor cursor=db.rawQuery("Select ProductID,FreeProductID FROM  tblStoreProductAppliedSchemesBenifitsRecords where StoreID='"+storeId+"' and schId='"+schmId+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"' and BenSubBucketType in(1,10)", null);
        try{
            String[] productIdBen10=new String[cursor.getCount()];
            if(cursor.getCount()>0)
            {
                if(cursor.moveToFirst())
                {

                    for(int index=0;index<cursor.getCount();index++)
                    {
                        productIdBen10[index]=cursor.getString(0)+"^"+cursor.getString(1);
                        //updateBensubBucket10Col(storeId,schmId, ((productIdBen10[index]).split(Pattern.quote("^")))[0],"10");
                        cursor.moveToNext();
                    }
                }


            }

            return productIdBen10;
        }
        finally
        {
            cursor.close();
           // close();
        }
    }

    public static void updateBensubBucket10Col(String storeId,String schemeId,String productId,String benSubBucketType)
    {
        final ContentValues values = new ContentValues();
        values.put("BenifitAssignedValue", 0.0);



        int affected = db.update(DATABASE_TABLE_Main211, values, "StoreID=? AND schId=? AND ProductID=? AND BenSubBucketType=?",new String[] {storeId,schemeId,productId,benSubBucketType});
    }

    public static void deleteUnRequiredRecordsFromTablesAfterCase() {
        //open();
        db.execSQL("DELETE FROM tblStoreProductAppliedSchemesBenifitsRecords WHERE Sstat ="+ 4);

       // close();
    }

    public static int fectRowIdBasedOnSchIDSlabID(int SchID,int SchemeSlabID)
    {
        //open();
        Cursor cursor = db.rawQuery("SELECT RowID FROM tblSchemeSlabBucketDetails WHERE SchemeID="+SchID+" and SchemeSlabID ="+ SchemeSlabID +" and SlabSubBucketType=5" , null);
        try {
            int CompleteResult = 0;
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult = Integer.parseInt(cursor.getString(0).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return CompleteResult;

        } finally {
            cursor.close();
          //  close();
        }

    }

    public static String[] fectProdIDBasedOnRowIDOfProductsPurchased(int sclSlabRowID)
    {
        //open();
        Cursor cursor = db.rawQuery("SELECT ProductID FROM tblSchemeSlabBucketProductMapping WHERE RowID="+sclSlabRowID , null);
        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = (String) cursor.getString(0).toString();
                        cursor.moveToNext();
                    }
                }
            }
            return CompleteResult;

        } finally {
            cursor.close();
           //close();
        }

    }

    public static int fnGetStatValueagainstStore(String StoreID)
    {
        //open();
        Cursor cursor = db.rawQuery("SELECT Sstat FROM tblStoreList WHERE StoreID='"+StoreID+"'" , null);
        try {
            int Sstat =0;
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    Sstat = Integer.parseInt(cursor.getString(0).toString());

                }
            }
            return Sstat;

        } finally {
            if(cursor!=null) {
                cursor.close();
            }
           // close();
        }

    }

    public static void updateReturnData(HashMap<String, String> hmapReturnData,String OrderPDAID,HashMap<String, String> hmapRemark,String TmpInvoiceCodePDA)
    {
        //open();
        String routeID;
        String storeID;
        String returnProductID;
        String prodReturnQty;
        String prodReturnReason;
        String prodReturnReasonIndex;
        String returnDate ;
        // String _outstat;
        int Sstat=0;


        for (Entry<String, String> entry : hmapReturnData.entrySet()) {

            returnProductID=entry.getKey();
            routeID=(entry.getValue().split(Pattern.quote("~")))[0];
            storeID=(entry.getValue().split(Pattern.quote("~")))[1];
            if((entry.getValue().split(Pattern.quote("~")))[2].equals(""))
            {
                prodReturnQty="0";
            }
            else
            {
                prodReturnQty=(entry.getValue().split(Pattern.quote("~")))[2];
            }

            prodReturnReason=hmapRemark.get(returnProductID);
            prodReturnReasonIndex=(entry.getValue().split(Pattern.quote("~")))[4];
            returnDate=(entry.getValue().split(Pattern.quote("~")))[5];
            // _outstat=(entry.getValue().split(Pattern.quote("~")))[6];

            Cursor cursor = db.rawQuery("SELECT RouteID FROM tblStoreReturnDetail where StoreID='"+storeID +"' and ReturnProductID ='"+ returnProductID +"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'" , null);
            // System.out.println("NitishReturn "+cursor.getCount());
            ContentValues initialValues = new ContentValues();
            // StoreID ,ProductID ,ClickedDateTime ,PhotoName ,PhotoValidation ,PDAPhotoPath ,outstat
            initialValues.put("RouteID", routeID.trim());
            initialValues.put("ReturnProductID", returnProductID.trim());
            initialValues.put("StoreID", storeID.trim());

            initialValues.put("ProdReturnQty", prodReturnQty.trim());

            initialValues.put("ProdReturnReason", prodReturnReason.trim());
            initialValues.put("ProdReturnReasonIndex", prodReturnReasonIndex.trim());
            initialValues.put("ReturnDate", returnDate.trim());
            initialValues.put("Sstat", Sstat);
            initialValues.put("OrderIDPDA", OrderPDAID);
            initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
            if(cursor.getCount()>0)
            {

                // System.out.println("Return update is called :"+ routeID+":"+storeID+":"+returnProductID+":"+prodReturnQty+":"+prodReturnReason+":"+ prodReturnReasonIndex+":"+returnDate);
                int affected = db.update(DATABASE_TABLE_Main213, initialValues, "StoreID=? AND ReturnProductID=? AND  TmpInvoiceCodePDA=?",new String[] {storeID,returnProductID,TmpInvoiceCodePDA});


            }
            else
            {
                // System.out.println("Return insert is called :"+ routeID+":"+storeID+":"+returnProductID+":"+prodReturnQty+":"+prodReturnReason+":"+ prodReturnReasonIndex+":"+returnDate);
                db.insert(DATABASE_TABLE_Main213, null, initialValues);
            }

        }
       // close();
    }

    public static HashMap<String, String> getRtrnOrderQtyReason(String storeID,String OrderPDAID,String TmpInvoiceCodePDA)
    {
        HashMap<String, String> hmapPrdctIdPrdctRtrnQtyReason=new HashMap<String, String>();
        //ReturnProductID text null, ProdReturnQty text null, ProdReturnReason
        Cursor cursor = db.rawQuery("SELECT ReturnProductID,ProdReturnQty,ProdReturnReasonIndex FROM tblStoreReturnDetail where StoreID='"+storeID+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'",null);
        String rtrnQty=null;
        // System.out.println("Return Cursor storeId"+storeID);
        // System.out.println("Return Cursor"+cursor.getCount());
        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i < cursor.getCount(); i++) {


                        hmapPrdctIdPrdctRtrnQtyReason.put(cursor.getString(0), cursor.getString(1) +"^"+cursor.getString(2));


                        cursor.moveToNext();
                        // cursor.close();
                    }

                }
            }
            else
            {
                hmapPrdctIdPrdctRtrnQtyReason.put("No Product", "Thankyou");
            }


            return hmapPrdctIdPrdctRtrnQtyReason;
        } finally {
            cursor.close();


        }
    }

    public static HashMap<String, String> getProductStockList(String StoreID,String OrderPDAID,String TmpInvoiceCodePDA)
    {

        //hmapCtgryPrdctDetail= key=prdctId,val=Stock
        HashMap<String, String> hmapPrdctIdPrdctStock=new HashMap<String, String>();
        Cursor cursor = db.rawQuery("SELECT DISTINCT ProdID,SUM(Stock) From tblTmpInvoiceDetails where StoreID='"+StoreID+"'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'" , null);
        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapPrdctIdPrdctStock.put(cursor.getString(0).toString(), cursor.getString(1).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return hmapPrdctIdPrdctStock;

        } finally {
            cursor.close();

        }
    }

    public static ArrayList<HashMap<String, String>> fetch_catgry_prdctReturnData(String storeId,String OrderPDAID,String TmpInvoiceCodePDA) {
        // System.out.println("Abhinav Raj is 2");
        //open();
        ArrayList<HashMap<String, String>> totalProductDetail=new ArrayList<HashMap<String, String>>(4);
        //hmapCtgryPrdctDetail= key=prdctId,val=CategoryID
        HashMap<String, String> hmapCtgryPrdctDetail=new HashMap<String, String>();

        //hmapCtgryPrdctDetail= key=prdctId,val=ProductName
        HashMap<String, String> hmapPrdctIdPrdctName=new HashMap<String, String>();
        //hmapCtgryPrdctDetail= key=prdctId,val=Stock
        HashMap<String, String> hmapPrdctIdPrdctStock=new HashMap<String, String>();

        //hmapCtgryPrdctDetail= key=prdctId,val=ProductRtrnQty,Reason
        HashMap<String, String> hmapPrdctIdPrdctRtrnQtyReason=new HashMap<String, String>();

        hmapPrdctIdPrdctRtrnQtyReason=getRtrnOrderQtyReason(storeId,OrderPDAID,TmpInvoiceCodePDA);
        hmapPrdctIdPrdctStock=getProductStockList(storeId,OrderPDAID,TmpInvoiceCodePDA);

        //Cursor cursor = db.rawQuery("SELECT ProductID,CategoryID,ProductShortName FROM tblProductListMaster",null);
        Cursor cursor = db.rawQuery("SELECT ProductID,CategoryID,tblProductListMaster.ProductShortName,tblTmpInvoiceDetails.Stock FROM tblProductListMaster inner join tblTmpInvoiceDetails on tblProductListMaster.ProductID=tblTmpInvoiceDetails.ProdID Where tblTmpInvoiceDetails.Stock>0 and StoreID='"+storeId+"'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"' order by CategoryID,ProductID",null);
        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i < cursor.getCount(); i++) {
                        hmapCtgryPrdctDetail.put(cursor.getString(0), cursor.getString(1));

                        hmapPrdctIdPrdctName.put(cursor.getString(0), cursor.getString(2));
                        hmapPrdctIdPrdctStock.put(cursor.getString(0), cursor.getString(3));
                        cursor.moveToNext();
                        // cursor.close();
                    }
                    totalProductDetail.add(0,hmapCtgryPrdctDetail);
                    totalProductDetail.add(1,hmapPrdctIdPrdctName);
                    totalProductDetail.add(2,hmapPrdctIdPrdctRtrnQtyReason);
                    totalProductDetail.add(3,hmapPrdctIdPrdctStock);

                }
            }


            return totalProductDetail;
        } finally {
            cursor.close();

            //close();
        }


    }

    public static void UpdateCancelStoreFlag(HashMap<String, String> hmapConfirmCancel,int isCancelConfirm)
    {
        //open();

        {
            for(Entry<String, String> dataEntry : hmapConfirmCancel.entrySet()){

                // // System.out.println("Update tblInvoiceButtonTransac Set flgCancel='"+isCancelConfirm+"' and Sstat="+dataEntry.getValue()+" WHERE OrderID='"+dataEntry.getKey()+"'");
                // db.execSQL("Update tblInvoiceButtonTransac Set flgCancel='"+isCancelConfirm+"' and Sstat="+dataEntry.getValue()+" WHERE OrderID='"+dataEntry.getKey()+"'");

                final ContentValues values = new ContentValues();
                if(Integer.parseInt(dataEntry.getValue())==10)
                {
                    values.put("Sstat", 9);
                }
                else
                {
                    values.put("Sstat", dataEntry.getValue());
                }
                values.put("flgCancel", isCancelConfirm);
                ////// System.out.println("Updating Status for Store ID: " + sID);
                //int affected = db.update("tblPendingInvoices", values, "StoreID=? AND RouteId=? AND DistId=? AND InvoiceForDate=?",new String[] { sID,RouteId,DistId,Invdate });

                int affected = db.update("tblPendingInvoices", values, "OrderID=?",new String[] { dataEntry.getKey() });
                int affected2 = db.update("tblInvoiceButtonTransac", values, "OrderID=?",new String[] { dataEntry.getKey() });

                //int affected2 = db.update("tblInvoiceButtonTransac", values, "StoreID=? AND OrderID=?",new String[] { sID,OrderID });
                //int affected1 = db.update("tblInvoiceButtonTransac", values, "StoreID=? AND OrderID=?",new String[] { sID,OrderID });

            }

            //  9,1

           // close();

        }


    }

    public static void UpdateProductCancelStoreFlag(String orderId,int isCancelConfirm)
    {
        //open();

        {

            // // System.out.println("Update tblInvoiceButtonTransac Set flgCancel='"+isCancelConfirm+"' and Sstat="+dataEntry.getValue()+" WHERE OrderID='"+dataEntry.getKey()+"'");
            // db.execSQL("Update tblInvoiceButtonTransac Set flgCancel='"+isCancelConfirm+"' and Sstat="+dataEntry.getValue()+" WHERE OrderID='"+dataEntry.getKey()+"'");

            final ContentValues values = new ContentValues();
            values.put("Sstat", "9");
            values.put("flgCancel", isCancelConfirm);
            ////// System.out.println("Updating Status for Store ID: " + sID);
            //int affected = db.update("tblPendingInvoices", values, "StoreID=? AND RouteId=? AND DistId=? AND InvoiceForDate=?",new String[] { sID,RouteId,DistId,Invdate });

            int affected = db.update("tblPendingInvoices", values, "OrderID=?",new String[] { orderId });
            int affected2 = db.update("tblInvoiceButtonTransac", values, "OrderID=?",new String[] { orderId });



            //int affected2 = db.update("tblInvoiceButtonTransac", values, "StoreID=? AND OrderID=?",new String[] { sID,OrderID });
            //int affected1 = db.update("tblInvoiceButtonTransac", values, "StoreID=? AND OrderID=?",new String[] { sID,OrderID });



            //  9,1

            //close();

        }


    }

    public static int fnCountToDisplayDailySummaryDetailsSKUWise(int DraftorNonSubmitted,int flgReportFromTmpOrPermanent)//DraftorNonSubmitted=3:-Submited But Not Synced,DraftorNonSubmitted=1:-Saved as Draft
    {
        int CountToDisplayDailySummaryDetailsSKUWise=0;
        //ArrayList<HashMap<String, String>> totalProductDetail=new ArrayList<HashMap<String, String>>(4);

        //Getting Category Details Starts Here
        Cursor cursor=null;
        //open();
        if(flgReportFromTmpOrPermanent==0) {
            cursor = db.rawQuery("Select Count(tblCategoryMaster.CategoryID) from tblCategoryMaster inner join tblTmpInvoiceDetails on tblCategoryMaster.CategoryID=tblTmpInvoiceDetails.CatID Where (tblTmpInvoiceDetails.OrderQty>0 or tblTmpInvoiceDetails.FreeQty>0) and tblTmpInvoiceDetails.Sstat=" + DraftorNonSubmitted, null);
        }
        if(flgReportFromTmpOrPermanent==1) {
            cursor = db.rawQuery("Select Count(tblCategoryMaster.CategoryID) from tblCategoryMaster inner join tblInvoiceDetails on tblCategoryMaster.CategoryID=tblInvoiceDetails.CatID Where (tblInvoiceDetails.OrderQty>0 or tblInvoiceDetails.FreeQty>0) and tblInvoiceDetails.Sstat=" + DraftorNonSubmitted, null);
        }
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    CountToDisplayDailySummaryDetailsSKUWise=Integer.parseInt(cursor.getString(0).toString());
                }
            }
            return CountToDisplayDailySummaryDetailsSKUWise;
        } finally {
            cursor.close();
           // close();
        }

    }





    // change by Abhnav Sir

    @SuppressWarnings("unchecked")
    public static LinkedHashMap<String, String> fnGetDailySummaryDetailsSKUWiseCategoryLevel(int DraftorNonSubmitted,int flgReportFromTmpOrPermanent)//DraftorNonSubmitted=3:-Submited But Not Synced,DraftorNonSubmitted=1:-Saved as Draft
    {
        ArrayList<Object> totalCategoryWiseResult=new ArrayList<Object>(11);

        //Getting Category Details Starts Here
        Cursor cursor=null;
        LinkedHashMap<String, String> hmapSKUWiseDailySummaryReport=new LinkedHashMap<String, String>();

        LinkedHashMap<String, String> hmapGrandTotalCategorySKUWiseDailySummaryReport=new LinkedHashMap<String, String>();

        String CompleteResult[]=null;

        String strGrandTotalDiscValue="";
        String strGrandTotalAmountBeforeTax="";
        String strGrandTotalTaxValue="";
        String strGrandTotalOrderValue="";
        //tblTmpInvoiceDetails (IMEIno text not null,RouteID int null,StoreID text not null,CatID text  null,ProdID text not null,TransDate string not null,Stock integer not null,OrderQty integer not null,OrderVal real not null,FreeQty integer not null,DisVal real not null,Sstat integer not null,SampleQuantity int null,ProductShortName text null,ProductPrice real null, TaxRate real null,TaxValue real null,StoreCatNodeId int null,OrderIDPDA text null,flgIsQuoteRateApplied int null);";
        //open();
        //  Cursor cursor = db.rawQuery("Select tblCategoryMaster.CategoryID,tblCategoryMaster.CategoryDescr,Count(Distinct tblTmpInvoiceDetails.StoreID) As StoreCount,1 AS FlgRowType  from tblCategoryMaster inner join tblTmpInvoiceDetails on tblCategoryMaster.CategoryID=tblTmpInvoiceDetails.CatID Where (tblTmpInvoiceDetails.OrderQty>0 or tblTmpInvoiceDetails.FreeQty>0) and tblTmpInvoiceDetails.Sstat="+DraftorNonSubmitted+" Group By tblCategoryMaster.CategoryID,tblCategoryMaster.CategoryDescr" , null);
        //or tblTmpInvoiceDetails.Stock>0
        if(flgReportFromTmpOrPermanent==1) {
            cursor = db.rawQuery("Select tblCategoryMaster.CategoryID,tblCategoryMaster.CategoryDescr,Count(Distinct tblInvoiceDetails.StoreID) As StoreCount,1 AS FlgRowType  from tblCategoryMaster inner join tblInvoiceDetails on tblCategoryMaster.CategoryID=tblInvoiceDetails.CatID Where (tblInvoiceDetails.OrderQty>0 or tblInvoiceDetails.FreeQty>0) and tblInvoiceDetails.Sstat=" + DraftorNonSubmitted + " Group By tblCategoryMaster.CategoryID,tblCategoryMaster.CategoryDescr Order by tblCategoryMaster.CatOrdr", null);
        }
        if(flgReportFromTmpOrPermanent==0) {
            cursor = db.rawQuery("Select tblCategoryMaster.CategoryID,tblCategoryMaster.CategoryDescr,Count(Distinct tblTmpInvoiceDetails.StoreID) As StoreCount,1 AS FlgRowType  from tblCategoryMaster inner join tblTmpInvoiceDetails on tblCategoryMaster.CategoryID=tblTmpInvoiceDetails.CatID Where (tblTmpInvoiceDetails.OrderQty>0 or tblTmpInvoiceDetails.FreeQty>0) and tblTmpInvoiceDetails.Sstat=" + DraftorNonSubmitted + " Group By tblCategoryMaster.CategoryID,tblCategoryMaster.CategoryDescr Order by tblCategoryMaster.CatOrdr", null);
        }
        try {
            if (cursor.getCount() > 0) {
                //CompleteResult = new String[cursor.getCount()];
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        ArrayList<Object> arrProductDailySummaryKUWiseReportWithCategory=fnGetDailySummaryDetailsSKUWiseProductLevel(Integer.parseInt(cursor.getString(0).toString()),DraftorNonSubmitted,flgReportFromTmpOrPermanent);

                        if(arrProductDailySummaryKUWiseReportWithCategory.size()>0)
                        {

                            // CompleteResult[i]=(String) cursor.getString(0).toString();



                            String strCatDisplayUnit=(String) arrProductDailySummaryKUWiseReportWithCategory.get(0);
                            String strCatOrderVolume=(String) arrProductDailySummaryKUWiseReportWithCategory.get(1);
                            String strCatFreeVolume=(String) arrProductDailySummaryKUWiseReportWithCategory.get(2);
                            String strCatDiscValue=(String) arrProductDailySummaryKUWiseReportWithCategory.get(3);
                            String strCatAmountBeforeTax=(String) arrProductDailySummaryKUWiseReportWithCategory.get(4);
                            String strCatTaxValue=(String) arrProductDailySummaryKUWiseReportWithCategory.get(5);
                            String strCatOrderValue=(String) arrProductDailySummaryKUWiseReportWithCategory.get(6);

                            if(strGrandTotalDiscValue.equals(""))
                            {
                                strGrandTotalDiscValue=""+Double.parseDouble(strCatDiscValue);
                            }
                            else
                            {
                                strGrandTotalDiscValue=""+(Double.parseDouble(strGrandTotalDiscValue) + Double.parseDouble(strCatDiscValue));
                            }
                            if(strGrandTotalAmountBeforeTax.equals(""))
                            {
                                strGrandTotalAmountBeforeTax=""+Double.parseDouble(strCatAmountBeforeTax);
                            }
                            else
                            {
                                strGrandTotalAmountBeforeTax=""+(Double.parseDouble(strGrandTotalAmountBeforeTax) + Double.parseDouble(strCatAmountBeforeTax));
                            }
                            if(strGrandTotalTaxValue.equals(""))
                            {
                                strGrandTotalTaxValue=""+Double.parseDouble(strCatTaxValue);
                            }
                            else
                            {
                                strGrandTotalTaxValue=""+(Double.parseDouble(strGrandTotalTaxValue) + Double.parseDouble(strCatTaxValue));
                            }
                            if(strGrandTotalOrderValue.equals(""))
                            {
                                strGrandTotalOrderValue=""+Double.parseDouble(strCatOrderValue);
                            }
                            else
                            {
                                strGrandTotalOrderValue=""+(Double.parseDouble(strGrandTotalOrderValue) + Double.parseDouble(strCatOrderValue));
                            }
                            LinkedHashMap<String, String> hmapSkuLevelRows=new LinkedHashMap<String, String>();
                            hmapSkuLevelRows=(LinkedHashMap<String, String>) arrProductDailySummaryKUWiseReportWithCategory.get(7);
                            //hmapSKUWiseDailySummaryReport.put((String) cursor.getString(0).toString(), "CATEGORY :"+(String) cursor.getString(1).toString()+"^"+0+"^"+0+"^"+(String) cursor.getString(2).toString()+"^"+strCatOrderVolume+" "+strCatDisplayUnit+"^"+strCatFreeVolume+" "+strCatDisplayUnit+"^"+strCatDiscValue+"^"+strCatAmountBeforeTax+"^"+strCatTaxValue+"^"+strCatOrderValue+"^"+(String) cursor.getString(3).toString());
                            hmapSKUWiseDailySummaryReport.put((String) cursor.getString(0).toString(), "CATEGORY :"+(String) cursor.getString(1).toString()+"^"+0+"^"+0+"^"+strCatOrderVolume+" "+strCatDisplayUnit+"^"+strCatFreeVolume+" "+strCatDisplayUnit+"^"+strCatDiscValue+"^"+strCatAmountBeforeTax+"^"+strCatTaxValue+"^"+strCatOrderValue+"^"+(String) cursor.getString(2).toString()+"^"+(String) cursor.getString(3).toString());
                            hmapSKUWiseDailySummaryReport.putAll(hmapSkuLevelRows);
                            if(i == cursor.getCount()-1)
                            {
                                int storeCntGrandTotal=fnGetCountDailySummaryDetailsSKUWiseGrandTotal(DraftorNonSubmitted,flgReportFromTmpOrPermanent);
                                hmapGrandTotalCategorySKUWiseDailySummaryReport.putAll(hmapSKUWiseDailySummaryReport);
                                //hmapGrandTotalCategorySKUWiseDailySummaryReport.put("0", "GRAND TOTAL :"+"^"+" "+"^"+" "+"^"+storeCntGrandTotal+"^"+" "+"^"+" "+"^"+strGrandTotalDiscValue+"^"+strGrandTotalAmountBeforeTax+"^"+strGrandTotalTaxValue+"^"+strGrandTotalOrderValue+"^0");
                                hmapGrandTotalCategorySKUWiseDailySummaryReport.put("0", "GRAND TOTAL :"+"^"+"0"+"^"+"0"+"^"+"0"+"^"+"0"+"^"+strGrandTotalDiscValue+"^"+strGrandTotalAmountBeforeTax+"^"+strGrandTotalTaxValue+"^"+strGrandTotalOrderValue+"^"+storeCntGrandTotal+"^0");

                            }



                            cursor.moveToNext();


                        }
                    }
                }

            }




            return hmapGrandTotalCategorySKUWiseDailySummaryReport;

        } finally {
            if(cursor!=null) {
                cursor.close();
            }
            //close();
        }
        //Getting Category Details Ends Here

    }

    public static LinkedHashMap<String, String> fnGetTabelEntry()//DraftorNonSubmitted=3:-Submited But Not Synced,DraftorNonSubmitted=1:-Saved as Draft
    {
        LinkedHashMap<String, String> hmapPrdRowDetails=new LinkedHashMap<String, String>();
        //ArrayList<Object> totalProductCategoryWiseResult=new ArrayList<Object>(8);
        //open();
        Cursor cursorSKUPrd = db.rawQuery("Select * from tblTmpInvoiceDetails", null);
        try {
            if (cursorSKUPrd.getCount() > 0) {
                cursorSKUPrd.moveToFirst();
                //if (cursorSKUPrd.moveToFirst()) {
                for (int i = 0; i <= (cursorSKUPrd.getCount() - 1); i++) {
                    String rowVales="";
                    for (int j = 0; j <= (cursorSKUPrd.getColumnCount() - 1); j++) {
                        if(rowVales.equals(""))
                        {
                            rowVales=cursorSKUPrd.getString(j).toString();
                        }
                        else
                        {
                            rowVales+="^"+cursorSKUPrd.getString(j).toString();
                        }
                    }

                    hmapPrdRowDetails.put(""+i,rowVales);
                    cursorSKUPrd.moveToNext();
                }
                //}
            }

            return hmapPrdRowDetails;

        } finally {
            cursorSKUPrd.close();
            //LinkedHashMap<String,String> hmapProductList=fnGetTabelEntryProduct();
           // close();
            // close();
        }

    }

    public static LinkedHashMap<String, String> fnGetTabelEntryProduct()//DraftorNonSubmitted=3:-Submited But Not Synced,DraftorNonSubmitted=1:-Saved as Draft
    {
        LinkedHashMap<String, String> hmapPrdRowDetails=new LinkedHashMap<String, String>();
        //ArrayList<Object> totalProductCategoryWiseResult=new ArrayList<Object>(8);
        ////open();
        Cursor cursorSKUPrd = db.rawQuery("Select * from tblProductListMaster", null);
        try {
            if (cursorSKUPrd.getCount() > 0) {
                cursorSKUPrd.moveToFirst();
                //if (cursorSKUPrd.moveToFirst()) {
                for (int i = 0; i <= (cursorSKUPrd.getCount() - 1); i++) {
                    String rowVales="";
                    for (int j = 0; j <= (cursorSKUPrd.getColumnCount() - 1); j++) {
                        if(rowVales.equals(""))
                        {
                            rowVales=cursorSKUPrd.getString(j).toString();
                        }
                        else
                        {
                            rowVales+="^"+cursorSKUPrd.getString(j).toString();
                        }
                    }

                    hmapPrdRowDetails.put(""+i,rowVales);
                    cursorSKUPrd.moveToNext();
                }
                //}
            }

            return hmapPrdRowDetails;

        } finally {
            cursorSKUPrd.close();
            //close();
            // close();
        }

    }

    public static ArrayList<Object> fnGetDailySummaryDetailsSKUWiseProductLevel(int CategoryId,int DraftorNonSubmitted,int flgReportFromTmpOrPermanent)//DraftorNonSubmitted=3:-Submited But Not Synced,DraftorNonSubmitted=1:-Saved as Draft
    {
        ArrayList<Object> totalProductCategoryWiseResult=new ArrayList<Object>(8);

        // Cursor cursorSKUPrd = db.rawQuery("Select tblProductListMaster.StoreCatNodeId || tblTmpInvoiceDetails.ProdID AS PID,tblProductListMaster.ProductShortName As ProdShortName,tblProductListMaster.ProductMRP As PMRP,tblTmpInvoiceDetails.ProductPrice As PSRate,Sum(tblTmpInvoiceDetails.OrderQty) as OrderQty,Sum(Cast(tblTmpInvoiceDetails.FreeQty As Real)) AS FreeQty, Sum(Cast(tblTmpInvoiceDetails.OrderQty as Real)) As OrderVolume,Cast(Sum(tblTmpInvoiceDetails.FreeQty) AS Real) As FreeVolume,Sum(Cast(tblTmpInvoiceDetails.DisVal As Real)) As DisVal,Sum(Cast(tblTmpInvoiceDetails.OrderVal As Real))-Sum(Cast(tblTmpInvoiceDetails.TaxValue As Real)) As AmtBeforeTax,Sum(Cast(tblTmpInvoiceDetails.TaxValue As Real)) As TaxValue,Sum(Cast(tblTmpInvoiceDetails.OrderVal As Real)) As OrderVal,tblProductListMaster.DisplayUnit AS PDisplayUnit,Count(Distinct tblTmpInvoiceDetails.StoreID) As StoreCount,2 AS FlgRowType  from tblTmpInvoiceDetails inner join tblProductListMaster on tblTmpInvoiceDetails.ProdID=tblProductListMaster.ProductID and tblProductListMaster.StoreCatNodeId=tblTmpInvoiceDetails.StoreCatNodeId Where tblProductListMaster.StoreCatNodeId=tblTmpInvoiceDetails.StoreCatNodeId and  (tblTmpInvoiceDetails.OrderQty>0 or tblTmpInvoiceDetails.FreeQty>0) and tblTmpInvoiceDetails.CatID="+CategoryId+" and  tblTmpInvoiceDetails.Sstat="+DraftorNonSubmitted+" Group By tblTmpInvoiceDetails.ProdID,tblProductListMaster.ProductShortName,tblProductListMaster.ProductMRP,tblProductListMaster.StandardRate,tblProductListMaster.DisplayUnit,tblProductListMaster.StoreCatNodeId Order by tblProductListMaster.CatOrdr,tblProductListMaster.PrdOrdr", null);
        //Cursor cursorSKUPrd = db.rawQuery("Select tblTmpInvoiceDetails.CatID || tblTmpInvoiceDetails.ProdID AS PID,tblProductListMaster.ProductShortName As ProdShortName,tblProductSegementMap.ProductMRP As PMRP,tblTmpInvoiceDetails.ProductPrice As PSRate,Sum(tblTmpInvoiceDetails.OrderQty) as OrderQty,Sum(Cast(tblTmpInvoiceDetails.FreeQty As Real)) AS FreeQty, Sum(Cast(tblTmpInvoiceDetails.OrderQty as Real)) As OrderVolume,Cast(Sum(tblTmpInvoiceDetails.FreeQty) AS Real) As FreeVolume,Sum(Cast(tblTmpInvoiceDetails.DisVal As Real)) As DisVal,Sum(Cast(tblTmpInvoiceDetails.OrderVal As Real))-Sum(Cast(tblTmpInvoiceDetails.TaxValue As Real)) As AmtBeforeTax,Sum(Cast(tblTmpInvoiceDetails.TaxValue As Real)) As TaxValue,Sum(Cast(tblTmpInvoiceDetails.OrderVal As Real)) As OrderVal,tblProductListMaster.DisplayUnit AS PDisplayUnit,Count(Distinct tblTmpInvoiceDetails.StoreID) As StoreCount,2 AS FlgRowType  from tblTmpInvoiceDetails inner join tblProductListMaster on tblTmpInvoiceDetails.ProdID=tblProductListMaster.ProductID and tblProductListMaster.StoreCatNodeId=tblTmpInvoiceDetails.StoreCatNodeId inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID  Where tblProductListMaster.StoreCatNodeId=tblTmpInvoiceDetails.StoreCatNodeId and  (tblTmpInvoiceDetails.OrderQty>0 or tblTmpInvoiceDetails.FreeQty>0) and tblTmpInvoiceDetails.CatID="+CategoryId+" and  tblTmpInvoiceDetails.Sstat="+DraftorNonSubmitted+"  Group By tblTmpInvoiceDetails.ProdID,tblProductListMaster.ProductShortName,tblProductSegementMap.ProductMRP,tblProductSegementMap.StandardRate,tblProductListMaster.DisplayUnit,tblProductListMaster.StoreCatNodeId Order by tblProductListMaster.CatOrdr,tblProductListMaster.PrdOrdr", null);
        // Cursor cursorSKUPrd = db.rawQuery("Select tblProductListMaster.CategoryID || tblTmpInvoiceDetails.ProdID AS PID,tblProductListMaster.ProductShortName As ProdShortName,((Sum(Cast(tblTmpInvoiceDetails.OrderVal As Real)))/Sum(tblTmpInvoiceDetails.OrderQty)) As PMRP,tblTmpInvoiceDetails.ProductPrice As PSRate,Sum(tblTmpInvoiceDetails.OrderQty) as OrderQty,Sum(Cast(tblTmpInvoiceDetails.FreeQty As Real)) AS FreeQty, Sum(Cast(tblTmpInvoiceDetails.OrderQty as Real)) As OrderVolume,Cast(Sum(tblTmpInvoiceDetails.FreeQty) AS Real) As FreeVolume,Sum(Cast(tblTmpInvoiceDetails.DisVal As Real)) As DisVal,Sum(Cast(tblTmpInvoiceDetails.OrderVal As Real))-Sum(Cast(tblTmpInvoiceDetails.TaxValue As Real)) As AmtBeforeTax,Sum(Cast(tblTmpInvoiceDetails.TaxValue As Real)) As TaxValue,Sum(Cast(tblTmpInvoiceDetails.OrderVal As Real)) As OrderVal,tblProductListMaster.DisplayUnit AS PDisplayUnit,Count(Distinct tblTmpInvoiceDetails.StoreID) As StoreCount,2 AS FlgRowType  from tblTmpInvoiceDetails inner join tblProductListMaster on tblTmpInvoiceDetails.ProdID=tblProductListMaster.ProductID   Where tblProductListMaster.CategoryID=tblTmpInvoiceDetails.CatID and  (tblTmpInvoiceDetails.OrderQty>0 or tblTmpInvoiceDetails.FreeQty>0) and tblTmpInvoiceDetails.CatID="+CategoryId+" and  tblTmpInvoiceDetails.Sstat="+DraftorNonSubmitted+"  Group By tblTmpInvoiceDetails.ProdID,tblProductListMaster.ProductShortName,tblProductListMaster.DisplayUnit Order by tblProductListMaster.CatOrdr,tblProductListMaster.PrdOrdr", null);
        Cursor cursorSKUPrd=null;
        if(flgReportFromTmpOrPermanent==0) {
            cursorSKUPrd = db.rawQuery("Select tblProductListMaster.CategoryID || tblTmpInvoiceDetails.ProdID AS PID,tblProductListMaster.ProductShortName As ProdShortName,((Sum(Cast(tblTmpInvoiceDetails.LineValAftrTxAftrDscnt As Real)))/Sum(tblTmpInvoiceDetails.OrderQty)) As PMRP,((Sum(Cast(tblTmpInvoiceDetails.LineValAftrTxAftrDscnt As Real)))/Sum(tblTmpInvoiceDetails.OrderQty)) As PSRate,Sum(tblTmpInvoiceDetails.OrderQty) as OrderQty,Sum(Cast(tblTmpInvoiceDetails.FreeQty As Real)) AS FreeQty, Sum(Cast(tblTmpInvoiceDetails.OrderQty as Real)) As OrderVolume,Cast(Sum(tblTmpInvoiceDetails.FreeQty) AS Real) As FreeVolume,Sum(Cast(tblTmpInvoiceDetails.DisVal As Real)) As DisVal,Sum(Cast(tblTmpInvoiceDetails.LineValAftrTxAftrDscnt As Real))-Sum(Cast(tblTmpInvoiceDetails.TaxValue As Real)) As AmtBeforeTax,Sum(Cast(tblTmpInvoiceDetails.TaxValue As Real)) AS TaxValue,Sum(Cast(tblTmpInvoiceDetails.LineValAftrTxAftrDscnt As Real)) As OrderVal,tblProductListMaster.DisplayUnit AS PDisplayUnit,Count(Distinct tblTmpInvoiceDetails.StoreID) As StoreCount,2 AS FlgRowType  from tblTmpInvoiceDetails inner join tblProductListMaster on tblTmpInvoiceDetails.ProdID=tblProductListMaster.ProductID Where tblTmpInvoiceDetails.CatID=" + CategoryId + "  and  tblTmpInvoiceDetails.Sstat=" + DraftorNonSubmitted + "  Group By tblProductListMaster.CategoryID, tblTmpInvoiceDetails.ProdID,tblProductListMaster.ProductShortName,tblProductListMaster.DisplayUnit having Sum(tblTmpInvoiceDetails.OrderQty) >0 or  Sum(Cast(tblTmpInvoiceDetails.FreeQty As Real))>0 Order by tblProductListMaster.CatOrdr,PrdOrdr", null);
        }
        if(flgReportFromTmpOrPermanent==1) {
            cursorSKUPrd = db.rawQuery("Select tblProductListMaster.CategoryID || tblInvoiceDetails.ProdID AS PID,tblProductListMaster.ProductShortName As ProdShortName,((Sum(Cast(tblInvoiceDetails.LineValAftrTxAftrDscnt As Real)))/Sum(tblInvoiceDetails.OrderQty)) As PMRP,((Sum(Cast(tblInvoiceDetails.LineValAftrTxAftrDscnt As Real)))/Sum(tblInvoiceDetails.OrderQty)) As PSRate,Sum(tblInvoiceDetails.OrderQty) as OrderQty,Sum(Cast(tblInvoiceDetails.FreeQty As Real)) AS FreeQty, Sum(Cast(tblInvoiceDetails.OrderQty as Real)) As OrderVolume,Cast(Sum(tblInvoiceDetails.FreeQty) AS Real) As FreeVolume,Sum(Cast(tblInvoiceDetails.DisVal As Real)) As DisVal,Sum(Cast(tblInvoiceDetails.LineValAftrTxAftrDscnt As Real))-Sum(Cast(tblInvoiceDetails.TaxValue As Real)) As AmtBeforeTax,Sum(Cast(tblInvoiceDetails.TaxValue As Real)) AS TaxValue,Sum(Cast(tblInvoiceDetails.LineValAftrTxAftrDscnt As Real)) As OrderVal,tblProductListMaster.DisplayUnit AS PDisplayUnit,Count(Distinct tblInvoiceDetails.StoreID) As StoreCount,2 AS FlgRowType  from tblInvoiceDetails inner join tblProductListMaster on tblInvoiceDetails.ProdID=tblProductListMaster.ProductID Where tblInvoiceDetails.CatID=" + CategoryId + "  and  tblInvoiceDetails.Sstat=" + DraftorNonSubmitted + "  Group By tblProductListMaster.CategoryID, tblInvoiceDetails.ProdID,tblProductListMaster.ProductShortName,tblProductListMaster.DisplayUnit having Sum(tblInvoiceDetails.OrderQty) >0 or  Sum(Cast(tblInvoiceDetails.FreeQty As Real))>0 Order by tblProductListMaster.CatOrdr,PrdOrdr", null);
        }
        try {
            //hmapCtgryDetails= key=CategoryId,val=CategoryDescr
            LinkedHashMap<String, String> hmapPrdRowDetails=new LinkedHashMap<String, String>();
            String strCatDisplayUnit="Kg/Liters";
            String strCatOrderVolume="";
            String strCatFreeVolume="";
            String strCatDiscValue="";
            String strCatAmountBeforeTax="";
            String strCatTaxValue="";
            String strCatOrderValue="";
            if (cursorSKUPrd.getCount() > 0) {
                if (cursorSKUPrd.moveToFirst()) {
                    for (int i = 0; i <= (cursorSKUPrd.getCount() - 1); i++) {

                        if(i==0)
                        {
                            strCatDisplayUnit=(String) cursorSKUPrd.getString(12).toString();
                        }
                        if(strCatOrderVolume.equals(""))
                        {
                            strCatOrderVolume=""+Double.parseDouble(cursorSKUPrd.getString(6).toString());
                        }
                        else
                        {
                            strCatOrderVolume=""+(Double.parseDouble(strCatOrderVolume) + Double.parseDouble(cursorSKUPrd.getString(6).toString()));
                        }
                        if(strCatFreeVolume.equals(""))
                        {
                            strCatFreeVolume=""+Double.parseDouble(cursorSKUPrd.getString(7).toString());

                            Double strCatFreeVolumeVolumeValue=Double.parseDouble(strCatFreeVolume);
                            strCatFreeVolume=""+ Double.parseDouble(new DecimalFormat("##.##").format(strCatFreeVolumeVolumeValue));
                        }
                        else
                        {
                            strCatFreeVolume=""+(Double.parseDouble(strCatFreeVolume) + Double.parseDouble(cursorSKUPrd.getString(7).toString()));

                            Double strCatFreeVolumeVolumeValue=Double.parseDouble(strCatFreeVolume);
                            strCatFreeVolume=""+ Double.parseDouble(new DecimalFormat("##.##").format(strCatFreeVolumeVolumeValue));
                        }
                        if(strCatDiscValue.equals(""))
                        {
                            strCatDiscValue=""+Double.parseDouble(cursorSKUPrd.getString(8).toString());
                        }
                        else
                        {
                            strCatDiscValue=""+(Double.parseDouble(strCatDiscValue) + Double.parseDouble(cursorSKUPrd.getString(8).toString()));


                        }
                        if(strCatAmountBeforeTax.equals(""))
                        {
                            strCatAmountBeforeTax=""+Double.parseDouble(cursorSKUPrd.getString(9).toString());
                        }
                        else
                        {
                            strCatAmountBeforeTax=""+(Double.parseDouble(strCatAmountBeforeTax) + Double.parseDouble(cursorSKUPrd.getString(9).toString()));
                        }
                        if(strCatTaxValue.equals(""))
                        {
                            strCatTaxValue=""+Double.parseDouble(cursorSKUPrd.getString(10).toString());
                        }
                        else
                        {
                            strCatTaxValue=""+(Double.parseDouble(strCatTaxValue) + Double.parseDouble(cursorSKUPrd.getString(10).toString()));
                        }
                        if(strCatOrderValue.equals(""))
                        {
                            strCatOrderValue=""+Double.parseDouble(cursorSKUPrd.getString(11).toString());
                        }
                        else
                        {
                            strCatOrderValue=""+(Double.parseDouble(strCatOrderValue) + Double.parseDouble(cursorSKUPrd.getString(11).toString()));
                        }

                        hmapPrdRowDetails.put(CategoryId +"_"+(String) cursorSKUPrd.getString(0).toString(),(String) cursorSKUPrd.getString(1).toString()+"^"+(String) cursorSKUPrd.getString(2).toString()+"^"+(String) cursorSKUPrd.getString(3).toString()+"^"+(String) cursorSKUPrd.getString(4).toString()+"^"+(String) cursorSKUPrd.getString(5).toString()+"^"+(String) cursorSKUPrd.getString(8).toString()+"^"+(String) cursorSKUPrd.getString(9).toString()+"^"+(String) cursorSKUPrd.getString(10).toString()+"^"+(String) cursorSKUPrd.getString(11).toString()+"^"+(String) cursorSKUPrd.getString(13).toString()+"^"+(String) cursorSKUPrd.getString(14).toString());
                        cursorSKUPrd.moveToNext();
                    }
                }

                if(strCatDisplayUnit.equals("Kg"))
                {
                    strCatOrderVolume=ConvertGramToKilo(strCatOrderVolume);
                    Double strCatOrderVolumeValue=Double.parseDouble(strCatOrderVolume);
                    strCatOrderVolume=""+ Double.parseDouble(new DecimalFormat("##.##").format(strCatOrderVolumeValue));
                }
                if(strCatDisplayUnit.equals("Lt"))
                {
                    strCatOrderVolume=ConvertMLToLiters(strCatOrderVolume);
                    Double strCatOrderVolumeValue=Double.parseDouble(strCatOrderVolume);
                    strCatOrderVolume=""+ Double.parseDouble(new DecimalFormat("##.##").format(strCatOrderVolumeValue));
                }


                if(strCatDisplayUnit.equals("Kg"))
                {
                    strCatFreeVolume=ConvertGramToKilo(strCatFreeVolume);
                    Double strCatFreeVolumeValue=Double.parseDouble(strCatFreeVolume);
                    strCatFreeVolume=""+ Double.parseDouble(new DecimalFormat("##.##").format(strCatFreeVolumeValue));
                }
                if(strCatDisplayUnit.equals("Lt"))
                {
                    strCatFreeVolume=ConvertMLToLiters(strCatFreeVolume);
                    Double strCatFreeVolumeValue=Double.parseDouble(strCatFreeVolume);
                    strCatFreeVolume=""+ Double.parseDouble(new DecimalFormat("##.##").format(strCatFreeVolumeValue));
                }


                totalProductCategoryWiseResult.add(0, strCatDisplayUnit);
                totalProductCategoryWiseResult.add(1, strCatOrderVolume);
                totalProductCategoryWiseResult.add(2, strCatFreeVolume);
                totalProductCategoryWiseResult.add(3, strCatDiscValue);
                totalProductCategoryWiseResult.add(4, strCatAmountBeforeTax);
                totalProductCategoryWiseResult.add(5, strCatTaxValue);
                totalProductCategoryWiseResult.add(6, strCatOrderValue);
                totalProductCategoryWiseResult.add(7, hmapPrdRowDetails);
            }


            return totalProductCategoryWiseResult;

        } finally {
            cursorSKUPrd.close();
            // close();
        }

    }

    public static int fnGetCountDailySummaryDetailsSKUWiseGrandTotal(int DraftorNonSubmitted,int flgReportFromTmpOrPermanent)//DraftorNonSubmitted=3:-Submited But Not Synced,DraftorNonSubmitted=1:-Saved as Draft
    {
        ////open();
        Cursor cursorGTota=null;
        if(flgReportFromTmpOrPermanent==1) {
            cursorGTota = db.rawQuery("Select Count(*) from tblInvoiceDetails where (OrderQty>0 or FreeQty>0) and Sstat=" + DraftorNonSubmitted + "", null);
        }
        if(flgReportFromTmpOrPermanent==0) {
            cursorGTota = db.rawQuery("Select Count(*) from tblTmpInvoiceDetails where (OrderQty>0 or FreeQty>0) and Sstat=" + DraftorNonSubmitted + "", null);
        }
        try {
            int CountCompleteResultSkuWiseProductLevel=0;
            if (cursorGTota.getCount() > 0) {
                if (cursorGTota.moveToFirst()) {
                    for (int i = 0; i <= (cursorGTota.getCount() - 1); i++) {
                        CountCompleteResultSkuWiseProductLevel = Integer.parseInt(cursorGTota.getString(0).toString());
                        cursorGTota.moveToNext();
                    }
                }
            }
            return CountCompleteResultSkuWiseProductLevel;

        } finally {
            cursorGTota.close();
            // close();
        }

    }

    public static void insertProductMappedWithSchemApplied(String storeId,String productId,String _schSlabId,String _schmId,String pdaOrderID,String TmpInvoiceCodePDA)
    {
        //open();


        ContentValues initialValues = new ContentValues();
        initialValues.put("schmIdMapped", _schmId.trim());
        initialValues.put("schSlabId", _schSlabId.trim());


        initialValues.put("StoreId", storeId.trim());
        initialValues.put("ProductID", productId.trim());
        initialValues.put("Sstat", 0);
        initialValues.put("OrderIDPDA", pdaOrderID);
        initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
        // System.out.println("DATABASE_TABLE_Main215 : StoreId = "+storeId+" ProductID = "+productId+" schSlabId ="+_schSlabId+" schmIdMapped ="+_schmId);

        db.insert(DATABASE_TABLE_Main215, null, initialValues);



        //close();

    }


    //	 DATABASE_CREATE_TABLE_215 =tblProductMappedWithSchemeSlabApplied (StoreId,ProductID,schSlabId,schmIdMapped
    // changes by nitish

    public static void insertSchemeAlrtVal(String storeId,String productId,String spinnerVal,String product,String SpinnerPosition,String _schSlabId,String _schmAlrtId,String pdaOrderID,String TmpInvoiceCodePDA)
    {
        //open();
        //StoreId text null,ProductID text null,SpinnerVal text null,SpinnerPosition text null,Product text null,schSlabId text null,schmAlrtId text null);";
        Cursor cur=db.rawQuery("Select Product,SpinnerVal from tblAlrtVal where StoreId ='"+storeId+"' and ProductID = '"+productId+"' and schSlabId = '"+_schSlabId+"' and schmAlrtId = '"+_schmAlrtId+"'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'",null );
        ContentValues initialValues = new ContentValues();

        initialValues.put("Product", product.trim());
        initialValues.put("SpinnerVal", spinnerVal.trim());
        initialValues.put("SpinnerPosition", SpinnerPosition.trim());



        if(cur.getCount()>0)
        {
            db.update(DATABASE_TABLE_Main214, initialValues, "StoreID=? AND ProductID=? AND  TmpInvoiceCodePDA=?",new String[] {storeId,productId,TmpInvoiceCodePDA});
        }
        else
        {

            //	 DATABASE_CREATE_TABLE_214,SpinnerPosition
            initialValues.put("schmAlrtId", _schmAlrtId.trim());
            initialValues.put("schSlabId", _schSlabId.trim());
            initialValues.put("StoreId", storeId.trim());
            initialValues.put("ProductID", productId.trim());
            initialValues.put("OrderIDPDA", pdaOrderID);
            initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
            //TmpInvoiceCodePDA

            db.insert(DATABASE_TABLE_Main214, null, initialValues);

        }

       // close();
        cur.close();
    }

    public static String[] getValOfSchemeAlrt(String storeId,String productId,String _schmSlabID,String pdaOrderID,String TmpInvoiceCodePDA)
    {
        //open();
        String[] alrtValues=new String[2];
        //open();
        Cursor cur=db.rawQuery("Select Product,SpinnerPosition from tblAlrtVal where StoreId ='"+storeId+"' and ProductID = '"+productId+"' and schSlabId = '"+_schmSlabID+"'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'",null );

        if(cur.getCount()>0)
        {
            if(cur.moveToFirst())
            {
                alrtValues[0]=cur.getString(0);
                alrtValues[1]=cur.getString(1);
            }


        }
        else
        {
            alrtValues[0]="No Data";
            alrtValues[1]="";
        }
        //close();
        cur.close();
        return alrtValues;

    }

    public static String getValOfSchemeAlrtSelected(String storeId,String _schmAlrtId,String _schSlabId,String pdaOrderID,String TmpInvoiceCodePDA)
    {
        //open();
        String alrtValues=null;
        //open();
        Cursor cur=db.rawQuery("Select SpinnerVal from tblAlrtVal where StoreId ='"+storeId+"' and schmAlrtId = '"+_schmAlrtId+"' and schSlabId = '"+_schSlabId+"'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'",null );

        if(cur.getCount()>0)
        {
            if(cur.moveToFirst())
            {
                alrtValues=cur.getString(0);

            }


        }
        else
        {
            alrtValues="0";

        }
        //close();
        cur.close();
        return alrtValues;

    }

    public static  LinkedHashMap<String, String> fnGetDailySummaryDetailsStoreWise(int DraftorNonSubmitted,int flgReportFromTmpOrPermanent)//DraftorNonSubmitted=3:-Submited But Not Synced,DraftorNonSubmitted=1:-Saved as Draft
    {
        ArrayList<Object> totalCategoryWiseResult=new ArrayList<Object>(11);

        //Getting Category Details Starts Here


        //hmapStoreDetails= key=StoreId,val=StoreDetails
        LinkedHashMap<String, String> hmapStoreWiseDailySummaryDetails=new LinkedHashMap<String, String>();

        //hmapStoreDetails= key=StoreId,val=StoreDetails
        LinkedHashMap<String, String> hmapStoreWiseDailySummaryDetailsWithGrandTotal=new LinkedHashMap<String, String>();
        String StoreStockValue="";
        String StoreDiscountValue="";
        String StoreOrderValueBeforeTax="";
        String StoreTaxValue="";
        String StoreOrderValueAfterTax="";

        //open();
        //or tblTmpInvoiceDetails.Stock>0
        Cursor cursor=null;
        if(flgReportFromTmpOrPermanent==0) {
            cursor = db.rawQuery("Select tblTmpInvoiceDetails.StoreID,tblStoreList.StoreName,Count(Distinct tblTmpInvoiceDetails.ProdID) As LinesPerBill,(Cast(tblTmpInvoiceDetails.ProductPrice As Real)*0) As StockValue,Sum(Cast(tblTmpInvoiceDetails.DisVal As Real)) As DiscountValue,(Sum(Cast(tblTmpInvoiceDetails.LineValAftrTxAftrDscnt As Real))-Sum(Cast(tblTmpInvoiceDetails.TaxValue As Real))) As ValueBeforeTax,Sum(Cast(tblTmpInvoiceDetails.TaxValue As Real)) As TaxValue,Sum(Cast(tblTmpInvoiceDetails.LineValAftrTxAftrDscnt As Real)) As ValueAfterTax from tblTmpInvoiceDetails inner join tblStoreList on tblTmpInvoiceDetails.StoreID=tblStoreList.StoreID Where  (tblTmpInvoiceDetails.OrderQty>0 or tblTmpInvoiceDetails.FreeQty>0) and tblTmpInvoiceDetails.Sstat=" + DraftorNonSubmitted + " Group By tblTmpInvoiceDetails.StoreID,tblStoreList.StoreName", null);
        }
        if(flgReportFromTmpOrPermanent==1) {
            cursor = db.rawQuery("Select tblInvoiceDetails.StoreID,tblStoreList.StoreName,Count(Distinct tblInvoiceDetails.ProdID) As LinesPerBill,(Cast(tblInvoiceDetails.ProductPrice As Real)*0) As StockValue,Sum(Cast(tblInvoiceDetails.DisVal As Real)) As DiscountValue,(Sum(Cast(tblInvoiceDetails.LineValAftrTxAftrDscnt As Real))-Sum(Cast(tblInvoiceDetails.TaxValue As Real))) As ValueBeforeTax,Sum(Cast(tblInvoiceDetails.TaxValue As Real)) As TaxValue,Sum(Cast(tblInvoiceDetails.LineValAftrTxAftrDscnt As Real)) As ValueAfterTax from tblInvoiceDetails inner join tblStoreList on tblInvoiceDetails.StoreID=tblStoreList.StoreID Where  (tblInvoiceDetails.OrderQty>0 or tblInvoiceDetails.FreeQty>0) and tblInvoiceDetails.Sstat=" + DraftorNonSubmitted + " Group By tblInvoiceDetails.StoreID,tblStoreList.StoreName", null);
        }
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapStoreWiseDailySummaryDetails.put((String) cursor.getString(0).toString(), (String) cursor.getString(1).toString()+"^"+(String) cursor.getString(2).toString()+"^"+(String) cursor.getString(3).toString()+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(5).toString()+"^"+(String) cursor.getString(6).toString()+"^"+(String) cursor.getString(7).toString());

                        if(StoreStockValue.equals(""))
                        {
                            StoreStockValue=(String) cursor.getString(3).toString();
                        }
                        else
                        {
                            StoreStockValue=""+(Double.parseDouble(StoreStockValue)+Double.parseDouble(cursor.getString(3).toString()));
                        }
                        if(StoreDiscountValue.equals(""))
                        {
                            StoreDiscountValue=(String) cursor.getString(4).toString();
                        }
                        else
                        {
                            StoreDiscountValue=""+(Double.parseDouble(StoreDiscountValue)+Double.parseDouble(cursor.getString(4).toString()));
                        }
                        if(StoreOrderValueBeforeTax.equals(""))
                        {
                            StoreOrderValueBeforeTax=(String) cursor.getString(5).toString();
                        }
                        else
                        {
                            StoreOrderValueBeforeTax=""+(Double.parseDouble(StoreOrderValueBeforeTax)+Double.parseDouble(cursor.getString(5).toString()));
                        }
                        if(StoreTaxValue.equals(""))
                        {
                            StoreTaxValue=(String) cursor.getString(6).toString();
                        }
                        else
                        {
                            StoreTaxValue=""+(Double.parseDouble(StoreTaxValue)+Double.parseDouble(cursor.getString(6).toString()));
                        }
                        if(StoreOrderValueAfterTax.equals(""))
                        {
                            StoreOrderValueAfterTax=(String) cursor.getString(7).toString();
                        }
                        else
                        {
                            StoreOrderValueAfterTax=""+(Double.parseDouble(StoreOrderValueAfterTax)+Double.parseDouble(cursor.getString(7).toString()));
                        }
                        if(i==cursor.getCount()-1)
                        {
                            int cntLinesBillTotStoreWiseGrandTotal=fnCountToDisplayDailySummaryDetailsStoreWiseLines(DraftorNonSubmitted,flgReportFromTmpOrPermanent);
                            hmapStoreWiseDailySummaryDetailsWithGrandTotal.put("0", "TOTAL :" +"^"+cntLinesBillTotStoreWiseGrandTotal+"^"+StoreStockValue+"^"+StoreDiscountValue+"^"+StoreOrderValueBeforeTax+"^"+StoreTaxValue+"^"+StoreOrderValueAfterTax);
                            hmapStoreWiseDailySummaryDetailsWithGrandTotal.putAll(hmapStoreWiseDailySummaryDetails);
                        }
                        cursor.moveToNext();
                    }
                }
                //totalCategoryWiseResult.add(1, hmapStoreDetails);


            }
            return hmapStoreWiseDailySummaryDetailsWithGrandTotal;

        } finally {
            cursor.close();
           // close();
        }
        //Getting Category Details Ends Here

    }


    // StoreWise Summary Function given by Abhinav Sir

    public static int fnCountToDisplayDailySummaryDetailsStoreWiseLines(int DraftorNonSubmitted,int flgReportFromTmpOrPermanent)//DraftorNonSubmitted=3:-Submited But Not Synced,DraftorNonSubmitted=1:-Saved as Draft
    {
        int CountToDisplayDailySummaryDetailsSKUWise=0;
        //ArrayList<HashMap<String, String>> totalProductDetail=new ArrayList<HashMap<String, String>>(4);

        //Getting Category Details Starts Here
        Cursor cursor=null;
        ////open();
        if(flgReportFromTmpOrPermanent==0) {
            cursor = db.rawQuery("Select Count(tblTmpInvoiceDetails.ProdID) from tblTmpInvoiceDetails Where  (tblTmpInvoiceDetails.OrderQty>0 or tblTmpInvoiceDetails.FreeQty>0) and tblTmpInvoiceDetails.Sstat=" + DraftorNonSubmitted, null);
        }
        if(flgReportFromTmpOrPermanent==1) {
            cursor = db.rawQuery("Select Count(tblInvoiceDetails.ProdID) from tblInvoiceDetails Where  (tblInvoiceDetails.OrderQty>0 or tblInvoiceDetails.FreeQty>0) and tblInvoiceDetails.Sstat=" + DraftorNonSubmitted, null);
        }
        try
        {
            if (cursor.getCount() > 0)
            {
                if (cursor.moveToFirst()) {
                    CountToDisplayDailySummaryDetailsSKUWise=Integer.parseInt(cursor.getString(0).toString());
                }
            }
            return CountToDisplayDailySummaryDetailsSKUWise;
        } finally {
            cursor.close();
            //close();
        }

    }

    public static int fnCountToDisplayDailySummaryDetailsStoreSKUWise(int DraftorNonSubmitted,int flgReportFromTmpOrPermanent)//DraftorNonSubmitted=3:-Submited But Not Synced,DraftorNonSubmitted=1:-Saved as Draft
    {
        int CountToDisplayDailySummaryDetailsSKUWise=0;
        //ArrayList<HashMap<String, String>> totalProductDetail=new ArrayList<HashMap<String, String>>(4);

        //Getting Category Details Starts Here
        Cursor cursor=null;
        //open();
        if(flgReportFromTmpOrPermanent==0) {
            cursor = db.rawQuery("Select Count(tblTmpInvoiceDetails.StoreID) from tblTmpInvoiceDetails Where  (tblTmpInvoiceDetails.OrderQty>0 or tblTmpInvoiceDetails.FreeQty>0) and tblTmpInvoiceDetails.Sstat=" + DraftorNonSubmitted, null);
        }
        if(flgReportFromTmpOrPermanent==1) {
            cursor = db.rawQuery("Select Count(tblInvoiceDetails.StoreID) from tblInvoiceDetails Where  (tblInvoiceDetails.OrderQty>0 or tblInvoiceDetails.FreeQty>0) and tblInvoiceDetails.Sstat=" + DraftorNonSubmitted, null);
        }
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    CountToDisplayDailySummaryDetailsSKUWise=Integer.parseInt(cursor.getString(0).toString());
                }
            }
            return CountToDisplayDailySummaryDetailsSKUWise;
        } finally {
            if(cursor!=null) {
                cursor.close();
            }
           // close();
        }

    }

    @SuppressWarnings("unchecked")

    public static LinkedHashMap<String, String> fnGetDailySummaryDetailsStoreSKUWiseLevel(int DraftorNonSubmitted,int flgReportFromTmpOrPermanent)//DraftorNonSubmitted=3:-Submited But Not Synced,DraftorNonSubmitted=1:-Saved as Draft
    {

        //Getting Category Details Starts Here

        LinkedHashMap<String, String> hmapSKUWiseDailySummaryReport=new LinkedHashMap<String, String>();

        LinkedHashMap<String, String> hmapGrandTotalCategorySKUWiseDailySummaryReport=new LinkedHashMap<String, String>();

        String CompleteResult[]=null;

        String strGrandTotalDiscValue="";
        String strGrandTotalAmountBeforeTax="";
        String strGrandTotalTaxValue="";
        String strGrandTotalOrderValue="";
        Cursor cursor =null;
        //open();
        // or tblTmpInvoiceDetails.Stock>0
        if(flgReportFromTmpOrPermanent==0) {
            cursor = db.rawQuery("Select tblTmpInvoiceDetails.StoreID,tblStoreList.StoreName,1 AS FlgRowType from  tblTmpInvoiceDetails inner join tblStoreList on  tblTmpInvoiceDetails.StoreID=tblStoreList.StoreID Where  (tblTmpInvoiceDetails.OrderQty>0 or tblTmpInvoiceDetails.FreeQty>0) and tblTmpInvoiceDetails.Sstat=" + DraftorNonSubmitted + " Group By tblTmpInvoiceDetails.StoreID,tblStoreList.StoreName", null);
        }
        if(flgReportFromTmpOrPermanent==1) {
            cursor = db.rawQuery("Select tblInvoiceDetails.StoreID,tblStoreList.StoreName,1 AS FlgRowType from  tblInvoiceDetails inner join tblStoreList on  tblInvoiceDetails.StoreID=tblStoreList.StoreID inner join tblStoreVisitMstr on tblStoreList.StoreID=tblStoreVisitMstr.StoreID Where  (tblInvoiceDetails.OrderQty>0 or tblInvoiceDetails.FreeQty>0) and tblStoreVisitMstr.Sstat=" + DraftorNonSubmitted + " Group By tblInvoiceDetails.StoreID,tblStoreList.StoreName", null);
        }
        try {
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        int StoreCatNodeId=fnGetStoreCatNodeId(cursor.getString(0).toString());
                        ArrayList<Object> arrProductDailySummaryKUWiseReportWithCategory=fnGetDailySummaryDetailsStoreSKUWiseProductLevel(cursor.getString(0).toString(),DraftorNonSubmitted,StoreCatNodeId,flgReportFromTmpOrPermanent);
                        if(arrProductDailySummaryKUWiseReportWithCategory.size()>0)
                        {
                            String strStoreSKUDiscValue=(String) arrProductDailySummaryKUWiseReportWithCategory.get(0);
                            String strStoreSKUAmountBeforeTax=(String) arrProductDailySummaryKUWiseReportWithCategory.get(1);
                            String strStoreSKUTaxValue=(String) arrProductDailySummaryKUWiseReportWithCategory.get(2);
                            String strStoreSKUOrderValue=(String) arrProductDailySummaryKUWiseReportWithCategory.get(3);

                            if(strGrandTotalDiscValue.equals(""))
                            {
                                strGrandTotalDiscValue=""+Double.parseDouble(strStoreSKUDiscValue);
                            }
                            else
                            {
                                strGrandTotalDiscValue=""+(Double.parseDouble(strGrandTotalDiscValue) + Double.parseDouble(strStoreSKUDiscValue));
                            }
                            if(strGrandTotalAmountBeforeTax.equals(""))
                            {
                                strGrandTotalAmountBeforeTax=""+Double.parseDouble(strStoreSKUAmountBeforeTax);
                            }
                            else
                            {
                                strGrandTotalAmountBeforeTax=""+(Double.parseDouble(strGrandTotalAmountBeforeTax) + Double.parseDouble(strStoreSKUAmountBeforeTax));
                            }
                            if(strGrandTotalTaxValue.equals(""))
                            {
                                strGrandTotalTaxValue=""+Double.parseDouble(strStoreSKUTaxValue);
                            }
                            else
                            {
                                strGrandTotalTaxValue=""+(Double.parseDouble(strGrandTotalTaxValue) + Double.parseDouble(strStoreSKUTaxValue));
                            }
                            if(strGrandTotalOrderValue.equals(""))
                            {
                                strGrandTotalOrderValue=""+Double.parseDouble(strStoreSKUOrderValue);
                            }
                            else
                            {
                                strGrandTotalOrderValue=""+(Double.parseDouble(strGrandTotalOrderValue) + Double.parseDouble(strStoreSKUOrderValue));
                            }
                            LinkedHashMap<String, String> hmapSkuLevelRows=new LinkedHashMap<String, String>();
                            hmapSkuLevelRows=(LinkedHashMap<String, String>) arrProductDailySummaryKUWiseReportWithCategory.get(4);
                            hmapSKUWiseDailySummaryReport.put((String) cursor.getString(0).toString(), (String) cursor.getString(1).toString()+"^"+"0"+"^"+"0"+"^"+"0"+"^"+"0"+"^"+"0"+"^"+strStoreSKUDiscValue+"^"+strStoreSKUAmountBeforeTax+"^"+strStoreSKUTaxValue+"^"+strStoreSKUOrderValue+"^"+(String) cursor.getString(2).toString());
                            hmapSKUWiseDailySummaryReport.putAll(hmapSkuLevelRows);
                            if(i == cursor.getCount()-1)
                            {
                                hmapGrandTotalCategorySKUWiseDailySummaryReport.put("0", "GRAND TOTAL :"+"^"+"0"+"^"+"0"+"^"+"0"+"^"+"0"+"^"+"0"+"^"+strGrandTotalDiscValue+"^"+strGrandTotalAmountBeforeTax+"^"+strGrandTotalTaxValue+"^"+strGrandTotalOrderValue+"^0");
                                hmapGrandTotalCategorySKUWiseDailySummaryReport.putAll(hmapSKUWiseDailySummaryReport);


                            }

                        }

                        cursor.moveToNext();
                    }
                }

            }




            return hmapGrandTotalCategorySKUWiseDailySummaryReport;

        } finally {
            if(cursor!=null) {
                cursor.close();
            }
            //close();
        }
        //Getting Category Details Ends Here
    }

    @SuppressWarnings("unchecked")

    public static ArrayList<Object> fnGetDailySummaryDetailsStoreSKUWiseProductLevel(String StoreID,int DraftorNonSubmitted,int StoreCatNodeId,int flgReportFromTmpOrPermanent)//DraftorNonSubmitted=3:-Submited But Not Synced,DraftorNonSubmitted=1:-Saved as Draft
    {
        ArrayList<Object> totalProductCategoryWiseResult=new ArrayList<Object>(4);
        Cursor cursorSKUPrd=null;
        //Cursor cursorSKUPrd = db.rawQuery("Select tblTmpInvoiceDetails.ProdID AS PID,tblProductListMaster.ProductShortName As ProdShortName,tblProductListMaster.ProductMRP As PMRP,tblTmpInvoiceDetails.ProductPrice As PSRate,tblTmpInvoiceDetails.Stock as Stock,tblTmpInvoiceDetails.OrderQty as OrderQty,tblTmpInvoiceDetails.FreeQty AS FreeQty,tblTmpInvoiceDetails.DisVal As DisVal,(Cast(tblTmpInvoiceDetails.OrderVal As Real)-Cast(tblTmpInvoiceDetails.TaxValue As Real)) As AmtBeforeTax,tblTmpInvoiceDetails.TaxValue As TaxValue,tblTmpInvoiceDetails.OrderVal As OrderVal,2 AS FlgRowType  from tblTmpInvoiceDetails inner join tblProductListMaster on tblTmpInvoiceDetails.ProdID=tblProductListMaster.ProductID Where  (tblTmpInvoiceDetails.OrderQty>0 or tblTmpInvoiceDetails.FreeQty>0) and tblTmpInvoiceDetails.StoreID='"+StoreID+"' and  tblTmpInvoiceDetails.Sstat="+DraftorNonSubmitted+" and tblTmpInvoiceDetails.StoreCatNodeId="+StoreCatNodeId+" and tblProductListMaster.StoreCatNodeId="+StoreCatNodeId+"  Group By tblTmpInvoiceDetails.ProdID,tblProductListMaster.ProductShortName,tblProductListMaster.ProductMRP,tblProductListMaster.StandardRate Order by PrdOrdr", null);
        //Cursor cursorSKUPrd = db.rawQuery("Select tblTmpInvoiceDetails.ProdID AS PID,tblProductListMaster.ProductShortName As ProdShortName,tblProductSegementMap.ProductMRP As PMRP,tblTmpInvoiceDetails.ProductPrice As PSRate,tblTmpInvoiceDetails.Stock as Stock,tblTmpInvoiceDetails.OrderQty as OrderQty,tblTmpInvoiceDetails.FreeQty AS FreeQty,tblTmpInvoiceDetails.DisVal As DisVal,(Cast(tblTmpInvoiceDetails.OrderVal As Real)-Cast(tblTmpInvoiceDetails.TaxValue As Real)) As AmtBeforeTax,tblTmpInvoiceDetails.TaxValue As TaxValue,tblTmpInvoiceDetails.OrderVal As OrderVal,2 AS FlgRowType  from tblTmpInvoiceDetails inner join tblProductListMaster on tblTmpInvoiceDetails.ProdID=tblProductListMaster.ProductID inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID Where  (tblTmpInvoiceDetails.OrderQty>0 or tblTmpInvoiceDetails.FreeQty>0) and tblTmpInvoiceDetails.StoreID='"+StoreID+"' and  tblTmpInvoiceDetails.Sstat="+DraftorNonSubmitted+" and tblTmpInvoiceDetails.StoreCatNodeId="+StoreCatNodeId+" and tblProductListMaster.StoreCatNodeId="+StoreCatNodeId+" Group By tblTmpInvoiceDetails.ProdID,tblProductListMaster.ProductShortName,tblProductSegementMap.ProductMRP,tblProductSegementMap.StandardRate Order by PrdOrdr", null);

        if(flgReportFromTmpOrPermanent==0) {
            cursorSKUPrd = db.rawQuery("Select tblTmpInvoiceDetails.ProdID AS PID,tblProductListMaster.ProductShortName As ProdShortName,((Sum(Cast(tblTmpInvoiceDetails.LineValAftrTxAftrDscnt As Real)))/Sum(tblTmpInvoiceDetails.OrderQty)) As PMRP,tblTmpInvoiceDetails.ProductPrice As PSRate,0 as Stock,tblTmpInvoiceDetails.OrderQty as OrderQty,tblTmpInvoiceDetails.FreeQty AS FreeQty,tblTmpInvoiceDetails.DisVal As DisVal,(Cast(tblTmpInvoiceDetails.LineValAftrTxAftrDscnt As Real)-Cast(tblTmpInvoiceDetails.TaxValue As Real)) As AmtBeforeTax,tblTmpInvoiceDetails.TaxValue As TaxValue,tblTmpInvoiceDetails.LineValAftrTxAftrDscnt As OrderVal,2 AS FlgRowType  from tblTmpInvoiceDetails inner join tblProductListMaster on tblTmpInvoiceDetails.ProdID=tblProductListMaster.ProductID Where  (tblTmpInvoiceDetails.OrderQty>0 or tblTmpInvoiceDetails.FreeQty>0) and tblTmpInvoiceDetails.StoreID='" + StoreID + "' and  tblTmpInvoiceDetails.Sstat=" + DraftorNonSubmitted + "  Group By tblTmpInvoiceDetails.ProdID,tblProductListMaster.ProductShortName Order by PrdOrdr", null);
        }
        if(flgReportFromTmpOrPermanent==1) {
            cursorSKUPrd = db.rawQuery("Select tblInvoiceDetails.ProdID AS PID,tblProductListMaster.ProductShortName As ProdShortName,((Sum(Cast(tblInvoiceDetails.LineValAftrTxAftrDscnt As Real)))/Sum(tblInvoiceDetails.OrderQty)) As PMRP,tblInvoiceDetails.ProductPrice As PSRate,0 as Stock,tblInvoiceDetails.OrderQty as OrderQty,tblInvoiceDetails.FreeQty AS FreeQty,tblInvoiceDetails.DisVal As DisVal,(Cast(tblInvoiceDetails.LineValAftrTxAftrDscnt As Real)-Cast(tblInvoiceDetails.TaxValue As Real)) As AmtBeforeTax,tblInvoiceDetails.TaxValue As TaxValue,tblInvoiceDetails.LineValAftrTxAftrDscnt As OrderVal,2 AS FlgRowType  from tblInvoiceDetails inner join tblProductListMaster on tblInvoiceDetails.ProdID=tblProductListMaster.ProductID Where  (tblInvoiceDetails.OrderQty>0 or tblInvoiceDetails.FreeQty>0) and tblInvoiceDetails.StoreID='" + StoreID + "' and  tblInvoiceDetails.Sstat=" + DraftorNonSubmitted + "  Group By tblInvoiceDetails.ProdID,tblProductListMaster.ProductShortName Order by PrdOrdr", null);
        }
        try {
            //hmapCtgryDetails= key=CategoryId,val=CategoryDescr
            LinkedHashMap<String, String> hmapPrdRowDetails=new LinkedHashMap<String, String>();
            String strCatDiscValue="";
            String strCatAmountBeforeTax="";
            String strCatTaxValue="";
            String strCatOrderValue="";
            if (cursorSKUPrd.getCount() > 0) {
                if (cursorSKUPrd.moveToFirst()) {
                    for (int i = 0; i <= (cursorSKUPrd.getCount() - 1); i++) {


                        if(strCatDiscValue.equals(""))
                        {
                            strCatDiscValue=""+Double.parseDouble(cursorSKUPrd.getString(7).toString());
                        }
                        else
                        {
                            strCatDiscValue=""+(Double.parseDouble(strCatDiscValue) + Double.parseDouble(cursorSKUPrd.getString(7).toString()));
                        }
                        if(strCatAmountBeforeTax.equals(""))
                        {
                            strCatAmountBeforeTax=""+Double.parseDouble(cursorSKUPrd.getString(8).toString());
                        }
                        else
                        {
                            strCatAmountBeforeTax=""+(Double.parseDouble(strCatAmountBeforeTax) + Double.parseDouble(cursorSKUPrd.getString(8).toString()));
                        }
                        if(strCatTaxValue.equals(""))
                        {
                            strCatTaxValue=""+Double.parseDouble(cursorSKUPrd.getString(9).toString());
                        }
                        else
                        {
                            strCatTaxValue=""+(Double.parseDouble(strCatTaxValue) + Double.parseDouble(cursorSKUPrd.getString(9).toString()));
                        }
                        if(strCatOrderValue.equals(""))
                        {
                            strCatOrderValue=""+Double.parseDouble(cursorSKUPrd.getString(10).toString());
                        }
                        else
                        {
                            strCatOrderValue=""+(Double.parseDouble(strCatOrderValue) + Double.parseDouble(cursorSKUPrd.getString(10).toString()));
                        }

                        hmapPrdRowDetails.put(StoreID +"_"+(String) cursorSKUPrd.getString(0).toString(),(String) cursorSKUPrd.getString(1).toString()+"^"+(String) cursorSKUPrd.getString(2).toString()+"^"+(String) cursorSKUPrd.getString(3).toString()+"^"+(String) cursorSKUPrd.getString(4).toString()+"^"+(String) cursorSKUPrd.getString(5).toString()+"^"+(String) cursorSKUPrd.getString(6).toString()+"^"+(String) cursorSKUPrd.getString(7).toString()+"^"+(String) cursorSKUPrd.getString(8).toString()+"^"+(String) cursorSKUPrd.getString(9).toString()+"^"+(String) cursorSKUPrd.getString(10).toString()+"^"+(String) cursorSKUPrd.getString(11).toString());
                        cursorSKUPrd.moveToNext();
                    }
                }


                totalProductCategoryWiseResult.add(0, strCatDiscValue);
                totalProductCategoryWiseResult.add(1, strCatAmountBeforeTax);
                totalProductCategoryWiseResult.add(2, strCatTaxValue);
                totalProductCategoryWiseResult.add(3, strCatOrderValue);
                totalProductCategoryWiseResult.add(4, hmapPrdRowDetails);
            }


            return totalProductCategoryWiseResult;

        } finally {
            cursorSKUPrd.close();
            // close();
        }

    }

    public static String[] getOrderedproductsOfBenSubBckt10(String storeId)
    {
        String[] productOrderedVal;
        //open();
        Cursor cursor=db.rawQuery("Select ProductID  from tblStoreProductAppliedSchemesBenifitsRecords where StoreID = '"+storeId+"' and BenSubBucketType ="+10, null);

        if(cursor.getCount()>0)
        {
            productOrderedVal=new String[cursor.getCount()];
            if(cursor.moveToFirst())
            {
                for(int i=0;i<cursor.getCount();i++)
                {
                    productOrderedVal[i]=cursor.getString(0);
                    cursor.moveToNext();
                }
            }
        }

        else
        {
            productOrderedVal=new String[1];
            productOrderedVal[0]="No Product";
        }
       // close();

        return productOrderedVal;
    }

    public static int CheckUserDoneGetStoreOrNot()
    {
        Cursor cursorE2 = null;
        int chkI = 0;

        try
        {
            //open();
            cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblStoreList", null);

            if (cursorE2.moveToFirst())
            {
                if (Integer.parseInt(cursorE2.getString(0)) > 0)
                {
                    chkI = 1;
                }
                else
                {
                    chkI = 0;
                }
            }

        }
        finally
        {
            if(cursorE2 != null)
            {
                cursorE2.close();
            }
            //close();
        }
        return chkI;
    }

    public static void droptblUserAuthenticationMstrTBL()
    {
        db.execSQL("DROP TABLE IF EXISTS tblUserAuthenticationMstr");
        db.execSQL("DROP TABLE IF EXISTS tblBloodGroup");
        db.execSQL("DROP TABLE IF EXISTS tblEducationQuali");

    }

    public static void createtblUserAuthenticationMstrTBL()
    {
        try
        {
            db.execSQL(TABLE_tblUserAuthenticationMstr_Definition);
            db.execSQL(DATABASE_CREATE_TABLE_tblBloodGroup);
            db.execSQL(DATABASE_CREATE_TABLE_tblEducationQuali);
        }
        catch (Exception e)
        {

        }

    }

    public static long savetblUserAuthenticationMstr(String flgUserAuthenticated,String PersonName,
                                              String FlgRegistered,String flgAppStatus,
                                              String DisplayMessage,String flgValidApplication,
                                              String MessageForInvalid,String flgPersonTodaysAtt,
                                              int PersonNodeID,int PersonNodeType,
                                              String ContactNo,String DOB,String SelfieName,
                                              String SelfieNameURL,String SalesAreaName,int CoverageNodeId,int CoverageNodeType,int FlgToShowAllRoutesData)
    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("flgUserAuthenticated", flgUserAuthenticated.trim());
        initialValues.put("PersonName", PersonName.trim());
        initialValues.put("FlgRegistered", FlgRegistered.trim());
      //  initialValues.put("flgAppStatus", flgAppStatus.trim());
      //  initialValues.put("DisplayMessage", DisplayMessage.trim());
      //  initialValues.put("flgValidApplication", flgValidApplication.trim());
       // initialValues.put("MessageForInvalid", MessageForInvalid.trim());
        initialValues.put("flgPersonTodaysAtt", flgPersonTodaysAtt.trim());
        initialValues.put("PersonNodeID", PersonNodeID);
        initialValues.put("PersonNodeType", PersonNodeType);
        initialValues.put("flgToShowAllRoutesData", FlgToShowAllRoutesData);
//flgToShowAllRoutesData
        initialValues.put("ContactNo", ContactNo.trim());
        initialValues.put("DOB", DOB.trim());
        initialValues.put("SelfieName", SelfieName.trim());
        initialValues.put("SelfieNameURL", SelfieNameURL);
        initialValues.put("SalesAreaName", SalesAreaName);
        initialValues.put("CoverageNodeId", CoverageNodeId);
        initialValues.put("CoverageNodeType", CoverageNodeType);

        return db.insert(TABLE_tblUserAuthenticationMstr_Define, null, initialValues);
    }

   /* public static long savetblUserAuthenticationMstr(String flgUserAuthenticated,String PersonName,
                                              String FlgRegistered,String PersonNodeID,String PersonNodeType,
                                              String flgPersonTodaysAtt)
    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("flgUserAuthenticated", flgUserAuthenticated.trim());
        initialValues.put("PersonName", PersonName.trim());
        initialValues.put("FlgRegistered", FlgRegistered.trim());
        initialValues.put("PersonNodeID", PersonNodeID.trim());
        initialValues.put("PersonNodeType", PersonNodeType.trim());
        initialValues.put("flgPersonTodaysAtt", flgPersonTodaysAtt.trim());



        // System.out.println("Data Insert in Table MAIN1User");

        return db.insert(TABLE_tblUserAuthenticationMstr_Define, null, initialValues);
    }*/

    public static long savetblBloodGroup(String BloddGroups)
    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("BloddGroups", BloddGroups.trim());

        // System.out.println("Data Insert in Table MAIN1User");

        return db.insert(TABLE_tblBloodGroup_Define, null, initialValues);
    }

    public static long savetblUserRegistarationStatus(String Flag,String MsgToDisplay)
    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("Flag", Flag.trim());
        initialValues.put("MsgToDisplay", MsgToDisplay.trim());

        // System.out.println("Data Insert in Table MAIN1User");

        return db.insert(TABLE_tblUserRegistarationStatus, null, initialValues);
    }

    public static LinkedHashMap<String, String> fnGettblBloodGroup()
    {
        LinkedHashMap<String, String> hmapQuestionMstr=new LinkedHashMap<String, String>();
        //open();

        try {
            Cursor cursor = db.rawQuery("SELECT BloddGroups from tblBloodGroup   ", null);// Where PNodeID='"+TSIID+"'
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapQuestionMstr.put((String) cursor.getString(0).toString(),(String) cursor.getString(0).toString());
                        //    System.out.println("QuestID:"+(String)cursor.getString(0).toString()+"QuestCode:"+(String) cursor.getString(1).toString()+"QuestDesc:"+(String) cursor.getString(2).toString()+"QuestType:"+(String) cursor.getString(3).toString()+"AnsControlType:"+(String) cursor.getString(4).toString()+"AnsControlInputTypeID:"+(String) cursor.getString(5).toString()+"AnsControlInputTypeMaxLength:"+(String) cursor.getString(6).toString()+"AnsMustRequiredFlg:"+(String) cursor.getString(7).toString()+"QuestBundleFlg:"+(String) cursor.getString(8).toString()+"ApplicationTypeID:"+(String) cursor.getString(9).toString()+"Sequence:"+(String) cursor.getString(10).toString());
                        cursor.moveToNext();
                    }
                }
            }

        }
        catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= "+e.toString());
        }
        finally
        {

            //close();
            return hmapQuestionMstr;
        }
    }

   /* public static String fnGetPersonNameAndFlgRegistered()
    {
        String PersonNameAndFlgRegistered="0";
        //open();

        try {
            Cursor cursor = db.rawQuery("SELECT  PersonName,  FlgRegistered from tblUserAuthenticationMstr   ", null);// Where PNodeID='"+TSIID+"'
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        PersonNameAndFlgRegistered=(String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString();

                        //    System.out.println("QuestID:"+(String)cursor.getString(0).toString()+"QuestCode:"+(String) cursor.getString(1).toString()+"QuestDesc:"+(String) cursor.getString(2).toString()+"QuestType:"+(String) cursor.getString(3).toString()+"AnsControlType:"+(String) cursor.getString(4).toString()+"AnsControlInputTypeID:"+(String) cursor.getString(5).toString()+"AnsControlInputTypeMaxLength:"+(String) cursor.getString(6).toString()+"AnsMustRequiredFlg:"+(String) cursor.getString(7).toString()+"QuestBundleFlg:"+(String) cursor.getString(8).toString()+"ApplicationTypeID:"+(String) cursor.getString(9).toString()+"Sequence:"+(String) cursor.getString(10).toString());
                        cursor.moveToNext();
                    }

                }
            }

        }
        catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= "+e.toString());
        }
        finally
        {

            close();
            return PersonNameAndFlgRegistered;
        }
    }*/

    public String fnGetPersonNameAndFlgRegistered()
    {
        String PersonNameAndFlgRegistered="0";
       // open();

        try {


            Cursor cursor = db.rawQuery("SELECT  PersonName,FlgRegistered,ContactNo,DOB,SelfieName,SelfieNameURL,SalesAreaName,PersonNodeID,PersonNodeType from tblUserAuthenticationMstr   ", null);// Where PNodeID='"+TSIID+"'
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        PersonNameAndFlgRegistered=(String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString()+"^"+(String) cursor.getString(2).toString()+"^"+(String) cursor.getString(3).toString()+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(5).toString()+"^"+(String) cursor.getString(6).toString()+"^"+(String) cursor.getString(7).toString()+"^"+(String) cursor.getString(8).toString();

                        cursor.moveToNext();
                    }

                }
            }

        }
        catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= "+e.toString());
        }
        finally
        {

            //close();
            return PersonNameAndFlgRegistered;
        }
    }

    public static String fnGettblUserRegistarationStatus()
    {
        String PersonNameAndFlgRegistered="0";
        //open();

        try {
            Cursor cursor = db.rawQuery("SELECT  Flag,  MsgToDisplay from tblUserRegistarationStatus   ", null);// Where PNodeID='"+TSIID+"'
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        String msg=(String) cursor.getString(1).toString();
                        if(msg.trim().equals("")){
                            msg="0";
                        }
                        PersonNameAndFlgRegistered=(String) cursor.getString(0).toString()+"^"+msg;

                        //    System.out.println("QuestID:"+(String)cursor.getString(0).toString()+"QuestCode:"+(String) cursor.getString(1).toString()+"QuestDesc:"+(String) cursor.getString(2).toString()+"QuestType:"+(String) cursor.getString(3).toString()+"AnsControlType:"+(String) cursor.getString(4).toString()+"AnsControlInputTypeID:"+(String) cursor.getString(5).toString()+"AnsControlInputTypeMaxLength:"+(String) cursor.getString(6).toString()+"AnsMustRequiredFlg:"+(String) cursor.getString(7).toString()+"QuestBundleFlg:"+(String) cursor.getString(8).toString()+"ApplicationTypeID:"+(String) cursor.getString(9).toString()+"Sequence:"+(String) cursor.getString(10).toString());
                        cursor.moveToNext();
                    }

                }
            }

        }
        catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= "+e.toString());
        }
        finally
        {

           // close();
            return PersonNameAndFlgRegistered;
        }
    }

    public static long savetblEducationQuali(String Qualification)
    {

        ContentValues initialValues = new ContentValues();
        initialValues.put("Qualification", Qualification.trim());
        // System.out.println("Data Insert in Table MAIN1User");
        return db.insert(TABLE_tblEducationQuali, null, initialValues);
    }

    public static long savetblDsrRegDetails(String IMEI,String ClickedDateTime,String FirstName,String LastName,String ContactNo,String DOB,String Sex,String MaritalStatus,String MarriedDate,String Qualification,String SelfieName,String SelfiePath,String EmailID,String BloodGroup,String SignName,String SignPath,int Sstat,String PhotoName,String PersonNodeId,String PersonNodeType)
    {

        ContentValues initialValues = new ContentValues();
        initialValues.put("IMEI", IMEI.trim());
        initialValues.put("ClickedDateTime", ClickedDateTime.trim());
        initialValues.put("FirstName", FirstName.trim());
        initialValues.put("LastName", LastName.trim());
        initialValues.put("ContactNo", ContactNo.trim());
        initialValues.put("DOB", DOB.trim());
        initialValues.put("Sex", Sex.trim());
        initialValues.put("MaritalStatus", MaritalStatus.trim());
        initialValues.put("MarriedDate", MarriedDate.trim());
        initialValues.put("Qualification", Qualification.trim());
        initialValues.put("SelfieName", SelfieName.trim());
        initialValues.put("SelfiePath", SelfiePath.trim());
        initialValues.put("EmailID", EmailID.trim());
        initialValues.put("BloodGroup", BloodGroup.trim());
        initialValues.put("SignName", SignName.trim());
        initialValues.put("SignPath", SignPath.trim());
        initialValues.put("Sstat", Sstat);
        initialValues.put("PhotoName", PhotoName.trim());
        initialValues.put("PersonNodeId", PersonNodeId.trim());
        initialValues.put("PersonNodeType", PersonNodeType.trim());

        return db.insert(TABLE_tblDsrRegDetails, null, initialValues);
    }

    public static int fngetcounttblDsrRegDetails()
    {
        int flgCheck=0;
        //open();

        try {
            Cursor cursor = db.rawQuery("SELECT Count(*) from tblDsrRegDetails  ", null);
            //StoreID,StoreName,LatCode,LongCode,DateAdded
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    if(cursor.getInt(0)>0)
                    {
                        flgCheck=1;
                    }
                }
            }

        }
        catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= "+e.toString());
        }
        finally
        {

           // close();
            return flgCheck;
        }
    }

    public static LinkedHashMap<String, String> fnGettblDsrRegDetails()
    {
        LinkedHashMap<String, String> hmapQuestionMstr=new LinkedHashMap<String, String>();
        //open();

        try {                                   //0             1                         2                      3                         4           5             6              7                         8                9                           10                    11                12                   13                 14                 15                        16           17                      18
            Cursor cursor = db.rawQuery("SELECT IFNULL(IMEI,0),IFNULL(ClickedDateTime,0),IFNULL(FirstName,0),IFNULL(LastName,0),IFNULL(ContactNo,0),IFNULL(DOB,0),IFNULL(Sex,0),IFNULL(MaritalStatus,0),IFNULL(MarriedDate,0),IFNULL(Qualification,0),IFNULL(SelfieName,0),IFNULL(SelfiePath,0),IFNULL(EmailID,0),IFNULL(BloodGroup,0),IFNULL(SignName,0),IFNULL(SignPath,0),IFNULL(PhotoName,0),IFNULL(PersonNodeId,0),IFNULL(PersonNodeType,0) from tblDsrRegDetails   ", null);// Where PNodeID='"+TSIID+"'
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapQuestionMstr.put("DSRDETAILS",(String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString()+"^"+(String) cursor.getString(2).toString()+"^"+(String) cursor.getString(3).toString()+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(5).toString()+"^"+(String) cursor.getString(6).toString()+"^"+(String) cursor.getString(7).toString()+"^"+(String) cursor.getString(8).toString()+"^"+(String) cursor.getString(9).toString()+"^"+(String) cursor.getString(10).toString()+"^"+(String) cursor.getString(11).toString()+"^"+(String) cursor.getString(12).toString()+"^"+(String) cursor.getString(13).toString()+"^"+(String) cursor.getString(14).toString()+"^"+(String) cursor.getString(15).toString()+"^"+(String) cursor.getString(16).toString()+"^"+(String) cursor.getString(17).toString()+"^"+(String) cursor.getString(18).toString());
                        //    System.out.println("QuestID:"+(String)cursor.getString(0).toString()+"QuestCode:"+(String) cursor.getString(1).toString()+"QuestDesc:"+(String) cursor.getString(2).toString()+"QuestType:"+(String) cursor.getString(3).toString()+"AnsControlType:"+(String) cursor.getString(4).toString()+"AnsControlInputTypeID:"+(String) cursor.getString(5).toString()+"AnsControlInputTypeMaxLength:"+(String) cursor.getString(6).toString()+"AnsMustRequiredFlg:"+(String) cursor.getString(7).toString()+"QuestBundleFlg:"+(String) cursor.getString(8).toString()+"ApplicationTypeID:"+(String) cursor.getString(9).toString()+"Sequence:"+(String) cursor.getString(10).toString());
                        cursor.moveToNext();
                    }
                }
            }

        }
        catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= "+e.toString());
        }
        finally
        {

           // close();
            return hmapQuestionMstr;
        }
    }

    public static LinkedHashMap<String, String> fnGettblEducationQuali()
    {
        LinkedHashMap<String, String> hmapQuestionMstr=new LinkedHashMap<String, String>();
        //open();

        try {
            Cursor cursor = db.rawQuery("SELECT Qualification from tblEducationQuali   ", null);// Where PNodeID='"+TSIID+"'
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapQuestionMstr.put((String) cursor.getString(0).toString(),(String) cursor.getString(0).toString());
                        //    System.out.println("QuestID:"+(String)cursor.getString(0).toString()+"QuestCode:"+(String) cursor.getString(1).toString()+"QuestDesc:"+(String) cursor.getString(2).toString()+"QuestType:"+(String) cursor.getString(3).toString()+"AnsControlType:"+(String) cursor.getString(4).toString()+"AnsControlInputTypeID:"+(String) cursor.getString(5).toString()+"AnsControlInputTypeMaxLength:"+(String) cursor.getString(6).toString()+"AnsMustRequiredFlg:"+(String) cursor.getString(7).toString()+"QuestBundleFlg:"+(String) cursor.getString(8).toString()+"ApplicationTypeID:"+(String) cursor.getString(9).toString()+"Sequence:"+(String) cursor.getString(10).toString());
                        cursor.moveToNext();
                    }
                }
            }

        }
        catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= "+e.toString());
        }
        finally
        {

          //  close();
            return hmapQuestionMstr;
        }
    }

    public static int FetchflgUserAuthenticated()
    {
        int SnamecolumnIndex1 = 0;
        int CatId=0;

        Cursor cursor = db.rawQuery("SELECT flgUserAuthenticated from tblUserAuthenticationMstr", null);
        try {

            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {

                    String abc =(String) cursor.getString(SnamecolumnIndex1).toString();
                    CatId=Integer.parseInt(abc);
                    cursor.moveToNext();
                }

            }
            return CatId;
        } finally {
            cursor.close();
        }

    }

    public static boolean isFreeProductIdExist(int freeProductId)
    {


        //open();
        Cursor cur=db.rawQuery("Select ProductID from tblStoreProductAppliedSchemesBenifitsRecords where freeProductId ="+freeProductId, null);
        try
        {


            if(cur.getCount()>0)
            {
                return true;
            }
            else
            {
                return false;
            }
        }
        finally
        {
            cur.close();
           // close();

        }



    }

    public static String getFreeProductIdAgainstFreeProductId(int freeProductId)
    {

        String productIdAgainstFreeProductId=null;
        //open();
        Cursor cur=db.rawQuery("Select ProductID from tblStoreProductAppliedSchemesBenifitsRecords where freeProductId ="+freeProductId, null);
        try
        {


            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    productIdAgainstFreeProductId=cur.getString(0);
                }

            }
            else
            {
                productIdAgainstFreeProductId="";
            }
        }

        finally
        {
            cur.close();
           // close();

        }

        return productIdAgainstFreeProductId;

    }

    public static String[] fectStatusIfBeniftRowIdExistsInSchemeSlabBenefitsValueDetailWithoutMultiply(int BenifitRowID,int toMultiply,Double defaultValue,int BenSubBucketType)
    {

        //open();
        Cursor cursor2 = db.rawQuery("SELECT BenValue FROM tblSchemeSlabBenefitsValueDetail where RowID="+BenifitRowID, null);
        if(BenSubBucketType==2 || BenSubBucketType==6 || BenSubBucketType==8)
        {
            toMultiply=1;
        }
        //////////// System.out.println("SELECT Sum(flgIsStrachApplicable) FROM tblStrachApplicableOnScheme");
        String[] chkI;
        try {
            if(cursor2.getCount()>0)
            {
                chkI=new String[cursor2.getCount()+1];
                if (cursor2.moveToFirst()) {
                    for (int i = 0; i < cursor2.getCount(); i++)
                    {
                        if(i==0)
                        {
                            chkI[i]=String.valueOf(defaultValue);

                        }

                        chkI[i+1]=String.valueOf((Integer.parseInt(cursor2.getString(0))));

                        cursor2.moveToNext();
                    }

                }
            }
            else
            {
                chkI=new String[1];
                chkI[0]=String.valueOf(defaultValue);
            }

        } finally {
            cursor2.close();
           // close();
        }
        //////////// System.out.println("fnCheckflgToShowStrachRowOrNot : " +chkI);
        return chkI;
    }

    public static void deleteAlrtProduct(String storeId,String _productID)
    {
        //open();
        Cursor cur=db.rawQuery("Select ProductID from tblAlrtVal where StoreId ='"+storeId+"' and ProductID = '"+_productID+"'",null );
        if(cur.getCount()>0)
        {
            db.delete(DATABASE_TABLE_Main214, "StoreID=? AND ProductID=? ",new String[] {storeId,_productID});
        }

       // close();
    }

    public static int checkStoreListTableCount()
    {

        Cursor cursor = db.rawQuery("SELECT Count(*) FROM tblStoreList ", null);

        try {

            int check=0;

            if (cursor.getCount() > 0)
            {
                if (cursor.moveToFirst())
                {

                    check=cursor.getCount();
			                 /* for (int i = 0; i <= (cursor.getCount() - 1); i++)
								{
									check=1;
									cursor.moveToNext();
								}*/
                }

            }
            return check;

        } finally {
            cursor.close();
        }

    }

    public static void deleteAlreadyStoreIdExist(String CustomStoreID)
    {

        db.execSQL("DELETE FROM tblStoreList WHERE StoreID ='"+CustomStoreID+"' ");
        db.execSQL("DELETE FROM tblNewStoreListEntriesNewFormat WHERE StoreID ='"+CustomStoreID+"' ");


    }

    public static void deletetblStoreTypeMstr()
    {
        db.execSQL("DELETE FROM tblStoreTypeMstr");
    }

    public static void deletetblTradeChannelMstr()
    {
        db.execSQL("DELETE FROM tblTradeChannelMstr");
    }

    public static void deletetblDayStartAttendanceOptions()
    {
        db.execSQL("DELETE FROM tblDayStartAttendanceOptions");
    }

    public static void deletetblStoreProductClassificationTypeListMstr()
    {
        db.execSQL("DELETE FROM tblStoreProductClassificationTypeListMstr");
    }

    public static void updatetblAvailableVersionMstr(String ServerDate)
    {


        db.execSQL("Update tblAvailableVersion Set  ServerDate='"+ServerDate+"'");

    }

    public static int checkRouteIDExistInStoreListTable()
    {
        int check=0;
        Cursor cursor = db.rawQuery("SELECT Count(*) FROM tblInvoiceButtonTransac WHERE Sstat=9", null);
        try {
            if (cursor.getCount() > 0)
            {
                if (cursor.moveToFirst())
                {
                    if(cursor.getInt(0)>0)
                    {
                        check=1;
                    }
                }
            }
            return check;
        } finally {
            cursor.close();
        }

    }



    public static long savetblOutletChannelBusinessSegmentMaster(int OutChannelID,String ChannelName,int BusinessSegmentID,String BusinessSegment)
    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("OutChannelID", OutChannelID);
        initialValues.put("ChannelName", ChannelName);

        initialValues.put("BusinessSegmentID", BusinessSegmentID);
        initialValues.put("BusinessSegment", BusinessSegment);

        return db.insert(TABLE_OutletChannelBusinessSegmentMaster, null, initialValues);
    }




    public static StringBuilder fnQuestionIdOnBasisOfDependentQuestionIDdpndntId(String dpndntQuesId,String optionId)
    {

        String value;
        //open();
        //tblGetPDAQuestionDependentMstr(QuestionID int null,OptionID int null,DependentQuestionID int null,GrpID int null,GrpDepQuestID int null);";
        Cursor cursor = db.rawQuery("SELECT GrpID from tblGetPDAQuestionDependentMstr where GrpDepQuestID = '"+dpndntQuesId +"' And OptionID = '"+optionId+"'", null);// Where PNodeID='"+TSIID+"'
        StringBuilder arrbhi=new StringBuilder();
        try {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        // hmapDpndntQuestionMstr.put((String) cursor.getString(3).toString()+"^"+(String) cursor.getString(1).toString(), (String) cursor.getString(2).toString());
                        if(i==0)
                        {
                            arrbhi.append(cursor.getString(0).toString());
                        }
                        else
                        {
                            arrbhi.append("^").append(cursor.getString(0).toString());
                        }

                        cursor.moveToNext();
                    }
                }
            }

            return arrbhi;
        }
        finally
        {
            cursor.close();
           // close();
        }
    }

    public static String[] fnQuestionIdDpndnt()
    {

        String value;
        //open();

        Cursor cursor = db.rawQuery("SELECT QuestionID from tblGetPDAQuestionDependentMstr", null);// Where PNodeID='"+TSIID+"'
        String[] arrbhi=new String[cursor.getCount()];
        try {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        // hmapDpndntQuestionMstr.put((String) cursor.getString(3).toString()+"^"+(String) cursor.getString(1).toString(), (String) cursor.getString(2).toString());
                        arrbhi[i]=(cursor.getString(0).toString());



                        cursor.moveToNext();
                    }
                }
            }

            return arrbhi;
        }
        finally
        {
            cursor.close();
            //close();
        }
    }

    public static int fnGetAnsValFromOptionID(int optionID)
    {
        //open();
        int AnsVal=0;
        Cursor cursor = db.rawQuery("SELECT tblGetPDAQuestOptionMstr.OptionNo from tblGetPDAQuestOptionMstr Where tblGetPDAQuestOptionMstr.OptID='"+optionID+"'", null);
        try {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    AnsVal=Integer.parseInt(cursor.getString(0).toString());
                }
            }
            return AnsVal;
        }
        finally
        {
            cursor.close();
            //close();
        }
    }

    public static void saveOutletQuestAnsMstr(ArrayList<ArrayList<String>> outletQuestAnsVal)
    {

        //open();

        String OutletID,QuestID,AnswerType,AnswerValue;
        for(int i=0;i<outletQuestAnsVal.size();i++)
        {
            ArrayList<String> outletsDetailValue=outletQuestAnsVal.get(i);

            OutletID=outletsDetailValue.get(0);
            QuestID=outletsDetailValue.get(1);
            AnswerType=outletsDetailValue.get(2);
            AnswerValue=outletsDetailValue.get(3);

            Cursor cursor = db.rawQuery("SELECT OutletID FROM tblOutletQuestAnsMstr where OutletID='"+OutletID +"' and QuestID ='"+ QuestID +"'" , null);
            ContentValues initialValues = new ContentValues();
            System.out.println("SavingPartCompleted ="+ OutletID+":"+QuestID+":"+AnswerType+":"+AnswerValue);

            initialValues.put("AnswerType", Integer.parseInt(AnswerType));


            initialValues.put("AnswerValue", AnswerValue.trim());
            initialValues.put("Sstat", 1);


            if(cursor.getCount()>0)
            {

                int affected = db.update("tblOutletQuestAnsMstr", initialValues, "OutletID=? AND QuestID=?",
                        new String[] {OutletID.toString().trim(),QuestID.toString().trim()});
            }
            else
            {

                initialValues.put("QuestID", Integer.parseInt(QuestID));
                initialValues.put("OutletID", OutletID.toString().trim());

                db.insert(TABLE_OutletQuestAnsMstr, null, initialValues);
            }


        }

       // close();

    }


		  	/*public static long savetblGetPDAQuestMstr(String QuestID,String QuestCode,String QuestDesc,String QuestType,String AnsControlType,String AnsControlInputTypeID,String AnsControlInputTypeMaxLength,String AnsMustRequiredFlg,String QuestBundleFlg,String ApplicationTypeID,String Sequence,String AnsControlInputTypeMinLength,int flgQuestIDForOutChannel)
		    {

		         ContentValues initialValues = new ContentValues();

		         initialValues.put("QuestCode", Integer.parseInt(QuestCode));
		         initialValues.put("QuestID", Integer.parseInt(QuestID));

		         initialValues.put("QuestDesc", QuestDesc.trim());
		         initialValues.put("QuestType", Integer.parseInt(QuestType));
		         initialValues.put("AnsControlType", Integer.parseInt(AnsControlType));
		         initialValues.put("AnsControlInputTypeID", Integer.parseInt(AnsControlInputTypeID));
		         initialValues.put("AnsControlInputTypeMaxLength", Integer.parseInt(AnsControlInputTypeMaxLength));
		         initialValues.put("AnsMustRequiredFlg", Integer.parseInt(AnsMustRequiredFlg));
		         initialValues.put("QuestBundleFlg", Integer.parseInt(QuestBundleFlg));
		         initialValues.put("ApplicationTypeID", Integer.parseInt(ApplicationTypeID));
		         initialValues.put("Sequence", Integer.parseInt(Sequence));//AnsControlInputTypeMinLength
		         initialValues.put("flgQuestIDForOutChannel", flgQuestIDForOutChannel);
		        // initialValues.put("AnsControlInputTypeMinLength", Integer.parseInt(AnsControlInputTypeMinLength));


		      return db.insert(TABLE_QuestionMstr, null, initialValues);
		    }*/

    public static void saveViewOutletQuestAnsMstr(ArrayList<ArrayList<String>> outletQuestAnsVal)
    {

        //open();

        String OutletID,QuestID,AnswerType,AnswerValue;
        for(int i=0;i<outletQuestAnsVal.size();i++)
        {
            ArrayList<String> outletsDetailValue=outletQuestAnsVal.get(i);

            OutletID=outletsDetailValue.get(0);
            QuestID=outletsDetailValue.get(1);
            AnswerType=outletsDetailValue.get(2);
            AnswerValue=outletsDetailValue.get(3);
            Cursor cursor = db.rawQuery("SELECT OutletID FROM tblViewOutletQuestAnsMstr where OutletID='"+OutletID +"' and QuestID ='"+ QuestID +"'" , null);
            ContentValues initialValues = new ContentValues();
            System.out.println("SavingPartCompleted ="+ OutletID+":"+QuestID+":"+AnswerType+":"+AnswerValue);


            initialValues.put("AnswerType", Integer.parseInt(AnswerType));


            initialValues.put("AnswerValue", AnswerValue.trim());

            if(cursor.getCount()>0)
            {

                int affected = db.update("tblViewOutletQuestAnsMstr", initialValues, "OutletID=? AND QuestID=?",
                        new String[] {OutletID.toString().trim(),QuestID.toString().trim()});
            }
            else
            {
                initialValues.put("QuestID", Integer.parseInt(QuestID));
                initialValues.put("OutletID", OutletID.toString().trim());

                db.insert(TABLE_ViewOutletQuestAnsMstr, null, initialValues);
            }


        }

       // close();

    }

    public static void saveViewOutletNameAndId(String outletId,String outletName)
    {

        //open();


        Cursor cursor = db.rawQuery("SELECT OutletID FROM tblViewOutletNameAndId where OutletID='"+outletId +"'" , null);
        ContentValues initialValues = new ContentValues();



        initialValues.put("OutletName", outletName.toString().trim());


        if(cursor.getCount()>0)
        {
            int affected = db.update("tblViewOutletNameAndId", initialValues, "OutletID=?",
                    new String[] {outletId.toString().trim()});
        }
        else
        {
            initialValues.put("OutletID", outletId.toString().trim());
            db.insert(TABLE_ViewOutletNameAndId, null, initialValues);
        }





      //  close();

    }

    public static LinkedHashMap<String, String> getAllNewAddedStoreName()
    {
        LinkedHashMap<String, String> lnkdHmapAllNewAddedStore=new LinkedHashMap<String, String>();

        //open();

        Cursor cur=db.rawQuery("Select * from tblViewOutletNameAndId", null);
        if(cur.getCount()>0)
        {
            if(cur.moveToFirst())
            {
                for(int i=0;i<cur.getCount();i++)
                {
                    lnkdHmapAllNewAddedStore.put(cur.getString(0), cur.getString(1));
                    cur.moveToNext();
                }
            }
        }
       // close();
        return lnkdHmapAllNewAddedStore;
    }

    public static LinkedHashMap<String, String> getAllQuesSavedForOutlet(String outletId)
    {
        LinkedHashMap<String, String> lnkdHmapAllQuesSavedForOutlet=new LinkedHashMap<String, String>();

        //open();

        Cursor cur=db.rawQuery("Select * from tblViewOutletQuestAnsMstr where OutletID = '"+outletId+"'", null);
        if(cur.getCount()>0)
        {
//OutletID ,QuestID ,AnswerType , AnswerValue );";
            if(cur.moveToFirst())
            {
                for(int i=0;i<cur.getCount();i++)
                {
                    lnkdHmapAllQuesSavedForOutlet.put(cur.getString(1)+"^"+ cur.getString(2),cur.getString(3));
                    cur.moveToNext();
                }
            }
        }
      //  close();
        return lnkdHmapAllQuesSavedForOutlet;
    }

    public static long savedataStoreList(String StoreID,String VisitDateTime,String ActualLatitude,String ActualLongitude,String LocProvider,String Accuracy,String BateryLeftStatus,String StoreName,int ISNewStore,
                                  int Sstat)
    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("OutletID", StoreID.trim());
        initialValues.put("VisitDateTime", VisitDateTime.trim());

        initialValues.put("ActualLatitude", ActualLatitude);
        initialValues.put("ActualLongitude", ActualLongitude);
        initialValues.put("LocProvider", LocProvider);
        initialValues.put("Accuracy", Accuracy);
        initialValues.put("BateryLeftStatus", BateryLeftStatus);
        initialValues.put("StoreName", StoreName.trim());
        initialValues.put("ISNewStore", ISNewStore);
        initialValues.put("Sstat", Sstat);

        ////System.out.println("inserting records in StoreList table..");

        return db.insert(DATABASE_CREATE_TABLE_tblOutletMstr, null, initialValues);
    }


    //

    public static String[] getStoreIDTblSelectedStoreIDinChangeRouteCaseStoreMapping() {

        int SnamecolumnIndex1 = 0;

        Cursor cursor = db.rawQuery("SELECT DISTINCT(OutletID) FROM tblOutletPhotoDetail where Sstat=3", null);
        try {

            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1).toString();
                    System.out.println("STORE ID 4 Pic: "+cursor.getString(SnamecolumnIndex1).toString());

                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }

    }

    public static int getExistingPicNosStoreMapping(String OutId) {

        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT Count(OutletID) FROM tblOutletPhotoDetail where OutletID='" + OutId + "'", null);
        try {
            int strProdStockQty = 0;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    if (!cursor.isNull(ScodecolumnIndex)) {
                        strProdStockQty = Integer.parseInt(cursor.getString(ScodecolumnIndex).toString());
                        cursor.moveToNext();
                    }

                }
            }
            return strProdStockQty;
        } finally {
            cursor.close();
        }
    }

    public static String[] getImgsPath(String StoreID)
    {

        int SnamecolumnIndex1 = 0;

        Cursor cursor = db.rawQuery("SELECT PhotoName FROM tblStoreMaterialPhotoDetail WHERE StoreID ='"+ StoreID + "'", null);
        try {

            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1)
                            .toString();

                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }

    }

    public static void updatexmlSyncdData()
    {
        try
        {

            final ContentValues values = new ContentValues();
            values.put("Sstat", "4");
            int affected = db.update("tblOutletMstr", values, "Sstat=?",
                    new String[] { "3" });
            int affected2 = db.update("tblOutletQuestAnsMstr", values, "Sstat=?",
                    new String[] { "3" });

        }
        catch (Exception ex)
        {

        }

    }


			/* public static void updateRecordsSyncd()
				{
				 try
					{

	                    final ContentValues values = new ContentValues();
						values.put("Sstat", "4");
						int affected = db.update("tblOutletMstr", values, "Sstat=?",
								new String[] { "3" });
						int affected2 = db.update("tblOutletQuestAnsMstr", values, "Sstat=?",
								new String[] { "3" });
						int affected3 = db.update("tblOutletPhotoDetail", values, "Sstat=?",
								new String[] { "3" });

					}
					catch (Exception ex)
					{

					}

				}*/

    public static void updatePhotoSyncdData()
    {
        try
        {

            final ContentValues values = new ContentValues();
            values.put("Sstat", "4");
            int affected3 = db.update("tblOutletPhotoDetail", values, "Sstat=?",
                    new String[] { "3" });

        }
        catch (Exception ex)
        {

        }

    }

    public static void deletetblOutletPhotoDetailBasedOutletID(String OutletID)
    {
        //open();


        db.execSQL("DELETE FROM tblOutletPhotoDetail WHERE OutletID ='"+ OutletID + "'");



       // close();
    }

    public static long savetblOutletMstr(String OutletID,String VisitDateTime,String ActualLatitude,
                                  String ActualLongitude,String LocProvider,String Accuracy,String BateryLeftStatus,String StoreName,
                                  int ISNewStore,int Sstat)
    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("OutletID", OutletID);
        initialValues.put("VisitDateTime", VisitDateTime);

        initialValues.put("ActualLatitude", ActualLatitude);
        initialValues.put("ActualLongitude", ActualLongitude);
        initialValues.put("LocProvider", LocProvider);
        initialValues.put("Accuracy", Accuracy);
        initialValues.put("BateryLeftStatus", BateryLeftStatus);
        initialValues.put("StoreName", StoreName);
        initialValues.put("ISNewStore", ISNewStore);
        initialValues.put("Sstat", Sstat);


        return db.insert(TABLE_OutletMstr, null, initialValues);
    }



			/* private static final String DATABASE_CREATE_TABLE_tblOutletMstr = "create table tblOutletMstr" +
			 		" (OutletID text not null,VisitDateTime string not null,Sstat integer not null,ActualLatitude text null," +
			 		" ActualLongitude text null, ISNewStore int null, LocProvider text null, Accuracy text null," +
			 		" BateryLeftStatus text null,String StoreName);";
			 */

    public static long insertPhotoDetail(String OutletID,String ClickedDateTime,String PhotoName,
                                  String PhotoComment,String PDAPhotoPath,int Sstat)
    {

        //open();
        ContentValues initialValues = new ContentValues();

        initialValues.put("OutletID", OutletID.trim());
        initialValues.put("ClickedDateTime", ClickedDateTime.trim());
        initialValues.put("PhotoName", PhotoName.trim());
        initialValues.put("PhotoComment", PhotoComment.trim());

        initialValues.put("PDAPhotoPath", PDAPhotoPath.trim());
        initialValues.put("Sstat", Sstat);

        long inserted=db.insert(TABLE_StoreProductPhotoDetail, null, initialValues);
     //   close();
        return inserted;
    }


				/*private static final String DATABASE_CREATE_TABLE_OutletPhotoDetail = "create table tblOutletPhotoDetail" +
						"(OutletID text null,ClickedDateTime text null,PhotoName text null,PhotoComment text null," +
						"PDAPhotoPath text null,Sstat integer null);";*/

    public static String[] deletFromSDcCardPhotoValidationBasedSstat(String Sstat) {

        String[] imageNameToBeDeleted = null;
        //open();

        Cursor cursor = db.rawQuery("SELECT  PhotoName from tblStoreProductPhotoDetail where Sstat='"+Sstat+"'", null);
        try{
            if(cursor.getCount()>0)
            {
                imageNameToBeDeleted=new String[cursor.getCount()];
                if(cursor.moveToFirst())
                {
                    for(int i=0;i<cursor.getCount();i++)
                    {
                        imageNameToBeDeleted[i]=cursor.getString(0);
                        cursor.moveToNext();
                    }
                }
            }
            else
            {
                imageNameToBeDeleted=new String[1];
                imageNameToBeDeleted[0]="No Data";
            }
        }finally
        {
            cursor.close();
          //  close();
        }



        return imageNameToBeDeleted;
    }

    public static String[] deletFromtableImageBasedSstat(String Sstat) {

        String[] imageNameToBeDeleted = null;
        //open();

        Cursor cursor = db.rawQuery("SELECT  imageName from tableImage where Sstat='"+Sstat+"'", null);
        try{
            if(cursor.getCount()>0)
            {
                imageNameToBeDeleted=new String[cursor.getCount()];
                if(cursor.moveToFirst())
                {
                    for(int i=0;i<cursor.getCount();i++)
                    {
                        imageNameToBeDeleted[i]=cursor.getString(0);
                        cursor.moveToNext();
                    }
                }
            }
            else
            {
                imageNameToBeDeleted=new String[1];
                imageNameToBeDeleted[0]="No Data";
            }
        }finally
        {
            cursor.close();
           // close();
        }



        return imageNameToBeDeleted;
    }

    public static String[] deletFromSDcCardPhotoValidationNewStore(String OutletID) {

        String[] imageNameToBeDeleted = null;
        //open();

        Cursor cursor = db.rawQuery("SELECT  PhotoName from tblOutletPhotoDetail where OutletID='"+OutletID+"'", null);
        try{
            if(cursor.getCount()>0)
            {
                imageNameToBeDeleted=new String[cursor.getCount()];
                if(cursor.moveToFirst())
                {
                    for(int i=0;i<cursor.getCount();i++)
                    {
                        imageNameToBeDeleted[i]=cursor.getString(0);
                        cursor.moveToNext();
                    }
                }
            }
            else
            {
                imageNameToBeDeleted=new String[1];
                imageNameToBeDeleted[0]="No Data";
            }
        }finally
        {
            cursor.close();
           // close();
        }



        return imageNameToBeDeleted;
    }

    public static long inserttblOutletMstr(String OutletID,String VisitStartTS,String ActualLatitude,
                                    String ActualLongitude,String Accuracy,String LocProvider,String BateryLeftStatus,String StoreName,
                                    String imei,int ISNewStore,int Sstat,int AppVersion)
    {

        //open();
        ContentValues initialValues = new ContentValues();

        initialValues.put("OutletID", OutletID.trim());
        initialValues.put("VisitStartTS", VisitStartTS.trim());

        initialValues.put("ActualLatitude", ActualLatitude.trim());
        initialValues.put("ActualLongitude", ActualLongitude.trim());


        initialValues.put("Accuracy", Accuracy.trim());
        initialValues.put("LocProvider", LocProvider.trim());
        initialValues.put("BateryLeftStatus", BateryLeftStatus.trim());
        initialValues.put("StoreName", StoreName.trim());
        initialValues.put("imei", imei.trim());

        initialValues.put("ISNewStore", 1);
        initialValues.put("Sstat", Sstat);
        initialValues.put("AppVersion", AppVersion);

        System.out.println("Data insert in OutletMstr");

        long inserted=db.insert(TABLE_OutletMstr, null, initialValues);
       // close();
        return inserted;
    }


				 /*private static final String DATABASE_CREATE_TABLE_tblOutletMstr = "create table tblOutletMstr " +
				 		"(OutletID text not null,VisitDateTime string not null,Sstat integer not null,ActualLatitude text null, " +
				 		"ActualLongitude text null, ISNewStore int null, LocProvider text null, Accuracy text null," +
				 		" BateryLeftStatus text null,String StoreName);";*/

    public static void UpdateStoreEndVisitNewStore(String OutletID, String VisitEndTS)
    { //open();
        final ContentValues values = new ContentValues();

        values.put("VisitEndTS", VisitEndTS);

        int affected = db.update("tblOutletMstr", values,"OutletID=? and VisitStartTS is not null",
                new String[] { OutletID });
       // close();

    }

    public static int counttblContainNotSyncData(int Sstat)
    {
        Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblOutletMstr WHERE Sstat ="+ Sstat, null);
        int chkI = 0;
        try {

            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }


    // static final String DATABASE_CREATE_TABLE_tblOutletMstr = "create table tblOutletMstr (OutletID text not null,VisitDateTime text not null,ActualLatitude text null, ActualLongitude text null, LocProvider text null, Accuracy text null, BateryLeftStatus text null,StoreName text null,imei text null, ISNewStore int null,Sstat integer not null);";

    public static int fetch_Store_invoiceCount()
    {

        //open();
        int  invoiceCount= 0;


        Cursor	cursor = db.rawQuery("SELECT Count(*) FROM tblInvoiceHeader", null); //order by AutoIdOutlet Desc

        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    invoiceCount=cursor.getCount();


                }
            }

            return invoiceCount;
        }
        finally
        {
            if(cursor!=null) {
                cursor.close();
            }
           // close();
        }
    }

    public static LinkedHashMap<String, String> fetch_StoreInvoiceWiseData_List()
    {
        int incoiceCount=fetch_Store_invoiceCount();

        //open();
        LinkedHashMap<String,String>hmapInvoiceCaptionPrefixAndSuffix=fetch_InvoiceCaptionPrefixAndSuffix();
        LinkedHashMap<String, String> hmapCatgry = new LinkedHashMap<String, String>();


        Cursor cursor = db.rawQuery("SELECT tblInvoiceHeader.StoreID, tblStoreList.StoreName,IFNULL(tblInvoiceHeader.InvoiceVal,0),tblInvoiceHeader.InvoiceNumber FROM tblInvoiceHeader inner join tblStoreList on tblInvoiceHeader.StoreID=tblStoreList.StoreID WHERE tblInvoiceHeader.StoreID=tblStoreList.StoreID AND  tblInvoiceHeader.Sstat=3 OR tblInvoiceHeader.Sstat=4 OR tblInvoiceHeader.Sstat=5 OR tblInvoiceHeader.Sstat=6", null); //order by AutoIdOutlet Desc

        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        hmapCatgry.put((i+1)+")  "+cursor.getString(1).toString() + " [ Invoice Number:->"+hmapInvoiceCaptionPrefixAndSuffix.get("INVPrefix")+"-"+cursor.getString(3).toString()+"/"+hmapInvoiceCaptionPrefixAndSuffix.get("INVSuffix")+" ]" + " [ Invoice Value:->"+cursor.getString(2).toString()+" ]",cursor.getString(0).toString());
                        cursor.moveToNext();
                    }
                }
            }
            else
            {
                hmapCatgry.put("No Submitted Invoices", "0");
            }
            return hmapCatgry;
        }
        finally
        {
            if(cursor!=null) {
                cursor.close();
            }
            //close();
        }
    }

    public static long savetblMessageTextFileContainer(String FileName,int FileFlag)
    {
        ContentValues initialValues = new ContentValues();

        initialValues.put("FileName", FileName);
        initialValues.put("FileFlag", FileFlag);

        System.out.println("inserting records in DATABASE_CREATE_TABLE_2..");

        return db.insert(DATABASE_TABLE_MAIN251, null, initialValues);
    }

    public static long savetblNoVisitStoreDetails(String IMEI,String CurDate,String ReasonId,String ReasonDescr,int flgHasVisit,int Sstat)
    {
        //open();

        ContentValues initialValues = new ContentValues();

        initialValues.put("IMEI", IMEI);
        initialValues.put("CurDate", CurDate);
        initialValues.put("ReasonId", ReasonId);
        initialValues.put("ReasonDescr", ReasonDescr);
        initialValues.put("flgHasVisit", flgHasVisit);
        initialValues.put("Sstat", Sstat);


        long inserted=db.insert(TABLE_tblNoVisitStoreDetails_Define, null, initialValues);
        //close();
        return inserted;
    }




					/*private static final String DATABASE_CREATE_TABLE_253 = "create table tblNoVisitStoreDetails " +
							"(IMEI text null,CurDate text null,ReasonId text null,ReasonDescr text null,flgHasVisit " +
							"integer null,Sstat integer null);";*/

					/* private static final String DATABASE_CREATE_TABLE_253 = "create table tblNoVisitStoreDetails(IMEI text null,CurDate text null," +
					 		"ReasonId text null,ReasonDescr text null,flgHasVisit integer null,Sstat integer null);";*/

    public static void deletetblNoVisitStoreDetails()
    {
        db.execSQL("DELETE FROM tblNoVisitStoreDetails");
    }

    public static void updateCurDatetblNoVisitStoreDetails(String CurDate)
    {
        //open();
        try
        {

            final ContentValues values = new ContentValues();
            values.put("CurDate", CurDate);
            int affected3 = db.update("tblNoVisitStoreDetails", values, "CurDate=?",new String[] { "NA" });

        }
        catch (Exception ex)
        {

        }
        finally
        {
           // close();
        }

    }

    public static void updateReason(String storeId,String productId,String reason)
    {
        //"create table tblStoreProductPhotoDetail (StoreID text null,ProductID text null,ClickedDateTime text null,PhotoName text null,ReasonForReturn text null,PhotoValidation text null,PDAPhotoPath text null,Sstat integer null,OrderIDPDA text null);";
        Cursor cur=db.rawQuery("Select ReasonForReturn from tblStoreProductPhotoDetail where StoreID='"+storeId+"' AND ProductID='"+productId+"'", null);
        if(cur.getCount()>0)
        {
            ContentValues values=new ContentValues();
            values.put("ReasonForReturn", reason);
            db.update(DATABASE_TABLE_Main212, values, "StoreID=? AND ProductID=?", new String[]{storeId,productId});
        }

    }

    public static void updateReasonIdAndDescrtblNoVisitStoreDetails(String ReasonId,String ReasonDescr)
    {
        //open();
        try
        {

            final ContentValues values = new ContentValues();
            values.put("ReasonId", ReasonId);
            values.put("ReasonDescr", ReasonDescr);
            int affected3 = db.update("tblNoVisitStoreDetails", values, "ReasonId=?",
                    new String[] { "0" });

        }
        catch (Exception ex)
        {

        }
        finally
        {
           // close();
        }

    }

    public static void updateSstattblNoVisitStoreDetails(int Sstat)
    {
        //open();
        try
        {

            final ContentValues values = new ContentValues();
            values.put("Sstat", Sstat);
            int affected32 = db.update("tblNoVisitStoreDetails", values, "Sstat=?",
                    new String[] { "0" });

        }
        catch (Exception ex)
        {

        }
        finally
        {
           // close();
        }

    }

    public static void updateSstattblNoVisitStoreDetailsAfterSync(int Sstat)
    {
        //open();
        try
        {

            final ContentValues values = new ContentValues();
            values.put("Sstat", Sstat);
            int affected32 = db.update("tblNoVisitStoreDetails", values, "Sstat=?",
                    new String[] { "3" });

        }
        catch (Exception ex)
        {

        }
        finally
        {
           // close();
        }

    }

    public static int fetchflgHasVisitFromtblNoVisitStoreDetails(String Sstat) {

        int flag=0;
        //open();

        Cursor cursor = db.rawQuery("SELECT  flgHasVisit from tblNoVisitStoreDetails where Sstat='"+Sstat+"' or Sstat='"+3+"'", null);
        try{
            if(cursor.getCount()>0)
            {
                if(cursor.moveToFirst())
                {
                    for(int i=0;i<cursor.getCount();i++)
                    {
                        flag=Integer.parseInt(cursor.getString(0));
                        cursor.moveToNext();
                    }
                }
            }

        }finally
        {
            cursor.close();
           // close();
        }
        return flag;
    }

    public static int countDataIntblNoVisitStoreDetails()  throws IOException
    {
        int chkI = 0;
        //open();

        Cursor cursorE2 = db.rawQuery("SELECT Count(*) from tblNoVisitStoreDetails where Sstat=3", null);

        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
            //close();
        }
        return chkI;
    }

    public static String[] fnGetALLDataInfo()
    {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT * FROM  tblNoVisitStoreDetails", null);
        String AllProductInSlab[] = new String[cursorE2.getCount()];

        try {
            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst())
                {

                    for (int i = 0; i <= (cursorE2.getCount() - 1); i++)
                    {
                        AllProductInSlab[i] = (String) cursorE2.getString(0).toString()+"^"+(String) cursorE2.getString(1).toString()+"^"+(String) cursorE2.getString(2).toString()+"^"+(String) cursorE2.getString(3).toString()+"^"+(String) cursorE2.getString(4).toString()+"^"+(String) cursorE2.getString(5).toString();
                        cursorE2.moveToNext();

                    }
                }
            }
            return AllProductInSlab;
        } finally {
            cursorE2.close();
           // close();
        }

    }

    public static int countDataIntblDayStartAttendanceOptions()  throws IOException
    {
        int chkI = 0;
        //open();

        Cursor cursorE2 = db.rawQuery("SELECT Count(*) from tblDayStartAttendanceOptions", null);

        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
          //  close();
        }
        return chkI;
    }

  /*  public static long savetblDayStartAttendanceOptions(int AutoIdStore,String ReasonId,String ReasonDescr,int FlgToShowTextBox)
    {

        ContentValues initialValues = new ContentValues();
        initialValues.put("AutoIdStore", AutoIdStore);
        initialValues.put("ReasonId", ReasonId);
        initialValues.put("ReasonDescr", ReasonDescr.trim());
        initialValues.put("FlgToShowTextBox", FlgToShowTextBox);

        //// System.out.println("Arjun data insert properly tblTradeChannelMstr ");
        return db.insert(TABLE_tblDayStartAttendanceOptions_Define, null, initialValues);
    }*/

  public static long savetblDayStartAttendanceOptions(int AutoIdStore,String ReasonId,String ReasonDescr,
                                         int FlgToShowTextBox,int flgSOApplicable,int flgDSRApplicable,
                                         int flgNoVisitOption,int SeqNo,int flgDelayedReason)
  {

      ContentValues initialValues = new ContentValues();
      initialValues.put("AutoIdStore", AutoIdStore);
      initialValues.put("ReasonId", ReasonId);
      initialValues.put("ReasonDescr", ReasonDescr.trim());
      initialValues.put("FlgToShowTextBox", FlgToShowTextBox);

      initialValues.put("flgSOApplicable", flgSOApplicable);
      initialValues.put("flgDSRApplicable", flgDSRApplicable);
      initialValues.put("flgNoVisitOption", flgNoVisitOption);
      initialValues.put("flgDelayedReason", flgDelayedReason);
      initialValues.put("SeqNo", SeqNo);


      return db.insert(TABLE_tblDayStartAttendanceOptions_Define, null, initialValues);
  }





					/* private static final String DATABASE_CREATE_TABLE_252 = "create table tblDayStartAttendanceOptions " +
					 		"(ReasonId text null,ReasonDescr text null,FlgToShowTextBox integer null);";*/

    public static LinkedHashMap<String, String> fetch_Reason_List()
    {
        //open();
        LinkedHashMap<String, String> hmapCatgry = new LinkedHashMap<String, String>();
        Cursor cursor = db.rawQuery("SELECT ReasonId,ReasonDescr FROM tblDayStartAttendanceOptions",null);
        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    hmapCatgry.put("Select Reason", "0");
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        hmapCatgry.put(cursor.getString(1).toString(),cursor.getString(0).toString());
                        cursor.moveToNext();
                    }
                }

            }

            else
            {
                hmapCatgry.put("No Reason", "0");
            }
            return hmapCatgry;
        }
        finally
        {
            cursor.close();
          //  close();
        }
    }

					/* initialValues.put("AutoIdStore", AutoIdStore);
						initialValues.put("ReasonId", ReasonId);
						initialValues.put("ReasonDescr", ReasonDescr.trim());
						initialValues.put("FlgToShowTextBox", FlgToShowTextBox);

						 private static final String DATABASE_CREATE_TABLE_252 = "create table tblDayStartAttendanceOptions (ReasonId text null,ReasonDescr text null,FlgToShowTextBox integer null);";
					*/

    public static int fetchFlgToShowTextBox(String ReasonDescr) {

        int FlgToShowTextBox=0;
        //open();

        Cursor cursor = db.rawQuery("SELECT  FlgToShowTextBox from tblDayStartAttendanceOptions where ReasonDescr='"+ReasonDescr+"'", null);
        try{
            if(cursor.getCount()>0)
            {

                if(cursor.moveToFirst())
                {
                    for(int i=0;i<cursor.getCount();i++)
                    {
                        FlgToShowTextBox=Integer.parseInt(cursor.getString(0));
                        cursor.moveToNext();
                    }
                }
            }

        }finally
        {
            cursor.close();
         //   close();
        }

        return FlgToShowTextBox;
    }

    public static String fetchReasonIdBasedOnReasonDescr(String ReasonDescr) {

        String ReasonId="0";
        //open();

        Cursor cursor = db.rawQuery("SELECT  ReasonId from tblDayStartAttendanceOptions where ReasonDescr='"+ReasonDescr+"'", null);
        try{
            if(cursor.getCount()>0)
            {

                if(cursor.moveToFirst())
                {
                    for(int i=0;i<cursor.getCount();i++)
                    {
                        ReasonId=cursor.getString(0);
                        cursor.moveToNext();
                    }
                }
            }

        }finally
        {
            cursor.close();
            //close();
        }

        return ReasonId;
    }

    public static String fetchReasonDescr() {

        String ReasonId="0";
        //open();

        Cursor cursor = db.rawQuery("SELECT  ReasonDescr from tblDayStartAttendanceOptions", null);
        try{
            if(cursor.getCount()>0)
            {

                if(cursor.moveToFirst())
                {
                    for(int i=0;i<cursor.getCount();i++)
                    {
                        ReasonId=cursor.getString(0);
                        cursor.moveToNext();
                    }
                }
            }

        }finally
        {
            cursor.close();
           // close();
        }

        return ReasonId;
    }

    public static String[] fetchDateFromtblStorePOSLastVisitDateDetail(String StoreID)
    {
        //open();
        Cursor cursor = db
                .rawQuery("SELECT LastVisitDate FROM tblStorePOSLastVisitDateDetail WHERE StoreID ='"+ StoreID + "'", null);

        try {

            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = (String) cursor.getString(0)
                                .toString();

                        cursor.moveToNext();
                    }
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
           // close();
        }

    }

    public static long savetblStorePOSLastVisitDateDetail(String StoreID, String LastVisitDate)
    {

        ContentValues initialValues = new ContentValues();
        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("LastVisitDate", LastVisitDate.trim());


        return db.insert(DATABASE_TABLE_Main165, null, initialValues);

    }

    //  private static final String DATABASE_CREATE_TABLE_165 = "create table
    //tblStorePOSLastVisitDateDetail (StoreID text null,LastVisitDate text null);";

    public static long savetblStorePOSLastVisitALLMaterialDetails(String StoreID, String POSMaterialID,String POSMaterialDescr
            ,String CurrentStockQty,String NewOrderQty,String ReturnQty,String DamageQty)
    {

        ContentValues initialValues = new ContentValues();
        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("POSMaterialID", POSMaterialID.trim());
        initialValues.put("POSMaterialDescr", POSMaterialDescr.trim());
        initialValues.put("CurrentStockQty", CurrentStockQty.trim());
        initialValues.put("NewOrderQty", NewOrderQty.trim());
        initialValues.put("ReturnQty", ReturnQty.trim());
        initialValues.put("DamageQty", DamageQty.trim());


        return db.insert(DATABASE_TABLE_Main166, null, initialValues);

    }


					/* private static final String DATABASE_CREATE_TABLE_166 = "create table " +
					 		"tblStorePOSLastVisitALLMaterialDetails (StoreID text null,POSMaterialID text null," +
					 		"POSMaterialDescr text null,CurrentStockQty text null,NewOrderQty text null," +
					 		"ReturnQty text null,DamageQty text null);";*/

    public static void Delete_tblLastVisitDetailsForPOS()
    {
        db.execSQL("DELETE FROM tblStorePOSLastVisitDateDetail");

        db.execSQL("DELETE FROM tblStorePOSLastVisitALLMaterialDetails");


    }

    public static int counttblStorePOSLastVisitDateDetail(String StoreID)
    {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblStorePOSLastVisitDateDetail WHERE StoreID ='"+ StoreID + "'", null);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
            //close();
        }
        return chkI;
    }

    public static int counttblStorePOSLastVisitALLMaterialDetails(String StoreID)
    {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblStorePOSLastVisitALLMaterialDetails WHERE StoreID ='"+ StoreID + "'", null);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
           // close();
        }
        return chkI;
    }

    public static ArrayList<LinkedHashMap<String, String>> fetch_tblStorePOSLastVisitALLMaterialDetails(String StoreID) {
        //open();
        ArrayList<LinkedHashMap<String, String>> totalProductDetail=new ArrayList<LinkedHashMap<String, String>>();

        LinkedHashMap<String, String> hmapStoreIDPOSMaterialID=new LinkedHashMap<String, String>();

        LinkedHashMap<String, String> hmapPOSMaterialIDPOSMaterialDescr=new LinkedHashMap<String, String>();

        LinkedHashMap<String, String> hmapPOSMaterialIDCurrentStockQty=new LinkedHashMap<String, String>();

        LinkedHashMap<String, String> hmapPOSMaterialIDNewOrderQty=new LinkedHashMap<String, String>();

        LinkedHashMap<String, String> hmapPOSMaterialIDReturnQty=new LinkedHashMap<String, String>();

        LinkedHashMap<String, String> hmapPOSMaterialIDDamageQty=new LinkedHashMap<String, String>();

        Cursor cursor = db.rawQuery("SELECT StoreID,POSMaterialID,POSMaterialDescr,CurrentStockQty,NewOrderQty,ReturnQty,DamageQty  FROM tblStorePOSLastVisitALLMaterialDetails WHERE StoreID ='"+ StoreID + "'", null);
        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i < cursor.getCount(); i++)
                    {
                        hmapStoreIDPOSMaterialID.put(cursor.getString(1), cursor.getString(0));
                        hmapPOSMaterialIDPOSMaterialDescr.put(cursor.getString(1), cursor.getString(2));
                        hmapPOSMaterialIDCurrentStockQty.put(cursor.getString(1), cursor.getString(3));
                        hmapPOSMaterialIDNewOrderQty.put(cursor.getString(1), cursor.getString(4));
                        hmapPOSMaterialIDReturnQty.put(cursor.getString(1), cursor.getString(5));
                        hmapPOSMaterialIDDamageQty.put(cursor.getString(1), cursor.getString(6));

                        cursor.moveToNext();

                    }
                    totalProductDetail.add(hmapStoreIDPOSMaterialID);
                    totalProductDetail.add(hmapPOSMaterialIDPOSMaterialDescr);
                    totalProductDetail.add(hmapPOSMaterialIDCurrentStockQty);
                    totalProductDetail.add(hmapPOSMaterialIDNewOrderQty);
                    totalProductDetail.add(hmapPOSMaterialIDReturnQty);
                    totalProductDetail.add(hmapPOSMaterialIDDamageQty);

                }
            }


            return totalProductDetail;
        } finally {
            cursor.close();

            //close();
        }


    }



					/* private static final String DATABASE_CREATE_TABLE_166 = "create table " +
					 		"tblStorePOSLastVisitALLMaterialDetails (StoreID text null,POSMaterialID text null," +
					 		"POSMaterialDescr text null,CurrentStockQty text null,NewOrderQty text null," +
					 		"ReturnQty text null" +
					 		",DamageQty text null);";*/

    public static int checkAnyDataSubmitORNot(int Sstat)
    {
        //open();
        Cursor cursor = db.rawQuery("SELECT Count(*) FROM tblStoreList WHERE Sstat ="+Sstat, null);

        try {

            int check=0;

            if (cursor.getCount() > 0)
            {
                if (cursor.moveToFirst())
                {
                    if (cursor.getInt(0) > 0) {
                        check = 1;
                    } else {
                        check = 0;
                    }


                }

            }
            return check;

        } finally {
            cursor.close();
           // close();
        }

    }


					/*	private static final String DATABASE_CREATE_TABLE_13 = "create table tblStoreList (StoreID text not " +
								"null, StoreType string not null, StoreName string not null, StoreLatitude real not null," +
								" StoreLongitude real not null, LastVisitDate string not null, LastTransactionDate string not " +
								"null, Sstat integer not null, ForDate string not null, ActualLatitude text null, " +
								"ActualLongitude text null, VisitStartTS text null, VisitEndTS text null,AutoIdStore int null," +
								" LocProvider text null, Accuracy text null, BateryLeftStatus text null,StoreClose integer null" +
								",StoreNextDay integer null,chainID integer null,ISNewStore int null,StoreRouteID int null);";
						*/

    public static void deleteOldtblStoreMaterialDetail(String StoreID)
    {
        //open();
        try
        {
            db.execSQL("DELETE FROM tblStoreMaterialDetail WHERE StoreID ='" + StoreID + "'");
        }
        catch(Exception e)
        {

        }
        finally
        {
            //close();
        }

    }


						/* private static final String DATABASE_CREATE_TABLE_163 = "create table tblStoreMaterialDetail " +
						 		"(RouteID text null,StoreID text null,MaterialID text null,ExistStock integer null," +
						 		"ReturntoDistributor integer null,FreshOrder integer null,DiscardDamage integer null," +
						 		"Sstat integer null);"; */

    public static String[] getAllStoreIDIntblStoreReturnPhotoDetail()
    {

        int SnamecolumnIndex1 = 0;


        Cursor cursor = db.rawQuery("SELECT DISTINCT(StoreID) FROM tblStoreProductPhotoDetail where Sstat=5", null);
        //Cursor cursor = db.rawQuery("SELECT StoreID FROM tblStoreMaterialPhotoDetail", null);
        try
        {
            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst())
            {
                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1).toString();
                    cursor.moveToNext();
                }
            }

            return StoreName;
        }
        finally
        {
            cursor.close();
        }

    }


    // New Sync way

    public static int getExistingPicNosForReturn(String StoreID)
    {

        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT Count(StoreID) FROM tblStoreProductPhotoDetail where StoreID='" + StoreID + "'", null);
        try {
            int strProdStockQty = 0;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    if (!cursor.isNull(ScodecolumnIndex)) {
                        strProdStockQty = Integer.parseInt(cursor.getString(ScodecolumnIndex).toString());
                        cursor.moveToNext();
                    }

                }
            }
            return strProdStockQty;
        } finally {
            cursor.close();
        }
    }

    public static String[] getImgsPathForReturn(String StoreID)
    {

        int SnamecolumnIndex1 = 0;

        Cursor cursor = db.rawQuery("SELECT PhotoName FROM tblStoreProductPhotoDetail WHERE StoreID ='"+ StoreID + "'", null);
        try
        {

            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {

                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1).toString();
                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }

    }

    public static void updateImageRecordsSyncdForReturn(String PhotoName)
    {

        try
        {
            //open();
            System.out.println("Sunil Doing Testing Response after sending Image inside BD" + PhotoName);
            final ContentValues values = new ContentValues();
            values.put("Sstat", 4);

            int affected3 = db.update("tblStoreProductPhotoDetail", values, "PhotoName=?",new String[] { PhotoName });
        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }
        finally
        {
           // close();
        }


    }

    public static void updateImageRecordsSyncd()
    {

        try
        {


            final ContentValues values = new ContentValues();
            values.put("Sstat", "4");
									/*int affected = db.update("tblUserLoginMstr", values, "Sstat=?",
											new String[] { "3" });*/
           /* int affected2 = db.update("tblStoreList", values, "Sstat=?",
                    new String[] { "3" });*/
            int affected3 = db.update("tblOutletPhotoDetail", values, "Sstat=?",
                    new String[] { "5" });
            int affected4 = db.update("tblStoreMaterialPhotoDetail", values, "Sstat=?",
                    new String[] { "5" });
            int affected5 = db.update("tableImage", values, "Sstat=?",
                    new String[] { "5" });




        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }

    }

    public static void deleteAllXmlDataTable(String Sstat)
    {

        //open();
        db.execSQL("DELETE FROM tblOutletQuestAnsMstr WHERE Sstat ="+ Sstat);
        db.execSQL("DELETE FROM tblOutletQuestAnsTempMapping WHERE Sstat ="+ Sstat);
        db.execSQL("DELETE FROM tblPDARetailerProductSaving WHERE Sstat ="+ Sstat);
        db.execSQL("DELETE FROM tableImage WHERE Sstat ="+ Sstat);

       // close();



    }
    public static void  delDayEnd()
    {
        db.execSQL("DELETE FROM tblDayStartEndDetails");
    }

    public static void savetbl_XMLfiles(String XmlFileName,String Sstat,String filetype)
    {
        //open();
        ContentValues initialValues = new ContentValues();


        initialValues.put("XmlFileName", XmlFileName.trim());
        initialValues.put("Sstat", Sstat.trim());
        initialValues.put("filetype", filetype.trim());


        db.insert(TABLE_XMLFILES, null, initialValues);
        //close();
    }

    public static void UpdateStoreMaterialphotoFlag(String sID, int flag2set)
    {
        try
        {
            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);
            int affected1 = db.update("tblStoreMaterialPhotoDetail", values,"StoreID=?", new String[] { sID });
        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }

    }

    public static void UpdateStoreCheckinFlg(String sID, int flag2set)
    {
        try
        {
            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);
            int affected1 = db.update("tblStoreCheckInPic", values,"StoreID=?", new String[] { sID });
        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }

    }

    public static String[] getAllStoreIDIntblStoreMaterialPhotoDetail()
    {

        int SnamecolumnIndex1 = 0;


        Cursor cursor = db.rawQuery("SELECT DISTINCT(StoreID) FROM tblStoreMaterialPhotoDetail where Sstat=5", null);
        //Cursor cursor = db.rawQuery("SELECT StoreID FROM tblStoreMaterialPhotoDetail", null);
        try
        {
            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst())
            {
                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1).toString();
                    cursor.moveToNext();
                }
            }

            return StoreName;
        }
        finally
        {
            cursor.close();
        }

    }

    public static void updateImageRecordsSyncdforPOSMaterial(String PhotoName)
    {

        try
        {
            //open();
            System.out.println("Sunil Doing Testing Response after sending Image inside BD" + PhotoName);
            final ContentValues values = new ContentValues();
            values.put("Sstat", 4);

            int affected3 = db.update("tblStoreMaterialPhotoDetail", values, "PhotoName=?",new String[] { PhotoName });
        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }
        finally
        {
           // close();
        }


    }

    public static String fnGetXMLFile(String Sstat)
    {
        String optionList="";
        //open();
        // Cursor cursor = db.rawQuery("SELECT SST_NameId,SST_Name_des from tbl_SST_NameMstr Order By Sequence ASC  ", null);// Where PNodeID='"+TSIID+"'
        Cursor cursor = db.rawQuery("SELECT XmlFileName from tbl_XMLfiles Where Sstat='"+Sstat+"'", null);// Where PNodeID='"+TSIID+"'
        // (String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString()+"^"+(String) cursor.getString(2).toString()+"^"+(String) cursor.getString(3).toString()+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(5).toString()+"^"+(String) cursor.getString(6).toString()+"^"+(String) cursor.getString(7).toString()+"^"+(String) cursor.getString(8).toString()+"^"+(String) cursor.getString(9).toString()+"^"+(String) cursor.getString(10).toString()
        // close();
        try {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        if(optionList.equals(""))
                        {
                            optionList =(String) cursor.getString(0).toString();
                        }
                        else
                        {
                            optionList =optionList+"^"+(String) cursor.getString(0).toString();
                        }
                        cursor.moveToNext();
                    }
                }
            }
            return optionList;
        }
        finally
        {
           // close();
            cursor.close();

        }
    }

    public static void upDateTblXmlFile(String XmlFileName) {
        //open();
        db.execSQL("UPDATE tbl_XMLfiles SET Sstat='4' WHERE XmlFileName='"+XmlFileName+"'");
     //   close();

    }

    public static void deleteXmlTable(String Sstat)
    {
        //open();
        db.execSQL("DELETE FROM tbl_XMLfiles WHERE Sstat ="+ Sstat);
       // close();
    }

    public static LinkedHashMap<String, String> getFileredProductListMap(String _searchString,int BusinessSegmentId,String ctgryId)
    {
        //tblProductListMaster (CategoryID text  null,ProductID text  null, ProductShortName text  null, DisplayUnit text null, CalculateKilo real  null,ProductMRP real not null, ProductRLP real not null, ProductTaxAmount real not null, KGLiter string null,RetMarginPer real null,VatTax real null,StandardRate real null,StandardRateBeforeTax real null,StandardTax real null,CatOrdr int null,PrdOrdr int null,StoreCatNodeId int null);";
        //open();
        String searchString="";
        LinkedHashMap<String, String> hmapFilterProductList=new LinkedHashMap<String, String>();
        try {
            if(_searchString.indexOf(":")!=-1)
            {
                String[] arrsearchString=_searchString.split(Pattern.quote(","));
                for(int i=0;i<arrsearchString.length;i++)
                {
                    if(i==0)
                    {
                        searchString=" LOWER(SearchField) LIKE '%"+arrsearchString[i].trim().toLowerCase()+"%'";
                    }
                    else
                    {
                        searchString+=	" AND LOWER(SearchField) LIKE '%"+arrsearchString[i].trim().toLowerCase()+"%'";
                    }
                }
            }

            if(_searchString.indexOf(",")!=-1)
            {
                String[] arrsearchString=_searchString.split(Pattern.quote(","));
                for(int i=0;i<arrsearchString.length;i++)
                {
                    if(i==0)
                    {
                        searchString=" LOWER(SearchField) LIKE '%"+arrsearchString[i].trim().toLowerCase()+"%'";
                    }
                    else
                    {
                        searchString+=	" AND LOWER(SearchField) LIKE '%"+arrsearchString[i].trim().toLowerCase()+"%'";
                    }
                }
            }

            else
            {
                if(ctgryId.equals("0") && TextUtils.isEmpty(_searchString))
                {
                    _searchString="All";
                    searchString=" LOWER(SearchField) LIKE '%"+_searchString.trim().toLowerCase()+"%'";
                }
                else
                {
                    searchString=" LOWER(SearchField) LIKE '%"+_searchString.trim().toLowerCase()+"%'";
                }

            }
            Cursor cur=null;
            if(CommonInfo.hmapAppMasterFlags.get("flgControlStock")==1) {
                if(!TextUtils.isEmpty(ctgryId) && !ctgryId.equals("0"))
                {
                    // tblDistributorProductStock(PrdctId text null,StockQntty text null,DistributorNodeIdNodeType text null,OriginalStock text null,SKUName text null);";
                    cur=db.rawQuery("Select tblProductListMaster.ProductID,ProductShortName from tblProductListMaster inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID inner join tblDistributorProductStock On tblProductListMaster.ProductID = tblDistributorProductStock.PrdctId where ("+searchString+")  AND tblProductListMaster.CategoryID='"+ctgryId+"' order by PrdOrdr Asc", null);//and tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"
                }
                else
                {

                    cur=db.rawQuery("Select tblProductListMaster.ProductID,ProductShortName from tblProductListMaster inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID inner join tblDistributorProductStock On tblProductListMaster.ProductID = tblDistributorProductStock.PrdctId where ("+searchString+") order by PrdOrdr Asc", null);//and tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"
                }
            }
            else
            {
                if(!TextUtils.isEmpty(ctgryId) && !ctgryId.equals("0"))
                {
                    // tblDistributorProductStock(PrdctId text null,StockQntty text null,DistributorNodeIdNodeType text null,OriginalStock text null,SKUName text null);";
                    cur=db.rawQuery("Select tblProductListMaster.ProductID,ProductShortName from tblProductListMaster inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID  where ("+searchString+")  AND tblProductListMaster.CategoryID='"+ctgryId+"' order by PrdOrdr Asc", null);//and tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"
                }
                else
                {

                    cur=db.rawQuery("Select tblProductListMaster.ProductID,ProductShortName from tblProductListMaster inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID  where ("+searchString+") order by PrdOrdr Asc", null);//and tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"
                }
            }


            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        hmapFilterProductList.put(cur.getString(0), cur.getString(1));
                        cur.moveToNext();
                    }
                }

            }

        } catch (Exception e) {
            // TODO: handle exception
        }
        finally
        {
           // close();
            return hmapFilterProductList;
        }
    }

    public static LinkedHashMap<String, String> getFileredOrderReviewProductListMap(String StoreId,String TmpInvoiceCodePDA)
    {
        //tblProductListMaster (CategoryID text  null,ProductID text  null, ProductShortName text  null, DisplayUnit text null, CalculateKilo real  null,ProductMRP real not null, ProductRLP real not null, ProductTaxAmount real not null, KGLiter string null,RetMarginPer real null,VatTax real null,StandardRate real null,StandardRateBeforeTax real null,StandardTax real null,CatOrdr int null,PrdOrdr int null,StoreCatNodeId int null);";
        //open();
        String searchString="";
        LinkedHashMap<String, String> hmapFilterProductList=new LinkedHashMap<String, String>();
        try {




            Cursor cur=db.rawQuery("Select tblProductListMaster.ProductID,tblProductListMaster.ProductShortName from tblProductListMaster inner join tblTmpInvoiceDetails on tblProductListMaster.ProductID=tblTmpInvoiceDetails.ProdID  where tblTmpInvoiceDetails.StoreID='"+StoreId+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"' order by tblProductListMaster.CategoryID Asc,tblProductListMaster.PrdOrdr Asc", null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        hmapFilterProductList.put(cur.getString(0), cur.getString(1));
                        cur.moveToNext();
                    }
                }

            }

        } catch (Exception e) {
            System.out.println(e.toString());
            // TODO: handle exception
        }
        finally
        {
           // close();
            return hmapFilterProductList;
        }
    }

    public static LinkedHashMap<String, String> getUOMMstr()
    {
        //tblProductListMaster (CategoryID text  null,ProductID text  null, ProductShortName text  null, DisplayUnit text null, CalculateKilo real  null,ProductMRP real not null, ProductRLP real not null, ProductTaxAmount real not null, KGLiter string null,RetMarginPer real null,VatTax real null,StandardRate real null,StandardRateBeforeTax real null,StandardTax real null,CatOrdr int null,PrdOrdr int null,StoreCatNodeId int null);";
        //open();
        LinkedHashMap<String, String> hmapUOMMstr=new LinkedHashMap<String, String>();
        try {
            Cursor cur=db.rawQuery("Select UOMID,UOM from tblUOMMstr", null);
            hmapUOMMstr.put("0", "Select UOM");
            if(cur.getCount()>0)
            {
                StringBuilder sBuilder=new StringBuilder();
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        hmapUOMMstr.put(cur.getString(0), cur.getString(1));
                        cur.moveToNext();
                    }
                }

            }

        } catch (Exception e) {
            // TODO: handle exception
        }
        finally
        {
           // close();
            return hmapUOMMstr;
        }
    }

    public static LinkedHashMap<String, String> getSalesQuotePrcsMstr()
    {
        //tblProductListMaster (CategoryID text  null,ProductID text  null, ProductShortName text  null, DisplayUnit text null, CalculateKilo real  null,ProductMRP real not null, ProductRLP real not null, ProductTaxAmount real not null, KGLiter string null,RetMarginPer real null,VatTax real null,StandardRate real null,StandardRateBeforeTax real null,StandardTax real null,CatOrdr int null,PrdOrdr int null,StoreCatNodeId int null);";
        //open();
        LinkedHashMap<String, String> hmapSalesQuoteMstr=new LinkedHashMap<String, String>();
        try {
            Cursor cur=db.rawQuery("Select SalesQuotePrcsId,SalesQuotePrcs from tblSalesQuotePrcsMstr", null);
            //hmapUOMMstr.put("0", "Select SalesQuote");
            if(cur.getCount()>0)
            {
                StringBuilder sBuilder=new StringBuilder();
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        hmapSalesQuoteMstr.put(cur.getString(0), cur.getString(1));
                        cur.moveToNext();
                    }
                }

            }

        } catch (Exception e) {
            // TODO: handle exception
        }
        finally
        {
          //  close();
            return hmapSalesQuoteMstr;
        }
    }

    public static LinkedHashMap<String, String> fngetDistinctSalesQuotePersonMeetMstr(String StoreId)
    {
        //tblProductListMaster (CategoryID text  null,ProductID text  null, ProductShortName text  null, DisplayUnit text null, CalculateKilo real  null,ProductMRP real not null, ProductRLP real not null, ProductTaxAmount real not null, KGLiter string null,RetMarginPer real null,VatTax real null,StandardRate real null,StandardRateBeforeTax real null,StandardTax real null,CatOrdr int null,PrdOrdr int null,StoreCatNodeId int null);";
        //open();
        LinkedHashMap<String, String> hmapDistinctSalesQuotePersonMeetMstr=new LinkedHashMap<String, String>();
        try {
            Cursor cur=db.rawQuery("Select SalesQuoteId,SalesQuoteCode,SalesQuotePrcsId,SalesQuotePrcs,SalesQuoteDate from tblSalesQuotePersonMeetMstr WHERE StoreId='"+StoreId+"'", null);
            //hmapUOMMstr.put("0", "Select SalesQuote");
            if(cur.getCount()>0)
            {
                StringBuilder sBuilder=new StringBuilder();
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        hmapDistinctSalesQuotePersonMeetMstr.put(cur.getString(0), cur.getString(1)+"^"+cur.getString(2)+"^"+cur.getString(3)+"^"+cur.getString(4));
                        cur.moveToNext();
                    }
                }

            }

        } catch (Exception e) {
            // TODO: handle exception
        }
        finally
        {
           // close();
            return hmapDistinctSalesQuotePersonMeetMstr;
        }
    }

    public static LinkedHashMap<String, String> fngetDistinctSalesQuotePersonMeetMstrForSstatUpdate(String StoreId)
    {
        //tblProductListMaster (CategoryID text  null,ProductID text  null, ProductShortName text  null, DisplayUnit text null, CalculateKilo real  null,ProductMRP real not null, ProductRLP real not null, ProductTaxAmount real not null, KGLiter string null,RetMarginPer real null,VatTax real null,StandardRate real null,StandardRateBeforeTax real null,StandardTax real null,CatOrdr int null,PrdOrdr int null,StoreCatNodeId int null);";
        //	//open();
        LinkedHashMap<String, String> hmapDistinctSalesQuotePersonMeetMstr=new LinkedHashMap<String, String>();
        try {
            Cursor cur=db.rawQuery("Select SalesQuoteId,SalesQuoteCode,SalesQuotePrcsId,SalesQuotePrcs,SalesQuoteDate from tblSalesQuotePersonMeetMstr WHERE StoreId='"+StoreId+"'", null);
            //hmapUOMMstr.put("0", "Select SalesQuote");
            if(cur.getCount()>0)
            {
                StringBuilder sBuilder=new StringBuilder();
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        hmapDistinctSalesQuotePersonMeetMstr.put(cur.getString(0), cur.getString(1)+"^"+cur.getString(2)+"^"+cur.getString(3)+"^"+cur.getString(4));
                        cur.moveToNext();
                    }
                }

            }

        } catch (Exception e) {
            // TODO: handle exception
        }
        finally
        {
            //close();
            return hmapDistinctSalesQuotePersonMeetMstr;
        }
    }

    public static int fncheckIfSalesQuotePersonMeetMstrExistsinTable(String SalesQuoteId)
    {
        //open();
        int strReturnPDADateExistOrNot = 0;

        Cursor cursor2 = db.rawQuery("SELECT SalesQuoteId FROM  tblSalesQuotePersonMeetMstr where tblSalesQuotePersonMeetMstr.SalesQuoteId='"+SalesQuoteId+"'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strReturnPDADateExistOrNot = 1;
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }

            return strReturnPDADateExistOrNot;
        } finally {
            cursor2.close();
          //  close();
        }
    }

    public static String[] fngetQutePersonMeetTabOneData(String SalesQuoteId)
    {
        //open();
        String qry="select SalesQuoteType,SalesQuoteValidFrom,SalesQuoteValidTo,SalesQuoteDate from tblSalesQuotePersonMeetMstr where SalesQuoteId='"+SalesQuoteId+"'";
        Cursor cur = db.rawQuery(qry,null);
        String BasicData[]= new String[4];
        try {
            if(cur.moveToFirst())
            {
                //for(int i=0;i<cur.getCount();i++)
                for(int i=0;i<cur.getCount();i++)
                {
                    BasicData[0]= (String) cur.getString(0).toString();
                    BasicData[1]= (String) cur.getString(1).toString();
                    BasicData[2]= (String) cur.getString(2).toString();
                    BasicData[3]= (String) cur.getString(3).toString();
                    cur.moveToNext();

                }


            }
            return BasicData;
        } finally {
            //cur.close();
           // close();
        }
    }

    public static LinkedHashMap<String, String> getFileredProductListQuotationMap(String _searchString,String SalesQuoteId,int BusinessSegmentId,String ManufacturerID)
    {
        int chkIfSalesQuotePersonMeetMstrExistsinTable=fncheckIfSalesQuotePersonMeetMstrExistsinTable(SalesQuoteId);
        String SalesQuoteValidFrom="0";
        String SalesQuoteValidTo="0";
        String SalesQuoteType="0";
        if(chkIfSalesQuotePersonMeetMstrExistsinTable==1)
        {
            //SalesQuoteType,SalesQuoteValidFrom,SalesQuoteValidTo,SalesQuoteDate
            String[] arrValues=new String[4];
            arrValues=fngetQutePersonMeetTabOneData(SalesQuoteId);
            SalesQuoteType=arrValues[0];
            SalesQuoteValidFrom=arrValues[1];
            SalesQuoteValidTo=arrValues[2];
            SalesQuoteType=arrValues[3];
        }
        //open();
        //int intcheckIfgetFileredProductListQuotationMapExistsinTable=fncheckIfgetFileredProductListQuotationMapExistsinTable(SalesQuoteId);
        String searchString="";
        LinkedHashMap<String, String> hmapFilterProductQuotationList=new LinkedHashMap<String, String>();
        try {
            if(_searchString.indexOf(",")!=-1)
            {
                String[] arrsearchString=_searchString.split(Pattern.quote(","));
                for(int i=0;i<arrsearchString.length;i++)
                {
                    if(i==0)
                    {
                        searchString=" LOWER(SearchField) LIKE '%"+arrsearchString[i].trim().toLowerCase()+"%'";
                    }
                    else
                    {
                        searchString+=" AND LOWER(SearchField) LIKE '%"+arrsearchString[i].trim().toLowerCase()+"%'";
                    }
                }
            }
            else
            {
                searchString=" LOWER(SearchField) LIKE '%"+_searchString.trim().toLowerCase()+"%'";
            }
            Cursor cur=null;

            //cur=db.rawQuery("Select ProductID,ProductShortName,StandardRate,StandardRateBeforeTax,0 AS RateOffer,0 AS InclusiveTax,'"+SalesQuoteValidFrom+"' AS ValidFrom,'"+SalesQuoteValidTo+"' As ValidTo,0 AS MinDlvryQty,0 AS UOMID,0 AS Remarks,'0.00' AS LastTranscRate,tblProductListMaster.VatTax from tblProductListMaster where ("+searchString+") order by PrdOrdr Asc", null);
            if(ManufacturerID.equals("0") || ManufacturerID.equals(""))
            {
                cur=db.rawQuery("Select tblProductListMaster.ProductID,ProductShortName,tblProductSegementMap.StandardRate,tblProductSegementMap.StandardRateBeforeTax,0 AS RateOffer,0 AS InclusiveTax,'"+SalesQuoteValidFrom+"' AS ValidFrom,'"+SalesQuoteValidTo+"' As ValidTo,0 AS MinDlvryQty,0 AS UOMID,0 AS Remarks,'0.00' AS LastTranscRate,tblProductSegementMap.VatTax from tblProductListMaster inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID where ("+searchString+") and tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+" order by PrdOrdr Asc", null);
            }
            else
            {

                cur=db.rawQuery("Select tblProductListMaster.ProductID,ProductShortName,tblProductSegementMap.StandardRate,tblProductSegementMap.StandardRateBeforeTax,0 AS RateOffer,0 AS InclusiveTax,'"+SalesQuoteValidFrom+"' AS ValidFrom,'"+SalesQuoteValidTo+"' As ValidTo,0 AS MinDlvryQty,0 AS UOMID,0 AS Remarks,'0.00' AS LastTranscRate,tblProductSegementMap.VatTax from tblProductListMaster inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID where ("+searchString+") and tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+" and tblProductListMaster.ManufacturerID="+Integer.parseInt(ManufacturerID)+" order by PrdOrdr Asc", null);
            }
            if(cur.getCount()>0)
            {
                StringBuilder sBuilder=new StringBuilder();
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        hmapFilterProductQuotationList.put(cur.getString(0), cur.getString(1)+"^"+cur.getString(2)+"^"+cur.getString(3)+"^"+cur.getString(4)+"^"+cur.getString(5)+"^"+cur.getString(6)+"^"+cur.getString(7)+"^"+cur.getString(8)+"^"+cur.getString(9)+"^"+cur.getString(10)+"^"+cur.getString(11)+"^"+cur.getString(12));
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e)
        {
            System.out.println("SSS"+e);
            // TODO: handle exception
        }
        finally
        {
           // close();
            int intcheckIfgetFileredProductListQuotationMapExistsinTable=fncheckIfgetFileredProductListQuotationMapExistsinTable(SalesQuoteId);
            if(intcheckIfgetFileredProductListQuotationMapExistsinTable==1)
            {
                getFileredProductListPreFiledListQuotationMap(hmapFilterProductQuotationList,SalesQuoteId,BusinessSegmentId);
            }
            return hmapFilterProductQuotationList;
        }
    }

    public static void getFileredProductListPreFiledListQuotationMap( LinkedHashMap<String, String> hmapFilterProductQuotationList,String SalesQuoteId,int BusinessSegmentId)
    {
        //open();
        try {
            Cursor cur=null;
            //cur=db.rawQuery("Select ProductID,ProductShortName,tblSalesQuoteProductsMstr.StandardRate ,tblSalesQuoteProductsMstr.StandardRateBeforeTax,tblSalesQuoteProductsMstr.RateOffer,tblSalesQuoteProductsMstr.InclusiveTax,tblSalesQuoteProductsMstr.ValidFrom AS ValidFrom,tblSalesQuoteProductsMstr.ValidTo As ValidTo,tblSalesQuoteProductsMstr.MinDlvryQty,tblSalesQuoteProductsMstr.UOMID,tblSalesQuoteProductsMstr.Remarks,tblSalesQuoteProductsMstr.LastTranscRate,tblProductListMaster.VatTax from tblProductListMaster inner join tblSalesQuoteProductsMstr on tblProductListMaster.ProductID=tblSalesQuoteProductsMstr.PrdId where tblSalesQuoteProductsMstr.SalesQuoteId='"+SalesQuoteId+"' order by tblProductListMaster.PrdOrdr Asc", null);
            cur=db.rawQuery("Select tblProductListMaster.ProductID,ProductShortName,tblSalesQuoteProductsMstr.StandardRate,tblSalesQuoteProductsMstr.StandardRateBeforeTax,tblSalesQuoteProductsMstr.RateOffer,tblSalesQuoteProductsMstr.InclusiveTax,tblSalesQuoteProductsMstr.ValidFrom AS ValidFrom,tblSalesQuoteProductsMstr.ValidTo As ValidTo,tblSalesQuoteProductsMstr.MinDlvryQty,tblSalesQuoteProductsMstr.UOMID,tblSalesQuoteProductsMstr.Remarks,tblSalesQuoteProductsMstr.LastTranscRate,tblProductSegementMap.VatTax from tblProductListMaster inner join tblSalesQuoteProductsMstr on tblProductListMaster.ProductID=tblSalesQuoteProductsMstr.PrdId inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID where tblSalesQuoteProductsMstr.SalesQuoteId='"+SalesQuoteId+"' and tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+" order by tblProductListMaster.PrdOrdr Asc", null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        hmapFilterProductQuotationList.put(cur.getString(0), cur.getString(1)+"^"+cur.getString(2)+"^"+cur.getString(3)+"^"+cur.getString(4)+"^"+cur.getString(5)+"^"+cur.getString(6)+"^"+cur.getString(7)+"^"+cur.getString(8)+"^"+cur.getString(9)+"^"+cur.getString(10)+"^"+cur.getString(11)+"^"+cur.getString(12));
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e)
        {
            System.out.println("SSS"+e);
            // TODO: handle exception
        }
        finally
        {

            //close();

        }
    }

    public static int fncheckIfgetFileredProductListQuotationMapExistsinTable(String SalesQuoteId)
    {
        //open();
        int strReturnPDADateExistOrNot = 0;
        //tblSalesQuoteProductsMstr.SalesQuoteId='"+SalesQuoteId+"'
        Cursor cursor2 = db.rawQuery("SELECT * FROM  tblSalesQuoteProductsMstr where tblSalesQuoteProductsMstr.SalesQuoteId='"+SalesQuoteId+"'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strReturnPDADateExistOrNot = 1;
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }

            return strReturnPDADateExistOrNot;
        } finally {
            //cursor2.close();
           // close();
        }
    }

    public static LinkedHashMap<String, String> getDefaultProductListQuotationMap(String SalesQuoteId,int BusinessSegmentId)
    {
        String searchString="";
        LinkedHashMap<String, String> hmapDefaultProductQuotationList=new LinkedHashMap<String, String>();
        try {
            //open();
            //Cursor cur=db.rawQuery("Select ProductID,ProductShortName,IFNULL(tblSalesQuoteProductsMstr.StandardRate,0),IFNULL(tblSalesQuoteProductsMstr.StandardRateBeforeTax,0),IFNULL(tblSalesQuoteProductsMstr.RateOffer,0),IFNULL(tblSalesQuoteProductsMstr.InclusiveTax,0),IFNULL(tblSalesQuoteProductsMstr.ValidFrom,0),IFNULL(tblSalesQuoteProductsMstr.ValidTo,0),IFNULL(tblSalesQuoteProductsMstr.MinDlvryQty,0),IFNULL(tblSalesQuoteProductsMstr.UOMID,0),IFNULL(tblSalesQuoteProductsMstr.Remarks,''),IFNULL(tblSalesQuoteProductsMstr.LastTranscRate,'0.00'),VatTax from tblProductListMaster Inner Join tblSalesQuoteProductsMstr On tblProductListMaster.ProductID=tblSalesQuoteProductsMstr.PrdId Where tblSalesQuoteProductsMstr.SalesQuoteId='"+SalesQuoteId+"' order by PrdOrdr Asc", null);
            Cursor cur=db.rawQuery("Select tblProductListMaster.ProductID,ProductShortName,IFNULL(tblSalesQuoteProductsMstr.StandardRate,0),IFNULL(tblSalesQuoteProductsMstr.StandardRateBeforeTax,0),IFNULL(tblSalesQuoteProductsMstr.RateOffer,0),IFNULL(tblSalesQuoteProductsMstr.InclusiveTax,0),IFNULL(tblSalesQuoteProductsMstr.ValidFrom,0),IFNULL(tblSalesQuoteProductsMstr.ValidTo,0),IFNULL(tblSalesQuoteProductsMstr.MinDlvryQty,0),IFNULL(tblSalesQuoteProductsMstr.UOMID,0),IFNULL(tblSalesQuoteProductsMstr.Remarks,''),IFNULL(tblSalesQuoteProductsMstr.LastTranscRate,'0.00'),tblProductSegementMap.VatTax from tblProductListMaster Inner Join tblSalesQuoteProductsMstr On tblProductListMaster.ProductID=tblSalesQuoteProductsMstr.PrdId inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID Where tblSalesQuoteProductsMstr.SalesQuoteId='"+SalesQuoteId+"' and tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+" order by PrdOrdr Asc", null);
            if(cur.getCount()>0)
            {
                StringBuilder sBuilder=new StringBuilder();

                if(cur.moveToFirst())

                {

                    for(int i=0;i<cur.getCount();i++)

                    {

                        hmapDefaultProductQuotationList.put(cur.getString(0), cur.getString(1)+"^"+cur.getString(2)+"^"+cur.getString(3)+"^"+cur.getString(4)+"^"+cur.getString(5)+"^"+cur.getString(6)+"^"+cur.getString(7)+"^"+cur.getString(8)+"^"+cur.getString(9)+"^"+cur.getString(10)+"^"+cur.getString(11)+"^"+cur.getString(12));

                        cur.moveToNext();

                    }

                }



            }



        } catch (Exception e) {

            // TODO: handle exception

        }

        finally

        {

           // close();

            return hmapDefaultProductQuotationList;

        }

    }

    public static String fnGettPrcIDBasedOnQuotationId(String SalesQuoteId)
    {
        //open();
        Cursor cursor = db.rawQuery("SELECT SalesQuotePrcsId from tblSalesQuotePersonMeetMstr where SalesQuoteId='"+SalesQuoteId +"'", null);
        String flag="0";
        try {
            if(cursor.getCount()>0){
                if (cursor.moveToFirst()){
                    flag=	cursor.getString(0).toString();
                }

            }
            return flag;
        }

        finally
        {
            cursor.close();
            //close();
        }
    }

    public static LinkedHashMap<String, String> getQuotationPersionMeetDetails(String SalesQuoteId)

    {

        //tblProductListMaster (CategoryID text  null,ProductID text  null, ProductShortName text  null, DisplayUnit text null, CalculateKilo real  null,ProductMRP real not null, ProductRLP real not null, ProductTaxAmount real not null, KGLiter string null,RetMarginPer real null,VatTax real null,StandardRate real null,StandardRateBeforeTax real null,StandardTax real null,CatOrdr int null,PrdOrdr int null,StoreCatNodeId int null);";



        String searchString="";

        LinkedHashMap<String, String> hmapQuotationPersionMeetDetails=new LinkedHashMap<String, String>();

        try {
            //open();



            // Cursor cur=db.rawQuery("Select StoreName As Customer,ContactPerson,ContactPersonPhone,ContactPersonEmail,SalesQuoteType,IFNULL(SalesQuoteValidFrom,0),IFNULL(SalesQuoteValidTo,0),IFNULL(ExpectedBusinessValue,0),IFNULL(PaymentTerms,0),IFNULL(PaymentTermsType,0),SalesQuoteDate from tblProductListMaster Inner Join tblSalesQuoteProductsMstr On tblProductListMaster.ProductID=tblSalesQuoteProductsMstr.PrdId Where tblSalesQuoteProductsMstr.SalesQuoteId='"+SalesQuoteId+"' order by PrdOrdr Asc", null);

            Cursor cur=db.rawQuery("Select StoreName As Customer,ContactPerson,ContactPersonPhone,ContactPersonEmail,SalesQuoteType,IFNULL(SalesQuoteValidFrom,0),IFNULL(SalesQuoteValidTo,0),IFNULL(ExpectedBusinessValue,0),IFNULL(CreditLimit,0),IFNULL(CreditDays,0),SalesQuoteDate,SalesQuotePrcsId ,SalesQuotePrcs,PaymentModeId,IFNULL(PymtStageId,0),IFNULL(ManufacturerID,0),IFNULL(ManufacturerName,0) from tblSalesQuotePersonMeetMstr Where tblSalesQuotePersonMeetMstr.SalesQuoteId='"+SalesQuoteId+"'", null);

            if(cur.getCount()>0)

            {

                StringBuilder sBuilder=new StringBuilder();

                if(cur.moveToFirst())

                {

                    for(int i=0;i<cur.getCount();i++)

                    {

                        hmapQuotationPersionMeetDetails.put(SalesQuoteId, cur.getString(0)+"^"+cur.getString(1)+"^"+cur.getString(2)+"^"+cur.getString(3)+"^"+cur.getString(4)+"^"+cur.getString(5)+"^"+cur.getString(6)+"^"+cur.getString(7)+"^"+cur.getString(8)+"^"+cur.getString(9)+"^"+cur.getString(10)+"^"+cur.getString(11)+"^"+cur.getString(12)+"^"+cur.getString(13)+"^"+cur.getString(14)+"^"+cur.getString(15)+"^"+cur.getString(16));

                        cur.moveToNext();

                    }

                }



            }



        } catch (Exception e) {

            // TODO: handle exception

        }

        finally

        {

           // close();

            return hmapQuotationPersionMeetDetails;

        }

    }

    public static void UpdateQuotePrcsAgainstQuotationId(String SalesQuoteId,String SalesQuotePrcsId,String SalesQuotePrcs)
    {

        try
        {
            final ContentValues values = new ContentValues();
            values.put("SalesQuotePrcsId", SalesQuotePrcsId);
            values.put("SalesQuotePrcs", SalesQuotePrcs);
            int affected = db.update("tblSalesQuotePersonMeetMstr", values, "SalesQuoteId=? ",new String[] { SalesQuoteId });
        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }
        finally
        {

        }
    }



    public static LinkedHashMap<String, String> fnGetDistinctSenction()
    {
        String searchString="";
        LinkedHashMap<String, String> hmapDistinctDiffrentSection=new LinkedHashMap<String, String>();
        try {
            //open();
            Cursor cur=db.rawQuery("Select Distinct SectionNo from tblGetPDAQuestGrpMapping", null);
            if(cur.getCount()>0)
            {
                StringBuilder sBuilder=new StringBuilder();
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        hmapDistinctDiffrentSection.put(cur.getString(0),"Section_"+cur.getString(0).toString().trim());
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            // TODO: handle exception

        }
        finally
        {
          //  close();
            return hmapDistinctDiffrentSection;
        }
    }

    public static LinkedHashMap<String, String> fnGetDistinctGroupsinSection(int SectionNo)
    {
        String searchString="";
        LinkedHashMap<String, String> hmapDistinctGroupsinSection=new LinkedHashMap<String, String>();
        try {
            //open();
            Cursor cur=db.rawQuery("Select GrpID,GrpNodeID,GrpDesc from tblGetPDAQuestGrpMapping Where SectionNo='"+SectionNo+"'", null);
            if(cur.getCount()>0)
            {
                StringBuilder sBuilder=new StringBuilder();
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        hmapDistinctGroupsinSection.put(cur.getString(2),cur.getString(0).toString().trim()+"_"+cur.getString(1).toString().trim());
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            // TODO: handle exception

        }
        finally
        {
           // close();
            return hmapDistinctGroupsinSection;
        }
    }



    public static LinkedHashMap<String, ArrayList<String>> fnGetGroupIDMapWithQuestionID()
    {
        LinkedHashMap<String, ArrayList<String>> hmapQuestionMstr=new LinkedHashMap<String, ArrayList<String>>();
        ArrayList<String> listKeyQuesVal=new ArrayList<String>();
        //open();
        //tblGetPDAQuestGrpMapping(GrpQuestID int null,QuestID int null,GrpID int null,GrpNodeID int null,GrpDesc text null,SectionNo int null);";
        //tblGetPDAQuestMstr(QuestID int null,QuestCode int null,QuestDesc text null,QuestType int null,AnsControlType int null,AnsControlInputTypeID int null,AnsControlInputTypeMinLength int null,AnsControlInputTypeMaxLength int null,AnsMustRequiredFlg int null,QuestBundleFlg int null,ApplicationTypeID int null,Sequence int null,AnswerHint text null);";
        Cursor cursor = db.rawQuery("SELECT tblGetPDAQuestMstr.QuestID,tblGetPDAQuestMstr.AnsControlType,tblGetPDAQuestGrpMapping.GrpQuestID,tblGetPDAQuestGrpMapping.GrpID from tblGetPDAQuestMstr inner join tblGetPDAQuestGrpMapping where tblGetPDAQuestMstr.QuestID=tblGetPDAQuestGrpMapping.QuestID  Order By tblGetPDAQuestGrpMapping.GrpID ASC  ", null);// Where PNodeID='"+TSIID+"'

        try
        {
            if(cursor.getCount()>0)
            {
                String sectionNo="0",preVisousSectionNum="0";
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        sectionNo= cursor.getString(3);
                        if(i==0)
                        {
                            preVisousSectionNum= sectionNo;
                            listKeyQuesVal.add(cursor.getString(0)+"^"+cursor.getString(1)+"^"+cursor.getString(2));
                        }
                        else if(preVisousSectionNum.equals(sectionNo))
                        {
                            listKeyQuesVal.add(cursor.getString(0)+"^"+cursor.getString(1)+"^"+cursor.getString(2));
                        }
                        else
                        {
                            hmapQuestionMstr.put(preVisousSectionNum, listKeyQuesVal);
                            listKeyQuesVal=new ArrayList<String>();
                            preVisousSectionNum=sectionNo;
                            listKeyQuesVal.add(cursor.getString(0)+"^"+cursor.getString(1)+"^"+cursor.getString(2));

                        }
                        if(i==(cursor.getCount()-1))
                        {
                            hmapQuestionMstr.put(preVisousSectionNum, listKeyQuesVal);
                        }

                        cursor.moveToNext();
                    }
                }
            }
            return hmapQuestionMstr;
        }
        finally
        {
            cursor.close();
            //close();
        }
    }

    public static LinkedHashMap<String, String> fnGetGroupIDWithGroupDescr()
    {
        {
            //open();
            LinkedHashMap<String, String> hmapGroupIDWithGroupDescr=new LinkedHashMap<String, String>();
            //tblGetPDAQuestGrpMapping(GrpQuestID int null,QuestID int null,GrpID int null,GrpNodeID int null,GrpDesc text null,SectionNo int null);";

            Cursor cur=db.rawQuery("Select Distinct GrpID,GrpDesc from tblGetPDAQuestGrpMapping", null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        hmapGroupIDWithGroupDescr.put(cur.getString(0), cur.getString(1));
                        cur.moveToNext();
                    }

                }
            }
            //close();
            return hmapGroupIDWithGroupDescr;
        }
    }

    public static int getsectionCount()
    {
        int sectionCount=0;


        try {

//tblQuestIDForOutChannel(GrpQstId int null,QuestID int null,OptID text null,SectionCount int null);";
            Cursor cur=db.rawQuery("Select SectionCount from tblQuestIDForOutChannel", null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {

                    sectionCount=cur.getInt(0);
                }
            }
        } catch (Exception e) {
            // TODO: handle exception
        }
        finally
        {

            return sectionCount;
        }
    }

    public static LinkedHashMap<String,ArrayList<String>> fnGetSectionIDMapWithGroupID()
    {
        LinkedHashMap<String, ArrayList<String>> hmapQuestionMstr=new LinkedHashMap<String, ArrayList<String>>();
        ArrayList<String> listKeyQuesVal=new ArrayList<String>();

        //open();
        int sectionCount=getsectionCount();
        //    int sectionCount=0;
        //tblGetPDAQuestGrpMapping(GrpQuestID int null,QuestID int null,GrpID int null,GrpNodeID int null,GrpDesc text null,SectionNo int null);";
        //tblGetPDAQuestMstr(QuestID int null,QuestCode int null,QuestDesc text null,QuestType int null,AnsControlType int null,AnsControlInputTypeID int null,AnsControlInputTypeMinLength int null,AnsControlInputTypeMaxLength int null,AnsMustRequiredFlg int null,QuestBundleFlg int null,ApplicationTypeID int null,Sequence int null,AnswerHint text null);";
        Cursor cursor;
        if(sectionCount!=0)
        {
            cursor = db.rawQuery("SELECT Distinct GrpID,SectionNo from tblGetPDAQuestGrpMapping where SectionNo<="+sectionCount+" order by SectionNo", null);// Where PNodeID='"+TSIID+"'
        }
        else
        {
            cursor = db.rawQuery("SELECT Distinct GrpID,SectionNo from tblGetPDAQuestGrpMapping order by SectionNo", null);// Where PNodeID='"+TSIID+"'
        }


        try
        {
            if(cursor.getCount()>0)
            {
                String sectionNo="0",preVisousSectionNum="0";
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        sectionNo= cursor.getString(1);
                        if(i==0)
                        {
                            preVisousSectionNum= sectionNo;
                            listKeyQuesVal.add(cursor.getString(0));
                        }
                        else if(preVisousSectionNum.equals(sectionNo))
                        {
                            listKeyQuesVal.add(cursor.getString(0));
                        }
                        else
                        {
                            hmapQuestionMstr.put(preVisousSectionNum, listKeyQuesVal);
                            listKeyQuesVal=new ArrayList<String>();
                            preVisousSectionNum=sectionNo;
                            listKeyQuesVal.add(cursor.getString(0));

                        }
                        if(i==cursor.getCount() - 1)
                        {
                            hmapQuestionMstr.put(preVisousSectionNum, listKeyQuesVal);
                        }


                        cursor.moveToNext();
                    }
                }
            }
            return hmapQuestionMstr;
        }
        finally
        {
            cursor.close();
            //close();
        }
    }

    public static LinkedHashMap<String, String> fnGetOptionId_OptionValue()
    {
        LinkedHashMap<String, String> hmapOptionId_OptionValue=new LinkedHashMap<String, String>();
        //open();

        Cursor cursor = db.rawQuery("SELECT QuestID,OptID,OptionNo from tblGetPDAQuestOptionMstr Order By Sequence ASC ", null);// Where PNodeID='"+TSIID+"'

        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        hmapOptionId_OptionValue.put((String) cursor.getString(0).toString()+"_"+(String) cursor.getString(1).toString(), (String) cursor.getString(2).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return hmapOptionId_OptionValue;
        }
        finally
        {
            cursor.close();
            //close();
        }
    }

    public static int getSectionCount()
    {
        int sectionNo=0;

        try
        {


            Cursor cursor = db.rawQuery("Select SectionCount from tblQuestIDForOutChannel", null);

            if (cursor.getCount() > 0)  //Return the number of rows in the cursor
            {
                if (cursor.moveToFirst())  // move the cursor to the first row .
                {                          // This method will return false  if cursor is empty
                    sectionNo = cursor.getInt(0);
                    cursor.moveToNext();    // move the cursor to the next row
                }
            }
        }
        catch(Exception e)
        {

        }
        finally
        {
            return sectionNo;
        }


    }

    public static LinkedHashMap<String, String> fnGetQuestionMstr(SharedPreferences sPref)
    {

        if(sPref.getString("Language", "").equals("en"))
        {

        }
        else if(sPref.getString("Language", "").equals("hi"))
        {

        }
        else
        {

        }
        LinkedHashMap<String, String> hmapQuestionMstr=new LinkedHashMap<String, String>();
        //open();
        int sectionCount=getsectionCount();




        Cursor cursor;


/*

		if(sPref.getString("Language", "").equals("en"))
		{
			if(sectionCount!=0)
			{
				cursor = db.rawQuery("SELECT tblGetPDAQuestMstr.QuestID,tblGetPDAQuestMstr.QuestCode,tblGetPDAQuestMstr.QuestDesc,tblGetPDAQuestMstr.QuestType,tblGetPDAQuestMstr.AnsControlType,tblGetPDAQuestMstr.AnsControlInputTypeID,tblGetPDAQuestMstr.AnsControlInputTypeMaxLength,tblGetPDAQuestMstr.AnsMustRequiredFlg,tblGetPDAQuestMstr.QuestBundleFlg,tblGetPDAQuestMstr.ApplicationTypeID,tblGetPDAQuestMstr.Sequence,tblGetPDAQuestMstr.AnsControlInputTypeMinLength,tblGetPDAQuestMstr.AnswerHint,tblGetPDAQuestGrpMapping.GrpQuestID,tblGetPDAQuestGrpMapping.Sequence from tblGetPDAQuestMstr inner join tblGetPDAQuestGrpMapping On tblGetPDAQuestMstr.QuestID=tblGetPDAQuestGrpMapping.QuestID  where tblGetPDAQuestGrpMapping.SectionNo<="+sectionCount+" Order By tblGetPDAQuestGrpMapping.Sequence ASC  ", null);// Where PNodeID='"+TSIID+"'
			}
			else
			{
				cursor = db.rawQuery("SELECT tblGetPDAQuestMstr.QuestID,tblGetPDAQuestMstr.QuestCode,tblGetPDAQuestMstr.QuestDesc,tblGetPDAQuestMstr.QuestType,tblGetPDAQuestMstr.AnsControlType,tblGetPDAQuestMstr.AnsControlInputTypeID,tblGetPDAQuestMstr.AnsControlInputTypeMaxLength,tblGetPDAQuestMstr.AnsMustRequiredFlg,tblGetPDAQuestMstr.QuestBundleFlg,tblGetPDAQuestMstr.ApplicationTypeID,tblGetPDAQuestMstr.Sequence,tblGetPDAQuestMstr.AnsControlInputTypeMinLength,tblGetPDAQuestMstr.AnswerHint,tblGetPDAQuestGrpMapping.GrpQuestID,tblGetPDAQuestGrpMapping.Sequence from tblGetPDAQuestMstr inner join tblGetPDAQuestGrpMapping On tblGetPDAQuestMstr.QuestID=tblGetPDAQuestGrpMapping.QuestID  Order By tblGetPDAQuestGrpMapping.Sequence ASC  ", null);// Where PNodeID='"+TSIID+"'
			}
		}
		else if(sPref.getString("Language", "").equals("hi"))
		{
			if(sectionCount!=0)
			{
				cursor = db.rawQuery("SELECT tblGetPDAQuestMstr.QuestID,tblGetPDAQuestMstr.QuestCode,tblGetPDAQuestMstr.QuestDescHindi,tblGetPDAQuestMstr.QuestType,tblGetPDAQuestMstr.AnsControlType,tblGetPDAQuestMstr.AnsControlInputTypeID,tblGetPDAQuestMstr.AnsControlInputTypeMaxLength,tblGetPDAQuestMstr.AnsMustRequiredFlg,tblGetPDAQuestMstr.QuestBundleFlg,tblGetPDAQuestMstr.ApplicationTypeID,tblGetPDAQuestMstr.Sequence,tblGetPDAQuestMstr.AnsControlInputTypeMinLength,tblGetPDAQuestMstr.AnswerHint,tblGetPDAQuestGrpMapping.GrpQuestID,tblGetPDAQuestGrpMapping.Sequence from tblGetPDAQuestMstr inner join tblGetPDAQuestGrpMapping On tblGetPDAQuestMstr.QuestID=tblGetPDAQuestGrpMapping.QuestID  where tblGetPDAQuestGrpMapping.SectionNo<="+sectionCount+" Order By tblGetPDAQuestGrpMapping.Sequence ASC  ", null);// Where PNodeID='"+TSIID+"'
			}
			else
			{
				cursor = db.rawQuery("SELECT tblGetPDAQuestMstr.QuestID,tblGetPDAQuestMstr.QuestCode,tblGetPDAQuestMstr.QuestDescHindi,tblGetPDAQuestMstr.QuestType,tblGetPDAQuestMstr.AnsControlType,tblGetPDAQuestMstr.AnsControlInputTypeID,tblGetPDAQuestMstr.AnsControlInputTypeMaxLength,tblGetPDAQuestMstr.AnsMustRequiredFlg,tblGetPDAQuestMstr.QuestBundleFlg,tblGetPDAQuestMstr.ApplicationTypeID,tblGetPDAQuestMstr.Sequence,tblGetPDAQuestMstr.AnsControlInputTypeMinLength,tblGetPDAQuestMstr.AnswerHint,tblGetPDAQuestGrpMapping.GrpQuestID,tblGetPDAQuestGrpMapping.Sequence from tblGetPDAQuestMstr inner join tblGetPDAQuestGrpMapping On tblGetPDAQuestMstr.QuestID=tblGetPDAQuestGrpMapping.QuestID  Order By tblGetPDAQuestGrpMapping.Sequence ASC  ", null);// Where PNodeID='"+TSIID+"'
			}
		}
		else
		{
			if(sectionCount!=0)
			{
				cursor = db.rawQuery("SELECT tblGetPDAQuestMstr.QuestID,tblGetPDAQuestMstr.QuestCode,tblGetPDAQuestMstr.QuestDesc,tblGetPDAQuestMstr.QuestType,tblGetPDAQuestMstr.AnsControlType,tblGetPDAQuestMstr.AnsControlInputTypeID,tblGetPDAQuestMstr.AnsControlInputTypeMaxLength,tblGetPDAQuestMstr.AnsMustRequiredFlg,tblGetPDAQuestMstr.QuestBundleFlg,tblGetPDAQuestMstr.ApplicationTypeID,tblGetPDAQuestMstr.Sequence,tblGetPDAQuestMstr.AnsControlInputTypeMinLength,tblGetPDAQuestMstr.AnswerHint,tblGetPDAQuestGrpMapping.GrpQuestID,tblGetPDAQuestGrpMapping.Sequence from tblGetPDAQuestMstr inner join tblGetPDAQuestGrpMapping On tblGetPDAQuestMstr.QuestID=tblGetPDAQuestGrpMapping.QuestID  where tblGetPDAQuestGrpMapping.SectionNo<="+sectionCount+" Order By tblGetPDAQuestGrpMapping.Sequence ASC  ", null);// Where PNodeID='"+TSIID+"'
			}
			else
			{
				cursor = db.rawQuery("SELECT tblGetPDAQuestMstr.QuestID,tblGetPDAQuestMstr.QuestCode,tblGetPDAQuestMstr.QuestDesc,tblGetPDAQuestMstr.QuestType,tblGetPDAQuestMstr.AnsControlType,tblGetPDAQuestMstr.AnsControlInputTypeID,tblGetPDAQuestMstr.AnsControlInputTypeMaxLength,tblGetPDAQuestMstr.AnsMustRequiredFlg,tblGetPDAQuestMstr.QuestBundleFlg,tblGetPDAQuestMstr.ApplicationTypeID,tblGetPDAQuestMstr.Sequence,tblGetPDAQuestMstr.AnsControlInputTypeMinLength,tblGetPDAQuestMstr.AnswerHint,tblGetPDAQuestGrpMapping.GrpQuestID,tblGetPDAQuestGrpMapping.Sequence from tblGetPDAQuestMstr inner join tblGetPDAQuestGrpMapping On tblGetPDAQuestMstr.QuestID=tblGetPDAQuestGrpMapping.QuestID  Order By tblGetPDAQuestGrpMapping.Sequence ASC  ", null);// Where PNodeID='"+TSIID+"'
			}
		}
*/

        if(sectionCount!=0)
        {
            cursor = db.rawQuery("SELECT tblGetPDAQuestMstr.QuestID,tblGetPDAQuestMstr.QuestCode,tblGetPDAQuestMstr.QuestDesc,tblGetPDAQuestMstr.QuestType,tblGetPDAQuestMstr.AnsControlType,tblGetPDAQuestMstr.AnsControlInputTypeID,tblGetPDAQuestMstr.AnsControlInputTypeMaxLength,tblGetPDAQuestMstr.AnsMustRequiredFlg,tblGetPDAQuestMstr.QuestBundleFlg,tblGetPDAQuestMstr.ApplicationTypeID,tblGetPDAQuestMstr.Sequence,tblGetPDAQuestMstr.AnsControlInputTypeMinLength,tblGetPDAQuestMstr.AnswerHint,tblGetPDAQuestGrpMapping.GrpQuestID,tblGetPDAQuestGrpMapping.Sequence from tblGetPDAQuestMstr inner join tblGetPDAQuestGrpMapping On tblGetPDAQuestMstr.QuestID=tblGetPDAQuestGrpMapping.QuestID  where tblGetPDAQuestGrpMapping.SectionNo<="+sectionCount+" Order By tblGetPDAQuestGrpMapping.Sequence ASC  ", null);// Where PNodeID='"+TSIID+"'
        }
        else
        {
            cursor = db.rawQuery("SELECT tblGetPDAQuestMstr.QuestID,tblGetPDAQuestMstr.QuestCode,tblGetPDAQuestMstr.QuestDesc,tblGetPDAQuestMstr.QuestType,tblGetPDAQuestMstr.AnsControlType,tblGetPDAQuestMstr.AnsControlInputTypeID,tblGetPDAQuestMstr.AnsControlInputTypeMaxLength,tblGetPDAQuestMstr.AnsMustRequiredFlg,tblGetPDAQuestMstr.QuestBundleFlg,tblGetPDAQuestMstr.ApplicationTypeID,tblGetPDAQuestMstr.Sequence,tblGetPDAQuestMstr.AnsControlInputTypeMinLength,tblGetPDAQuestMstr.AnswerHint,tblGetPDAQuestGrpMapping.GrpQuestID,tblGetPDAQuestGrpMapping.Sequence from tblGetPDAQuestMstr inner join tblGetPDAQuestGrpMapping On tblGetPDAQuestMstr.QuestID=tblGetPDAQuestGrpMapping.QuestID  Order By tblGetPDAQuestGrpMapping.Sequence ASC  ", null);// Where PNodeID='"+TSIID+"'
        }


        try
        {
            //	String aa="  $  ";
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        System.out.println("Varun Quest Id = "+(String) cursor.getString(0).toString()+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(13).toString()+"~"+ (String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString()+"^"+(String) cursor.getString(2).toString()+"^"+(String) cursor.getString(3).toString()+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(5).toString()+"^"+(String) cursor.getString(6).toString()+"^"+(String) cursor.getString(7).toString()+"^"+(String) cursor.getString(8).toString()+"^"+(String) cursor.getString(13).toString()+"^"+(String) cursor.getString(14).toString());
                        //	hmapQuestionMstr.put((String) cursor.getString(0).toString()+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(13).toString(), (String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString()+"^"+(String) cursor.getString(2).toString()+"^"+(String) cursor.getString(3).toString()+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(5).toString()+"^"+(String) cursor.getString(6).toString()+"^"+(String) cursor.getString(7).toString()+"^"+(String) cursor.getString(8).toString()+"^"+(String) cursor.getString(9).toString()+"^"+(String) cursor.getString(10).toString()+"^"+(String) cursor.getString(11).toString()+"^"+(String) cursor.getString(12).toString()+"^"+(String) cursor.getString(13).toString());
                        hmapQuestionMstr.put((String) cursor.getString(0).toString()+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(13).toString(), (String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString()+"^"+(String) cursor.getString(2).toString()+"^"+(String) cursor.getString(3).toString()+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(5).toString()+"^"+(String) cursor.getString(6).toString()+"^"+(String) cursor.getString(7).toString()+"^"+(String) cursor.getString(8).toString()+"^"+(String) cursor.getString(9).toString()+"^"+(String) cursor.getString(10).toString()+"^"+(String) cursor.getString(11).toString()+"^"+(String) cursor.getString(12).toString()+"^"+(String) cursor.getString(13).toString());
                        //use=aa in place of (String) cursor.getString(2).toString()
                        cursor.moveToNext();
                    }
                }
            }
            return hmapQuestionMstr;
        }
        finally
        {
            cursor.close();
           // close();
        }
    }

    public static void fnDeletesaveOutletQuestAnsMstrSctionWise(String OutletID,int sectionID)
    {
        db.execSQL("DELETE FROM tblOutletQuestAnsMstr WHERE OutletID ='"+ OutletID + "'");// and sectionID="+sectionID
    }


    //Add New Store Section wise Code Ends Here

    public static LinkedHashMap<String, String> getReasonReturn()
    {
        ////tblGetReturnsReasonForPDAMstr(StockStatusId text not null,StockStatus text not null);";
        LinkedHashMap<String, String> hmapRtrnRsn=new LinkedHashMap<String, String>();
        //open();
        try {


            Cursor cur=db.rawQuery("Select * from tblGetReturnsReasonForPDAMstr", null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        hmapRtrnRsn.put(cur.getString(1), cur.getString(0));
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println(" Print e ="+e.toString());
        }
        finally
        {
          //  close();
            return hmapRtrnRsn;
        }
    }

    public static LinkedHashMap<String, String> getSavedRemark(String StoreID,String OrderPDAID,String TmpInvoiceCodePDA)
    {
//			              /  //tblStoreReturnDetail (RouteID text null,StoreID text null,ReturnProductID text null, ProdReturnQty text null, ProdReturnReason text null, ProdReturnReasonIndex text null,ReturnDate text null,Sstat integer null,OrderIDPDA text null);";
        LinkedHashMap<String, String> hmapRtrnRsn=new LinkedHashMap<String, String>();
        //open();
        try {


            Cursor cur=db.rawQuery("Select * from tblStoreReturnDetail where StoreID='"+StoreID+"'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'", null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        hmapRtrnRsn.put(cur.getString(2), cur.getString(4));
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println(" Print e ="+e.toString());
        }
        finally
        {
           // close();
            return hmapRtrnRsn;
        }
    }

    public static void updateflgFromWhereSubmitStatusAgainstStore(String sID, int flag2set,String StoreVisitCode)
    {
        try
        {

            final ContentValues values = new ContentValues();
            values.put("flgFromWhereSubmitStatus", flag2set);
            int affected = db.update("tblStoreVisitMstr", values, "StoreID=? AND flgFromWhereSubmitStatus=? AND StoreVisitCode=?",new String[] { sID,""+0,StoreVisitCode });
        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }
    }

    public static int checkCountIntblNewStoreSalesQuotePaymentDetails(String  StoreId)
    {
        //open();
        Cursor cursor =null;
        int check=0;
        try {

            //tblNewStoreSalesQuotePaymentDetails (StoreId text null,PymtStageId text null,Sstat text null);";
            cursor= db.rawQuery("SELECT Count(*) FROM tblNewStoreSalesQuotePaymentDetails WHERE  StoreId ='"+ StoreId + "'", null);
            if (cursor.getCount() > 0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        check=1;
                        cursor.moveToNext();
                    }
                }

            }


        } catch (Exception e) {
            System.out.println("shivam query = "+e.toString());
        }
        finally {
            cursor.close();
           // close();
        }
        return check;
    }

    //Code For Order Payment and Bill Starts Here

    public static ArrayList<LinkedHashMap<String, String>> fngetStoreBillToAddressAndDiliverToAddress(String StoreID)
    {

        ArrayList<LinkedHashMap<String, String>> totalProductDetail=new ArrayList<LinkedHashMap<String, String>>(3);
        LinkedHashMap<String, String> hmapStoreBillTogAddresse=new LinkedHashMap<String, String>();
        LinkedHashMap<String, String> hmapStoreShippToAddress=new LinkedHashMap<String, String>();
        LinkedHashMap<String, String> hmapStoreAddress=new LinkedHashMap<String, String>();
        //open();
        Cursor cur=db.rawQuery("Select OutAddTypeID,Address,AddressDet,OutAddID from tblStoreAddressMapDetailsMstr where StoreID='"+StoreID+"'",null);
        if(cur.getCount()>0)
        {
            if(cur.moveToFirst())
            {
                for(int i=0;i<cur.getCount();i++)
                {
                    if(Integer.parseInt(cur.getString(0))==1)
                    {
                        hmapStoreBillTogAddresse.put(cur.getString(1), cur.getString(3)) ;
                    }
                    if(Integer.parseInt(cur.getString(0))==2)
                    {
                        hmapStoreShippToAddress.put(cur.getString(1), cur.getString(3)) ;
                    }
                    hmapStoreAddress.put(cur.getString(3), cur.getString(2));

                    cur.moveToNext();
                }
            }
        }
       // close();

        totalProductDetail.add(0,hmapStoreBillTogAddresse);
        totalProductDetail.add(1,hmapStoreShippToAddress);
        totalProductDetail.add(2,hmapStoreAddress);

        return totalProductDetail;
    }

    public static long fnsaveStoreSalesOrderPaymentDetails(String StoreId,String OrderID,String PaymentStageId,String Sstat,String TmpInvoiceCodePDA)
    {

        ContentValues initialValues = new ContentValues();


        initialValues.put("StoreId", StoreId.toString().trim());
        initialValues.put("OrderID", OrderID.toString().trim());
        initialValues.put("PymtStageId", PaymentStageId.toString().trim());
        initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
        initialValues.put("Sstat", Sstat);

        return db.insert(DATABASE_TABLE_StoreSalesOrderPaymentDetails, null, initialValues);
    }

    public static void fndeleteStoreSalesOrderPaymentDetails(String StoreID,String OrderID,String TmpInvoiceCodePDA)
    {

        db.execSQL("DELETE FROM tblStoreSalesOrderPaymentDetails WHERE StoreId ='" + StoreID +"' and OrderID='"+OrderID+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'");
    }

    public static void fndeleteStoreAddressMapDetailsMstr()
    {

        db.execSQL("DELETE FROM tblStoreAddressMapDetailsMstr");
    }

    public static int checkCountIntblStoreSalesOrderPaymentDetails(String  StoreId,String OrderID,String TmpInvoiceCodePDA)
    {
        //open();
        Cursor cursor =null;
        int check=0;
        try {


            cursor= db.rawQuery("SELECT * FROM tblStoreSalesOrderPaymentDetails WHERE  StoreId ='"+ StoreId + "'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'", null);
            if (cursor.getCount() > 0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        check=1;
                        cursor.moveToNext();
                    }
                }

            }


        } catch (Exception e) {
            System.out.println("shivam query = "+e.toString());
        }
        finally {
            cursor.close();
         //   close();
        }
        return check;
    }
//tblStoreAddressMapDetailsMstr

    public static String fngettblStoreSalesOrderPaymentDetails(String StoreID,String OrderID,String TmpInvoiceCodePDA)

    {



        String searchString="";



        try {
            //open();

            Cursor cur=db.rawQuery("Select IFNULL(PymtStageId,0) from tblStoreSalesOrderPaymentDetails Where StoreId ='"+ StoreID + "' and OrderID='"+OrderID+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'", null);

            if(cur.getCount()>0)

            {

                StringBuilder sBuilder=new StringBuilder();

                if(cur.moveToFirst())

                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        searchString= cur.getString(0);
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            // TODO: handle exception
        }
        finally
        {
         //   close();
            return searchString;
        }
    }

    public static int checkPaymentStageintStoreMstrTabel(String  StoreId)
    {
        //open();
        Cursor cursor =null;
        int check=0;
        try {

            cursor= db.rawQuery("SELECT * FROM tblStoreList WHERE  StoreID ='"+ StoreId + "'", null);
            if (cursor.getCount() > 0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        check=1;
                        cursor.moveToNext();
                    }
                }

            }


        } catch (Exception e) {
            System.out.println("shivam query = "+e.toString());
        }
        finally {
            cursor.close();
           // close();
        }
        return check;
    }

    public static int checkStoreOrderBillAddressDetails(String  StoreId,String OrderID)
    {
        //open();
        Cursor cursor =null;
        int check=0;
        try {

            cursor= db.rawQuery("SELECT * FROM tblStoreOrderBillAddressDetails WHERE  StoreID ='"+ StoreId + "' and OrderID='"+OrderID+"'", null);
            if (cursor.getCount() > 0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        check=1;
                        cursor.moveToNext();
                    }
                }

            }


        } catch (Exception e) {
            System.out.println("shivam query = "+e.toString());
        }
        finally {
            cursor.close();
            //close();
        }
        return check;
    }

    public static void fndeleteStoreOrderBillAddressDetails(String StoreID,String OrderID)
    {
        //open();
        db.execSQL("DELETE FROM tblStoreOrderBillAddressDetails WHERE StoreId ='" + StoreID +"' and OrderID='"+OrderID+"'");
       // close();
    }

    public static long fnsaveStoreOrderBillAddressDetails(String StoreId,String OrderID,String BillToAddress,String ShipToAddress,String Sstat)
    {

        ContentValues initialValues = new ContentValues();


        initialValues.put("StoreID", StoreId.toString().trim());
        initialValues.put("OrderID", OrderID.toString().trim());
        initialValues.put("BillToAddress", BillToAddress.toString().trim());
        initialValues.put("ShipToAddress", ShipToAddress.toString().trim());
	    /* initialValues.put("OrderID", OrderID.toString().trim());
	      initialValues.put("OutAddTypeID",OutAddTypeID );
	      initialValues.put("OutAddID", OutAddID);
	      initialValues.put("DeliveryPreferTime", DeliveryPreferTime);
	      initialValues.put("DeliveryNotPreferTime", DeliveryNotPreferTime);*/
        initialValues.put("Sstat", Sstat);

        return db.insert("tblStoreOrderBillAddressDetails", null, initialValues);
    }

    public static int checkIfCurrentStoreIsNewInOrderBill(String StoreID)
    {

        int ScodecolumnIndex = 0;
        int ISNewStore=0;
        //open();
        Cursor cursor = db.rawQuery("SELECT ISNewStore FROM tblStoreList where StoreID='"+StoreID+"'", null);
        try
        {
            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    ISNewStore = Integer.parseInt(cursor.getString(ScodecolumnIndex).toString());
                    cursor.moveToNext();
                }
            }
            return ISNewStore;
        }
        finally
        {
            cursor.close();
         //   close();
        }
    }

    public static String fetchBillAddress(String OutletID)
    {
        //open();
        Cursor cursor =null;
        String CompleteBillAddress="";
        try {

            cursor= db.rawQuery("SELECT QuestID,AnswerType,AnswerValue,QuestionGroupID FROM tblOutletQuestAnsMstr WHERE  OutletID ='"+ OutletID + "' and QuestionGroupID in (1,3,4) ", null);
            if (cursor.getCount() > 0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        String DDlStringCity="";
                        if(Integer.parseInt(cursor.getString(1).toString())==8)
                        {
                            DDlStringCity=fnGetCityName(cursor.getString(0).toString().trim(),cursor.getString(2).toString().trim());
                        }
                        if(Integer.parseInt(cursor.getString(3))==1 || Integer.parseInt(cursor.getString(3))==4)
                        {
                            if(CompleteBillAddress.equals(""))
                            {
                                CompleteBillAddress= cursor.getString(2).toString().trim();
                            }
                            else
                            {
                                CompleteBillAddress= CompleteBillAddress+", "+cursor.getString(2).toString().trim();
                            }
                        }
                        else if(Integer.parseInt(cursor.getString(3))==3)
                        {
                            if(CompleteBillAddress.equals(""))
                            {
                                CompleteBillAddress=DDlStringCity;
                            }
                            else
                            {
                                CompleteBillAddress= CompleteBillAddress+", "+DDlStringCity;
                            }
                        }

                        cursor.moveToNext();
                    }
                }

            }


        } catch (Exception e) {
            System.out.println("shivam query = "+e.toString());
        }
        finally {
            cursor.close();
           // close();
        }
        return CompleteBillAddress;
    }

    public static String fnGetCityName(String QuestID,String AnsValue)
    {

        Cursor cursor =null;
        String DDlStringCity="";
        try {

            cursor= db.rawQuery("SELECT OptionDescr FROM tblGetPDAQuestOptionMstr WHERE  QuestID ='"+ QuestID + "' and OptID='"+AnsValue+"'", null);
            if (cursor.getCount() > 0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        DDlStringCity=cursor.getString(0).toString().trim();

                        cursor.moveToNext();
                    }
                }

            }


        } catch (Exception e) {
            System.out.println("shivam query = "+e.toString());
        }
        finally {
            cursor.close();

        }
        return DDlStringCity;
    }

    public static String fetchDeliverAddress(String OutletID)
    {
        //open();
        Cursor cursor =null;
        String CompleteDileveryAddress="";
        try {

            cursor= db.rawQuery("SELECT QuestID,AnswerType,AnswerValue,QuestionGroupID FROM tblOutletQuestAnsMstr WHERE  OutletID ='"+ OutletID + "' and QuestionGroupID in (5,7,8) ", null);
            if (cursor.getCount() > 0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        String DDlStringCity="";
                        if(Integer.parseInt(cursor.getString(1).toString())==8)
                        {
                            DDlStringCity=fnGetCityName(cursor.getString(0).toString().trim(),cursor.getString(2).toString().trim());
                        }
                        if(Integer.parseInt(cursor.getString(3))==5 || Integer.parseInt(cursor.getString(3))==8)
                        {
                            if(CompleteDileveryAddress.equals(""))
                            {
                                CompleteDileveryAddress= cursor.getString(2).toString().trim();
                            }
                            else
                            {
                                CompleteDileveryAddress= CompleteDileveryAddress+", "+cursor.getString(2).toString().trim();
                            }
                        }
                        else if(Integer.parseInt(cursor.getString(3))==7)
                        {
                            if(CompleteDileveryAddress.equals(""))
                            {
                                CompleteDileveryAddress=DDlStringCity;
                            }
                            else
                            {
                                CompleteDileveryAddress= CompleteDileveryAddress+", "+DDlStringCity;
                            }
                        }

                        cursor.moveToNext();
                    }
                }

            }


        } catch (Exception e) {
            System.out.println("shivam query = "+e.toString());
        }
        finally {
            cursor.close();
           // close();
        }
        return CompleteDileveryAddress;
    }

    public static String fnGetPreFilledStoreOrderBillAddressDetails(String StoreId,String OrderID)
    {
        ////tblGetReturnsReasonForPDAMstr(StockStatusId text not null,StockStatus text not null);";
        String strPreFilledStoreOrderBillAddressDetails="";
        //open();
        try {
            Cursor cur=db.rawQuery("Select BillToAddress,ShipToAddress from tblStoreOrderBillAddressDetails Where StoreID='"+StoreId+"' and OrderID='"+OrderID+"'", null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        strPreFilledStoreOrderBillAddressDetails= cur.getString(0)+"$"+cur.getString(1);
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println(" Print e ="+e.toString());
        }
        finally
        {
          //  close();
            return strPreFilledStoreOrderBillAddressDetails;
        }
    }

    public static void fndeleteStoreSalesOrderPaymentDetailsOnStoreIDBasis(String StoreID)
    {
        //open();
        db.execSQL("DELETE FROM tblStoreSalesOrderPaymentDetails WHERE StoreId ='" + StoreID +"'");
        //close();
    }

    public static void fndeleteStoreOrderBillAddressDetailsOnStoreIDBasis(String StoreID)
    {
        //open();
        db.execSQL("DELETE FROM tblStoreOrderBillAddressDetails WHERE StoreId ='" + StoreID +"'");
       // close();
    }

    public static String fnGetDefaultStoreOrderPAymentDetails(String  StoreId)
    {
        //open();
        Cursor cursor =null;
        String PaymentStageFROM="";
        try {

            cursor= db.rawQuery("SELECT PaymentStage FROM tblStoreList WHERE  StoreID ='"+ StoreId + "'", null);
            if (cursor.getCount() > 0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        PaymentStageFROM=cursor.getString(0).toString();
                        cursor.moveToNext();
                    }
                }

            }


        } catch (Exception e) {
            System.out.println("shivam query = "+e.toString());
        }
        finally {
            cursor.close();
           // close();
        }
        return PaymentStageFROM;
    }

    // "create table tblStoreSomeProdQuotePriceMstr (PrdId text null,StoreID text null,QPBT text null,QPTaxAmount text null,MinDlvrQty int null,UOMID text null,Sstat text null);";
    public static LinkedHashMap<String, Integer> getMinDlvryQntty(String storeId)
    {
        LinkedHashMap<String, Integer> hmapMinDlvrQty=new LinkedHashMap<String, Integer>();
        //open();
        try {


            Cursor cur=db.rawQuery("Select PrdId,MinDlvrQty from tblStoreSomeProdQuotePriceMstr where StoreID='"+storeId+"'",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        hmapMinDlvrQty.put(cur.getString(0), cur.getInt(1));
                        cur.moveToNext();
                    }
                }
            }

        } catch (Exception e) {

        }finally
        {
          //  close();
            return hmapMinDlvrQty;
        }
    }

    // "create table tblStoreSomeProdQuotePriceMstr (PrdId text null,StoreID text null,QPBT text null,QPTaxAmount text null,MinDlvrQty int null,UOMID text null,Sstat text null);";
    public static LinkedHashMap<String, String> getMinDlvryQnttyQPBT(String storeId)
    {
        LinkedHashMap<String, String> hmapMinDlvrQtyQPBT=new LinkedHashMap<String, String>();
        //open();
        try {


            Cursor cur=db.rawQuery("Select PrdId,QPBT from tblStoreSomeProdQuotePriceMstr where StoreID='"+storeId+"'",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        hmapMinDlvrQtyQPBT.put(cur.getString(0), cur.getString(1));
                        cur.moveToNext();
                    }
                }
            }

        } catch (Exception e) {

        }finally
        {
          //  close();
            return hmapMinDlvrQtyQPBT;
        }
    }

    public static LinkedHashMap<String, String> getMinDlvryQnttyQPAT(String storeId)
    {
        LinkedHashMap<String, String> hmapMinDlvrQtyQPAT=new LinkedHashMap<String, String>();
        //open();
        try {


            Cursor cur=db.rawQuery("Select PrdId,QPAT from tblStoreSomeProdQuotePriceMstr where StoreID='"+storeId+"'",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        hmapMinDlvrQtyQPAT.put(cur.getString(0), cur.getString(1));
                        cur.moveToNext();
                    }
                }
            }

        } catch (Exception e) {

        }finally
        {
           // close();
            return hmapMinDlvrQtyQPAT;
        }
    }

    // "create table tblStoreSomeProdQuotePriceMstr (PrdId text null,StoreID text null,QPBT text null,QPTaxAmount text null,MinDlvrQty int null,UOMID text null,Sstat text null);";
    public static LinkedHashMap<String, String> getMinDlvryQnttyQPTaxAmount(String storeId)
    {
        LinkedHashMap<String, String> hmapMinDlvrQtyQPTaxAmount=new LinkedHashMap<String, String>();
        //open();
        try {


            Cursor cur=db.rawQuery("Select PrdId,QPTaxAmount from tblStoreSomeProdQuotePriceMstr where StoreID='"+storeId+"'",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        hmapMinDlvrQtyQPTaxAmount.put(cur.getString(0), cur.getString(1));
                        cur.moveToNext();
                    }
                }
            }

        } catch (Exception e) {

        }finally
        {
           // close();
            return hmapMinDlvrQtyQPTaxAmount;
        }
    }

    public static int fnchkIfStoreFasQuote(String  StoreId)
    {
        //open();
        Cursor cursor =null;
        int check=0;
        try {

            cursor= db.rawQuery("SELECT flgHasQuote FROM tblStoreList WHERE  StoreID ='"+ StoreId + "'", null);
            if (cursor.getCount() > 0)
            {
                if (cursor.moveToFirst())
                {
                    if(Integer.parseInt(cursor.getString(0).toString())==1)
                    {
                        check=1;
                    }
                }

            }


        } catch (Exception e) {
            System.out.println("shivam query = "+e.toString());
        }
        finally {
            cursor.close();
          //  close();
        }
        return check;
    }

    public static void fnDeletefromtblSchemeStoreMappingAgainstStore(String StoreID)
    {
        //open();
        db.execSQL("DELETE  FROM tblSchemeStoreMapping WHERE  StoreID='"+ StoreID + "'");
      //  close();
    }

    public static int fnchkIfStoreAllowQuotation(String  StoreId)
    {
        //open();
        Cursor cursor =null;
        int check=0;
        try {

            cursor= db.rawQuery("SELECT flgAllowQuotation FROM tblStoreList WHERE  StoreID ='"+ StoreId + "'", null);
            if (cursor.getCount() > 0)
            {
                if (cursor.moveToFirst())
                {
                    if(Integer.parseInt(cursor.getString(0).toString())==1)
                    {
                        check=1;
                    }
                }

            }


        } catch (Exception e) {
            System.out.println("shivam query = "+e.toString());
        }
        finally {
            cursor.close();
          //  close();
        }
        return check;
    }

    public static void UpdateStoreFlagQoutation(String sID, int flag2set)
    {

        try
        {

            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);
            int affected = db.update("tblStoreList", values, "StoreID=?",new String[] { sID });
            int affected26 = db.update("tblRateDistribution", values, "StoreId=?",new String[] { sID });

            int affected4 = db.update("tblNewStoreListEntries", values,"StoreID=?", new String[] { sID });
            int affected9 = db.update("tblNewStoreEntries", values,"StoreID=?", new String[] { sID });
            int affected10 = db.update("tblTemp", values,"StoreID=?", new String[] { sID });

            int affected17 = db.update("tblSalesQuotePersonMeetMstr", values,"StoreId=?", new String[] { sID });
            int affected21 = db.update("tblOutletQuestAnsMstr", values,"OutletID=?", new String[] { sID });
            int affected261 = db.update("tblNewAddedStoreLocationDetails", values,"StoreID=?", new String[] { sID });
            int affected23 = db.update("tblNewStoreSalesQuotePaymentDetails", values,"StoreId=?", new String[] { sID });

            LinkedHashMap<String, String> hmapDistinctSalesQuotePersonMeetMstr= fngetDistinctSalesQuotePersonMeetMstrForSstatUpdate(sID);


            Iterator it11new = hmapDistinctSalesQuotePersonMeetMstr.entrySet().iterator();

            while (it11new.hasNext()) {
                Entry pair = (Entry)it11new.next();
                if(hmapDistinctSalesQuotePersonMeetMstr.containsKey(pair.getKey().toString())){
                    //crntPID	=pair.getKey().toString();
                    int affected18 = db.update("tblSalesQuoteProductsMstr", values,"SalesQuoteId=?", new String[] { pair.getKey().toString() });
                }

            }

            Log.w(TAG, "affected records: " + affected);

            Log.w(TAG, "Record(s) Updated..");

        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }

    }

    public static void updateStoreQuoteSubmitFlgInStoreMstr(String StoreID,int flgSubmitFromQuotation,String StoreVisitCode)
    {
        //open();

        final ContentValues values = new ContentValues();
        values.put("flgSubmitFromQuotation", flgSubmitFromQuotation);
        int affected = db.update("tblStoreVisitMstr", values, "StoreID=? AND StoreVisitCode=?",
                new String[] { StoreID,StoreVisitCode });

       // close();
    }

    public static int fnchkIfStoreHasInvoiceEntry(String  StoreId)
    {

        Cursor cursor =null;
        int check=0;
        try {

            cursor= db.rawQuery("SELECT * FROM tblTmpInvoiceHeader WHERE  StoreID ='"+ StoreId + "'", null);
            if (cursor.getCount() > 0)
            {
                if (cursor.moveToFirst())
                {
                    if(Integer.parseInt(cursor.getString(0).toString())==1)
                    {
                        check=1;
                    }
                }

            }


        } catch (Exception e) {
            System.out.println("shivam query = "+e.toString());
        }
        finally {
            cursor.close();

        }
        return check;
    }

    public static void updateStoreQuoteSubmitFlgInStoreMstrInChangeRouteCase(String StoreID,int flgSubmitFromQuotation)
    {
        final ContentValues values = new ContentValues();
        values.put("flgSubmitFromQuotation", flgSubmitFromQuotation);
        int affected = db.update("tblStoreList", values, "StoreID=?",new String[] { StoreID });
    }

    public static String[] FetchStoreStatusflgSubmitFromQuotation()
    {
        int ScodecolumnIndex = 0;
        Cursor cursor = db.rawQuery("SELECT flgSubmitFromQuotation FROM tblStoreList ORDER BY DistanceNear", null);
        try
        {
            String StoreName[] = new String[cursor.getCount()];
            if (cursor.moveToFirst())
            {
                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    StoreName[i] = cursor.getString(ScodecolumnIndex).toString();
                    cursor.moveToNext();
                }
            }
            return StoreName;
        }
        finally
        {
            cursor.close();
        }
    }

    public static LinkedHashMap<String, String> fnGetListQuoteISOfUnmappedWithProducts(String StoreID)
    {
        //open();
        Cursor cursor = db.rawQuery("Select Distinct tblSalesQuotePersonMeetMstr.SalesQuoteId from tblSalesQuotePersonMeetMstr Where tblSalesQuotePersonMeetMstr.SalesQuoteId not in(Select tblSalesQuoteProductsMstr.SalesQuoteId from tblSalesQuoteProductsMstr) and StoreId='"+StoreID+"'", null);
        LinkedHashMap<String, String> hmapList=new LinkedHashMap<String, String>();
        try {
            if(cursor.getCount()>0){
                if (cursor.moveToFirst()){
                    hmapList.put(cursor.getString(0).toString(),StoreID);
                }

            }
            return hmapList;
        }

        finally
        {
            //cursor.close();
          //  close();
        }
    }

    public static void fndeleteQuoteISOfUnmappedWithProducts(String SalesQuoteId)
    {
        //open();
        db.execSQL("DELETE FROM tblSalesQuoteProductsMstr WHERE SalesQuoteId='"+SalesQuoteId+"'");
        db.execSQL("DELETE FROM tblSalesQuotePersonMeetMstr WHERE SalesQuoteId='"+SalesQuoteId+"'");
        db.execSQL("DELETE FROM tblRateDistribution WHERE SalesQuoteId='"+SalesQuoteId+"'");
       // close();
    }

    public static int fnGetBusinessSegmentIDAgainstStoreType(int OutChannelID)
    {

        int ScodecolumnIndex = 0;
        int BusinessSegmentID=0;
        //open();
        Cursor cursor = db.rawQuery("SELECT BusinessSegmentID FROM tblOutletChannelBusinessSegmentMaster where OutChannelID="+OutChannelID, null);
        try
        {


            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    BusinessSegmentID = Integer.parseInt(cursor.getString(ScodecolumnIndex).toString());
                    cursor.moveToNext();
                }
            }
            return BusinessSegmentID;
        }
        finally
        {
            cursor.close();
           // close();
        }
    }

    public static int fnGetAnsValID(int optionId)
    {
//tblGetPDAQuestOptionMstr(OptID int null,QuestID int null,OptionNo int null,OptionDescr text null,Sequence int null );";
        int ScodecolumnIndex = 0;
        int ansValId=0;
        //open();
        Cursor cursor = db.rawQuery("SELECT OptionNo FROM tblGetPDAQuestOptionMstr where OptID="+optionId, null);
        try
        {


            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    ansValId = Integer.parseInt(cursor.getString(ScodecolumnIndex).toString());
                    cursor.moveToNext();
                }
            }
            return ansValId;
        }
        finally
        {
            cursor.close();
           // close();
        }
    }

    public static String fnGetQuestIDForOutChannelFromQuestionMstr()
    {//tblGetPDAQuestGrpMapping(GrpQuestID int null,QuestID int null,GrpID int null,GrpNodeID int null,GrpDesc text null,SectionNo int null,GrpCopyID int null,QuestCopyID int null);";

        int ScodecolumnIndex = 0;
        int ansCntrlTypeIndex = 1;
        int grpQuestIdIndex = 2;
        String QuestID="0";
        //open();
        Cursor cursor = db.rawQuery("SELECT tblGetPDAQuestMstr.QuestID,tblGetPDAQuestMstr.AnsControlType,tblGetPDAQuestGrpMapping.GrpQuestID FROM tblGetPDAQuestMstr inner join tblGetPDAQuestGrpMapping ON tblGetPDAQuestMstr.QuestID=tblGetPDAQuestGrpMapping.QuestID where tblGetPDAQuestMstr.flgQuestIDForOutChannel=1", null);
        try
        {


            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    QuestID = cursor.getString(ScodecolumnIndex)+"^"+cursor.getString(ansCntrlTypeIndex)+"^"+cursor.getString(grpQuestIdIndex);
                    cursor.moveToNext();
                }
            }
            return QuestID;
        }
        finally
        {
            cursor.close();
           // close();
        }
    }

    public static long saveTblSalesQuoteSponsorMstr(String SalesQuoteSponsorID,String SponsorDescr,String Ordr)
    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("SalesQuoteSponsorID", SalesQuoteSponsorID.toString().trim());
        initialValues.put("SponsorDescr", SponsorDescr.toString().trim());
        initialValues.put("Ordr", Ordr.toString().trim());

        return db.insert(TABLE_tblSalesQuoteSponsorMstr, null, initialValues);
    }

    public static long saveTblManufacturerMstrMain(String ManufacturerID,String ManufacturerName,String NodeType)
    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("ManufacturerID", ManufacturerID.toString().trim());
        initialValues.put("ManufacturerName", ManufacturerName.toString().trim());
        initialValues.put("NodeType", NodeType.toString().trim());

        return db.insert(TABLE_tblManufacturerMstrMain, null, initialValues);
    }

    public static long saveTblRateDistribution(String SalesQuoteId,String StoreId,String SalesQuoteSponsorID,String ManufacturerID,String Percentage,String SponsorDescr,String ManufacturerName,String Sstat)
    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("SalesQuoteId", SalesQuoteId.toString().trim());
        initialValues.put("StoreId", StoreId.toString().trim());
        initialValues.put("SalesQuoteSponsorID", SalesQuoteSponsorID.toString().trim());
        initialValues.put("ManufacturerID", ManufacturerID.toString().trim());
        initialValues.put("Percentage", Percentage.toString().trim());
        initialValues.put("SponsorDescr", SponsorDescr.toString().trim());
        initialValues.put("ManufacturerName", ManufacturerName.toString().trim());
        initialValues.put("Sstat", Sstat.toString().trim());

        return db.insert(TABLE_tblRateDistribution, null, initialValues);
    }

    public static LinkedHashMap<String, String> fnGettblManufacturerMstrMain()
    {
        LinkedHashMap<String, String> hmapQuestionMstr=new LinkedHashMap<String, String>();
        //open();
// Cursor cursor = db.rawQuery("SELECT SST_NameId,SST_Name_des from tbl_SST_NameMstr Order By Sequence ASC  ", null);// Where PNodeID='"+TSIID+"'

// (String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString()+"^"+(String) cursor.getString(2).toString()+"^"+(String) cursor.getString(3).toString()+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(5).toString()+"^"+(String) cursor.getString(6).toString()+"^"+(String) cursor.getString(7).toString()+"^"+(String) cursor.getString(8).toString()+"^"+(String) cursor.getString(9).toString()+"^"+(String) cursor.getString(10).toString()
        // close();
        try {
            Cursor cursor = db.rawQuery("SELECT ManufacturerID,ManufacturerName,NodeType from tblManufacturerMstrMain   ", null);// Where PNodeID='"+TSIID+"'
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapQuestionMstr.put((String) cursor.getString(1).toString(),(String) cursor.getString(0).toString()+"^"+(String) cursor.getString(2).toString());
                        //    System.out.println("QuestID:"+(String)cursor.getString(0).toString()+"QuestCode:"+(String) cursor.getString(1).toString()+"QuestDesc:"+(String) cursor.getString(2).toString()+"QuestType:"+(String) cursor.getString(3).toString()+"AnsControlType:"+(String) cursor.getString(4).toString()+"AnsControlInputTypeID:"+(String) cursor.getString(5).toString()+"AnsControlInputTypeMaxLength:"+(String) cursor.getString(6).toString()+"AnsMustRequiredFlg:"+(String) cursor.getString(7).toString()+"QuestBundleFlg:"+(String) cursor.getString(8).toString()+"ApplicationTypeID:"+(String) cursor.getString(9).toString()+"Sequence:"+(String) cursor.getString(10).toString());
                        cursor.moveToNext();
                    }
                }
            }

        }
        catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= "+e.toString());
        }
        finally
        {

           // close();
            return hmapQuestionMstr;
        }
    }

    public static LinkedHashMap<String, ArrayList<String>> fnGettblRateDistribution(String SalesQuoteId,String StoreId)
    {
        LinkedHashMap<String, ArrayList<String>> hmapQuestionMstr=new LinkedHashMap<String, ArrayList<String>>();

        //open();

        try {
            Cursor cursor = db.rawQuery("SELECT SalesQuoteSponsorID,ManufacturerID,Percentage,SponsorDescr,ManufacturerName from tblRateDistribution   where SalesQuoteId='"+SalesQuoteId+"' and StoreId='"+StoreId+"'", null);// Where PNodeID='"+TSIID+"'
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        ArrayList<String> abc=new ArrayList<String>();
                        abc.add((String) cursor.getString(0).toString());
                        abc.add((String) cursor.getString(1).toString());
                        abc.add((String) cursor.getString(2).toString());
                        abc.add((String) cursor.getString(3).toString());
                        abc.add((String) cursor.getString(4).toString());
                        hmapQuestionMstr.put(abc.get(0),abc);
                        cursor.moveToNext();
                    }
                }

            }

        }
        catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= "+e.toString());
        }
        finally
        {

           // close();
            return hmapQuestionMstr;
        }
    }

    public static LinkedHashMap<String, String> fnGettblSalesQuoteSponsorMstr()
    {
        LinkedHashMap<String, String> hmapQuestionMstr=new LinkedHashMap<String, String>();
        //open();
// Cursor cursor = db.rawQuery("SELECT SST_NameId,SST_Name_des from tbl_SST_NameMstr Order By Sequence ASC  ", null);// Where PNodeID='"+TSIID+"'

// (String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString()+"^"+(String) cursor.getString(2).toString()+"^"+(String) cursor.getString(3).toString()+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(5).toString()+"^"+(String) cursor.getString(6).toString()+"^"+(String) cursor.getString(7).toString()+"^"+(String) cursor.getString(8).toString()+"^"+(String) cursor.getString(9).toString()+"^"+(String) cursor.getString(10).toString()
        // close();
        try {
            Cursor cursor = db.rawQuery("SELECT SalesQuoteSponsorID,SponsorDescr,Ordr from tblSalesQuoteSponsorMstr   ", null);// Where PNodeID='"+TSIID+"'
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapQuestionMstr.put((String) cursor.getString(1).toString(),(String) cursor.getString(0).toString()+"^"+(String) cursor.getString(2).toString());
                        //    System.out.println("QuestID:"+(String)cursor.getString(0).toString()+"QuestCode:"+(String) cursor.getString(1).toString()+"QuestDesc:"+(String) cursor.getString(2).toString()+"QuestType:"+(String) cursor.getString(3).toString()+"AnsControlType:"+(String) cursor.getString(4).toString()+"AnsControlInputTypeID:"+(String) cursor.getString(5).toString()+"AnsControlInputTypeMaxLength:"+(String) cursor.getString(6).toString()+"AnsMustRequiredFlg:"+(String) cursor.getString(7).toString()+"QuestBundleFlg:"+(String) cursor.getString(8).toString()+"ApplicationTypeID:"+(String) cursor.getString(9).toString()+"Sequence:"+(String) cursor.getString(10).toString());
                        cursor.moveToNext();
                    }
                }
            }

        }
        catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= "+e.toString());
        }
        finally
        {

            //close();
            return hmapQuestionMstr;
        }
    }

    public static LinkedHashMap<String, String> fnProductManufractureIDList()
    {
        LinkedHashMap<String, String> hmapProductManufractureIDList=new LinkedHashMap<String, String>();
        //open();

        try {
            Cursor cursor = db.rawQuery("SELECT ProductID,ManufacturerID from tblProductListMaster", null);
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapProductManufractureIDList.put((String) cursor.getString(0).toString(),(String) cursor.getString(1).toString());
                        cursor.moveToNext();
                    }
                }
            }

        }
        catch (Exception e) {
            System.out.println("Error fnProductManufractureIDList= "+e.toString());
        }
        finally
        {

           // close();
            return hmapProductManufractureIDList;
        }
    }

    public static ArrayList<String> fectProductIDMappedInSchSlbSubBukRowIdTemp(int schSlbSubRowID)
    {
        //open();
        Cursor cursor = db.rawQuery("SELECT ProductID FROM tblSchemeSlabBucketProductMapping WHERE RowID ="+ schSlbSubRowID , null);
        try {
            ArrayList<String> CompleteResult = new ArrayList<String>();
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult.add(cursor.getString(0));
                        cursor.moveToNext();
                    }
                }
            }
            return CompleteResult;

        } finally {
            cursor.close();
           // close();
        }

    }

    public static String fnGetBenifitAssignedValue(String StoreID,int ProductIdOnClicked,int schId,String TmpInvoiceCodePDA)
    {
        //tblStoreProductAppliedSchemesBenifitsRecords (StoreID text not null,ProductID int not null,schId int not null,schSlabId integer not null,schSlbBuckId integer not null,schSlabSubBucketValue real not null,schSubBucketValType integer not null,schSlabSubBucketType int not null,BenifitRowID integer not null,BenSubBucketType int null,FreeProductID int null,BenifitSubBucketValue real null,BenifitMaxValue real null,BenifitAssignedValue real null,BenifitAssignedValueType int null,BenifitDiscountApplied int null,BenifitCouponCode text null,Sstat integer not null,Per real null,UOM real null,WhatFinallyApplied int null,schSlbRowId int null,SchTypeId int null,DiscountPercentage real null,OrderIDPDA text null);";
        //open();
        Cursor cursor = db.rawQuery("SELECT FreeProductID,BenifitAssignedValue,BenSubBucketType FROM tblStoreProductAppliedSchemesBenifitsRecords WHERE StoreID ='"+ StoreID + "' and  schId="+schId+" and BenSubBucketType in(1,5,2,6,3,7) AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"' and ProductID="+ProductIdOnClicked, null);
        String chkI = "";
        try {
            if(cursor.getCount()>0)
            {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        if(cursor.getString(0)!=null && cursor.getString(1)!=null && cursor.getString(2)!=null)
                        {
                            chkI = cursor.getString(0)+"^"+cursor.getString(1)+"^"+cursor.getString(2);
                        }
                        cursor.moveToNext();
                    }
                }
            }

        } finally {
            cursor.close();
            //close();
        }
        return chkI;
    }

    public static ArrayList<String> fnGetProductsSchIdSlabRowList(String StoreID,int RowID,String pdaOrderID,String TmpInvoiceCodePDA)
    {//tblSchemeSlabBenefitsProductMappingDetail (RowID text null,ProductID text null)
        //open();//schId
// Cursor cursorE2 = db.rawQuery("SELECT ProductID FROM  tblStoreProductAppliedSchemesBenifitsRecords where schSlbRowId="+RowID, null);
        Cursor cursorE2 = db.rawQuery("SELECT ProductID FROM  tblStoreProductAppliedSchemesBenifitsRecords where schSlbRowId="+RowID +" AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'  and StoreID='"+StoreID+"'", null);
        ArrayList<String> AllProductInSlab = new ArrayList<String>();

        try {
            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst())
                {

                    for (int i = 0; i <= (cursorE2.getCount() - 1); i++)
                    {
                        AllProductInSlab.add(cursorE2.getString(0));
                        cursorE2.moveToNext();
                        //cursor.moveToNext();
                    }
                }
            }
            return AllProductInSlab;
        } finally {
            cursorE2.close();
           // close();
        }

    }

    public static void updateManufacturerIDAndName(String SalesQuoteId,String ManufacturerID, String ManufacturerName)
    {

        try
        {
            //open();

            final ContentValues values = new ContentValues();
            values.put("ManufacturerID", ManufacturerID);
            values.put("ManufacturerName", ManufacturerName);

            int affected = db.update("tblSalesQuotePersonMeetMstr", values, "SalesQuoteId=?",new String[] {SalesQuoteId});

        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }
        finally
        {
           // close();
        }

    }

    public static String getManufacturerIDAndManufacturerNameDetails(String SalesQuoteId)
    {
        String searchString="0^0";
        // LinkedHashMap<String, String> hmapQuotationPersionMeetDetails=new LinkedHashMap<String, String>();

        try
        {
            //open();
            Cursor cur=db.rawQuery("Select ManufacturerID,ManufacturerName from tblSalesQuotePersonMeetMstr Where tblSalesQuotePersonMeetMstr.SalesQuoteId='"+SalesQuoteId+"'", null);

            if(cur.getCount()>0)

            {

                StringBuilder sBuilder=new StringBuilder();

                if(cur.moveToFirst())

                {

                    for(int i=0;i<cur.getCount();i++)

                    {

                        searchString=cur.getString(0)+"^"+cur.getString(1);

                        cur.moveToNext();

                    }

                }



            }



        } catch (Exception e) {

            // TODO: handle exception

        }

        finally

        {

           // close();

            return searchString;

        }

    }

    public static int checkMessageIDExistOrNotForNotification(int MsgServerID)
    {
        Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblPDANotificationMaster WHERE MsgServerID ="+ MsgServerID, null);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst())
            {

                if (cursorE2.getInt(0) > 0)
                {
                    chkI = 1;
                }
                else
                {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }


    public static ArrayList<String> getGstDataByStore(String StoreID)
    {
        ArrayList<String> PrevAccuracy=new ArrayList<String>();
        //open();
        try
        {
            Cursor cursor2 = db.rawQuery("Select flgGSTCapture,flgGSTCompliance,GSTNumber from tblStoreList where StoreID ='"+ StoreID + "'", null);
            if(cursor2.getCount()>0)
            {
                if (cursor2.moveToFirst())
                {
                    for (int i = 0; i < cursor2.getCount(); i++)
                    {
                        PrevAccuracy.add(cursor2.getString(0).toString().trim());
                        PrevAccuracy.add(cursor2.getString(1).toString().trim());
                        PrevAccuracy.add(cursor2.getString(2).toString().trim());
                        // PrevAccuracy =cursor2.getString(0).toString().trim()+"^"+cursor2.getString(1).toString().trim()+"^"+cursor2.getString(2).toString().trim();
                        cursor2.moveToNext();
                    }

                }
            }
        }
        catch(Exception e)
        {}
        finally
        {
          //  close();
        }
        return PrevAccuracy;
    }

    public static int fnGetflgServerRecordFromOutletMstr(String StoreID)
    {
        int flgServerRecord = 0;

        try
        {
            //open();
            //Cursor cursor = db.rawQuery("SELECT flgGSTRecordFromServer FROM tblStoreList where StoreID='" + StoreID + "' and Sstat=3", null);
            Cursor cursor = db.rawQuery("SELECT flgGSTRecordFromServer FROM tblStoreList where StoreID='" + StoreID + "'", null);

            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    if (!cursor.isNull(0))
                    {
                        flgServerRecord = Integer.parseInt(cursor.getString(0).toString());
                        cursor.moveToNext();
                    }

                }
            }
            return flgServerRecord;
        } finally
        {
           // close();
        }
    }

    public static void UpdateStoreInfoGST(String StoreID,String flgGSTCapture,String flgGSTCompliance,String GSTNumber)
    {
        try
        {
            //open();
            final ContentValues values = new ContentValues();
            values.put("flgGSTCapture", flgGSTCapture);
            values.put("flgGSTCompliance", flgGSTCompliance);
            values.put("GSTNumber", GSTNumber);


            int affected = db.update("tblStoreList", values, "StoreID=?",new String[] { StoreID });
        }
        catch(Exception e)
        {

        }
        finally
        {
           // close();
        }

    }

    public static String fnGetGstOptionIDComplianceWhileAddingNewStore(String flgGSTCompliance)
    {
        String flgGSTComplianceResult = "0";

        try
        {
            //open();
            Cursor cursor = db.rawQuery("SELECT OptionNo FROM tblGetPDAQuestOptionMstr where OptID='" + flgGSTCompliance+"'", null);

            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    if (!cursor.isNull(0))
                    {
                        flgGSTComplianceResult =cursor.getString(0).toString();
                        cursor.moveToNext();
                    }

                }
            }
            return flgGSTComplianceResult;
        } finally
        {
           // close();
        }
    }

    public static int countNumberOFNotificationtblPDANotificationMaster()  throws IOException
    {
        int chkI = 0;
        Cursor cursorE2 = db.rawQuery("SELECT Count(*) FROM tblPDANotificationMaster where Noti_NewOld=1 and Noti_ReadStatus=1", null);

        try {
            if (cursorE2.moveToFirst())
            {

                if (cursorE2.getInt(0) > 0)
                {
                    chkI = 1;
                } else
                {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    public static  LinkedHashMap<String,String> fngetAllOptionForQuestionID(int QuestID)
    {
        //open();
        LinkedHashMap<String,String> hashMapOption=new LinkedHashMap<String,String>();

        try {
            Cursor cursor = db.rawQuery("Select OptID,OptionDescr,Sequence from tblGetPDAQuestOptionMstr where QuestID=" + QuestID + "and Sequence Order by acs", null);

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount() - 1; i++) {
                        hashMapOption.put(cursor.getString(0), cursor.getString(1));
                    }
                }
            }
        }
        catch(Exception e)
        {

        }
        finally
        {
           // close();
            return hashMapOption;
        }



    }
    //private static final String DATABASE_CREATE_TABLE_OPTIONMstr = "create table tblGetPDAQuestOptionMstr" +
    //"(OptID int null,QuestID int null,OptionNo int null,OptionDescr text null,Sequence int null );";

    public static String[] getAllOptValueDpndntQuest()
    {
        String[] allQuestValesDpndnt=null;
        //open();
        try {

            //tblGetPDAQuestionDependentMstr(QuestionID int null,OptionID int null,DependentQuestionID int null,GrpID int null,GrpDepQuestID int null)
            Cursor cur=db.rawQuery("Select Distinct GrpID from tblGetPDAQuestionDependentMstr", null);
            if(cur.getCount()>0)
            {
                allQuestValesDpndnt=new String[cur.getCount()];
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        allQuestValesDpndnt[i]=String.valueOf(cur.getInt(0));
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            // TODO: handle exception
        }
        finally
        {
           // close();
            return allQuestValesDpndnt;
        }

    }


    // New Added Store Fun Start

    public static String[] fnGetDependentParentQuesIdr()
    {


        //open();
//tblGetPDAQuestionDependentMstr(QuestionID int null,OptionID int null,DependentQuestionID int null,GrpID int null,GrpDepQuestID int null);";
        Cursor cursor = db.rawQuery("SELECT DISTINCT GrpDepQuestID from tblGetPDAQuestionDependentMstr", null);// Where PNodeID='"+TSIID+"'
        String []arrbhi=new String[cursor.getCount()];
        try {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        // hmapDpndntQuestionMstr.put((String) cursor.getString(3).toString()+"^"+(String) cursor.getString(1).toString(), (String) cursor.getString(2).toString());
                        arrbhi[i]=(String) cursor.getString(0).toString();
                        cursor.moveToNext();
                    }
                }
            }

            return arrbhi;
        }
        finally
        {
            cursor.close();
            //close();
        }
    }

    public static LinkedHashMap<String, String> fnGetQuestionID_AnsCntrlType()
    {
        LinkedHashMap<String, String> hmapQuestionId_AnsCntrlTyper=new LinkedHashMap<String, String>();
        //open();
        int lastIndex=0;
        //tblGetPDAQuestMstr(QuestID int null,QuestCode int null,QuestDesc text null,QuestType int null,AnsControlType int null,AnsControlInputTypeID int null,AnsControlInputTypeMinLength int null,AnsControlInputTypeMaxLength int null,AnsMustRequiredFlg int null,QuestBundleFlg int null,ApplicationTypeID int null,Sequence int null,AnswerHint text null);";
        Cursor cursor = db.rawQuery("SELECT QuestID,AnsControlType from tblGetPDAQuestMstr", null);

        try {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapQuestionId_AnsCntrlTyper.put(cursor.getString(0).trim(),(String) cursor.getString(1).toString().trim());
                        //    System.out.println("QuestID:"+(String)cursor.getString(0).toString()+"QuestCode:"+(String) cursor.getString(1).toString()+"QuestDesc:"+(String) cursor.getString(2).toString()+"QuestType:"+(String) cursor.getString(3).toString()+"AnsControlType:"+(String) cursor.getString(4).toString()+"AnsControlInputTypeID:"+(String) cursor.getString(5).toString()+"AnsControlInputTypeMaxLength:"+(String) cursor.getString(6).toString()+"AnsMustRequiredFlg:"+(String) cursor.getString(7).toString()+"QuestBundleFlg:"+(String) cursor.getString(8).toString()+"ApplicationTypeID:"+(String) cursor.getString(9).toString()+"Sequence:"+(String) cursor.getString(10).toString());
                        cursor.moveToNext();
                    }

                }
            }
            return hmapQuestionId_AnsCntrlTyper;
        }
        finally
        {
            cursor.close();
           // close();
        }
    }

    public static LinkedHashMap<String, ArrayList<String>> getAllQuestIdDpndnt()
    {// //tblGetPDAQuestionDependentMstr(QuestionID int null,OptionID int null,DependentQuestionID int null,GrpID int null,GrpDepQuestID int null);";
        LinkedHashMap<String, ArrayList<String>> hmapQuestDependVisible=new LinkedHashMap<String, ArrayList<String>>();
        ArrayList<String> listQestDpndnt=new ArrayList<String>();

        try {


            //open();

            Cursor cur=db.rawQuery("Select GrpID,GrpDepQuestID from tblGetPDAQuestionDependentMstr Order By GrpDepQuestID", null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    String questId,dpndntQuestId,prvsdpndntQuestId = null;
                    for(int i=0;i<cur.getCount();i++)
                    {
                        questId=String.valueOf(cur.getInt(0));
                        dpndntQuestId =String.valueOf(cur.getInt(1));
                        if(i==0)
                        {
                            listQestDpndnt.add(questId);
                            prvsdpndntQuestId=dpndntQuestId;
                        }
                        else
                        {
                            if( prvsdpndntQuestId==dpndntQuestId)
                            {
                                listQestDpndnt.add(questId);
                            }
                            else
                            {
                                hmapQuestDependVisible.put(prvsdpndntQuestId, listQestDpndnt);
                                listQestDpndnt=new ArrayList<String>();

                                listQestDpndnt.add(questId);
                                prvsdpndntQuestId=dpndntQuestId;
                            }


                        }
                        if(i==cur.getCount()-1)
                        {
                            hmapQuestDependVisible.put(prvsdpndntQuestId, listQestDpndnt);
                        }
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println("ErrorDatabase getAllQuestIdWhoseValuesDpndnt ="+ e.toString());
        } finally
        {
           // close();
            return hmapQuestDependVisible;
        }
    }

    public static LinkedHashMap<String, String> getAllQstGrpIdAgainstGrp()
    {
        //tblGetPDAQuestGrpMapping(GrpQuestID int null,QuestID int null,GrpID int null,GrpNodeID int null,GrpDesc text null,SectionNo int null);";
        //open();
        LinkedHashMap<String, String> hmapData=new LinkedHashMap<String, String>();
        Cursor cur=db.rawQuery("Select GrpID,GrpQuestID from tblGetPDAQuestGrpMapping", null);
        if(cur.getCount()>0)
        {
            if(cur.moveToFirst())
            {
                for(int i=0;i<cur.getCount();i++)
                {
                    hmapData.put(cur.getString(1), cur.getString(0));
                    cur.moveToNext();
                }
            }
        }
       // close();
        return hmapData;
    }

    public static LinkedHashMap<String, String> getQuestGrpIdLnkWdQstId()
    {
        //tblGetPDAQuestGrpMapping(GrpQuestID int null,QuestID int null,GrpID int null,GrpNodeID int null,GrpDesc text null,SectionNo int null);";
        //open();
        LinkedHashMap<String, String> hmapData=new LinkedHashMap<String, String>();
        Cursor cur=db.rawQuery("Select QuestID,GrpQuestID from tblGetPDAQuestGrpMapping", null);
        if(cur.getCount()>0)
        {
            if(cur.moveToFirst())
            {
                for(int i=0;i<cur.getCount();i++)
                {
                    hmapData.put(cur.getString(1), cur.getString(0));
                    cur.moveToNext();
                }
            }
        }
       // close();
        return hmapData;
    }

    public static String getChannelGroupIdOptId()
    {
        String grpQstIdOptIdForChannel="0-0-0";


        try {

//tblQuestIDForOutChannel(GrpQstId int null,QuestID int null,OptID text null,SectionCount int null);";
            Cursor cur=db.rawQuery("Select OptID from tblQuestIDForOutChannel", null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {

                    grpQstIdOptIdForChannel=cur.getString(0);
                }
            }
        } catch (Exception e) {
            // TODO: handle exception
        }
        finally
        {

            return grpQstIdOptIdForChannel;
        }
    }

    public static LinkedHashMap<String, String> getQuestAnswer(String tempId)
    {
        //open();
        LinkedHashMap<String, String> hmapRtrvQuestAns=new LinkedHashMap<String, String>();
        try {
            String channelOptId=getChannelGroupIdOptId();
            String channelkey =getChannelGroupIdKey();
            if(!channelOptId.equals("0-0-0") && !TextUtils.isEmpty(channelkey))
            {
                hmapRtrvQuestAns.put(channelkey,channelOptId);
            }

            //  hmapRtrvQuestAns.put("1^6^1","0-1-80");
            //tblOutletQuestAnsMstr (OutletID text not null,QuestID text not null,AnswerType text null, AnswerValue text null,QuestionGroupID integer null,sectionID integer null,Sstat integer not null);";
            Cursor cursor=db.rawQuery("Select * from tblOutletQuestAnsMstr where OutletID='"+tempId+"'", null);

            if(cursor.getCount()>0)
            {
                if(cursor.moveToFirst())
                {
                    for(int i=0;i<cursor.getCount();i++)
                    {

                        hmapRtrvQuestAns.put(cursor.getString(1)+"^"+cursor.getString(2)+"^"+cursor.getString(4), cursor.getString(3));
                        cursor.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            // TODO: handle exception
        }
        finally
        {
            //close();
            return hmapRtrvQuestAns;
        }
    }

    public static LinkedHashMap<String, String> getPDAUserPreviousQuestionAnswerMasterServer(String tempId)
    {
        //open();
        LinkedHashMap<String, String> hmapPreviousVisitServerQuestionSavedAns=new LinkedHashMap<String, String>();
        try {
//tblPreAddedStoresDataDetails (StoreIDDB text null,GrpQuestID text null,QstId text null,AnsControlTypeID text null,AnsTextVal text null,flgPrvVal text null);";
            //tblPDAUserPreviousQuestionAnswerMaster(NodeID text null, NodeType text null,QstID text null,AnsControlTypeID text null,Answers text null,temID text null,flgPrvValue text null);";
            Cursor cursor=db.rawQuery("Select * from tblPreAddedStoresDataDetails where StoreIDDB='"+tempId+"'", null);

            if(cursor.getCount()>0)
            {
                if(cursor.moveToFirst())
                {
                    for(int i=0;i<cursor.getCount();i++)
                    {
                        hmapPreviousVisitServerQuestionSavedAns.put(cursor.getString(2)+"^"+cursor.getString(3)+"^"+cursor.getString(1), cursor.getString(4));
                        cursor.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            // TODO: handle exception
        }
        finally
        {
            //close();
            return hmapPreviousVisitServerQuestionSavedAns;
        }
    }
/*	public static LinkedHashMap<String, String> fnGetQuestionIdFlgPrvValue(String TempID)
	{
	LinkedHashMap<String, String> hmapQuestionflgPrvValue=new LinkedHashMap<String, String>();
	//open();

	int lastIndex=0;
	Cursor cursor;
	cursor = db.rawQuery("SELECT QstId,AnsControlTypeID,flgPrvVal,GrpQuestID from tblPreAddedStoresDataDetails Where tblPreAddedStoresDataDetails.StoreIDDB='"+ TempID +"'", null);


	try {
		if(cursor.getCount()>0)
		{
			if (cursor.moveToFirst())
			{
				for (int i = 0; i <= (cursor.getCount() - 1); i++) {
					hmapQuestionflgPrvValue.put((String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString()+"^"+(String) cursor.getString(3).toString(), (String) cursor.getString(2).toString());

					cursor.moveToNext();
				}

			}
		}
		return hmapQuestionflgPrvValue;
	}
	finally
	{
		cursor.close();
		//close();
	}
}*/

    public static LinkedHashMap<String, String> getGroupIdCopyAsAbove()
    {
        LinkedHashMap<String, String> hmapGroupIdCopyAsAbove=new LinkedHashMap<String, String>();
        //open();
        Cursor cur=db.rawQuery("Select DISTINCT GrpID,GrpCopyID from tblGetPDAQuestGrpMapping where GrpCopyID<>0",null);
        if(cur.getCount()>0)
        {
            if(cur.moveToFirst())
            {
                for(int i=0;i<cur.getCount();i++)
                {
                    hmapGroupIdCopyAsAbove.put(cur.getString(0), cur.getString(1)) ;
                    cur.moveToNext();
                }
            }
        }
       // close();
        return hmapGroupIdCopyAsAbove;
    }

    public static String getChannelGroupId()
    {
        String grpQstIdForChannel="";

        //open();
        try {

//tblQuestIDForOutChannel(GrpQstId int null,QuestID int null,OptID text null,SectionCount int null);";
            Cursor cur=db.rawQuery("Select GrpQstId,QuestID from tblQuestIDForOutChannel", null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    grpQstIdForChannel=cur.getString(0);
                }
            }
        } catch (Exception e) {
            // TODO: handle exception
        }
        finally
        {
           // close();
            return grpQstIdForChannel;
        }
    }

    public static LinkedHashMap<String,String> getNameQstGrpId_QstId()
    {
        LinkedHashMap<String,String> grpQstId_qstIdForName=new LinkedHashMap<>();

        //open();
        try {


            Cursor cur=db.rawQuery("Select ID,GrpQstId,QuestID from tblQuestIDForName", null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        grpQstId_qstIdForName.put(cur.getString(0),cur.getString(1)+"^"+cur.getString(2));
                        cur.moveToNext();
                    }

                }
            }
        } catch (Exception e) {
            // TODO: handle exception
        }
        finally
        {
          //  close();
            return grpQstId_qstIdForName;
        }
    }

    public static  LinkedHashMap<String, String> getDepOptMstr()
    {


        LinkedHashMap<String, String> hmapgetOptDepMstr=new LinkedHashMap<String, String>();

        //open();
        try {


            Cursor cur=db.rawQuery("Select GrpQuestID,GrpDepQuestID from tblPDAQuestOptionDependentMstr", null);
            if(cur.getCount()>0)
            {
                String grpDepQstId,grpQstd;
                if(cur.moveToFirst())
                    for(int i=0;i<cur.getCount();i++)
                    {
                        grpQstd=cur.getString(0);
                        grpDepQstId=cur.getString(1);
                        hmapgetOptDepMstr.put(grpQstd, grpDepQstId);
                        cur.moveToNext();


                    }

            }
        } catch (Exception e) {
            // TODO: handle exception
        }
        finally
        {
            //close();
            return hmapgetOptDepMstr;
        }
    }

    public static ArrayList<String> getImagePath(String StoreID)
    {
        //open();
        ArrayList<String> listImagePath=new ArrayList<String>();
        try {

            //tableImage(tempId text null,QstIdAnsCntrlTyp text null,imageName text null,imagePath text null,ImageClicktime text null,Sstat integer null);";
            //imagButtonTag+"~"+tempId+"~"+uriSavedImage.toString()+"~"+clkdTime+"~"+"2";
            Cursor cursor=db.rawQuery("Select QstIdAnsCntrlTyp,StoreID,imagePath,ImageClicktime,Sstat from tableImage where StoreID='"+StoreID+"'", null);

            if(cursor.getCount()>0)
            {
                if(cursor.moveToFirst())
                {
                    for(int i=0;i<cursor.getCount();i++)
                    {
                        listImagePath.add(cursor.getString(0)+"~"+cursor.getString(1)+"~"+cursor.getString(2)+"~"+cursor.getString(3)+"~"+cursor.getString(4));
                        cursor.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            // TODO: handle exception
        }
        finally
        {
            //close();
            return listImagePath;
        }
    }

    public static String getChannelGroupIdKey()
    {
        String keyForChannel="";


        try {
//tblGetPDAQuestMstr(QuestID int null,QuestCode int null,QuestDesc text null,QuestType int null,AnsControlType int null,
//tblQuestIDForOutChannel(GrpQstId int null,QuestID int null,OptID text null,SectionCount int null);";
            Cursor cur=db.rawQuery("Select tblQuestIDForOutChannel.GrpQstId,tblQuestIDForOutChannel.QuestID,tblGetPDAQuestMstr.AnsControlType from tblQuestIDForOutChannel inner join tblGetPDAQuestMstr On tblQuestIDForOutChannel.QuestID=tblGetPDAQuestMstr.QuestID", null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    keyForChannel=cur.getString(1)+"^"+cur.getString(2)+"^"+cur.getString(0);
                }
            }
        } catch (Exception e) {
            // TODO: handle exception
        }
        finally
        {

            return keyForChannel;
        }
    }

    public static void fnsaveOutletQuestAnsMstrSectionWise(LinkedHashMap<String, String> hmapQuesAnsVal,int CurrentsectionID,String CurrentOutletID)
    {

        //open();
        fnDeletesaveOutletQuestAnsMstrSctionWise(CurrentOutletID,CurrentsectionID);
        String channelOptId=getChannelGroupIdOptId();
        String channelkey =getChannelGroupIdKey();
        if(!channelOptId.equals("0-0-0"))
        {
            hmapQuesAnsVal.put(channelkey,channelOptId);
        }
        // hmapQuesAnsVal.put("1^6^1","0-1-80");
        String OutletID="0",QuestID = "0",AnswerType,AnswerValue = "";
        int sectionID = 0;
        int QuestionGroupID=0;

        for(Entry<String, String> entry:hmapQuesAnsVal.entrySet())
        {
            String questId=entry.getKey().split(Pattern.quote("^"))[0].toString();
            AnswerType=entry.getKey().split(Pattern.quote("^"))[1].toString();
            QuestionGroupID=Integer.valueOf(entry.getKey().split(Pattern.quote("^"))[2].toString());
            AnswerValue=entry.getValue();

            ContentValues content=new ContentValues();

            content.put("AnswerType", Integer.parseInt(AnswerType));
            content.put("AnswerValue", AnswerValue.trim());

            content.put("Sstat", 3);

            content.put("sectionID", CurrentsectionID);
            content.put("QuestionGroupID", QuestionGroupID);

            Cursor cursor = db.rawQuery("SELECT OutletID FROM tblOutletQuestAnsMstr where OutletID='"+CurrentOutletID.toString().trim() +"' and QuestID ='"+ questId +"'" , null);

            //db.insert(TABLE_OutletQuestAnsMstr, null, content);
            if(cursor.getCount()>0)
            {

                int affected = db.update("tblOutletQuestAnsMstr", content, "OutletID=? AND QuestID=?",
                        new String[] {CurrentOutletID.toString().trim(),questId.toString().trim()});
            }
            else
            {

                content.put("QuestID", questId);
                content.put("OutletID", CurrentOutletID.toString().trim());


                db.insert(TABLE_OutletQuestAnsMstr, null, content);
            }

        }


       // close();

    }

    public static String fngettblNewStoreSalesQuotePaymentDetails(String StoreID)

    {



        String searchString="";



        try {
            //open();

            Cursor cur=db.rawQuery("Select IFNULL(PymtStageId,0) from tblNewStoreSalesQuotePaymentDetails Where StoreId ='"+ StoreID + "'", null);

            if(cur.getCount()>0)

            {

                StringBuilder sBuilder=new StringBuilder();

                if(cur.moveToFirst())

                {

                    for(int i=0;i<cur.getCount();i++)

                    {

                        searchString= cur.getString(0);

                        cur.moveToNext();

                    }

                }



            }



        } catch (Exception e) {

            // TODO: handle exception

        }

        finally

        {

           // close();

            return searchString;

        }

    }

    public static LinkedHashMap<String, String> fnGettblSalesQuotePaymentModeMstrAllValues()
    {
        LinkedHashMap<String, String> hmapQuestionMstr=new LinkedHashMap<String, String>();
        //open();
        Cursor cursor= db.rawQuery("SELECT PymtModeId,PymtMode from tblSalesQuotePaymentModeMstr", null);// Where PNodeID='"+TSIID+"'
        //(String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString()+"^"+(String) cursor.getString(2).toString()+"^"+(String) cursor.getString(3).toString()+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(5).toString()+"^"+(String) cursor.getString(6).toString()+"^"+(String) cursor.getString(7).toString()+"^"+(String) cursor.getString(8).toString()+"^"+(String) cursor.getString(9).toString()+"^"+(String) cursor.getString(10).toString()
        // close();
        try {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapQuestionMstr.put((String) cursor.getString(0).toString(),(String) cursor.getString(1).toString());
                        //    System.out.println("QuestID:"+(String)cursor.getString(0).toString()+"QuestCode:"+(String) cursor.getString(1).toString()+"QuestDesc:"+(String) cursor.getString(2).toString()+"QuestType:"+(String) cursor.getString(3).toString()+"AnsControlType:"+(String) cursor.getString(4).toString()+"AnsControlInputTypeID:"+(String) cursor.getString(5).toString()+"AnsControlInputTypeMaxLength:"+(String) cursor.getString(6).toString()+"AnsMustRequiredFlg:"+(String) cursor.getString(7).toString()+"QuestBundleFlg:"+(String) cursor.getString(8).toString()+"ApplicationTypeID:"+(String) cursor.getString(9).toString()+"Sequence:"+(String) cursor.getString(10).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return hmapQuestionMstr;
        }
        finally
        {
            cursor.close();
          //  close();
        }
    }

    public static LinkedHashMap<String, String> fnGettblSalesQuotePaymentModeMstr(String PaymentStageID)
    {


        String strPaymentModeID="";
        LinkedHashMap<String, String> hmapQuestionMstr=new LinkedHashMap<String, String>();
        //open();
        strPaymentModeID=fngetPaymentModeIDsBasedOnStageID(PaymentStageID);

        String searchString="0";

        if(strPaymentModeID.indexOf(",")!=-1)
        {
            String[] arrsearchString=strPaymentModeID.split(Pattern.quote(","));
            for(int i=0;i<arrsearchString.length;i++)
            {
                if(i==0)
                {
                    searchString="'"+arrsearchString[i].trim().toLowerCase()+"'";
                }
                else
                {
                    searchString+= ",'"+arrsearchString[i].trim().toLowerCase()+"'";
                }
            }
        }
        else
        {
            searchString="'"+strPaymentModeID.trim().toLowerCase()+"'";
        }

        // Cursor cursor = db.rawQuery("SELECT SST_NameId,SST_Name_des from tbl_SST_NameMstr Order By Sequence ASC  ", null);// Where PNodeID='"+TSIID+"'
        Cursor cursor=null;
//tblSalesQuotePaymentModeMstr (PymtModeId text null,PymtMode text null);";
        //   cursor= db.rawQuery("SELECT PymtModeId,PymtMode from tblSalesQuotePaymentModeMstr Where  PymtModeId in ("+searchString+")  ", null);// Where PNodeID='"+TSIID+"'

        if(PaymentStageID.equals("1"))
        {
            cursor= db.rawQuery("SELECT PymtModeId,PymtMode from tblSalesQuotePaymentModeMstr limit 3  ", null);// Where PNodeID='"+TSIID+"'
        }
        if(PaymentStageID.equals("2"))
        {
            cursor= db.rawQuery("SELECT PymtModeId,PymtMode from tblSalesQuotePaymentModeMstr limit 4  ", null);// Where PNodeID='"+TSIID+"'
        }
        if(PaymentStageID.equals("3"))
        {
            cursor= db.rawQuery("SELECT PymtModeId,PymtMode from tblSalesQuotePaymentModeMstr limit 5  ", null);// Where PNodeID='"+TSIID+"'
        }
        if(PaymentStageID.equals("1")||PaymentStageID.equals("2")||PaymentStageID.equals("3"))
        {
            try {
                if(cursor.getCount()>0)
                {
                    if (cursor.moveToFirst())
                    {
                        for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                            hmapQuestionMstr.put((String) cursor.getString(0).toString(),(String) cursor.getString(1).toString());
                            //    System.out.println("QuestID:"+(String)cursor.getString(0).toString()+"QuestCode:"+(String) cursor.getString(1).toString()+"QuestDesc:"+(String) cursor.getString(2).toString()+"QuestType:"+(String) cursor.getString(3).toString()+"AnsControlType:"+(String) cursor.getString(4).toString()+"AnsControlInputTypeID:"+(String) cursor.getString(5).toString()+"AnsControlInputTypeMaxLength:"+(String) cursor.getString(6).toString()+"AnsMustRequiredFlg:"+(String) cursor.getString(7).toString()+"QuestBundleFlg:"+(String) cursor.getString(8).toString()+"ApplicationTypeID:"+(String) cursor.getString(9).toString()+"Sequence:"+(String) cursor.getString(10).toString());
                            cursor.moveToNext();
                        }
                    }
                }

            }
            finally
            {
                cursor.close();
               // close();
            }
        }
        return hmapQuestionMstr;

    }

    public static ArrayList<String> fnGetOptionMstr(int questionId)
    {
        //  LinkedHashMap<String, String> hmapOptionMstr=new LinkedHashMap<String, String>();
        ArrayList<String> listOptionMstr = new ArrayList<String>();
        // ArrayList<String> al1 = new ArrayList<String>();
        String idd="0";

        //open();
        Cursor cursor = db.rawQuery("SELECT  tblGetPDAQuestMstr.AnsControlType ,tblGetPDAQuestOptionMstr.OptID,tblGetPDAQuestOptionMstr.QuestID,tblGetPDAQuestOptionMstr.OptionDescr,tblGetPDAQuestOptionMstr.Sequence from tblGetPDAQuestOptionMstr inner join tblGetPDAQuestMstr on tblGetPDAQuestOptionMstr.QuestID =tblGetPDAQuestMstr.QuestID  Where tblGetPDAQuestOptionMstr.QuestID='"+questionId+"' Order By tblGetPDAQuestOptionMstr.Sequence ASC ", null);// Where PNodeID='"+TSIID+"'
        // close();
        try {
            if(cursor.getCount()>0)

            {
                if (cursor.moveToFirst())
                {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                        listOptionMstr.add(i,(String) cursor.getString(1).toString()+"^"+(String) cursor.getString(3).toString());
                        cursor.moveToNext();
                    }
                    //  hmapOptionMstr.put(idd, al1);
                }
            }
            return listOptionMstr;
        }
        finally
        {
            cursor.close();
          //  close();
        }
    }

    public static String[] getQuestIdGroupIdCopyAsAbove(int GrpCopyID,int groupId)
    {
        String[] questGroupIdCopyAsAbove = null;
        //open();
        Cursor cur=db.rawQuery("Select QuestCopyID from tblGetPDAQuestGrpMapping where GrpID="+groupId+" AND GrpCopyID="+GrpCopyID,null);
        if(cur.getCount()>0)
        {
            questGroupIdCopyAsAbove=new String[cur.getCount()];
            if(cur.moveToFirst())
            {
                for(int i=0;i<cur.getCount();i++)
                {
                    questGroupIdCopyAsAbove[i]= cur.getString(0);
                    cur.moveToNext();
                }
            }
        }
        //close();
        return questGroupIdCopyAsAbove;
    }

    public static String[] fnGetGroupIdQuestionMstr(String questGroupID,int section)
    {
        String[] questonWdSameGroupId=new String[2];
        //open();
        int lastIndex=0;
        //tblGetPDAQuestGrpMapping(GrpQuestID int null,QuestID int null,GrpID int null,GrpNodeID int null,GrpDesc text null,SectionNo int null);";
        Cursor cursor = db.rawQuery("SELECT tblGetPDAQuestMstr.QuestID,tblGetPDAQuestMstr.AnsControlType, tblGetPDAQuestGrpMapping.GrpQuestID from tblGetPDAQuestMstr inner join tblGetPDAQuestGrpMapping on tblGetPDAQuestMstr.QuestID=tblGetPDAQuestGrpMapping.QuestID where tblGetPDAQuestMstr.QuestBundleGroupId = '"+questGroupID+"' AND tblGetPDAQuestGrpMapping.SectionNo="+section, null);
        try {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        questonWdSameGroupId[i]=(String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString()+"^"+(String) cursor.getString(2).toString();

                        cursor.moveToNext();
                    }

                }
            }
            return questonWdSameGroupId;
        }
        finally
        {
            cursor.close();
          //  close();
        }
    }

    public static ArrayList<String> getDepOtnVal(String depAnsValid,int grpId,int grpQstDepId)
    {
        ////  private static final String DATABASE_CREATE_TABLE_QUESTION_OPTION_VAL_DEPENDENTMstr = "create table tblPDAQuestOptionValuesDependentMstr(DepQstId int null,DepAnswValId int null,QstId int null,AnswValId text null,OptDescr text null,Sequence int null,GrpQuestID int null,GrpDepQuestID int null);";
        //open();

        ArrayList<String> listOptId_OptName=new ArrayList<String>();
        try {


            Cursor cur=db.rawQuery("Select AnswValId,OptDescr from tblPDAQuestOptionValuesDependentMstr where GrpQuestID="+grpId+" AND GrpDepQuestID="+grpQstDepId+" AND DepAnswValId='"+depAnsValid+"'", null);

            if(cur.getCount()>0)
            {
                String optId_optDescr;
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        optId_optDescr=cur.getString(0)+"^"+cur.getString(1);
                        listOptId_OptName.add(optId_optDescr);
                        cur.moveToNext();
                    }

                }


            }
        } catch (Exception e) {
            // TODO: handle exception
        }
        finally
        {
            //close();
            return listOptId_OptName;
        }

    }

    public static void deleteImageData(String imageValidName,String storeId)
    {
        //tableImage(tempId text null,QstIdAnsCntrlTyp text null,imageName text null,imagePath text null,Sstat integer null);";
        //open();
        Cursor cur=db.rawQuery("Select imageName from tableImage where StoreID='"+storeId+"' AND imageName='"+imageValidName+"'", null);
        if(cur.getCount()>0)
        {
            db.delete(TABLE_IMAGE, "StoreID=? AND imageName=?", new String[]{storeId,imageValidName});
        }
       // close();
    }

    public static void insertImageInfo(String tempId,LinkedHashMap<String, String> hmapAllValues)
    {
        //tableImage(tempId text null,QstIdAnsCntrlTyp text null,imageName text null,imagePath text null,Sstat integer null);";
        //open();
        Cursor cur=db.rawQuery("Select imageName from tableImage where StoreID='"+tempId+"'", null);
        if(cur.getCount()>0)
        {
            db.delete(TABLE_IMAGE, "StoreID=?", new String[]{tempId});
        }
        String StoreID = null, qstIdAndCntrlTyp = null, _imageName = null, imagePath = null,clkdTime;
        int sStat = 3;
        for(Entry<String, String> hmaEntry:hmapAllValues.entrySet())
        {
            StoreID=hmaEntry.getValue().split(Pattern.quote("~"))[1].toString();
            qstIdAndCntrlTyp=hmaEntry.getValue().split(Pattern.quote("~"))[0].toString();
            _imageName=hmaEntry.getKey();
            imagePath=hmaEntry.getValue().split(Pattern.quote("~"))[2].toString();
            clkdTime=hmaEntry.getValue().split(Pattern.quote("~"))[3].toString();
           // sStat=Integer.valueOf(hmaEntry.getValue().split(Pattern.quote("~"))[4].toString());


            // tableImage(tempId
            ContentValues content=new ContentValues();
            content.put("StoreID", StoreID);
            content.put("QstIdAnsCntrlTyp", qstIdAndCntrlTyp);

            content.put("imageName", _imageName);
            content.put("imagePath", imagePath);
            content.put("ImageClicktime", clkdTime);
            content.put("Sstat", sStat);

            db.insert(TABLE_IMAGE, null, content);


        }

       // close();
    }

    public static void fnInsertOrUpdate_tblStoreDeatils(String StoreID,String StoreName,String ActualLatitude,String ActualLongitude,String VisitStartTS,String VisitEndTS,String LocProvider,String Accuracy,String BateryLeftStatus,int IsStoreDataCompleteSaved,String PaymentStage,int flgLocationTrackEnabled,String StoreAddress,String StoreCity,String StorePinCode,String StoreState,int Sstat)
    {



		/*//open();
		try {
			Cursor cursor = db.rawQuery("SELECT StoreID FROM "+ DATABASE_TABLE_MAINtblStoreDeatils +" where StoreID='"+StoreID +"'" , null);


			ContentValues initialValues = new ContentValues();


			initialValues.put("StoreName", StoreName.trim());
			initialValues.put("VisitEndTS", VisitEndTS);

			initialValues.put("IsStoreDataCompleteSaved", IsStoreDataCompleteSaved);
			initialValues.put("PaymentStage", PaymentStage);
			initialValues.put("flgLocationTrackEnabled", flgLocationTrackEnabled);
			initialValues.put("StoreAddress", StoreAddress);
			initialValues.put("StoreCity", StoreCity);
			initialValues.put("StorePinCode", StorePinCode);
			initialValues.put("StoreState", StoreState);
			initialValues.put("Sstat", Sstat);


			if(cursor.getCount()>0)
			{

				int affected = db.update(DATABASE_TABLE_MAINtblStoreDeatils, initialValues, "StoreID=?",new String[] {StoreID});
			}
			else
			{
				initialValues.put("StoreID", StoreID.trim());
				initialValues.put("ActualLatitude", ActualLatitude);
				initialValues.put("ActualLongitude", ActualLongitude);
				initialValues.put("VisitStartTS", VisitStartTS);
				initialValues.put("LocProvider", LocProvider);
				initialValues.put("Accuracy", Accuracy);
				initialValues.put("BateryLeftStatus", BateryLeftStatus);
				db.insert(DATABASE_TABLE_MAINtblStoreDeatils, null, initialValues);
			}


		} finally {
			close();
		}*/

    }

    public static void UpdateStoreReturnphotoFlag(String sID, int flag2set)
    {
        try
        {
            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);
            int affected16 = db.update("tblStoreProductPhotoDetail", values,"StoreID=?", new String[] { sID });
        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }
    }

    public static void UpdateNewAddedStorephotoFlag(String sID, int flag2set)
    {
        try
        {
            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);
            int affected16 = db.update("tableImage", values,"StoreID=?", new String[] { sID });
        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }
    }

    public static void UpdateStoreClosephotoWithOutFlag(String sID, int flag2set)
    {
        try
        {
            // final ContentValues values = new ContentValues();
            //values.put("Sstat", flag2set);
            // int affected16 = db.update("tblStoreClosedPhotoDetail", values,"", new String[] {  });
            db.execSQL("UPDATE tblStoreClosedPhotoDetail SET Sstat=5 where Sstat="+ 3);
        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }
    }

    /*public static void UpdateStoreReturnphotoFlag(String StoreID, String StoreName,int flgReMap)
	{
		try
		{
			//
			final ContentValues values = new ContentValues();
			values.put("StoreName", StoreName);
			values.put("flgReMap", flgReMap);



			int affected16 = db.update("tblPreAddedStores", values,"StoreID=?", new String[] { StoreID });
		}
		catch (Exception ex) {

		}
	}*/
    public static String getTodatAndTotalStores()
    {
        String StoresData="0";
        //open();
        try {
            Cursor cur=db.rawQuery("Select TotStoreAdded , TodayStoreAdded from tblStoreCountDetails", null);

            if(cur.getCount()>0)
            {
                StringBuilder sBuilder=new StringBuilder();
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        StoresData=cur.getString(0)+"^"+cur.getString(1);
                        cur.moveToNext();
                    }
                }

            }

        } catch (Exception e) {
            // TODO: handle exception
        }
        finally
        {
           // close();
            return StoresData;
        }
    }

    public static void fnDeletesaveNewOutletFromOutletMstr(String OutletID)
    {
        //open();
        db.execSQL("DELETE FROM tblPreAddedStores WHERE StoreID ='"+ OutletID + "'");// and sectionID="+sectionID
       // close();
    }

    public static void deletetblStoreCountDetails()
    {
        db.execSQL("DELETE FROM tblStoreCountDetails");

    }

    public static int checkCountIntblNewStoreMainTable(String  StoreId)
    {
        //open();
        Cursor cursor =null;
        int check=0;
        try {

            cursor= db.rawQuery("SELECT Count(*) FROM tblOutletQuestAnsMstr WHERE  OutletID ='"+ StoreId + "'", null);
            if (cursor.getCount() > 0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        check=1;
                        cursor.moveToNext();
                    }
                }

            }


        } catch (Exception e) {
            System.out.println("shivam query = "+e.toString());
        }
        finally {
            cursor.close();
           // close();
        }
        return check;
    }

	/*public static long saveTblStoreCountDetails(String TotStoreAdded,String TodayStoreAdded)
	{

		ContentValues initialValues = new ContentValues();

		initialValues.put("TotStoreAdded", Integer.parseInt(TotStoreAdded.toString().trim()));
		initialValues.put("TodayStoreAdded", Integer.parseInt(TodayStoreAdded.toString().trim()));

		return db.insert(DATABASE_TABLE_tblStoreCountDetails, null, initialValues);
	}*/


    public static void fndeleteNewStoreSalesQuotePaymentDetails(String StoreID)
    {

        db.execSQL("DELETE FROM tblNewStoreSalesQuotePaymentDetails WHERE StoreId ='" + StoreID + "'");
    }

    public static long fnsaveNewStoreSalesQuotePaymentDetails(String StoreId,String PaymentStageId) {

        ContentValues initialValues = new ContentValues();


        initialValues.put("StoreId", StoreId.toString().trim());

        initialValues.put("PymtStageId", PaymentStageId.toString().trim());
        initialValues.put("Sstat", "1");

        return db.insert(DATABASE_TABLE_NewStoreSalesQuotePaymentDetails, null, initialValues);
    }

    public static String getLocationDetails()
    {
        //String StoresData="0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0";
        String StoresData="0";
        //open();
        try {                           //  0           1        2         3       4     5       6     7                 8          9   1 0              11     12    13           14          15         16          17                        18        19    20                21                                   22                                   23
            Cursor cur=db.rawQuery("Select Lattitude,Longitude,Accuracy,Address,City,Pincode,State,fnAccurateProvider,GpsLat,GpsLong,GpsAccuracy,NetwLat,NetwLong,NetwAccuracy,FusedLat,FusedLong,FusedAccuracy,AllProvidersLocation,GpsAddress,NetwAddress,FusedAddress,FusedLocationLatitudeWithFirstAttempt,FusedLocationLongitudeWithFirstAttempt,FusedLocationAccuracyWithFirstAttempt from tblLocationDetails", null);

            if(cur.getCount()>0)
            {
                StringBuilder sBuilder=new StringBuilder();
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        StoresData=cur.getString(0)+"^"+cur.getString(1)+"^"+cur.getString(2)+"^"+cur.getString(3)+"^"+cur.getString(4)+"^"+cur.getString(5)+"^"+cur.getString(6)+"^"+cur.getString(7)+"^"+cur.getString(8)+"^"+cur.getString(9)+"^"+cur.getString(10)+"^"+cur.getString(11)+"^"+cur.getString(12)+"^"+cur.getString(13)+"^"+cur.getString(14)+"^"+cur.getString(15)+"^"+cur.getString(16)+"^"+cur.getString(17)+"^"+cur.getString(18)+"^"+cur.getString(19)+"^"+cur.getString(20)+"^"+cur.getString(21)+"^"+cur.getString(22)+"^"+cur.getString(23);
                        cur.moveToNext();
                    }
                }

            }

        } catch (Exception e) {
            // TODO: handle exception
        }
        finally
        {
          //  close();
            return StoresData;
        }
    }

    public static long  saveLatLngToTxtFile(String StoreID, String fnLati, String fnLongi,
                                     String fnAccuracy, String fnAccurateProvider,
                                     String GpsLat, String GpsLong, String GpsAccuracy,
                                     String NetwLat, String NetwLong, String NetwAccuracy, String FusedLat,
                                     String FusedLong, String FusedAccuracy,
                                     int Sstat, String flgLocNotFound, String fnAddress, String AllProvidersLocation, String GpsAddress, String NetwAddress
            , String FusedAddress, String FusedLocationLatitudeWithFirstAttempt, String FusedLocationLongitudeWithFirstAttempt, String FusedLocationAccuracyWithFirstAttempt)
    {
        //open();
        try
        {
            ContentValues initialValues = new ContentValues();

            Cursor cursor=db.rawQuery("Select StoreID from tblLatLongDetails where StoreID='"+StoreID+"'",null);

            if(cursor.getCount()>0)
            {

            }
            else
            {
                initialValues.put("StoreID", StoreID);
                initialValues.put("fnLati", fnLati);
                initialValues.put("fnLongi", fnLongi.trim());
                initialValues.put("fnAccuracy", fnAccuracy.trim());
                initialValues.put("flgLocNotFound", flgLocNotFound);
                initialValues.put("fnAccurateProvider", fnAccurateProvider.trim());
                initialValues.put("fnAddress", fnAddress);
                initialValues.put("AllProvidersLocation", AllProvidersLocation);


                initialValues.put("GpsLat", GpsLat.trim());
                initialValues.put("GpsLong", GpsLong.trim());
                initialValues.put("GpsAccuracy", GpsAccuracy.trim());
                initialValues.put("GpsAddress", GpsAddress);

                initialValues.put("NetwLat", NetwLat.trim());
                initialValues.put("NetwLong", NetwLong.trim());
                initialValues.put("NetwAccuracy", NetwAccuracy.trim());
                initialValues.put("NetwAddress", NetwAddress);

                initialValues.put("FusedLat", FusedLat.trim());
                initialValues.put("FusedLong", FusedLong.trim());
                initialValues.put("FusedAccuracy", FusedAccuracy.trim());
                initialValues.put("FusedAddress", FusedAddress);


                initialValues.put("FusedLocationLatitudeWithFirstAttempt", FusedLocationLatitudeWithFirstAttempt);
                initialValues.put("FusedLocationLongitudeWithFirstAttempt", FusedLocationLongitudeWithFirstAttempt);
                initialValues.put("FusedLocationAccuracyWithFirstAttempt", FusedLocationAccuracyWithFirstAttempt);
                initialValues.put("Sstat", Sstat);
                return db.insert(DATABASE_TABLE_Main271, null, initialValues);
            }





        }
        catch(Exception e)
        {

        }
        finally
        {
           // close();
        }
        return 0;
    }

    public static LinkedHashMap<String, String> fetch_DSRCoverage_List()
    {
        //open();
        LinkedHashMap<String, String> hmapCatgry = new LinkedHashMap<String, String>();

        Cursor cursor = db.rawQuery("SELECT CoverageAreaNodeID,CoverageArea FROM tblDSRCoverageMaster",null);
        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    hmapCatgry.put("Select DSM", "0");
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        hmapCatgry.put(cursor.getString(1).toString(),cursor.getString(0).toString());
                        cursor.moveToNext();
                    }
                }

            }

            else
            {
                hmapCatgry.put("No DSR", "0");
            }
            return hmapCatgry;
        }
        finally
        {
            cursor.close();
            //close();
        }
    }


    public static String[] getSuplierDataMstr()
    {
        String strStoreTypeNamesDetais[] =null;
        try {
            Cursor cursor2 = db.rawQuery("SELECT NodeID,NodeType,Descr,flgMapped FROM tblSupplierMstrList", null);

            if(cursor2.getCount()>0)
            {
                strStoreTypeNamesDetais=new String[cursor2.getCount()+1];
                if (cursor2.moveToFirst())
                {
                    for (int i = 0; i < cursor2.getCount(); i++)
                    {
                        if(i==0)
                        {
                            strStoreTypeNamesDetais[i]="0^0^Select Distributor^0";
                        }
                        strStoreTypeNamesDetais[i+1] = cursor2.getString(0).toString()+"^"+cursor2.getString(1)+"^"+cursor2.getString(2)+"^"+cursor2.getString(3);
                        cursor2.moveToNext();
                    }
                }
            }
            else
            {
                strStoreTypeNamesDetais=new String[1];
                strStoreTypeNamesDetais[0]="0^0^Select Distributor^0";
            }
            return strStoreTypeNamesDetais;
        } finally {

        }
    }

    public static void Delete_tblSuplierMapping(int DistribtrId,int DistributorNodeType)
    {
        try
        {

            db.execSQL("DELETE FROM tblSuplierMapping where SuplierId="+DistribtrId+" and SuplierNodeType="+DistributorNodeType);
        }
        catch(Exception e)
        {

        }
        finally
        {

        }
    }

    public static long savetblSuplierMappingData(String SuplierUniqueId,String  SuplierId ,String SuplierNodeType ,
                                              String flgGSTCapture,String flgGSTCompliance ,String GSTNumber, String Address,
                                              String PinCode,String City,String State,String fnLati,
                                              String fnLongi ,String fnAccuracy ,String flgLocNotFound,String fnAccurateProvider,
                                              String AllProvidersLocation ,String fnAddress ,String GpsLat ,String  GpsLong ,
                                              String GpsAccuracy ,String GpsAddress ,String NetwLat ,String NetwLong ,
                                              String NetwAccuracy ,String  NetwAddress ,String  FusedLat ,String  FusedLong ,
                                              String FusedAccuracy ,String  FusedAddress ,String FusedLocationLatitudeWithFirstAttempt,
                                              String FusedLocationLongitudeWithFirstAttempt ,String FusedLocationAccuracyWithFirstAttempt,
                                              int Sstat,int flgLocationServicesOnOff,int flgGPSOnOff,int flgNetworkOnOff,int flgFusedOnOff,int flgInternetOnOffWhileLocationTracking,int flgRestart)
    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("SuplierUniqueId", SuplierUniqueId.trim());
        initialValues.put("SuplierId", SuplierId.trim());
        initialValues.put("SuplierNodeType", SuplierNodeType.trim());
        initialValues.put("flgGSTCapture", flgGSTCapture.trim());
        initialValues.put("flgGSTCompliance", flgGSTCompliance.trim());
        initialValues.put("GSTNumber", GSTNumber.trim());

        initialValues.put("Address", Address.trim());
        initialValues.put("PinCode", PinCode.trim());
        initialValues.put("City", City.trim());
        initialValues.put("State", State.trim());

        initialValues.put("fnLati", fnLati.trim());
        initialValues.put("fnLongi", fnLongi.trim());
        initialValues.put("fnAccuracy", fnAccuracy.trim());
        initialValues.put("flgLocNotFound", flgLocNotFound.trim());
        initialValues.put("fnAccurateProvider", fnAccurateProvider.trim());
        initialValues.put("AllProvidersLocation", AllProvidersLocation.trim());
        initialValues.put("fnAddress", fnAddress.trim());

        initialValues.put("GpsLat", GpsLat.trim());
        initialValues.put("GpsLong", GpsLong.trim());
        initialValues.put("GpsAccuracy", GpsAccuracy.trim());
        initialValues.put("GpsAddress", GpsAddress.trim());

        initialValues.put("NetwLat", NetwLat.trim());
        initialValues.put("NetwLong", NetwLong.trim());
        initialValues.put("NetwAccuracy", NetwAccuracy.trim());
        initialValues.put("NetwAddress", NetwAddress.trim());

        initialValues.put("FusedLat", FusedLat.trim());
        initialValues.put("FusedLong", FusedLong.trim());
        initialValues.put("FusedAccuracy", FusedAccuracy.trim());
        initialValues.put("FusedAddress", FusedAddress.trim());

        initialValues.put("FusedLocationLatitudeWithFirstAttempt", FusedLocationLatitudeWithFirstAttempt.trim());
        initialValues.put("FusedLocationLongitudeWithFirstAttempt", FusedLocationLongitudeWithFirstAttempt.trim());
        initialValues.put("FusedLocationAccuracyWithFirstAttempt", FusedLocationAccuracyWithFirstAttempt.trim());
        initialValues.put("Sstat", Sstat);

        initialValues.put("flgLocationServicesOnOff", flgLocationServicesOnOff);
        initialValues.put("flgGPSOnOff", flgGPSOnOff);
        initialValues.put("flgNetworkOnOff", flgNetworkOnOff);
        initialValues.put("flgFusedOnOff", flgFusedOnOff);
        initialValues.put("flgInternetOnOffWhileLocationTracking", flgInternetOnOffWhileLocationTracking);
        initialValues.put("flgRestart", flgRestart);


        return db.insert(TABLE_tblSuplierMapping, null, initialValues);
    }

    public static int fnCheckIfStoreIDExistsIn_tblStoreDeatils(String StoreID)
    {
        //open();
        int flgCheckIfStoreExists=0;
        //tblStoreDetails(StoreID
        Cursor cursor2 = db.rawQuery("SELECT Count(*) FROM tblStoreList where StoreID='"+StoreID+"'", null);
        try {
            if(cursor2.getCount()>0)
            {
                if(cursor2.moveToFirst())
                {
                    if (cursor2.getInt(0)>0)
                    {

                        flgCheckIfStoreExists=1;

                    }
                }
            }


        }
        catch(Exception e)
        {

        }
        finally {
            cursor2.close();
          //  close();
        }
        return flgCheckIfStoreExists;
    }

    public static ArrayList<String> fnGetDetails_tblStoreDeatils(String StoreID)
    {
        ArrayList<String> arrBasisDetailsAgainstStore=new ArrayList<String>();

        //open();
        try
        {
            //Cursor cursor = db.rawQuery("SELECT StoreName,IFNULL(PaymentStage,'0') AS PaymentStage,IFNULL(StoreAddress,'NA') AS StoreAddress,IFNULL(StoreCity,'NA') AS StoreCity,IFNULL(StorePinCode,'NA') AS StorePinCode,IFNULL(StoreState,'NA') AS StoreState,ActualLatitude,ActualLongitude,Accuracy FROM tblStoreList where StoreID='" + StoreID+"'", null);
            // by sunil
            //SELECT t1.product_s_desc, t1.product_desc, t1.product_name, t2.product_price
            //FROM table1 t1
            //INNER JOIN table2 t2 ON t2.product_id = t1.product_id
            Cursor cursor = db.rawQuery("SELECT StoreName,StoreClose,StoreClose,StoreCity,StorePinCode,StoreState,ActualLatitude,ActualLongitude,Accuracy FROM tblStoreList where StoreID='"+StoreID+"'", null);


            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    arrBasisDetailsAgainstStore.add((String) cursor.getString(0).toString());
                    arrBasisDetailsAgainstStore.add((String) cursor.getString(1).toString());
                    arrBasisDetailsAgainstStore.add((String) cursor.getString(2).toString());
                    arrBasisDetailsAgainstStore.add((String) cursor.getString(3).toString());
                    arrBasisDetailsAgainstStore.add((String) cursor.getString(4).toString());
                    arrBasisDetailsAgainstStore.add((String) cursor.getString(5).toString());
                    arrBasisDetailsAgainstStore.add((String) cursor.getString(6).toString());
                    arrBasisDetailsAgainstStore.add((String) cursor.getString(7).toString());
                    arrBasisDetailsAgainstStore.add((String) cursor.getString(8).toString());
                    cursor.moveToNext();
                }
            }


        }
        catch (Exception e) {
            // TODO: handle exception
        }
        finally
        {
          //  close();
        }

        return arrBasisDetailsAgainstStore;
    }

    public static LinkedHashMap<String, ArrayList<String>> fnGetQuestionMstrKey()
    {
        LinkedHashMap<String, ArrayList<String>> hmapQuestionMstr=new LinkedHashMap<String, ArrayList<String>>();
        ArrayList<String> listKeyQuesVal=new ArrayList<String>();
        //open();
        //tblGetPDAQuestGrpMapping(GrpQuestID int null,QuestID int null,GrpID int null,GrpNodeID int null,GrpDesc text null,SectionNo int null,GrpCopyID int null,QuestCopyID int null,Sequence int null);";
        //tblGetPDAQuestMstr(QuestID int null,QuestCode int null,QuestDesc text null,QuestType int null,AnsControlType int null,AnsControlInputTypeID int null,AnsControlInputTypeMinLength int null,AnsControlInputTypeMaxLength int null,AnsMustRequiredFlg int null,QuestBundleFlg int null,ApplicationTypeID int null,Sequence int null,AnswerHint text null);";
        Cursor cursor = db.rawQuery("SELECT tblGetPDAQuestMstr.QuestID,tblGetPDAQuestMstr.AnsControlType,tblGetPDAQuestGrpMapping.GrpQuestID,tblGetPDAQuestGrpMapping.GrpID,tblGetPDAQuestGrpMapping.Sequence from tblGetPDAQuestMstr inner join tblGetPDAQuestGrpMapping where tblGetPDAQuestMstr.QuestID=tblGetPDAQuestGrpMapping.QuestID  Order By tblGetPDAQuestGrpMapping.GrpID ASC,tblGetPDAQuestGrpMapping.Sequence", null);// Where PNodeID='"+TSIID+"'

        try
        {
            if(cursor.getCount()>0)
            {

                String sectionNo="0",preVisousSectionNum="0";
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        sectionNo= cursor.getString(3);
                        System.out.println("Squence Added = "+cursor.getString(3)+" : "+cursor.getString(4));
                        if(i==0)
                        {
                            preVisousSectionNum= sectionNo;
                            listKeyQuesVal.add(cursor.getString(0)+"^"+cursor.getString(1)+"^"+cursor.getString(2));
                        }
                        else if(preVisousSectionNum.equals(sectionNo))
                        {
                            listKeyQuesVal.add(cursor.getString(0)+"^"+cursor.getString(1)+"^"+cursor.getString(2));
                        }
                        else
                        {
                            hmapQuestionMstr.put(preVisousSectionNum, listKeyQuesVal);
                            listKeyQuesVal=new ArrayList<String>();
                            preVisousSectionNum=sectionNo;
                            listKeyQuesVal.add(cursor.getString(0)+"^"+cursor.getString(1)+"^"+cursor.getString(2));

                        }
                        if(i==(cursor.getCount()-1))
                        {
                            hmapQuestionMstr.put(preVisousSectionNum, listKeyQuesVal);
                        }

                        cursor.moveToNext();
                    }
                }
            }
            return hmapQuestionMstr;
        }
        finally
        {
            cursor.close();
           // close();
        }
    }

    public static LinkedHashMap<String, String> getGroupDescription()
    {
        //open();
        LinkedHashMap<String, String> hmapGroupDescrptn=new LinkedHashMap<String, String>();
        //tblGetPDAQuestGrpMapping(GrpQuestID int null,QuestID int null,GrpID int null,GrpNodeID int null,GrpDesc text null,SectionNo int null);";
        Cursor cur=db.rawQuery("Select Distinct GrpID,GrpDesc from tblGetPDAQuestGrpMapping", null);
        if(cur.getCount()>0)
        {
            if(cur.moveToFirst())
            {
                for(int i=0;i<cur.getCount();i++)
                {
                    hmapGroupDescrptn.put(cur.getString(0), cur.getString(1));
                    cur.moveToNext();
                }

            }
        }
       // close();
        return hmapGroupDescrptn;
    }

    public static LinkedHashMap<String, ArrayList<String>> fnGetGroupIdMpdWdSectionId()
    {
        LinkedHashMap<String, ArrayList<String>> hmapQuestionMstr=new LinkedHashMap<String, ArrayList<String>>();
        ArrayList<String> listKeyQuesVal=new ArrayList<String>();

        //open();
        int sectionCount=getsectionCount();
        //    int sectionCount=0;
        //tblGetPDAQuestGrpMapping(GrpQuestID int null,QuestID int null,GrpID int null,GrpNodeID int null,GrpDesc text null,SectionNo int null);";
        //tblGetPDAQuestMstr(QuestID int null,QuestCode int null,QuestDesc text null,QuestType int null,AnsControlType int null,AnsControlInputTypeID int null,AnsControlInputTypeMinLength int null,AnsControlInputTypeMaxLength int null,AnsMustRequiredFlg int null,QuestBundleFlg int null,ApplicationTypeID int null,Sequence int null,AnswerHint text null);";
        Cursor cursor;
        if(sectionCount!=0)
        {
            cursor = db.rawQuery("SELECT Distinct GrpID,SectionNo from tblGetPDAQuestGrpMapping where SectionNo<="+sectionCount+" order by SectionNo", null);// Where PNodeID='"+TSIID+"'
        }
        else
        {
            cursor = db.rawQuery("SELECT Distinct GrpID,SectionNo from tblGetPDAQuestGrpMapping order by SectionNo", null);// Where PNodeID='"+TSIID+"'
        }


        try
        {
            if(cursor.getCount()>0)
            {
                String sectionNo="0",preVisousSectionNum="0";
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        sectionNo= cursor.getString(1);
                        if(i==0)
                        {
                            preVisousSectionNum= sectionNo;
                            listKeyQuesVal.add(cursor.getString(0));
                        }
                        else if(preVisousSectionNum.equals(sectionNo))
                        {
                            listKeyQuesVal.add(cursor.getString(0));
                        }
                        else
                        {
                            hmapQuestionMstr.put(preVisousSectionNum, listKeyQuesVal);
                            listKeyQuesVal=new ArrayList<String>();
                            preVisousSectionNum=sectionNo;
                            listKeyQuesVal.add(cursor.getString(0));

                        }
                        if(i==cursor.getCount() - 1)
                        {
                            hmapQuestionMstr.put(preVisousSectionNum, listKeyQuesVal);
                        }


                        cursor.moveToNext();
                    }
                }
            }
            return hmapQuestionMstr;
        }
        finally
        {
            cursor.close();
            //close();
        }
    }

    public static LinkedHashMap<String, String> fnGetDependentQuestionMstr()
    {

        LinkedHashMap<String, String> hmapDpndntQuestionMstr=new LinkedHashMap<String, String>();
        //open();
        //tblGetPDAQuestionDependentMstr(QuestionID int null,OptionID int null,DependentQuestionID int null,GrpID int null,GrpDepQuestID int null);";
        Cursor cursor = db.rawQuery("SELECT DISTINCT GrpDepQuestID,OptionID from tblGetPDAQuestionDependentMstr", null);// Where PNodeID='"+TSIID+"'
        String []arrbhi=new String[cursor.getCount()];
        try {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        // hmapDpndntQuestionMstr.put((String) cursor.getString(3).toString()+"^"+(String) cursor.getString(1).toString(), (String) cursor.getString(2).toString());
                        arrbhi[i]=(String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString();

                        cursor.moveToNext();
                    }

                }
            }
            for(int cntLoop=0;cntLoop<arrbhi.length;cntLoop++)
            {
                String dpndIdAndOptId=arrbhi[cntLoop].toString();
                String dpndntId=dpndIdAndOptId.split(Pattern.quote("^"))[0];
                String optId=dpndIdAndOptId.split(Pattern.quote("^"))[1];
                StringBuilder quesIdToBeVisOrinVis= fnQuestionIdOnBasisOfDependentQuestionIDdpndntId(dpndntId,optId);
                hmapDpndntQuestionMstr.put(arrbhi[cntLoop].toString(), quesIdToBeVisOrinVis.toString());
            }

            return hmapDpndntQuestionMstr;
        }
        finally
        {
            cursor.close();
            //close();
        }

    }

    public static LinkedHashMap<String, ArrayList<String>> fnGetSection_Key()
    {
        LinkedHashMap<String, ArrayList<String>> hmapQuestionMstr=new LinkedHashMap<String, ArrayList<String>>();
        ArrayList<String> listKeyQuesVal=new ArrayList<String>();
        //open();
        //tblGetPDAQuestGrpMapping(GrpQuestID int null,QuestID int null,GrpID int null,GrpNodeID int null,GrpDesc text null,SectionNo int null);";
        //tblGetPDAQuestMstr(QuestID int null,QuestCode int null,QuestDesc text null,QuestType int null,AnsControlType int null,AnsControlInputTypeID int null,AnsControlInputTypeMinLength int null,AnsControlInputTypeMaxLength int null,AnsMustRequiredFlg int null,QuestBundleFlg int null,ApplicationTypeID int null,Sequence int null,AnswerHint text null);";
        Cursor cursor = db.rawQuery("SELECT tblGetPDAQuestMstr.QuestID,tblGetPDAQuestMstr.AnsControlType,tblGetPDAQuestGrpMapping.GrpQuestID,tblGetPDAQuestGrpMapping.SectionNo from tblGetPDAQuestMstr inner join tblGetPDAQuestGrpMapping where tblGetPDAQuestMstr.QuestID=tblGetPDAQuestGrpMapping.QuestID  Order By tblGetPDAQuestGrpMapping.SectionNo ASC  ", null);// Where PNodeID='"+TSIID+"'

        try
        {
            if(cursor.getCount()>0)
            {
                String sectionNo="0",preVisousSectionNum="0";
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        sectionNo= cursor.getString(3);
                        if(i==0)
                        {
                            preVisousSectionNum= sectionNo;
                            listKeyQuesVal.add(cursor.getString(0)+"^"+cursor.getString(1)+"^"+cursor.getString(2));
                        }
                        else if(preVisousSectionNum.equals(sectionNo))
                        {
                            listKeyQuesVal.add(cursor.getString(0)+"^"+cursor.getString(1)+"^"+cursor.getString(2));
                        }
                        else
                        {
                            hmapQuestionMstr.put(preVisousSectionNum, listKeyQuesVal);
                            listKeyQuesVal=new ArrayList<String>();
                            preVisousSectionNum=sectionNo;
                            listKeyQuesVal.add(cursor.getString(0)+"^"+cursor.getString(1)+"^"+cursor.getString(2));

                        }
                        if(i==(cursor.getCount()-1))
                        {
                            hmapQuestionMstr.put(preVisousSectionNum, listKeyQuesVal);
                        }

                        cursor.moveToNext();
                    }
                }
            }
            return hmapQuestionMstr;
        }
        finally
        {
            cursor.close();
           // close();
        }
    }

    public static  void deleteLocationTable()
    {
        db.execSQL("DELETE FROM tblLocationDetails");

    }

    public static long saveTblLocationDetails(String Lattitude, String Longitude, String Accuracy, String Address, String City, String Pincode, String State, String fnAccurateProvider, String GpsLat, String GpsLong, String GpsAccuracy, String NetwLat, String NetwLong, String NetwAccuracy, String FusedLat, String FusedLong, String FusedAccuracy, String AllProvidersLocation, String GpsAddress, String NetwAddress, String FusedAddress, String FusedLocationLatitudeWithFirstAttempt, String FusedLocationLongitudeWithFirstAttempt, String FusedLocationAccuracyWithFirstAttempt)
    {
        ContentValues initialValues = new ContentValues();

        initialValues.put("Lattitude", Lattitude);
        initialValues.put("Longitude", Longitude);
        initialValues.put("Accuracy", Accuracy);
        initialValues.put("Address", Address);
        initialValues.put("City", City);
        initialValues.put("Pincode", Pincode);
        initialValues.put("State", State);

        initialValues.put("fnAccurateProvider", fnAccurateProvider);
        initialValues.put("GpsLat", GpsLat);
        initialValues.put("GpsLong", GpsLong);
        initialValues.put("GpsAccuracy", GpsAccuracy);
        initialValues.put("NetwLat", NetwLat);
        initialValues.put("NetwLong", NetwLong);
        initialValues.put("NetwAccuracy", NetwAccuracy);
        initialValues.put("FusedLat", FusedLat);
        initialValues.put("FusedLong", FusedLong);
        initialValues.put("FusedAccuracy", FusedAccuracy);

        initialValues.put("AllProvidersLocation", AllProvidersLocation);
        initialValues.put("GpsAddress", GpsAddress);
        initialValues.put("NetwAddress", NetwAddress);
        initialValues.put("FusedAddress", FusedAddress);
        initialValues.put("FusedLocationLatitudeWithFirstAttempt", FusedLocationLatitudeWithFirstAttempt);
        initialValues.put("FusedLocationLongitudeWithFirstAttempt", FusedLocationLongitudeWithFirstAttempt);
        initialValues.put("FusedLocationAccuracyWithFirstAttempt", FusedLocationAccuracyWithFirstAttempt);



        return db.insert(DATABASE_TABLE_tblLocationDetails, null, initialValues);
    }

    public static int fncheckCountNearByStoreExistsOrNot(int DistanceRange)
    {
        int flgCheck=0;
        //open();

        try {
            // Cursor cursor = db.rawQuery("SELECT Count(*) from tblPreAddedStores Where (LatCode<>'0' and LatCode<>'NA') and DistanceNear<"+ DistanceRange+ " ORDER BY DistanceNear", null);

            Cursor cursor = db.rawQuery("SELECT Count(*) from tblStoreList WHERE (StoreLatitude<>'0' AND StoreLatitude<>'NA')    ORDER BY DistanceNear ASC", null);//
            //StoreID,StoreName,LatCode,LongCode,DateAdded
            if(cursor.getCount()>0) {
                if (cursor.moveToFirst())
                {
                    if(cursor.getInt(0)>0)
                    {
                        flgCheck=1;
                    }
                }
            }

        }
        catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= "+e.toString());
        }
        finally
        {

           // close();
            if(flgCheck==0)
            {
                flgCheck=fncheckCountNewAddedNearByStoreExistsOrNotSM(flgCheck);
            }
            return flgCheck;
        }
    }

    public static int fncheckCountNewAddedNearByStoreExistsOrNotSM(int DistanceRange)
    {

        //open();

        try {
            Cursor cursor = db.rawQuery("SELECT StoreID,StoreName,LatCode,LongCode,DateAdded,DistanceNear from tblPreAddedStores WHERE (LatCode<>'0' AND LatCode<>'NA') AND DistanceNear<"+ DistanceRange +" ORDER BY DistanceNear  ASC Limit 30", null);//
           // Cursor cursor = db.rawQuery("SELECT Count(*) from tblStoreList WHERE (StoreLatitude='NA') and ISNewStore=1", null);//
            if(cursor.getCount()>0) {
                if (cursor.moveToFirst())
                {
                    if(cursor.getInt(0)>0)
                    {
                        DistanceRange=1;
                    }
                }
            }

        }
        catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= "+e.toString());
        }
        finally
        {

           // close();

        }
        return DistanceRange;
    }
    public static LinkedHashMap<String, String> fnGetALLOutletMstrSM()
    {
        Cursor cursor=null;

        LinkedHashMap<String, String> hmapOutletMstr=new LinkedHashMap<String, String>();
        //open();

        cursor = db.rawQuery("SELECT StoreID,ifnull(LatCode,0),ifnull(LongCode,0) from tblPreAddedStores", null);


        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    String phoneNum;
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        hmapOutletMstr.put((String) cursor.getString(0).toString(), (String) cursor.getString(1).toString()+"^"+(String) cursor.getString(2).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return hmapOutletMstr;
        }
        finally
        {
            cursor.close();
           // close();
        }
    }

    public static int fncheckCountNewAddedNearByStoreExistsOrNot(int flgCheck)
    {

        //open();

        try {
            //Cursor cursor = db.rawQuery("SELECT StoreID,StoreName,LatCode,LongCode,DateAdded,DistanceNear from tblPreAddedStores WHERE (LatCode<>'0' AND LatCode<>'NA') AND DistanceNear<"+ DistanceRange +" ORDER BY DistanceNear  ASC Limit 30", null);//
            Cursor cursor = db.rawQuery("SELECT Count(*) from tblStoreList WHERE (StoreLatitude='NA') and ISNewStore=1", null);//
            if(cursor.getCount()>0) {
                if (cursor.moveToFirst())
                {
                    if(cursor.getInt(0)>0)
                    {
                        flgCheck=1;
                    }
                }
            }

        }
        catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= "+e.toString());
        }
        finally
        {

           // close();

        }
        return flgCheck;
    }

    public static LinkedHashMap<String, String> fnGeStoreList(int DistanceRange)
    {
        LinkedHashMap<String, String> hmapQuestionMstr=new LinkedHashMap<String, String>();
        String ForDate=fnGetDateTimeString();
        //open();

        try {
            Cursor cursor = db.rawQuery("SELECT StoreID,StoreLatitude,StoreLongitude,DistanceNear,0 AsflgReMap from tblStoreList WHERE (StoreLatitude<>'0' AND StoreLatitude<>'NA') ORDER BY DistanceNear", null);//
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        String StoreLat="0.00";
                        String StoreLon="0.00";
                        if(!cursor.getString(2).toString().equals("NA"))
                        {
                            StoreLat=(String) cursor.getString(2).toString();
                            StoreLon=(String) cursor.getString(3).toString();
                        }

                        hmapQuestionMstr.put((String) cursor.getString(0).toString(),StoreLat+"^"+StoreLon+"^"+ForDate+"^"+(String) cursor.getString(5).toString());

                        cursor.moveToNext();
                    }
                }
            }

        }
        catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= "+e.toString());
        }
        finally
        {

           // close();
            fnGeNewlyAddedStoreList(hmapQuestionMstr);
            return hmapQuestionMstr;
        }
    }

    public static void fnGeNewlyAddedStoreList(LinkedHashMap<String, String> hmapQuestionMstr)
    {

        //open();

        try {
            //Cursor cursor = db.rawQuery("SELECT StoreID,StoreName,LatCode,LongCode,DateAdded,DistanceNear from tblPreAddedStores WHERE (LatCode<>'0' AND LatCode<>'NA') AND DistanceNear<"+ DistanceRange +" ORDER BY DistanceNear  ASC Limit 30", null);//
String fetchdate=fnGetDateTimeString();
            Cursor cursor = db.rawQuery("SELECT StoreID,StoreLatitude,StoreLongitude,DistanceNear,0 AsflgReMap from tblStoreList WHERE (StoreLatitude='NA') and ISNewStore=1", null);//
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        String StoreLat="0.00";
                        String StoreLon="0.00";
                        if(!cursor.getString(1).toString().equals("NA"))
                        {
                            StoreLat=(String) cursor.getString(1).toString();
                            StoreLon=(String) cursor.getString(2).toString();
                        }

                        //hmapQuestionMstr.put((String) cursor.getString(0).toString(),StoreLat+"^"+StoreLon+"^"+(String) cursor.getString(3).toString());
                        hmapQuestionMstr.put((String) cursor.getString(0).toString(),StoreLat+"^"+StoreLon+"^"+fetchdate+"^"+(String) cursor.getString(4).toString());
                        cursor.moveToNext();
                    }
                }
            }

        }
        catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= "+e.toString());
        }
        finally
        {

            //close();

        }
    }

    public static LinkedHashMap<String, String> fnGetALLOutletMstr()
    {
        Cursor cursor=null;

        LinkedHashMap<String, String> hmapOutletMstr=new LinkedHashMap<String, String>();
        //open();

        cursor = db.rawQuery("SELECT StoreID,ifnull(StoreLatitude,0),ifnull(StoreLongitude,0) from tblStoreList", null);


        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    String phoneNum;
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        hmapOutletMstr.put((String) cursor.getString(0).toString(), (String) cursor.getString(1).toString()+"^"+(String) cursor.getString(2).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return hmapOutletMstr;
        }
        finally
        {
            cursor.close();
            //close();
        }
    }

    public static void UpdateStoreDistanceNear(String OutletID, int DistanceNear)
    {
        try
        {

            final ContentValues values = new ContentValues();
            values.put("DistanceNear", DistanceNear);
            int affected = db.update("tblStoreList", values, "StoreID=?", new String[]{OutletID});
        }
        catch(Exception e)
        {

        }
        finally
        {

        }

    }

    public static long savetblManagerMstr(String PersonID, String PersonType, String  PersonName, String ManagerID, String ManagerType,String ManagerName)
    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("PersonID", PersonID.trim());
        initialValues.put("PersonType", PersonType.trim());
        initialValues.put("PersonName", PersonName.trim());
        initialValues.put("ManagerID", ManagerID.trim());
        initialValues.put("ManagerType", ManagerType.trim());
        initialValues.put("ManagerName", ManagerName.trim());

        return db.insert(DATABASE_TABLE_MAIN261, null, initialValues);
    }

    public static LinkedHashMap<String, String> fetch_Manager_List()
    {
        //open();
        LinkedHashMap<String, String> hmapCatgry = new LinkedHashMap<String, String>();
        Cursor cursor = db.rawQuery("SELECT ManagerID,ManagerName FROM tblManagerMstr ",null);
        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
											/*if(i==0)
											{
												hmapCatgry.put("Select Manager", "00");
											}*/
                        hmapCatgry.put(cursor.getString(1).toString(),cursor.getString(0).toString());
                        cursor.moveToNext();
                    }
                }

            }

            else
            {
                hmapCatgry.put("No Manager", "0");
            }
            return hmapCatgry;
        }
        finally
        {
            cursor.close();
            //close();
        }
    }

    public static void deletetblSelectedManagerDetails()
    {
        //open();
        db.execSQL("DELETE FROM tblSelectedManagerDetails");

       // close();
    }

    public static int counttblSelectedManagerDetails()
    {
        Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblSelectedManagerDetails", null);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    public static String Fetch_tblSelectedManagerDetails()
    {
        //open();
        Cursor cursor = null;
        try
        {
            cursor = db.rawQuery("SELECT ManagerID,ManagerName  FROM tblSelectedManagerDetails", null);

            String RankOutletName = null;//[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {

                RankOutletName = (String) cursor.getString(0).toString()+ "_"
                        + (String) cursor.getString(1).toString();
                cursor.moveToNext();



            }
            return RankOutletName;
        } finally {
            cursor.close();
            //close();
        }

    }

    public static String fetchOtherNameBasicOfManagerID(int ManagerID)
    {
        int SnamecolumnIndex1 = 0;
        String LocIDDesc="0";
        Cursor cursor = db.rawQuery("SELECT  OtherName from tblSelectedManagerDetails where ManagerID='"+ManagerID+"'", null);
        try {

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    LocIDDesc = (String) cursor.getString(SnamecolumnIndex1).toString().trim();

                    cursor.moveToNext();
                }

            }
            return LocIDDesc;
        } finally {
            cursor.close();
        }


    }

    public static long savetblSelectedManagerDetails(String IMEI,String CurDate,String PersonID,
                                              String PersonType, String  PersonName, String ManagerID, String ManagerType,
                                              String ManagerName,String OtherName)
    {

        ContentValues initialValues = new ContentValues();
        initialValues.put("IMEI", IMEI.trim());
        initialValues.put("CurDate", CurDate.trim());
        initialValues.put("PersonID", PersonID.trim());
        initialValues.put("PersonType", PersonType.trim());
        initialValues.put("PersonName", PersonName.trim());
        initialValues.put("ManagerID", ManagerID.trim());
        initialValues.put("ManagerType", ManagerType.trim());
        initialValues.put("ManagerName", ManagerName.trim());
        initialValues.put("OtherName", OtherName.trim());
        initialValues.put("Sstat", 3);

        return db.insert(DATABASE_TABLE_MAIN262, null, initialValues);
    }

    public static String fetchtblManagerMstr(String ManagerID)
    {
        //open();
        int SnamecolumnIndex1 = 0;
        String LocIDDesc="0";
        Cursor cursor = null;
        try
        {
            cursor = db.rawQuery("SELECT  * from tblManagerMstr where ManagerID='"+ManagerID+"'", null);


            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    LocIDDesc = (String) cursor.getString(0).toString().trim()+"^"+(String) cursor.getString(1).toString().trim()+"^"+(String) cursor.getString(2).toString().trim()+"^"+(String) cursor.getString(3).toString().trim()+"^"+(String) cursor.getString(4).toString().trim()+"^"+(String) cursor.getString(5).toString().trim();

                    cursor.moveToNext();
                }

            }
            return LocIDDesc;
        } finally {
            cursor.close();
           // close();
        }


    }

    public static void droptblManagerMstr()
    {
        db.execSQL("DROP TABLE IF EXISTS tblManagerMstr");
        db.execSQL("DROP TABLE IF EXISTS tblSelectedManagerDetails");

    }

    public static void createtblManagerMstr()
    {
        try
        {
            db.execSQL(DATABASE_CREATE_TABLE_261);
            db.execSQL(DATABASE_CREATE_TABLE_262);
        }
        catch (Exception e)
        {

        }

    }

    public static void Delete_tblRouteMasterAndDistributorMstr()
    {
        db.execSQL("DELETE FROM tblRouteListMaster");

    }

    public static void Delete_tblManagerMstr()
    {
        //db.execSQL("DELETE FROM tblManagerMstr");
        //db.execSQL("DELETE FROM tblSelectedManagerDetails");
    }



    public static String[] getSuplierData()
    {
        Cursor cursor2=null;
        try {
            cursor2 = db.rawQuery("SELECT *  FROM tblSupplierMstrList", null);
            String strStoreTypeNamesDetais[] =null;// new String[cursor2.getCount()];
            if(cursor2.getCount()>0)
            {
                strStoreTypeNamesDetais=new String[cursor2.getCount()+1];
                if (cursor2.moveToFirst())
                {
                    for (int i = 0; i < cursor2.getCount(); i++)
                    {
                        if(i==0)
                        {
                            strStoreTypeNamesDetais[i]="0^0^Select Distributor";
                        }
                        strStoreTypeNamesDetais[i+1] = cursor2.getString(0).toString()+"^"+cursor2.getString(1)+"^"+cursor2.getString(2);
                        cursor2.moveToNext();
                    }
                }
            }
            else
            {
                strStoreTypeNamesDetais=new String[1];
                strStoreTypeNamesDetais[0]="0^0^Select Distributor";

            }
            return strStoreTypeNamesDetais;
        } finally {
            cursor2.close();
        }
    }

    public static String fetchSuplierIdByName(String Descr)
    {
        //open();
        Cursor cursor2=null;
        String strStoreTypeNamesDetais = "0^0";
        try {
            cursor2 = db.rawQuery("SELECT NodeType,NodeType FROM tblSupplierMstrList where Descr='"+Descr+"'", null);
            /*[] = new String[cursor2.getCount()]*/

            if (cursor2.moveToFirst())
            {
                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    strStoreTypeNamesDetais = cursor2.getInt(0)+"^"+cursor2.getInt(1);
                    cursor2.moveToNext();
                }
            }
            return strStoreTypeNamesDetais;
        }
        catch(Exception e)
        {
            System.out.println("EXCEPTION    "+e);
        }finally {

            cursor2.close();
            //close();
            return strStoreTypeNamesDetais;
        }
    }

    public static int fetchSuplierNodeTypeByID(int NodeID)
    {
        //open();
        Cursor cursor2=null;
        int strStoreTypeNamesDetais = 0;
        try {
            cursor2 = db.rawQuery("SELECT NodeType FROM tblSupplierMstrList where NodeID='"+NodeID+"'", null);
            /*[] = new String[cursor2.getCount()]*/

            if (cursor2.moveToFirst())
            {
                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    strStoreTypeNamesDetais = cursor2.getInt(0);
                    cursor2.moveToNext();
                }
            }
            return strStoreTypeNamesDetais;
        }
        catch(Exception e)
        {
            System.out.println("EXCEPTION    "+e);
        }finally {

            cursor2.close();
            //close();
            return strStoreTypeNamesDetais;
        }
    }

    public static String fetchProductNodeTypeByID(int ProductNodeID,int DistID,int DistNodeType)
    {
        //open();
        Cursor cursor2=null;
        String strStoreTypeNamesDetais = "0^0";
        try {
            cursor2 = db.rawQuery("SELECT ProductNodeType,StockDate FROM tblDistributorDayReport where ProductNodeID='"+ProductNodeID+"' and DistributorNodeID="+DistID+" and DistributorNodeType="+DistNodeType, null);
            /*[] = new String[cursor2.getCount()]*/

            if (cursor2.moveToFirst())
            {
                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    strStoreTypeNamesDetais = cursor2.getInt(0)+"^"+cursor2.getString(1).toString();
                    cursor2.moveToNext();
                }
            }
            return strStoreTypeNamesDetais;
        }
        catch(Exception e)
        {
            System.out.println("EXCEPTION    "+e);
        }finally {

            //cursor2.close();
           // close();
            return strStoreTypeNamesDetais;
        }
    }

    public static int countDataIntblDistributorSavedData(int DistribtrId,int DistributorNodeType,int Sstat)
    {
        //open();

        Cursor cursorE2=null;
        int chkI = 0;
        try {
            cursorE2 = db.rawQuery("SELECT * FROM tblDistributorSavedData WHERE DistribtrId="+DistribtrId+" and DistributorNodeType="+DistributorNodeType, null);

            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst()) {


                }		chkI = 1;

            }

        } finally {
            //cursorE2.close();
           // close();
        }
        return chkI;
    }

    public static int counttblDistributorSavedData()  throws IOException
    {
        int chkI = 0;
        try
        {
            //open();
            Cursor cursorE2 = db.rawQuery("SELECT * from tblSuplierMapping where Sstat=3", null);

            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst())
                {

                    chkI = 1;

                }
            }

        }
        catch(Exception e)
        {

        }
        finally
        {
            //cursorE2.close();
            //close();
        }
        return chkI;
    }

    public static void deleteDistributorStockTbles()
    {
        try
        {
            //open();

            db.execSQL("DELETE FROM tblDistributorDayReport");
            db.execSQL("DELETE FROM tblDistributorDayReportColumnsDesc");
            db.execSQL("DELETE FROM tblDistributorSavedData");
            db.execSQL("DELETE FROM tblDistributorOldStockData");
        }
        catch(Exception e)
        {

        }finally
        {
          //  close();
        }

    }

    public static String GetActiveRouteIDForDistributor()
    {
        int LoncolumnIndex = 0;
        String activeRouteID = "0";
        Cursor cursor2 = db.rawQuery("SELECT ID FROM tblRouteListMaster WHERE flgTodayRoute = 1 Limit 1", null);
        try
        {

            if (cursor2.moveToFirst())
            {

                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    activeRouteID = cursor2.getString(LoncolumnIndex);
                    cursor2.moveToNext();
                }

            }
            return activeRouteID;
        }
        finally
        {
            cursor2.close();
        }

    }

    public static void deleteDistributorStockTblesOnDistributorIDBasic(int DistributorNodeID,int DistributorNodeType)
    {
        try
        {
            //open();

            db.execSQL("DELETE FROM tblDistributorDayReport where DistributorNodeID="+DistributorNodeID+" and DistributorNodeType="+DistributorNodeType);
            db.execSQL("DELETE FROM tblDistributorDayReportColumnsDesc where DistributorNodeID="+DistributorNodeID+" and DistributorNodeType="+DistributorNodeType);
            db.execSQL("DELETE FROM tblDistributorSavedData where DistribtrId="+DistributorNodeID+" and DistributorNodeType="+DistributorNodeType);
            db.execSQL("DELETE FROM tblDistributorOldStockData where DistribtrId="+DistributorNodeID+" and DistributorNodeType="+DistributorNodeType);
        }
        catch(Exception e)
        {

        }finally
        {
            //close();
        }

    }

    public static LinkedHashMap<String,String> fetchtblDistribtrReport(int DistributorNodeID,int DistributorNodeType)
    {
        int ScodecolumnIndex = 0;

        Cursor cursor = null;
        LinkedHashMap<String, String> HmapDistrbutrReport;
        try {
            cursor = db.rawQuery("SELECT *  FROM tblDistributorDayReport where DistributorNodeType="+DistributorNodeID+" and DistributorNodeType="+DistributorNodeType, null);
            HmapDistrbutrReport=new LinkedHashMap<String, String>();

            if (cursor.moveToFirst()) {

                for (int i = 0; i < cursor.getCount(); i++)
                {
                    ScodecolumnIndex = 1;

                    HmapDistrbutrReport.put(cursor.getString(0).toString().trim()+"^"+(String) cursor.getString(3).toString().trim(), cursor.getString(1).toString().trim()+"^"+(String) cursor.getString(2).toString().trim());
                    //// System.out.println("Value inserting 231 fetching :"+allData[i]);
                    cursor.moveToNext();
                    // cursor.close();
                }

            }
            ////// System.out.println("value  of new store is in DBadapter"+ScodecolumnIndex);
            return HmapDistrbutrReport;
        } finally {
            cursor.close();
        }

    }

    public static ArrayList<String> fetchtblDistribtrReportColumnDesc(int DistributorNodeID,int DistributorNodeType)
    {
        int ScodecolumnIndex = 0;

        Cursor cursor = null;
        ArrayList<String> alist;
        try {
            cursor = db.rawQuery("SELECT *  FROM tblDistributorDayReportColumnsDesc where DistributorNodeID="+DistributorNodeID+" and DistributorNodeType="+DistributorNodeType, null);
            alist= new ArrayList<String>();

            if (cursor.moveToFirst())
            {
                for (int i = 0; i < cursor.getCount(); i++)
                {
                    if(i >4)
                    {
                        alist.add(cursor.getString(0)+"^"+cursor.getString(1).toString().trim());
                        System.out.println(cursor.getString(0).toString().trim()+"^"+cursor.getString(1).toString().trim());
                        //// System.out.println("Value inserting 231 fetching :"+allData[i]);
                        // cursor.close();
                    }
                    cursor.moveToNext();
                }

            }
            ////// System.out.println("value  of new store is in DBadapter"+ScodecolumnIndex);
            return alist;
        } finally {
            cursor.close();
        }
    }

    public static void Delete_tblDistributorSavedData(int DistribtrId,int DistributorNodeType)
    {
        try
        {
            //open();
            db.execSQL("DELETE FROM tblDistributorSavedData where DistribtrId="+DistribtrId+" and DistributorNodeType="+DistributorNodeType);
            db.execSQL("DELETE FROM tblDistributorOldStockData where DistribtrId="+DistribtrId+" and DistributorNodeType="+DistributorNodeType);
        }
        catch(Exception e)
        {

        }
        finally
        {
           // close();
        }
    }

    public static long savetblDistributorSavedData(String ProductName,String ShortName,String ProductID,String Date,String EnteredValue, int DistribtrId,int DistributorNodeType,int ProductNodeType,String StockDate, int Sstat,int EntryType,int StockPcsCaseType)
    {
        ContentValues initialValues = new ContentValues();

        initialValues.put("ProductName", ProductName.trim());
        initialValues.put("ShortName", ShortName.trim());
        initialValues.put("ProductID", ProductID.trim());
        initialValues.put("Date", Date.trim());
        initialValues.put("EnteredValue", EnteredValue.trim());
        initialValues.put("DistribtrId", DistribtrId);
        initialValues.put("DistributorNodeType", DistributorNodeType);
        initialValues.put("ProductNodeType", ProductNodeType);
        initialValues.put("EntryType", EntryType);
        initialValues.put("StockDate", StockDate);
        initialValues.put("StockPcsCaseType", StockPcsCaseType);


        initialValues.put("Sstat", Sstat);
        return db.insert(TABLE_tblDistributorSavedData, null, initialValues);
    }

    public static LinkedHashMap<String, String> fetchtblDistribtrMnthDates(int DistributorNodeID,int DistributorNodeType)
    {
        //open();
        int ScodecolumnIndex = 0;

        Cursor cursor = null;
        LinkedHashMap<String, String> HmapForDates;
        try {
            cursor = db.rawQuery("SELECT DistDayReportColumnDisplayName  FROM tblDistributorDayReportColumnsDesc where DistributorNodeID="+DistributorNodeID+" and DistributorNodeType="+DistributorNodeType, null);
            HmapForDates= new LinkedHashMap<String, String>();

            if (cursor.moveToFirst())
            {
                for (int i = 0; i < cursor.getCount(); i++)
                {
                    if(i >6)
                    {
                        HmapForDates.put(cursor.getString(0).toString().trim(),cursor.getString(0).toString().trim());
                        System.out.println(cursor.getString(0).toString().trim());
                    }
                    cursor.moveToNext();
                }


            }
            HmapForDates.put("01-01-1900","Older Stock");
            ////// System.out.println("value  of new store is in DBadapter"+ScodecolumnIndex);
            return HmapForDates;
        } finally {
            cursor.close();
           // close();
        }
    }

    public static String[] getDistinctProdctName(int DistributorNodeID,int DistributorNodeType)
    {
        int LoncolumnIndex = 0;

        Cursor cursor2=null;
        try {
            cursor2 = db.rawQuery("SELECT DISTINCT SKUName  FROM tblDistributorDayReport where DistributorNodeID="+DistributorNodeID+" and DistributorNodeType="+DistributorNodeType, null);
            String strStoreTypeNamesDetais[] = new String[cursor2.getCount()];

            if (cursor2.moveToFirst())
            {
                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    strStoreTypeNamesDetais[i] = cursor2.getString(0);
                    cursor2.moveToNext();
                }

            }
            return strStoreTypeNamesDetais;
        } finally {
            cursor2.close();
        }
    }

    public static String[] getPrdctIdAndSku(String SKUName,int DistribtrId,int DistributorNodeType)
    {
        int LoncolumnIndex = 0;

        Cursor cursor2=null;
        try {
            cursor2 = db.rawQuery("SELECT ProductNodeID,FlvShortName  FROM tblDistributorDayReport where SKUName='"+SKUName+"' and DistributorNodeID="+DistribtrId+" and DistributorNodeType="+DistributorNodeType, null);
            String strStoreTypeNamesDetais[] = new String[cursor2.getCount()];

            if (cursor2.moveToFirst())
            {
                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    strStoreTypeNamesDetais[i] = cursor2.getString(0)+"^"+cursor2.getString(1);
                    cursor2.moveToNext();
                }

            }
            return strStoreTypeNamesDetais;
        } finally {
            if(cursor2!=null) {
                cursor2.close();
            }
        }
    }

    public static LinkedHashMap<String,String> fetchtblDistribtrOldStockData(int DistribtrId,int DistribtrNodeType)
    {
        //open();
        int ScodecolumnIndex = 0;

        Cursor cursor = null;
        LinkedHashMap<String, String> HmapDistrbutrSavedData;
        try {
            cursor = db.rawQuery("SELECT DistribtrTag,EnteredValue  FROM tblDistributorOldStockData where  DistribtrId="+DistribtrId+" and DistributorNodeType="+DistribtrNodeType, null);
            HmapDistrbutrSavedData=new LinkedHashMap<String, String>();

            if (cursor.moveToFirst()) {

                for (int i = 0; i < cursor.getCount(); i++)
                {
                    ScodecolumnIndex = 1;

                    HmapDistrbutrSavedData.put(cursor.getString(0).toString().trim(),(String)cursor.getString(1).toString().trim());
                    //// System.out.println("Value inserting 231 fetching :"+allData[i]);
                    cursor.moveToNext();
                    // cursor.close();
                }
            }
            return HmapDistrbutrSavedData;
        } finally {
            //cursor.close();
            //close();
        }
    }

    public static LinkedHashMap<String,String> fetchtblDistribtrSavedData(int DistribtrId,int DistribtrNodeType)
    {
        //open();
        int ScodecolumnIndex = 0;

        Cursor cursor = null;
        LinkedHashMap<String, String> HmapDistrbutrSavedData;
        try {
            cursor = db.rawQuery("SELECT ProductID,Date,EnteredValue,DistribtrId,DistributorNodeType,EntryType  FROM tblDistributorSavedData where  DistribtrId="+DistribtrId+" and DistributorNodeType="+DistribtrNodeType, null);
            HmapDistrbutrSavedData=new LinkedHashMap<String, String>();

            if (cursor.moveToFirst()) {

                for (int i = 0; i < cursor.getCount(); i++)
                {
                    ScodecolumnIndex = 1;

                    HmapDistrbutrSavedData.put(cursor.getString(0).toString().trim()+"_"+(String)cursor.getString(1).toString().trim()+"_"+(String)cursor.getString(3).toString().trim()+"_"+(String)cursor.getString(4).toString().trim()+"_"+(String)cursor.getString(5).toString().trim(),(String)cursor.getString(2).toString().trim());
                    //// System.out.println("Value inserting 231 fetching :"+allData[i]);
                    cursor.moveToNext();
                    // cursor.close();
                }
            }
            return HmapDistrbutrSavedData;
        } finally {
            //cursor.close();
           // close();
        }



    }

    public static int fnGetDistributorStockPcsCaseType(int DistribtrId,int DistributorNodeType)
    {

        //open();
        int ScodecolumnIndex = 0;

        Cursor cursor = null;
        //LinkedHashMap<String, String> HmapDistrbutrSavedData;
        try {
            cursor = db.rawQuery("SELECT DISTINCT StockPcsCaseType  FROM tblDistributorSavedData where DistribtrId="+DistribtrId+" and DistributorNodeType="+DistributorNodeType, null);

            if (cursor.moveToFirst()) {

                for (int i = 0; i < cursor.getCount(); i++)
                {
                    ScodecolumnIndex = Integer.parseInt(cursor.getString(0).toString().trim());
                    cursor.moveToNext();
                }
            }
            return ScodecolumnIndex;
        } finally {
            //cursor.close();
           // close();
        }

    }

    public static String getDistinctStockDate()
    {
        //open();
        int LoncolumnIndex = 0;

        Cursor cursor2=null;
        try {
            cursor2 = db.rawQuery("SELECT DISTINCT StockDate  FROM tblDistributorDayReport", null);
            String strStoreTypeNamesDetais="NA";

            if (cursor2.moveToFirst())
            {
                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    strStoreTypeNamesDetais= cursor2.getString(0);
                    cursor2.moveToNext();
                }

            }
            return strStoreTypeNamesDetais;
        } finally {
            cursor2.close();
           // close();
        }
    }

    public static long savetblDistributorOldStockData(int DistribtrId,int DistributorNodeType,String DistribtrTag,String EnteredValue)
    {
        ContentValues initialValues = new ContentValues();

        initialValues.put("DistribtrId", DistribtrId);
        initialValues.put("DistributorNodeType", DistributorNodeType);
        initialValues.put("DistribtrTag", DistribtrTag.trim());
        initialValues.put("EnteredValue", EnteredValue.trim());

        return db.insert(TABLE_tblDistributorOldStockData, null, initialValues);
    }

    public static long savetblDistributorDayReportColumnsDesc(String DistDayReportCoumnName,String DistDayReportColumnDisplayName,int CustomerNodeID,int CustomerNodeType)
    {
        ContentValues initialValues = new ContentValues();

        initialValues.put("DistDayReportCoumnName", DistDayReportCoumnName);
        initialValues.put("DistDayReportColumnDisplayName", DistDayReportColumnDisplayName);
        initialValues.put("DistributorNodeID", CustomerNodeID);
        initialValues.put("DistributorNodeType", CustomerNodeType);

        return db.insert(TABLE_tblDistributorDayReportColumnsDesc, null, initialValues);
    }

    public static long savetblDistributorDayReport(String ProductNodeID,String ProductNodeType,String SKUName,String FlvShortName,String StockDate,int CustomerNodeID,int CustomerNodeType)
    {
        ContentValues initialValues = new ContentValues();

        initialValues.put("ProductNodeID", ProductNodeID);
        initialValues.put("ProductNodeType", ProductNodeType.trim());
        initialValues.put("SKUName", SKUName.trim());
        initialValues.put("FlvShortName", FlvShortName.trim());
        initialValues.put("StockDate", StockDate.trim());
        initialValues.put("DistributorNodeID", CustomerNodeID);
        initialValues.put("DistributorNodeType", CustomerNodeType);
        return db.insert(TABLE_tblDistributorDayReport, null, initialValues);
    }

    public static void updateDistributorSstat()
    {

        try
        {

            final ContentValues values = new ContentValues();
            values.put("Sstat", "4");
            int affected = db.update("tblDistributorSavedData", values, "Sstat=?",new String[] { "3" });

        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }
    }

    public static void updateDistributorCheckInSstat()
    {

        try
        {

            final ContentValues values = new ContentValues();
            values.put("Sstat", "4");
            int affected = db.update("tblDistributorSavedData", values, "Sstat=?",new String[] { "3" });
            int affected1 = db.update("tblSuplierMapping", values, "Sstat=?",new String[] { "3" });
        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }
    }

    public static long savetblTargetVsAchievedNote(String msgToDisplay)
    {
        //DATABASE_TABLE_MAIN236 = "create table tblTargetVsAchievedNote (MsgToDisplay text null);";
        ContentValues initialValues = new ContentValues();

        initialValues.put("MsgToDisplay", msgToDisplay);


        return db.insert(DATABASE_TABLE_MAIN236, null, initialValues);
    }

    public static String fetchNoteFromtblTargetVsAchievedNote()
    {
        //open();
        int ScodecolumnIndex = 0;
        ////DATABASE_TABLE_MAIN236 = "create table tblTargetVsAchievedNote (MsgToDisplay text null);";

        try {
            Cursor cursor = db.rawQuery("SELECT MsgToDisplay  FROM tblTargetVsAchievedNote", null);
            String note="";
            if (cursor.moveToFirst()) {

                for (int i = 0; i < cursor.getCount(); i++)
                {
                    ScodecolumnIndex = 1;
                    note =  cursor.getString(0);
                    //// System.out.println("Value inserting 231 fetching :"+allData[i]);
                    cursor.moveToNext();
                    // cursor.close();
                }

            }
            ////// System.out.println("value  of new store is in DBadapter"+ScodecolumnIndex);
            return note;
        } finally {

           // close();
        }

    }

    public static long savetblStoreWiseTarget(String StoreID, String TargetValue)
    {

        ContentValues initialValues = new ContentValues();



        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("TargetValue", TargetValue.trim());

        return db.insert(DATABASE_TABLE_MAIN23, null, initialValues);
    }

    public static long savetblTargetVsAchievedSummary(int AutoId,String Descr,String TodayTarget,String TodayAchieved,String TodayBal,
                                               String Todayflg,String MonthTarget,String MonthAchieved,String MonthBal,String Monthflg,int flgValTgtOrPrdct)
    {
        //ValTgtOrPrdctFlg
        ContentValues initialValues = new ContentValues();

        initialValues.put("AutoId", AutoId);
        initialValues.put("Descr", Descr.trim());
        initialValues.put("TodayTarget", TodayTarget.trim());
        initialValues.put("TodayAchieved", TodayAchieved.trim());
        initialValues.put("TodayBal", TodayBal.trim());
        initialValues.put("Todayflg", Todayflg.trim());
        initialValues.put("MonthTarget", MonthTarget.trim());
        initialValues.put("MonthAchieved", MonthAchieved.trim());
        initialValues.put("MonthBal", MonthBal.trim());
        initialValues.put("Monthflg", Monthflg.trim());
        initialValues.put("ValTgtOrPrdctFlg", flgValTgtOrPrdct);


        return db.insert(DATABASE_TABLE_MAIN235, null, initialValues);
    }

    public static String GetActiveRouteIDSunilAgain()
    {
        int LoncolumnIndex = 0;
        String activeRouteID = "0";
        // //open();
        Cursor cursor2 = null;
        try
        {
            cursor2 = db.rawQuery("SELECT ID FROM tblRouteListMaster WHERE flgTodayRoute = 1 Limit 1", null);


            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    activeRouteID = cursor2.getString(LoncolumnIndex);
                    cursor2.moveToNext();

                }

            }
            if(!CommonInfo.ActiveRouteSM.equals("0"))
            {
                activeRouteID= CommonInfo.ActiveRouteSM;
            }
            return activeRouteID;
        } finally {
            cursor2.close();
            //close();
        }

    }

    public static void Delete_tblStoreWiseTarget()
    {
        db.execSQL("DELETE FROM tblStoreWiseTarget");
    }

    public static String fetchtblStoreWiseTarget(String StoreID)
    {

        //open();
        String LocIDDesc="0";
        Cursor cursor = db.rawQuery("SELECT  TargetValue from tblStoreWiseTarget where StoreID='"+StoreID+"'", null);
        try
        {

            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    LocIDDesc = (String) cursor.getString(0).toString().trim();
                    cursor.moveToNext();
                }

            }
            return LocIDDesc;
        }
        finally
        {
            cursor.close();
           // close();
        }


    }

    public static ArrayList<Object> fetchIncentiveData()
    {
        ArrayList<Object> arrlstObjects=new ArrayList<Object>();
        ArrayList<LinkedHashMap<String, ArrayList<String>>> array=new ArrayList<LinkedHashMap<String,ArrayList<String>>>();;
        LinkedHashMap<String, ArrayList<String>> HmapMstrData=new LinkedHashMap<String, ArrayList<String>>();


        LinkedHashMap<String, ArrayList<String>> HmapIncPastDetailData=new LinkedHashMap<String, ArrayList<String>>();
        LinkedHashMap<String, ArrayList<String>> HmapInnerData=new LinkedHashMap<String, ArrayList<String>>();
        String total_earning="0",Incentive_msg="NA";

        //open();
        try
        {
            Cursor cursor = db.rawQuery("SELECT tblIncentiveMaster.IncId,OutputType,IncentiveName,count(tblIncentiveDetailsColumnsDesc.IncId) as ColumnCount,flgAcheived,Earning FROM tblIncentiveMaster INNER JOIN tblIncentiveDetailsColumnsDesc ON tblIncentiveMaster.IncId = tblIncentiveDetailsColumnsDesc.IncId group by tblIncentiveDetailsColumnsDesc.IncId", null);

            if(cursor.getCount() >0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i < cursor.getCount(); i++)
                    {
                        ArrayList<String> list_frstTbl=new ArrayList<String>();
                        list_frstTbl.add(0,cursor.getString(1).toString().trim()); //output type
                        list_frstTbl.add(1,cursor.getString(2).toString().trim()); //incentive name
                        list_frstTbl.add(2,cursor.getString(3).toString().trim()); //count of incId frm columndesc tbl
                        list_frstTbl.add(3,cursor.getString(4).toString().trim()); //flgAchieved
                        list_frstTbl.add(4,cursor.getString(5).toString().trim()); //Earning

                        HmapMstrData.put(cursor.getString(0).toString().trim(), list_frstTbl);

                        HmapInnerData.put(cursor.getString(0).toString().trim(),fetchIncentiveInnerData(cursor.getString(0).toString().trim()));

                        ArrayList<String> list_pastDetail=new ArrayList<String>();
                        list_pastDetail=fetchIncPastDetailData(cursor.getString(0).toString().trim());
                        if(!list_pastDetail.isEmpty())
                        {
                            HmapIncPastDetailData.put(cursor.getString(0).toString().trim(),list_pastDetail);
                        }

                        list_frstTbl.add(5,String.valueOf(getCountFromIncPastDetails(cursor.getString(0).toString().trim())));

                        cursor.moveToNext();
                    }

                    array.add(HmapMstrData);
                    array.add(HmapInnerData);
                    array.add(HmapIncPastDetailData);
                    arrlstObjects.add(array);
                    total_earning=fetchTotalEarning();
                    arrlstObjects.add(total_earning);
                    Incentive_msg=getMsgToDisplay();
                    arrlstObjects.add(Incentive_msg);
                }
            }

        }
        catch(Exception e)
        {
            System.out.println("EXception.."+e);
        }
        finally
        {
           // close();
        }
        return arrlstObjects;
    }

    public static ArrayList<String> fetchIncentiveInnerData(String IncId)
    {
        LinkedHashMap<String, ArrayList<String>> HmapInnerData=new LinkedHashMap<String, ArrayList<String>>();
        String columnIncentives="";
        String columnIncentivesForTableDisplay="";
        ArrayList<String> list_frstTbl=new ArrayList<String>();
        int ColumnCount=0;
        try
        {
            Cursor cursor = db.rawQuery("SELECT Distinct ReportColumnName,DisplayColumnName FROM tblIncentiveDetailsColumnsDesc where IncId='"+IncId+"'", null);

            if(cursor.getCount() >0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i < cursor.getCount(); i++)
                    {
                        ArrayList<String> arrIncenticeData=new ArrayList<String>();
                        if(columnIncentives.equals(""))
                        {
                            columnIncentives="IFNULL("+cursor.getString(0).toString().trim()+",' ')";
                            columnIncentivesForTableDisplay=cursor.getString(1).toString().trim();
                            ColumnCount=0;
                        }
                        else
                        {
                            columnIncentives=columnIncentives+",IFNULL("+cursor.getString(0).toString().trim()+",' ')";;
                            columnIncentivesForTableDisplay=columnIncentivesForTableDisplay+"^"+cursor.getString(1).toString().trim();
                            ColumnCount=ColumnCount+1;

                        }
											/*	ArrayList<String> list_frstTbl=new ArrayList<String>();
												list_frstTbl.add(cursor.getString(1).toString().trim()); //column desc to show in tbl

												;*/

                        if(i==(cursor.getCount()-1))
                        {
                            list_frstTbl.add(columnIncentivesForTableDisplay);
                            arrIncenticeData=fetchColumnData(IncId,columnIncentives,ColumnCount,list_frstTbl);
                        }

                        cursor.moveToNext();
                    }

                }
            }
            return list_frstTbl;
        }
        finally
        {
        }
    }

    public static ArrayList<String> fetchColumnData(String IncId,String columnIncentives,int ColumnCount,ArrayList<String> list_frstTbl)
    {
        try
        {
            Cursor cursor = db.rawQuery("SELECT "+columnIncentives+" FROM tblIncentiveDetailsData where IncId='"+IncId+"'", null);

            System.out.println("PASSED INFO..."+"IncId:"+IncId+" columnIncentives:"+columnIncentives+" ColumnCount:"+ColumnCount);
            if(cursor.getCount() >0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i < cursor.getCount(); i++)
                    {
                        Boolean val=false;
                        String incentiveColumnsData="";
                        for(int j=0;j <= ColumnCount;j++)
                        {
                            if(incentiveColumnsData.equals("") && val == false)
                            {
                                incentiveColumnsData=cursor.getString(j).toString().trim();
                                val=true;
                            }
                            else
                            {
                                if(j == (ColumnCount))
                                {
                                    if(cursor.getString(j).toString().trim().equals(""))
                                    {
                                        incentiveColumnsData=incentiveColumnsData+"^"+"NA";
                                        System.out.println("j:"+j+"-"+incentiveColumnsData+"-"+cursor.getColumnName(j).toString());
                                    }
                                    else
                                    {
                                        incentiveColumnsData=incentiveColumnsData+"^"+cursor.getString(j).toString().trim();
                                    }

                                    System.out.println("END OF LOOP: "+"IncId"+IncId+"-"+incentiveColumnsData);
                                }
                                else
                                {
                                    incentiveColumnsData=incentiveColumnsData+"^"+cursor.getString(j).toString().trim();
                                }
                            }

                        }
                        list_frstTbl.add(incentiveColumnsData); //column desc to show in tbl
                        cursor.moveToNext();
                    }
                }
            }
            return list_frstTbl;
        }
        finally
        {
        }
    }

    public static String fetchTotalEarning()
    {
        String total_earning="NA";
        try
        {
            Cursor cursor = db.rawQuery("SELECT Total_Earning FROM tblTotalEarning", null);

            if(cursor.getCount() >0)
            {
                if (cursor.moveToFirst())
                {
                    total_earning=cursor.getString(0).toString().trim();
                    System.out.println("TOTAL EARNING: "+total_earning);
                    cursor.moveToNext();
                }
            }
        }
        finally
        {
            return total_earning;
        }
    }

    public static ArrayList<String> fetchIncPastDetailData(String IncId)
    {
        LinkedHashMap<String, ArrayList<String>> HmapInnerData=new LinkedHashMap<String, ArrayList<String>>();

        String columnIncentives="";
        String columnIncentivesForTableDisplay="";
        ArrayList<String> list_frstTbl=new ArrayList<String>();
        int ColumnCount=0;

        try
        {
            Cursor cursor = db.rawQuery("SELECT Distinct ReportColumnName,DisplayColumnName FROM tblIncentivePastDetailsColumnsDesc where IncId='"+IncId+"'", null);

            if(cursor.getCount() >0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i < cursor.getCount(); i++)
                    {
                        ArrayList<String> arrIncenticeData=new ArrayList<String>();

                        if(columnIncentives.equals(""))
                        {
                            columnIncentives=cursor.getString(0).toString().trim();
                            columnIncentivesForTableDisplay=cursor.getString(1).toString().trim();
                            ColumnCount=0;
                        }
                        else
                        {
                            columnIncentives=columnIncentives+","+cursor.getString(0).toString().trim();
                            columnIncentivesForTableDisplay=columnIncentivesForTableDisplay+"^"+cursor.getString(1).toString().trim();
                            ColumnCount=ColumnCount+1;
                        }

                        if(i==(cursor.getCount()-1)) //in end
                        {
                            list_frstTbl.add(columnIncentivesForTableDisplay);
                            fetchIncPastDetailColumnData(IncId,columnIncentives,ColumnCount,list_frstTbl);
                        }

                        cursor.moveToNext();
                    }
                }
            }
            return list_frstTbl;
        }
        finally
        {
        }
    }

    public static void fetchIncPastDetailColumnData(String IncId,String columnIncentives,int ColumnCount,ArrayList<String> list_frstTbl)
    {
        try
        {
            Cursor cursor = db.rawQuery("SELECT "+columnIncentives+" FROM tblIncentivePastDetailsData where IncId='"+IncId+"'", null);

            if(cursor.getCount() >0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i < cursor.getCount(); i++)
                    {
                        String incentiveColumnsData="";

                        for(int j=0;j<=ColumnCount;j++)
                        {
                            if(incentiveColumnsData.equals(""))
                            {
                                incentiveColumnsData=cursor.getString(j).toString().trim();
                            }
                            else
                            {
                                incentiveColumnsData=incentiveColumnsData+"^"+cursor.getString(j).toString().trim();
                            }
                        }
                        list_frstTbl.add(incentiveColumnsData); //column desc to show in tbl
                        cursor.moveToNext();
                    }
                }
            }
        }
        finally
        {
        }
    }

    public static int getCountFromIncPastDetails(String IncId)
    {
        int cal=0;
        try
        {
            Cursor cursor = db.rawQuery("SELECT IncId as ColumnCount FROM tblIncentivePastDetailsColumnsDesc where IncId='"+IncId+"'", null);

            if(cursor.getCount() >0)
            {
                cal=cursor.getCount();
                System.out.println("COUNT..."+cal+"INC ID.."+IncId);
            }
        }
        finally
        {
        }
        return cal;
    }

    public static long savetblIncentiveMsgToDisplay(String MsgToDisplay)
    {
        ContentValues initialValues = new ContentValues();

        initialValues.put("MsgToDisplay", MsgToDisplay);
        System.out.println("MSG..."+MsgToDisplay);
        return db.insert(TABLE_tblIncentiveMsgToDisplay_Define, null, initialValues);
    }

    public static String getMsgToDisplay()
    {
        String val="NA";
        try
        {
            Cursor cursor = db.rawQuery("SELECT MsgToDisplay FROM tblIncentiveMsgToDisplay", null);

            if(cursor.getCount() >0)
            {
                if (cursor.moveToFirst())
                {
                    val=cursor.getString(0).toString().trim();
                    System.out.println("MSG FETCHED..."+val);
                }
            }
        }
        finally
        {
        }
        return val;
    }

    public static void truncatetblTargetVsAchievedSummary()
    {
        db.execSQL("DELETE FROM tblTargetVsAchievedSummary");

    }

    public static String[] fetchAllDataFromtblTargetVsAchievedSummary()
    {
        int ScodecolumnIndex = 0;
        //open();
        Cursor cursor = db.rawQuery("SELECT *  FROM tblTargetVsAchievedSummary", null);
        try {
            String allData[]=new String[cursor.getCount()];
            if (cursor.moveToFirst()) {

                for (int i = 0; i < cursor.getCount(); i++)
                {
                    ScodecolumnIndex = 1;
                    //tblTargetVsAchievedSummary (AutoId int not null,Descr text null," +
                    //"TodayTarget text null,TodayAchieved text null,TodayBal text null,Todayflg text null,
                    //MonthTarget text null,MonthAchieved text null,MonthBal text null,Monthflg text null,ValTgtOrPrdctFlg int not null);";
                    allData[i] = (String) cursor.getString(0).toString().trim()+"^"+(String) cursor.getString(1).toString().trim()+"^"+(String) cursor.getString(2).toString().trim()+"^"+(String) cursor.getString(3).toString().trim()+"^"+(String) cursor.getString(4).toString().trim()+"^"+(String) cursor.getString(5).toString().trim()+"^"+(String) cursor.getString(6).toString().trim()+"^"+(String) cursor.getString(7).toString().trim()+"^"+(String) cursor.getString(8).toString().trim()+"^"+(String) cursor.getString(9).toString().trim()+"^"+String.valueOf(cursor.getInt(10));
                    //// System.out.println("Value inserting 231 fetching :"+allData[i]);
                    cursor.moveToNext();
                    // cursor.close();
                }

            }
            ////// System.out.println("value  of new store is in DBadapter"+ScodecolumnIndex);
            return allData;
        } finally {
            cursor.close();
            //close();
        }

    }

    public static long savetblIncentiveMaster(int IncId,int OutputType,String IncentiveName,String flgAcheived,String Earning)
    {
        ContentValues initialValues = new ContentValues();

        initialValues.put("IncId", IncId);
        initialValues.put("OutputType", OutputType);
        initialValues.put("IncentiveName", IncentiveName.trim());
        initialValues.put("flgAcheived", flgAcheived.trim());
        initialValues.put("Earning", Earning.trim());

        return db.insert(TABLE_tblIncentiveMaster, null, initialValues);
    }

    public static void CreateDynamicTables(String Table_Name, String TableColumn[])
    {
        db.execSQL("DROP TABLE IF EXISTS " + Table_Name);

        for(int i=0;i<TableColumn.length;i++)
        {
            if(i==0)
            {
                DATABASE_CREATE_TABLE_tblIncentiveDetailsData="CREATE TABLE " + Table_Name + "(" + TableColumn[0]+ " TEXT";
            }
            else
            {
                DATABASE_CREATE_TABLE_tblIncentiveDetailsData=DATABASE_CREATE_TABLE_tblIncentiveDetailsData+", "+TableColumn[i]+ " TEXT";
            }
        }
        DATABASE_CREATE_TABLE_tblIncentiveDetailsData=DATABASE_CREATE_TABLE_tblIncentiveDetailsData+ " );";
        db.execSQL(DATABASE_CREATE_TABLE_tblIncentiveDetailsData);

        System.out.println("hi");

    }

    public static void insertDynamicTables(String Table_Name,String[] TableColumn,String TableColumnValue[])
    {
        ContentValues cv = new ContentValues();

        for(int i=0;i<TableColumn.length;i++)
        {
            cv.put(TableColumn[i], TableColumnValue[i]);
        }

        db.insert(Table_Name, null, cv);
    }

    public static void CreateDynamicTblIncPastDetails(String Table_Name, String TableColumn[])
    {
        db.execSQL("DROP TABLE IF EXISTS " + Table_Name);

        for(int i=0;i<TableColumn.length;i++)
        {
            if(i==0)
            {
                DATABASE_CREATE_TABLE_tblIncentivePastDetailsData="CREATE TABLE " + Table_Name + "(" + TableColumn[0]+ " TEXT";
            }
            else
            {
                DATABASE_CREATE_TABLE_tblIncentivePastDetailsData=DATABASE_CREATE_TABLE_tblIncentivePastDetailsData+", "+TableColumn[i]+ " TEXT";
            }
        }
        DATABASE_CREATE_TABLE_tblIncentivePastDetailsData=DATABASE_CREATE_TABLE_tblIncentivePastDetailsData+ " );";
        db.execSQL(DATABASE_CREATE_TABLE_tblIncentivePastDetailsData);

        System.out.println("hi");
    }

    public static long savetblIncentiveDetailsColumnsDesc(int IncId,String ReportColumnName,String DisplayColumnName)
    {
        ContentValues initialValues = new ContentValues();

        initialValues.put("IncId", IncId);
        initialValues.put("ReportColumnName", ReportColumnName.trim());
        initialValues.put("DisplayColumnName", DisplayColumnName.trim());

        return db.insert(TABLE_tblIncentiveDetailsColumnsDesc, null, initialValues);
    }

    public static long savetblIncentivePastDetailsColumnsDesc(int IncId,String ReportColumnName,String DisplayColumnName, String Ordr)
    {
        ContentValues initialValues = new ContentValues();

        initialValues.put("IncId", IncId);
        initialValues.put("ReportColumnName", ReportColumnName.trim());
        initialValues.put("DisplayColumnName", DisplayColumnName.trim());
        initialValues.put("Ordr", Ordr.trim());

        return db.insert(TABLE_tblIncentivePastDetailsColumnsDesc, null, initialValues);
    }

    public static long savetblTotalEarning(String Total_Earning)
    {
        ContentValues initialValues = new ContentValues();

        initialValues.put("Total_Earning", Total_Earning.trim());

        return db.insert(TABLE_tblTotalEarning, null, initialValues);
    }

    public static void deleteIncentivesTbles()
    {
        try
        {
            db.execSQL("DELETE FROM tblIncentiveMaster");
            db.execSQL("DELETE FROM tblIncentiveDetailsColumnsDesc");
            db.execSQL("DELETE FROM tblIncentivePastDetailsColumnsDesc");
            db.execSQL("DELETE FROM tblTotalEarning");
            db.execSQL("DELETE FROM tblIncentiveMsgToDisplay");

        }
        catch(Exception e)
        {	}
        finally
        {
        }
    }

    public static void insertRestartStoreInfo(String prvsStoreID, String CrntStoreID, String isSavedOrSubmittedStore, String MsgToRestartPopUpShown, String isRestartDoneByDSR, int Sstat, String ActionTime)
    {
        //tblsameLocationForStoreRestartDone(UniqueID INTEGER PRIMARY KEY AUTOINCREMENT,prvsStoreID text null,CrntStoreID text null,isSavedOrSubmittedStore text null,is MsgToRestartPopUpShown text null,isRestartDoneByDSR text null ,prvsStoreFlag text null,Sstat text null);";
        //open();

        Cursor cursor=db.rawQuery("Select prvsStoreID from tblsameLocationForStoreRestartDone where prvsStoreID='"+CrntStoreID+"'",null);

        ContentValues values = new ContentValues();





        values.put("Sstat",Sstat);

        if(cursor.getCount()>0)
        {


            db.update(DATABASE_TABLE_tblSameLocationForStoreRestartDone,values,"prvsStoreID=?",new String[]{prvsStoreID});
        }
        else
        {
            fnDeleteFlgStoreUnusedPrvs("0");

            values.put("ActionTime",ActionTime);
            values.put("CrntStoreID",CrntStoreID);
            values.put("prvsStoreID",prvsStoreID);
            values.put("isMsgToRestartPopUpShown",MsgToRestartPopUpShown);
            values.put("isSavedOrSubmittedStore",isSavedOrSubmittedStore);
            values.put("isRestartDoneByDSR",isRestartDoneByDSR);
            db.insert(DATABASE_TABLE_tblSameLocationForStoreRestartDone,null,values);
        }


        //close();


    }

    public static void updateMsgToRestartPopUpShown(String prvsStoreId, String visitSTime)
    {
        //open();
        ContentValues values=new ContentValues();
        values.put("isMsgToRestartPopUpShown","1");
        values.put("ActionTime",visitSTime);
        db.update(DATABASE_TABLE_tblSameLocationForStoreRestartDone,values,"prvsStoreID=?",new String[]{prvsStoreId});
       // close();
    }

    public static boolean isPrvsStoreMsgShownAndRestrtDone(String prvsStoreId)
    {
        //open();
        boolean isToShowPopUpForResart=true;
        try {
            Cursor cur=db.rawQuery("Select prvsStoreID from tblsameLocationForStoreRestartDone where isMsgToRestartPopUpShown='1' AND isRestartDoneByDSR='1' AND prvsStoreID='"+prvsStoreId+"'",null);
            if(cur.getCount()>0)
            {
                isToShowPopUpForResart=false;
            }
        }
        catch(Exception e)
        {

        }
        finally {
            //close();
            return isToShowPopUpForResart;
        }

    }

    public static String PrvsStoreMsgShownAndRestrtDone()
    {
        //open();
        String storeShowPopUpForResartAndDone="";
        try {
            Cursor cur=db.rawQuery("Select prvsStoreID from tblsameLocationForStoreRestartDone where isMsgToRestartPopUpShown='1' AND isRestartDoneByDSR='1' AND UniqueID=(SELECT MAX(UniqueID) FROM tblsameLocationForStoreRestartDone)",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    storeShowPopUpForResartAndDone=cur.getString(0);
                }

            }
            else
            {
                cur.close();
                Cursor cursor=db.rawQuery("Select prvsStoreID from tblsameLocationForStoreRestartDone where isMsgToRestartPopUpShown='1' AND isRestartDoneByDSR='0' AND UniqueID=(SELECT MAX(UniqueID) FROM tblsameLocationForStoreRestartDone)",null);
                if(cursor.getCount()>0)
                {
                    if(cursor.moveToFirst())
                    {
                        storeShowPopUpForResartAndDone=cursor.getString(0);
                    }

                }
            }
        }
        catch(Exception e)
        {
            e.printStackTrace();
        }
        finally {
           // close();
            return storeShowPopUpForResartAndDone;
        }

    }

    public static void updateisRestartDoneByDSR(String prvsStoreId)
    {
        //open();
        ContentValues values=new ContentValues();
        values.put("isRestartDoneByDSR","1");
        db.update(DATABASE_TABLE_tblSameLocationForStoreRestartDone,values,"prvsStoreID=?",new String[]{prvsStoreId});
        //close();
    }

    public static void updateCurrentStoreId(String crntStoreID, String prvsStoreId)
    {
        //open();
        ContentValues values=new ContentValues();
        values.put("CrntStoreID",crntStoreID);
        db.update(DATABASE_TABLE_tblSameLocationForStoreRestartDone,values,"prvsStoreID=?",new String[]{prvsStoreId});
        //close();
    }

    public static String getPreviousStoreId()
    {
        String prvsStoreId="";
        //open();
        try {
            Cursor cursor=db.rawQuery("Select prvsStoreID from tblsameLocationForStoreRestartDone where UniqueID=(SELECT MAX(UniqueID) FROM tblsameLocationForStoreRestartDone)",null);
            if(cursor.getCount()>0)
            {
                if(cursor.moveToFirst())
                {
                    prvsStoreId=cursor.getString(0);
                }

            }
        }catch (Exception e)
        {
            e.printStackTrace();
        }
        finally {
           // close();
            return prvsStoreId;
        }

    }

    public static String getPreviousShownPopUpStoreId()
    {
        String prvsStoreId="";
        //open();
        try {
            Cursor cursor=db.rawQuery("Select prvsStoreID from tblsameLocationForStoreRestartDone where UniqueID=(SELECT MAX(UniqueID) FROM tblsameLocationForStoreRestartDone) AND isMsgToRestartPopUpShown='1'",null);
            if(cursor.getCount()>0)
            {
                if(cursor.moveToFirst())
                {
                    prvsStoreId=cursor.getString(0);
                }

            }
        }catch (Exception e)
        {

        }
        finally {
            //close();
            return prvsStoreId;
        }

    }

    public static void fnDeleteFlgStoreUnusedPrvs(String MsgToRestartPopUpShown) {
        try {
            db.execSQL("DELETE FROM tblsameLocationForStoreRestartDone WHERE isMsgToRestartPopUpShown='"+ MsgToRestartPopUpShown + "'");// and sectionID="+sectionID
        }
        catch (Exception e)
        {

        }


    }

    public static String[] getAllStoreIDIntblNewAddedStorePhotoDetail()
    {

        int SnamecolumnIndex1 = 0;


        Cursor cursor = db.rawQuery("SELECT DISTINCT(StoreID) FROM tableImage where Sstat=5", null);
        //Cursor cursor = db.rawQuery("SELECT StoreID FROM tblStoreMaterialPhotoDetail", null);
        try
        {
            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst())
            {
                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1).toString();
                    cursor.moveToNext();
                }
            }

            return StoreName;
        }
        finally
        {
            cursor.close();
        }

    }

    public static String[] getAllStoreIDIntblStoreCheckIn()
    {

        int SnamecolumnIndex1 = 0;


        Cursor cursor = db.rawQuery("SELECT DISTINCT(StoreID) FROM tblStoreCheckInPic where Sstat=5", null);
        //Cursor cursor = db.rawQuery("SELECT StoreID FROM tblStoreMaterialPhotoDetail", null);
        try
        {
            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst())
            {
                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1).toString();
                    cursor.moveToNext();
                }
            }

            return StoreName;
        }
        finally
        {
            cursor.close();
        }

    }

    public static int getExistingPicNosForNewAddedStore(String StoreID)
    {

        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT Count(StoreID) FROM tableImage where StoreID='" + StoreID + "'", null);
        try {
            int strProdStockQty = 0;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    if (!cursor.isNull(ScodecolumnIndex)) {
                        strProdStockQty = Integer.parseInt(cursor.getString(ScodecolumnIndex).toString());
                        cursor.moveToNext();
                    }

                }
            }
            return strProdStockQty;
        } finally {
            cursor.close();
        }
    }

    public static int getExistingPicNosForStoreCheckIn(String StoreID)
    {

        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT Count(StoreID) FROM tblStoreCheckInPic where StoreID='" + StoreID + "'", null);
        try {
            int strProdStockQty = 0;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    if (!cursor.isNull(ScodecolumnIndex)) {
                        strProdStockQty = Integer.parseInt(cursor.getString(ScodecolumnIndex).toString());
                        cursor.moveToNext();
                    }

                }
            }
            return strProdStockQty;
        } finally {
            cursor.close();
        }
    }

    public static String[] getImgsPathForNewAddedStore(String StoreID)
    {

        int SnamecolumnIndex1 = 0;

        Cursor cursor = db.rawQuery("SELECT imageName FROM tableImage WHERE StoreID ='"+ StoreID + "'", null);
        try
        {

            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {

                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1).toString();
                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }

    }

    public static String[] getImgsPathForStoreCheckIn(String StoreID)
    {

        int SnamecolumnIndex1 = 0;

        Cursor cursor = db.rawQuery("SELECT imageName FROM tblStoreCheckInPic WHERE StoreID ='"+ StoreID + "'", null);
        try
        {

            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {

                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1).toString();
                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }

    }

    public static void updateImageRecordsSyncdForNewAddedStore(String PhotoName)
    {

        try
        {
            //open();
            //System.out.println("Sunil Doing Testing Response after sending Image inside BD" + PhotoName);
            final ContentValues values = new ContentValues();
            values.put("Sstat", 4);

            int affected3 = db.update("tableImage", values, "imageName=?",new String[] { PhotoName });
        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }
        finally
        {
           // close();
        }


    }

    public static void updateImageRecordsSyncdForStoreCheckIN(String PhotoName)
    {

        try
        {
            //open();
            //System.out.println("Sunil Doing Testing Response after sending Image inside BD" + PhotoName);
            final ContentValues values = new ContentValues();
            values.put("Sstat", 4);

            int affected3 = db.update("tblStoreCheckInPic", values, "imageName=?",new String[] { PhotoName });
        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }
        finally
        {
           // close();
        }


    }

    public static LinkedHashMap<String, LinkedHashMap<String, String>> fetchTblRowSummary()
    {
        LinkedHashMap<String, String> hmapCatgry = new LinkedHashMap<String, String>();
        LinkedHashMap<String, LinkedHashMap<String, String>> hmapCatgryAll = new LinkedHashMap<String, LinkedHashMap<String, String>>();

        Cursor cursor = db.rawQuery("SELECT DISTINCT TableNo FROM tblAllSummaryDay", null);
        try {
            String allData[]=new String[cursor.getCount()];
            if (cursor.moveToFirst()) {

                for (int i = 0; i < cursor.getCount(); i++)
                {
                    allData[i] = (String)cursor.getString(0).toString().trim();

                    hmapCatgry=fetch_Summary_Detail_DayData(allData[i]);
                    hmapCatgryAll.put(allData[i],hmapCatgry);
                    cursor.moveToNext();

                }

            }
            ////// System.out.println("value  of new store is in DBadapter"+ScodecolumnIndex);
            return hmapCatgryAll;
        } finally {
            cursor.close();
        }

    }

    public static LinkedHashMap<String, String> fetch_Summary_Detail_DayData(String TableNo)
    {
//		//open();
        LinkedHashMap<String, String> hmapCatgry = new LinkedHashMap<String, String>();
        try
        {
            Cursor cursor = db.rawQuery("SELECT Measures,TodaysSummary,MTDSummary,ColorCode FROM tblAllSummaryDay WHERE TableNo='"+TableNo+"'",null);

            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        hmapCatgry.put(cursor.getString(0).toString(),cursor.getString(1).toString()+"^"+cursor.getString(2).toString()+"^"+cursor.getString(3).toString());
                        cursor.moveToNext();
                    }
                }

            }

            return hmapCatgry;
        }
        finally
        {
//			cursor.close();
//			close();
        }
    }


//nitika

    //nitika
    public static long savetblAllSummaryDayAndMTD(int AutoId,String Measures,String TodaysSummary,String MTDSummary, String TableNo,String ColorCode)
    {
//table tblAllSummaryDay (AutoId int not null,Measures text null," +
        //"TodaysSummary text null,MTDSummary text null , TableNo text not null,ColorCode text not null);";

        ContentValues initialValues = new ContentValues();

        initialValues.put("AutoId", AutoId);
        initialValues.put("Measures", Measures.trim());
        initialValues.put("TodaysSummary", TodaysSummary.trim());
        initialValues.put("MTDSummary", MTDSummary.trim());

        initialValues.put("TableNo", TableNo.trim());
        initialValues.put("ColorCode", ColorCode.trim());

        long value= db.insert(DATABASE_TABLE_DayAndSummary, null, initialValues);
        System.out.println("Inserted ; "+value);
        return value;
    }

    //nitika
    public static void truncateAllSummaryDayDataTable()
    {
        db.execSQL("DELETE FROM tblAllSummaryDay");

    }

    public static void updateFlgCrediBal(String storeId,int flgCreditRetailBal)
    {
        //flgRetailerCreditBalnce
        // tblStoreList(StoreID text not null, StoreType string not null, StoreName string not null, StoreLatitude real not null, StoreLongitude real not null, LastVisitDate string not null, LastTransactionDate string not null, Sstat integer not null, ForDate string not null, ActualLatitude text null, ActualLongitude text null, VisitStartTS text null, VisitEndTS text null,AutoIdStore int null, LocProvider text null, Accuracy text null, BateryLeftStatus text null,StoreClose integer null,StoreNextDay integer null,chainID integer null,ISNewStore int null,StoreRouteID int null,RouteNodeType int null,StoreCatNodeId int null,IsNewStoreDataCompleteSaved int null,flgFromWhereSubmitStatus int null,StoreAddress text null,PaymentStage text null,flgHasQuote int null,flgAllowQuotation int null,flgSubmitFromQuotation int null,flgGSTCapture text null,flgGSTCompliance text null,GSTNumber text null,flgGSTRecordFromServer int null,DistanceNear int null,flgLocationServicesOnOff int null,flgGPSOnOff int null,flgNetworkOnOff int null,flgFusedOnOff int null,flgInternetOnOffWhileLocationTracking int null,flgRestart int null,flgStoreOrder int null,StoreCity text null,StorePinCode text not null,StoreState text null,flgRetailerCreditBalnce text null);";
        //open();
        try{

            ContentValues values=new ContentValues();
            values.put("flgRetailerCreditBalnce",flgCreditRetailBal);

            db.update(DATABASE_TABLE_MAIN13,values,"StoreID=?",new String[]{storeId});

        }catch(Exception e)
        {

        }
        finally
        {
           // close();
        }

    }

    public static boolean isFlgCrediBalSubmitted(String storeId)
    {
        boolean isRtalrCreditBalSbmtd=true;
        Cursor cur=null;
        //open();
        try {

            cur=db.rawQuery("Select flgRetailerCreditBalnce from tblStoreList where StoreID='"+storeId+"' AND flgRetailerCreditBalnce<>-1",null);
            if(cur.getCount()>0)
            {
                isRtalrCreditBalSbmtd=true;
            }
        }
        catch(Exception e)
        {

        }
        finally
        {
            if(cur!=null)
            {
                cur.close();
            }
           // close();
            return isRtalrCreditBalSbmtd;
        }
    }


    public static int fetchtblStockUploadedCycleId()
    {
        //open();
        int retVal=0;
        try
        {
            Cursor cur=db.rawQuery("Select VanLoadUnLoadCycID from tblStockUploadedStatus",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        retVal=Integer.parseInt(cur.getString(0));
                        cur.moveToNext();
                    }
                }
            }
        }
        catch(Exception e)
        {
            System.out.println("Error getOtherReason = "+e.toString());
        }
        finally
        {
           // close();
            return retVal;
        }
    }

    public static int fetchtblVanCycleId()
    {
        //open();
        int retVal=-1;
        try
        {
            //tblCycleID(CycleID int null,Sstat int null,CycStartTime text null);";
            Cursor cur=db.rawQuery("Select CycleID from tblCycleID",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        retVal=Integer.parseInt(cur.getString(0));
                        cur.moveToNext();
                    }
                }
            }
        }
        catch(Exception e)
        {
            System.out.println("Error getOtherReason = "+e.toString());
        }
        finally
        {
           // close();
            return retVal;
        }
    }

    public static String fetchtblVanCycleTime()
    {
        //open();
        String CycStartTime="";
        try
        {
            //tblCycleID(CycleID int null,Sstat int null,CycStartTime text null,CycleTime text null);";
            Cursor cur=db.rawQuery("Select CycleTime from tblCycleID",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        CycStartTime=cur.getString(0);
                        cur.moveToNext();
                    }
                }
            }
        }
        catch(Exception e)
        {
            System.out.println("Error getOtherReason = "+e.toString());
        }
        finally
        {
           // close();
            return CycStartTime;
        }
    }


    public static void updateOriginalStock(HashMap<String,Integer> hmapProductStock,String distId)
    {
        //open();
        for(Entry<String,Integer> entry:hmapProductStock.entrySet())
        {
            ContentValues values=new ContentValues();
            System.out.println("hmapProductStock = "+entry.getKey()+" : "+entry.getValue());
            values.put("OriginalStock",String.valueOf(entry.getValue()));
            db.update(DATABASE_TABLE_DISTRIBUTOR_STOCK,values,"DistributorNodeIdNodeType=? AND PrdctId=?", new String[]{distId,entry.getKey()});
        }

       // close();
    }



    public static void insertStockOut(int flgStockOutEntryDone)
    {
        ////open();

        ContentValues values=new ContentValues();

//tblDistributorIDOrderIDLeft(DistributorNodeIdNodeType text null,OrderId text null,ProductId text null,OrderQntty text null);";
        values.put("flgStockOutEntryDone",flgStockOutEntryDone);

        db.insert(DATABASE_TABLE_tblStockOut,null,values);


        //close();
    }

    public static String getDistinctInvoiceNumbers()
    {
        //open();
        String distIDOrderId="";
        Cursor cur=null;
        //tblDistributorIDOrderIDLeft
        //tblDistributorOrderPdaId(DistributorNodeIdNodeType text null,OrderPDAID text null,ProductId text null,OrderQntty text null,Sstat integer not null);";
        try {
            cur=db.rawQuery("Select DISTINCT ServingDBRId,InvoiceNumber from tblInvoiceDetails",null);
            if(cur.getCount()>0)
            {
                StringBuilder sb=new StringBuilder();
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        if(i==0)
                        {
                            sb.append(cur.getString(0)).append("|").append(cur.getString(1));
                        }
                        else
                        {
                            sb.append("^").append(cur.getString(0)).append("|").append(cur.getString(1));
                        }
                        cur.moveToNext();
                    }
                }
                distIDOrderId=sb.toString();
            }
        }
        catch(Exception e)
        {

        }
        finally
        {
            if(cur!=null)
            {
                cur.close();
            }
           // close();
            return distIDOrderId;
        }

    }


    public static String getDistinctCollectionPaymentIds()
    {
        //open();
        String strStoreCollectionUniquneVisitId="";
        Cursor cur=null;
        try {
            cur=db.rawQuery("Select DISTINCT StoreVisitCode from tblAllCollectionData WHERE Sstat in(3,5,6)",null);
            if(cur.getCount()>0)
            {
                StringBuilder sb=new StringBuilder();
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        if(i==0)
                        {
                            sb.append(cur.getString(0));
                        }
                        else
                        {
                            sb.append("^").append(cur.getString(0));
                        }
                        cur.moveToNext();
                    }
                }
                strStoreCollectionUniquneVisitId=sb.toString();
            }
        }
        catch(Exception e)
        {

        }
        finally
        {
            if(cur!=null)
            {
                cur.close();
            }
           // close();
            return strStoreCollectionUniquneVisitId;
        }

    }

    public static void insertDistributorPDAOrderId(String distributorNodeIdNodeType,String orderId,String productId,String orderQntty,int Sstat)
    {
        //tblDistributorOrderPdaId(DistributorNodeIdNodeType text null,OrderPDAID text null,ProductId text null,OrderQntty text null,Sstat integer not null);";
        //open();
//tblDistributorOrderPdaId
        Cursor cur=db.rawQuery("Select DistributorNodeIdNodeType from tblDistributorOrderPdaId where OrderPDAID='"+orderId+"' AND ProductId='"+productId+"' AND DistributorNodeIdNodeType='"+distributorNodeIdNodeType+"'",null);
        ContentValues values=new ContentValues();
        values.put("Sstat",Sstat);

        values.put("OrderQntty",orderQntty);
        if(cur.getCount()>0)
        {
            if(cur!=null)
            {
                cur.close();
            }
            db.update(DATABASE_TABLE_DISTRIBUTOR_ORDERPDAID,values,"OrderPDAID=? AND DistributorNodeIdNodeType=? AND ProductId=?",new String[]{orderId,distributorNodeIdNodeType,productId});
        }
        else
        {

            values.put("ProductId",productId);

            values.put("DistributorNodeIdNodeType",distributorNodeIdNodeType);
            values.put("OrderPDAID",orderId);

            long insertd=db.insert(DATABASE_TABLE_DISTRIBUTOR_ORDERPDAID,null,values);
            System.out.println("Nitish Entered = "+insertd);
        }

       // close();
    }

    public static void deleteExistStockTable(String distributorNodeIdNodeType,String orderId,String ProductId)
    {
        //open();
        Cursor cur=db.rawQuery("Select DistributorNodeIdNodeType from tblDistributorOrderPdaId where OrderPDAID='"+orderId+"' AND DistributorNodeIdNodeType='"+distributorNodeIdNodeType+"' AND ProductId='"+ProductId+"'",null);
        if(cur.getCount()>0)
        {
            db.delete(DATABASE_TABLE_DISTRIBUTOR_ORDERPDAID,"DistributorNodeIdNodeType=? AND OrderPDAID=? AND ProductId=?",new String[]{distributorNodeIdNodeType, orderId, ProductId});
        }
       // close();
    }

    public static HashMap<String,String> getProductStock(String orderPDAId,String distId)
    {
        //open();
        HashMap<String,String> hmapPrdctStock=new HashMap<String,String>();
        Cursor cur=db.rawQuery("Select ProductId,OrderQntty from tblDistributorOrderPdaId where DistributorNodeIdNodeType='"+distId+"' AND OrderPDAID='"+orderPDAId+"'",null);
        if(cur.getCount()>0)
        {
            if(cur.moveToFirst())
            {
                for(int i=0;i<cur.getCount();i++)
                {
                    hmapPrdctStock.put(cur.getString(0),cur.getString(1));
                    cur.moveToNext();
                }
            }
        }
       // close();
        return hmapPrdctStock;
    }

    public static void deleteCompleteDataDistStock()
    {


        db.execSQL("DELETE FROM tblTmpDistributorStock");
        db.execSQL("DELETE FROM tblDistributorStockOutFlg");
        db.execSQL("DELETE FROM tblCycleID");
//tblStockConfirm


        db.execSQL("DELETE FROM tblDistributorIDOrderIDLeft");






    }

    public static String fngetSalesPersonMstrData()
    {
        String abcd="0^0";
        Cursor cursor=null;
        try
        {
            //open();
            cursor = db.rawQuery("SELECT PersonNodeID,PersonNodeType from tblUserAuthenticationMstr", null);
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        abcd=cursor.getString(0)+"^"+cursor.getString(1);
                        cursor.moveToNext();
                    }
                }
            }
        }catch(Exception e)
        { e.printStackTrace();}
        finally
        {
            if(cursor != null)
            {
                cursor.close();
            }
            //close();
            return abcd;
        }
    }

    public static HashMap<String,Integer> getDistStockCount(String distId)
    {
        // tblDistributorProductStock(PrdctId text null,StockQntty text null,DistributorNodeIdNodeType text null);";
        HashMap<String,Integer> hmapDistPrdctStockCount=new HashMap<>();
        //open();
        try {
            Cursor cur=db.rawQuery("Select PrdctId,OriginalStock from tblDistributorProductStock where DistributorNodeIdNodeType='"+distId+"'",null);
            // Cursor cur=db.rawQuery("Select PrdctId,OriginalStock from tblDistributorProductStock",null);// where DistributorNodeIdNodeType='"+distId+"'
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        hmapDistPrdctStockCount.put(cur.getString(0),Integer.parseInt(cur.getString(1)));
                        cur.moveToNext();
                    }
                }


            }



        } catch(Exception e)
        {

        }

        finally
        {
           // close();
            return hmapDistPrdctStockCount;
        }


    }

    public static LinkedHashMap<String,String> getDistStockCountName()
    {
        // tblDistributorProductStock(PrdctId text null,StockQntty text null,DistributorNodeIdNodeType text null);";
        LinkedHashMap<String,String> hmapDistPrdctStockCount=new LinkedHashMap<>();
        int flgVal=flgConfirmedWareHouse();
        //open();
      //  updateInvoiceExecuted();
       // try {

            //tblTmpDistributorStock
            //PrdctId text null,StockQntty text null,DistributorNodeIdNodeType text null,SKUName text null,OpeningStock text null,AddedStock text null,NetSalesQty text null,StockOutQty text null,CategoryID text null
            //  Cursor cur=db.rawQuery("Select PrdctId,SKUName,StockQntty,OpeningStock,AddedStock,CategoryID from tblDistributorProductStock",null);
            Cursor cur=null;
            if(flgVal==0)//tblTmpDistributorStock
            {
                //avinash
              //  cur=db.rawQuery(" SELECT DISTINCT S.PrdctId,S.SKUName,(S.StockQntty-ifnull(X.OrderQty,0)) AS Stqty,S.OpeningStock,S.CycleAddedStock,S.NetSalesQty+ifnull(X.OrderQty,0) AS OrdQty,S.CategoryID,S.CycleUnloadStk FROM tblTmpDistributorStock S LEFT join tblDistributorProductStock ST ON S.PrdctId=ST.PrdctId LEFT OUTER JOIN (SELECT ID.ProdID,SUM(ID.OrderQty) OrderQty FROM tblInvoiceHeader AS I INNER JOIN tblInvoiceDetails AS ID ON ID.InvoiceNumber=I.InvoiceNumber  WHERE I.flgProcessedInvoice=0 GROUP BY ID.ProdID) D ON D.ProdID=S.PrdctId LEFT OUTER JOIN (SELECT ID.ProdID,SUM(ID.OrderQty) OrderQty FROM tblDistributorIDOrderIDLeft AS D INNER JOIN tblInvoiceDetails AS ID ON ID.InvoiceNumber=D.OrderId WHERE D.flgProcessedInvoice=0 GROUP BY ID.ProdID) X",null);
           //   cur=db.rawQuery(" SELECT DISTINCT S.PrdctId,S.SKUName,(S.StockQntty-ifnull(X.OrderQty,0)) AS Stqty,S.OpeningStock,S.CycleAddedStock,S.NetSalesQty+ifnull(X.OrderQty,0) AS OrdQty,S.CategoryID,S.CycleUnloadStk FROM tblTmpDistributorStock S LEFT join tblDistributorProductStock ST ON S.PrdctId=ST.PrdctId LEFT OUTER JOIN (SELECT ID.ProdID,SUM(ID.OrderQty) OrderQty FROM tblDistributorIDOrderIDLeft AS D INNER JOIN tblInvoiceDetails AS ID ON ID.InvoiceNumber=D.OrderId WHERE D.flgProcessedInvoice=0 GROUP BY ID.ProdID) X ON S.PrdctId=X.ProdID ",null);
                cur=db.rawQuery(" SELECT DISTINCT S.PrdctId,S.SKUName,(S.StockQntty-ifnull(X.OrderQty,0)) AS Stqty,S.OpeningStock,S.CycleAddedStock,S.NetSalesQty+ifnull(X.OrderQty,0) AS OrdQty,S.CategoryID,S.CycleUnloadStk FROM tblTmpDistributorStock S LEFT join tblDistributorProductStock ST ON S.PrdctId=ST.PrdctId LEFT OUTER JOIN (SELECT ID.ProdID,SUM(ID.OrderQty) OrderQty FROM tblInvoiceDetails AS ID WHERE ID.InvoiceNumber NOT IN (SELECT D.OrderId FROM tblDistributorIDOrderIDLeft AS D WHERE D.flgProcessedInvoice=1) GROUP BY ID.ProdID) X ON S.PrdctId=X.ProdID ",null);
                /*  cur=db.rawQuery(       " SELECT DISTINCT S.PrdctId,S.SKUName,S.StockQntty-ifnull(D.OrderQty,0) AS Stqty,S.OpeningStock,S.CycleAddedStock,S.NetSalesQty+ifnull(D.OrderQty,0) AS OrdQty,S.CategoryID,S.CycleUnloadStk FROM tblTmpDistributorStock S LEFT OUTER JOIN \n" +
                        " (SELECT ID.ProdID,SUM(ID.OrderQty) OrderQty FROM tblInvoiceHeader AS I INNER JOIN tblInvoiceDetails AS ID ON ID.InvoiceNumber=I.InvoiceNumber  WHERE I.flgProcessedInvoice=0 GROUP BY ID.ProdID) D ON D.ProdID=S.PrdctId",null);*/
            }
            else
            {
               // cur=db.rawQuery(" SELECT DISTINCT S.PrdctId,S.SKUName,S.StockQntty-ifnull(D.OrderQty,0) AS Stqty,S.OpeningStock,S.CycleAddedStock,S.NetSalesQty-ifnull(D.OrderQty,0) AS OrdQty,S.CategoryID,S.CycleUnloadStk FROM tblDistributorProductStock S\n" +
                        cur=db.rawQuery(       " SELECT DISTINCT S.PrdctId,S.SKUName,S.StockQntty-ifnull(D.OrderQty,0) AS Stqty,S.OpeningStock,S.CycleAddedStock,S.NetSalesQty+ifnull(D.OrderQty,0) AS OrdQty,S.CategoryID,S.CycleUnloadStk FROM tblDistributorProductStock S LEFT OUTER JOIN \n" +
                                " (SELECT ID.ProdID,SUM(ID.OrderQty) OrderQty FROM tblInvoiceHeader AS I INNER JOIN tblInvoiceDetails AS ID ON ID.InvoiceNumber=I.InvoiceNumber  WHERE I.flgProcessedInvoice=0 GROUP BY ID.ProdID) D ON D.ProdID=S.PrdctId",null);
                //cur=db.rawQuery("Select  tblDistributorProductStock.PrdctId,tblDistributorProductStock.SKUName,(ifnull(tblDistributorProductStock.StockQntty,0) - ifnull(SUM(tblInvoiceDetails.OrderQty),0)) AS StockQntty1,OpeningStock,CycleAddedStock,(ifnull(tblDistributorProductStock.NetSalesQty,0) + ifnull(SUM(tblInvoiceDetails.OrderQty),0))  AS NetSalesQty1,tblDistributorProductStock.CategoryID,CycleUnloadStk from tblDistributorProductStock left outer join  tblInvoiceDetails on  tblDistributorProductStock.PrdctId=tblInvoiceDetails.ProdID  left outer join tblInvoiceHeader ON  tblInvoiceDetails.InvoiceNumber=tblInvoiceHeader.InvoiceNumber AND  tblInvoiceHeader.flgProcessedInvoice=0",null);
            }
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        hmapDistPrdctStockCount.put(cur.getString(0)+"^"+cur.getString(1),cur.getString(2)+"^"+cur.getString(3)+"^"+cur.getString(4)+"^"+cur.getString(5)+"^"+cur.getString(6)+"^"+cur.getString(7));
                        cur.moveToNext();
                    }
                }


            }



       // } catch(Exception e)
       // {
          //  System.out.println("Error to Done = "+e.toString());
      //  }

       /* finally
        {*/
           // close();
            return hmapDistPrdctStockCount;
       // }


    }

    public static String getUserId()
    {
        // tblDistributorProductStock(PrdctId text null,StockQntty text null,DistributorNodeIdNodeType text null);";
        String userId="0";
        int flgVal=flgConfirmedWareHouse();
        Cursor cur=null;
        //open();
        try {
            if(flgVal==0)
            {
                cur=db.rawQuery("Select DISTINCT DistributorNodeIdNodeType from tblTmpDistributorStock",null);
            }
            else {
              //  tblDistributorProductStock
                        cur=db.rawQuery("Select DISTINCT DistributorNodeIdNodeType from tblDistributorProductStock",null);
            }
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        userId=cur.getString(0);
                        cur.moveToNext();
                    }
                }


            }



        } catch(Exception e)
        {

        }

        finally
        {
          //  close();
            return userId;
        }


    }

    public static int getLeftProductToAddBasedOnInvoiceNumberQantity(int NetStockQty,String distId,String PrdctId)
    {
        int netStock=0;
        //tblTmpInvoiceDetails (IMEIno text not null,RouteID int null,StoreID text not null,CatID text  null,ProdID text not null,TransDate string not null,Stock integer not null,OrderQty integer not null,OrderVal real not null,FreeQty integer not null,DisVal real not null,Sstat integer not null,SampleQuantity int null,ProductShortName text null,ProductPrice real null, TaxRate real null,TaxValue real null,StoreCatNodeId int null,OrderIDPDA text null,flgIsQuoteRateApplied int null,distibutorID text null,flgWholeSellApplicable int null,TmpInvoiceCodePDA text null);";
        try {
            boolean isPrdctFound=false;
            //Cursor cur=db.rawQuery("Select tblTmpInvoiceDetails.ProdID , tblTmpInvoiceDetails.OrderQty from tblTmpInvoiceDetails inner join tblDistributorIDOrderIDLeft ON tblTmpInvoiceDetails.FinalAllotedInvoiceIds=tblDistributorIDOrderIDLeft.OrderId where tblTmpInvoiceDetails.distibutorID='"+distId+"' AND tblTmpInvoiceDetails.FinalAllotedInvoiceIds<>'NA'",null);
            Cursor cur=db.rawQuery("Select tblInvoiceDetails.ProdID , tblInvoiceDetails.OrderQty from tblInvoiceDetails inner join tblDistributorIDOrderIDLeft ON tblInvoiceDetails.InvoiceNumber=tblDistributorIDOrderIDLeft.OrderId where  tblInvoiceDetails.InvoiceNumber<>'NA' AND tblDistributorIDOrderIDLeft.flgProcessedInvoice=0",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        if(PrdctId.equals(cur.getString(0)))
                        {
                            netStock=NetStockQty+Integer.parseInt(cur.getString(1));
                            NetStockQty=netStock;
                            isPrdctFound=true;

                        }



                        cur.moveToNext();
                    }
                }
            }
            else
            {
                netStock=NetStockQty;
            }

            if(!isPrdctFound){
                netStock=NetStockQty;
            }

        }
        catch (Exception e)
        {
            Log.e("Error",e.toString() );
        }finally {
            {
                return netStock;
            }
        }


    }

    public static int getLeftProductQantity(int stockCount,String distId,String PrdctId)
    {
        int netStock=0;
        //tblTmpInvoiceDetails (IMEIno text not null,RouteID int null,StoreID text not null,CatID text  null,ProdID text not null,TransDate string not null,Stock integer not null,OrderQty integer not null,OrderVal real not null,FreeQty integer not null,DisVal real not null,Sstat integer not null,SampleQuantity int null,ProductShortName text null,ProductPrice real null, TaxRate real null,TaxValue real null,StoreCatNodeId int null,OrderIDPDA text null,flgIsQuoteRateApplied int null,distibutorID text null,flgWholeSellApplicable int null,TmpInvoiceCodePDA text null);";
        try {
            boolean isPrdctFound=false;
           // Cursor cur=db.rawQuery("Select tblTmpInvoiceDetails.ProdID , tblTmpInvoiceDetails.OrderQty from tblTmpInvoiceDetails inner join tblDistributorIDOrderIDLeft ON tblTmpInvoiceDetails.FinalAllotedInvoiceIds=tblDistributorIDOrderIDLeft.OrderId where tblTmpInvoiceDetails.distibutorID='"+distId+"' AND tblTmpInvoiceDetails.FinalAllotedInvoiceIds<>'NA'",null);
            Cursor cur=db.rawQuery("Select tblInvoiceDetails.ProdID , tblInvoiceDetails.OrderQty from tblInvoiceDetails inner join tblDistributorIDOrderIDLeft ON tblInvoiceDetails.InvoiceNumber=tblDistributorIDOrderIDLeft.OrderId where  tblInvoiceDetails.InvoiceNumber<>'NA' AND tblDistributorIDOrderIDLeft.flgProcessedInvoice=0",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        if(PrdctId.equals(cur.getString(0)))
                        {
                            netStock=stockCount-Integer.parseInt(cur.getString(1));
                            stockCount=netStock;
                            isPrdctFound=true;

                        }



                        cur.moveToNext();
                    }
                }
            }
            else
            {
                netStock=stockCount;
            }

            if(!isPrdctFound){
                netStock=stockCount;
            }

        }
        catch (Exception e)
        {
            Log.e("Error",e.toString() );
        }finally {
            {
                return netStock;
            }
        }


    }

    public static String getDisId(String storeId)
    {
        //open();
        String dbstID="";
        boolean isDBRPresent=false;
        Cursor cur=null;
        try {


            cur=db.rawQuery("Select DBR from tblStoreList where StoreID='"+storeId+"'",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    if(!cur.getString(0).equals("0"))
                    {
                        isDBRPresent=true;
                        dbstID=cur.getString(0);
                    }
                }
            }
            if(!isDBRPresent)
            {
                cur=db.rawQuery("Select DBR from tblStoreList where DBR<>'0' Limit 1",null);
                if(cur.getCount()>0)
                {
                    if(cur.moveToFirst())
                    {
                        if(!cur.getString(0).equals("0"))
                        {
                            dbstID=cur.getString(0);
                        }
                    }
                }
            }
        } catch(Exception e)
        {

        }
        finally
        {
            if(cur!=null)
            {
                cur.close();
            }
            //close();
            return dbstID;
        }
    }

    public static void updateRtlrCrdtBal(String storeId)
    {
        ContentValues values=new ContentValues();
        values.put("flgRetailerCreditBalnce",1);
        try {
            db.update(DATABASE_TABLE_MAIN13,values,"StoreID=?",new String[]{storeId});
        }catch (Exception e)
        {

        }

    }

    public static void deleteOrderId(String orderId)
    {
        //"Select DistributorNodeIdNodeType from tblDistributorOrderPddb.insert(DATABASE_TABLE_DISTRIBUTOR_ORDERPDAID,null,values);
        Cursor cur=db.rawQuery("Select DistributorNodeIdNodeType from tblDistributorOrderPdaId where OrderPDAID='"+orderId+"'",null);
        if(cur.getCount()>0)
        {
            db.delete(DATABASE_TABLE_DISTRIBUTOR_ORDERPDAID,"OrderPDAID=?",new String[]{orderId});
        }
    }

    public static String[] getAllDSRSignatureAndSelfi()
    {

        int SnamecolumnIndex1 = 0;


        Cursor cursor = db.rawQuery("SELECT DISTINCT(IMEI) FROM tblDsrRegDetails", null);
        //Cursor cursor = db.rawQuery("SELECT StoreID FROM tblStoreMaterialPhotoDetail", null);
        try
        {
            String StoreName[] = new String[cursor.getCount()];
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        StoreName[i] = (String) cursor.getString(SnamecolumnIndex1).toString();
                        cursor.moveToNext();
                    }
                }

            }

            return StoreName;
        }
        finally
        {
            cursor.close();
        }

    }

    public static int getExistingPicNosForSignatureAndSelfi()
    {

        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT ifnull(SelfiePath,''),ifnull(SignPath,'') FROM tblDsrRegDetails", null);
        try {
            int strProdStockQty = 0;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    if (!cursor.isNull(ScodecolumnIndex)) {
                        if(!cursor.getString(ScodecolumnIndex).toString().equals(""))
                        {
                            strProdStockQty=1;
                        }
                        if(!cursor.getString(1).toString().equals(""))
                        {
                            strProdStockQty=2;
                        }
                        ///strProdStockQty = Integer.parseInt(cursor.getString(ScodecolumnIndex).toString());
                        cursor.moveToNext();
                    }

                }
            }
            return strProdStockQty;
        } finally {
            cursor.close();
        }
    }

    public static String[] getImgsPathForSignatureAndSelfi()
    {

        int SnamecolumnIndex1 = 0;

        Cursor cursor = db.rawQuery("SELECT ifnull(SelfieName,''),ifnull(SignName,'') FROM tblDsrRegDetails", null);
        try
        {

            String StoreName[] = new String[cursor.getCount()+1];

            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    if(!cursor.getString(SnamecolumnIndex1).toString().equals(""))
                    {
                        StoreName[i] = (String) cursor.getString(SnamecolumnIndex1).toString();
                    }
                    if(!cursor.getString(1).toString().equals(""))
                    {
                        StoreName[1] = (String) cursor.getString(1).toString();
                    }

                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }

    }

    public static void updateImageRecordsSyncdForDSRRegistrationAndSelfi()
    {

        try
        {
            //open();
            db.execSQL("Update tblDsrRegDetails SET Sstat=4");

        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }
        finally
        {
            //close();
        }


    }

    public static void UpdateDistributerFlag(String SuplierUniqueId, int flag2set)
    {

        try
        {
            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);
            int affected = db.update("tblSuplierMapping", values, "SuplierUniqueId=?",new String[] { SuplierUniqueId });
        }
        catch (Exception ex)
        {
            String ex1=ex.getMessage();
        }

    }

    public static String fngetDIdAndDType(String DistribtrUniqueId)
    {

        String flgCheckIfStoreExists="0^0";
        //tblStoreDetails(StoreID
        Cursor cursor2 = db.rawQuery("SELECT NodeID,NodeType FROM tblSuplierMapping WHERE tblSuplierMapping.SuplierUniqueId='"+DistribtrUniqueId+"'", null);
        try {
            if(cursor2.getCount()>0)
            {
                if(cursor2.moveToFirst())
                {

                    flgCheckIfStoreExists=(String) cursor2.getString(0).toString()+"^"+(String) cursor2.getString(1).toString();

                }
            }
        }
        catch(Exception e)
        {
            String ex1=e.getMessage();
        }
        finally {
            cursor2.close();

        }
        return flgCheckIfStoreExists;
    }

    public static void fnupdateSuplierMstrLocationtrackRemapFlg(String DistribtrUniqueId)
    {
        //open();
        String DIdAndDType=fngetDIdAndDType(DistribtrUniqueId);
        db.execSQL("UPDATE tblSupplierMstrList SET flgRemap=0 WHERE tblSupplierMstrList.NodeID='"+DIdAndDType.split(Pattern.quote("^"))[0]+"' AND tblSupplierMstrList.NodeType='"+DIdAndDType.split(Pattern.quote("^"))[1]+"'");
      //  close();

    }

    public static void Delete_tblDistributorMstr()
    {
        db.execSQL("DELETE FROM tblSupplierMstrList");
    }


    public static void deletetblStoreList()
    {
        //open();
        db.execSQL("DELETE FROM tblStoreList");
       // close();


    }

    public static String[] SaveStoreList()
    {

        int LoncolumnIndex = 0;
        int LoncolumnIndex2 = 1;

        Cursor cursor2 = db.rawQuery("SELECT StoreID, StoreName FROM tblStoreList WHERE Sstat = 1 or Sstat = 3",null);
        try
        {
            String strAreaIdsDetais[] = new String[cursor2.getCount()];
            ////// System.out.println("records count[ProcessStoreReq]: "+cursor2.getCount());
            if (cursor2.moveToFirst())
            {
                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    strAreaIdsDetais[i] = (String) cursor2.getString(LoncolumnIndex)+ "%"+ (String) cursor2.getString(LoncolumnIndex2);

                    ////// System.out.println("VAL1: "+(String) cursor2.getString(LoncolumnIndex) + "  "+"VAL2: "+(String) cursor2.getString(LoncolumnIndex2));
                    cursor2.moveToNext();
                }

            }
            return strAreaIdsDetais;
        }
        finally
        {
            cursor2.close();
        }

    }

    public static LinkedHashMap<String, String> fetch_Route_List()
    {
        //open();
        LinkedHashMap<String, String> hmapCatgry = new LinkedHashMap<String, String>();
        Cursor cursor = db.rawQuery("SELECT ID,RouteType,Descr FROM tblRouteListMaster ",null);
        //Cursor cursor2 = db.rawQuery("SELECT ID FROM tblRouteListMaster where CoverageAreaNodeID='"+CommonInfo.CoverageAreaNodeID+"' and CoverageAreaNodeType='"+CommonInfo.CoverageAreaNodeType+"'", null);

        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
											/*if(i==0)
											{
												hmapCatgry.put("Select Manager", "00");
											}*/
                        hmapCatgry.put(cursor.getString(2).toString(),cursor.getString(0).toString()+"_"+cursor.getString(1).toString());
                        cursor.moveToNext();
                    }
                }

            }

            else
            {
                hmapCatgry.put("No Routes", "0");
            }
            return hmapCatgry;
        }
        finally
        {
            cursor.close();
           // close();
        }
    }

    public static int checkDSRCheckIntblSuplierMapping()
    {
        int chkI = 0;
        //open();
        Cursor cursorE2=null;

        try
        {
            //cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblSuplierMapping WHERE Sstat =4", null);
            cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblSuplierMapping", null);
            if (cursorE2.moveToFirst())
            {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }
            //chkI=checkDSRCheckIntblDistributorSavedData();

        } finally
        {
            cursorE2.close();
           // close();
        }
        return chkI;
    }
    //Cursor cursor2 = db.rawQuery("SELECT StoreID, StoreName FROM tblStoreList WHERE Sstat = 1 ",null);

    public static int checkDSRCheckIntblDistributorSavedData()
    {
        int chkI = 0;
        Cursor cursorE2=null;

        try
        {
            cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblDistributorSavedData WHERE Sstat =4", null);
            if (cursorE2.moveToFirst())
            {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally
        {
            cursorE2.close();

        }
        return chkI;
    }

    public static String GetActiveRouteDescr()
    {
        int LoncolumnIndex = 0;

        //open();
        Cursor cursor2 = null;
        try
        {
            cursor2 = db.rawQuery("SELECT Descr FROM tblRouteListMaster WHERE flgTodayRoute = 1 Limit 1", null);

            String activeRouteID = "0";
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    activeRouteID = cursor2.getString(LoncolumnIndex);
                    cursor2.moveToNext();

                }

            }
            if(activeRouteID.equals("0"))
            {
                activeRouteID=GetNoActiveRouteDescr();
            }
            return activeRouteID;
        } finally {
            cursor2.close();
            //close();
        }

    }

    public static String GetNoActiveRouteDescr()
    {
        int LoncolumnIndex = 0;


        Cursor cursor2 = null;
        try
        {
            cursor2 = db.rawQuery("SELECT Descr FROM tblRouteListMaster WHERE flgTodayRoute = 0 Limit 1", null);

            String activeRouteID = "0";
            if (cursor2.moveToFirst())
            {

                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    activeRouteID = cursor2.getString(LoncolumnIndex);
                    cursor2.moveToNext();

                }

            }

            return activeRouteID;
        } finally {
            cursor2.close();

        }

    }

    public static String[] FetchStoreRouteIdType(String rID)
    {
        int ScodecolumnIndex = 0;
        int SnamecolumnIndex = 1;

        Cursor cursor = db.rawQuery("SELECT StoreRouteID, RouteNodeType FROM tblStoreList where StoreRouteID='"+ rID +"'   ORDER BY DistanceNear", null);
        try
        {
            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst())
            {
                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    StoreName[i] = (String) cursor.getString(ScodecolumnIndex).toString()+ "_"+ (String) cursor.getString(SnamecolumnIndex).toString();
                    cursor.moveToNext();
                }

            }
            return StoreName;
        }
        finally
        {
            cursor.close();
        }

    }

    public static boolean checkDistributorLocatioExists(String DistribtrId) {
        // int entryCount;
        //open();
        Cursor cursorE2=null;
        boolean chkI = false;
        try {
            cursorE2 = db.rawQuery("SELECT count(*) FROM tblSuplierMapping WHERE SuplierId ='" + DistribtrId+ "'", null);
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    ////// System.out.println("Stock prev.. entered!");
                    chkI = true;
                } else {
                    chkI = false;
                }
            }

        } finally {
            cursorE2.close();
           // close();
        }
        return chkI;
    }

    public static  void deleteStorecloseLocationTable()
    {
        db.execSQL("DELETE FROM tblStoreCloseLocationDetails");
    }

    public static  void deleteStorecloseLocationTableBasedOnStoreID(String StoreID,String StoreVisitCode)
    {
        db.execSQL("DELETE FROM tblStoreCloseLocationDetails where StoreID='"+StoreID+"' AND StoreVisitCode='"+StoreVisitCode+"'");
    }

    public static long saveTblStorecloseLocationDetails(String StoreID,
                                                 String Lattitude, String Longitude, String Accuracy,
                                                 String Address, String City, String Pincode, String State,
                                                 String fnAccurateProvider, String GpsLat, String GpsLong,
                                                 String GpsAccuracy, String NetwLat, String NetwLong,
                                                 String NetwAccuracy, String FusedLat, String FusedLong,
                                                 String FusedAccuracy, String AllProvidersLocation, String GpsAddress,
                                                 String NetwAddress, String FusedAddress,
                                                 String FusedLocationLatitudeWithFirstAttempt, String FusedLocationLongitudeWithFirstAttempt,
                                                 String FusedLocationAccuracyWithFirstAttempt,int Sstat,String StoreVisitCode)
    {
        ContentValues initialValues = new ContentValues();
        initialValues.put("StoreVisitCode", StoreVisitCode);
        initialValues.put("StoreID", StoreID);

        initialValues.put("Lattitude", Lattitude);
        initialValues.put("Longitude", Longitude);
        initialValues.put("Accuracy", Accuracy);
        initialValues.put("Address", Address);
        initialValues.put("City", City);
        initialValues.put("Pincode", Pincode);
        initialValues.put("State", State);
        initialValues.put("fnAccurateProvider", fnAccurateProvider);
        initialValues.put("GpsLat", GpsLat);
        initialValues.put("GpsLong", GpsLong);
        initialValues.put("GpsAccuracy", GpsAccuracy);
        initialValues.put("NetwLat", NetwLat);
        initialValues.put("NetwLong", NetwLong);
        initialValues.put("NetwAccuracy", NetwAccuracy);
        initialValues.put("FusedLat", FusedLat);
        initialValues.put("FusedLong", FusedLong);
        initialValues.put("FusedAccuracy", FusedAccuracy);

        initialValues.put("AllProvidersLocation", AllProvidersLocation);
        initialValues.put("GpsAddress", GpsAddress);
        initialValues.put("NetwAddress", NetwAddress);
        initialValues.put("FusedAddress", FusedAddress);
        initialValues.put("FusedLocationLatitudeWithFirstAttempt", FusedLocationLatitudeWithFirstAttempt);
        initialValues.put("FusedLocationLongitudeWithFirstAttempt", FusedLocationLongitudeWithFirstAttempt);
        initialValues.put("FusedLocationAccuracyWithFirstAttempt", FusedLocationAccuracyWithFirstAttempt);

        initialValues.put("Sstat", Sstat);

        return db.insert(DATABASE_TABLE_tblStoreCloseLocationDetails, null, initialValues);
    }

    public static long inserttblStoreClosedPhotoDetail(String storeId,String ClickedDateTime,String PhotoName,
                                                String PDAPhotoPath,int Sstat,String StoreVisitCode)
    {

        //open();
        ContentValues initialValues = new ContentValues();
        //StoreID text null,ClickedDateTime text null,PhotoName text null,PDAPhotoPath text null,Sstat integer null
        initialValues.put("StoreID", storeId.trim());
        initialValues.put("StoreVisitCode", StoreVisitCode);
        initialValues.put("ClickedDateTime", ClickedDateTime.trim());
        initialValues.put("PhotoName", PhotoName.trim());
        initialValues.put("PDAPhotoPath", PDAPhotoPath.trim());
        initialValues.put("Sstat", Sstat);

        long inserted=db.insert(DATABASE_TABLE_tblStoreClosedPhotoDetail, null, initialValues);
       // close();
        return inserted;
    }

    public static void validateAndDelStoreClosePic(String StoreId,String imgName,String StoreVisitCode)
    {
        //open();
        try
        {
            /*tblPutStckRoomPhotoDetails(TempId text null,StoreId text null,PhotoName text null,PhotoPath text null,ClickedDateTime text null,ClickTagPhoto text null,Sstat text null);";*/
            Cursor cur=db.rawQuery("Select PhotoName from tblStoreClosedPhotoDetail where StoreId='"+StoreId+"'" +
                    "and PhotoName='"+imgName+"' AND StoreVisitCode='"+StoreVisitCode+"'",null);

            if(cur.getCount()>0)
            {
                db.delete(DATABASE_TABLE_tblStoreClosedPhotoDetail,"StoreID=? and PhotoName=?",
                        new String[] {StoreId,imgName});
            }
        }
        catch (SQLiteException ex)
        {
            System.out.println("validate pic..."+ex);
        }
        finally {
           // close();
        }
    }

    public static ArrayList<String> getStoreClosedImgNameByStoreId(String StoreID,String StoreVisitCode)
    {
        //open();
        ArrayList<String> list=new ArrayList<>();
        try
        {
            Cursor cur=db.rawQuery("Select PhotoName from tblStoreClosedPhotoDetail where StoreID='"+StoreID+"' AND StoreVisitCode='"+StoreVisitCode+"'",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        list.add(cur.getString(0));
                        cur.moveToNext();
                    }
                }
            }
        }
        catch(Exception e)
        {
            System.out.println("Error getStoreClosedImgNameByStoreId = "+e.toString());
        }
        finally
        {
            //close();
            return list;
        }
    }

    public static void upDateCloseStoreReason(String StoreID,String ReasonID, String ReasonDesc,String StoreVisitCode) {
        try {
            //open();
            final ContentValues values = new ContentValues();
            values.put("ReasonID", ReasonID);
            values.put("ReasonDesc", ReasonDesc);
            //values.put("StoreVisitCode", StoreVisitCode);

            int affected = db.update("tblStoreCloseReasonSaving", values, "StoreID=? AND StoreVisitCode=?",
                    new String[] {StoreID,StoreVisitCode});
        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }
        finally {
           // close();
        }
    }

    public static void savetblStoreCloseReasonMaster(int CloseReasonID,String CloseReasonDescr)
    {
        ContentValues values=new ContentValues();
        values.put("CloseReasonID", CloseReasonID);
        values.put("CloseReasonDescr", CloseReasonDescr);

        db.insert(DATABASE_TABLE_tblStoreCloseReasonMaster , null, values);
    }

    public static  void deletetblStoreCloseReasonMaster()
    {
        db.execSQL("DELETE FROM tblStoreCloseReasonMaster");
    }

    public static LinkedHashMap<String,String> getStoreClosedReasons()
    {
        //open();
        LinkedHashMap<String,String> list=new LinkedHashMap<>();
        try
        {
            Cursor cur=db.rawQuery("Select CloseReasonID,CloseReasonDescr from tblStoreCloseReasonMaster",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        if(i==0)
                        {
                            list.put("00","Select");
                            list.put(cur.getString(0),cur.getString(1));
                        }
                        else
                        {
                            list.put(cur.getString(0),cur.getString(1));
                        }
                        cur.moveToNext();
                    }
                }
            }
            else
            {
                list.put("00","Select");
            }
        }
        catch(Exception e)
        {
            System.out.println("Error getStoreClosedReasons = "+e.toString());
        }
        finally
        {
           // close();
            return list;
        }
    }

    public static Boolean checkIfRouteExist()
    {
        //open();
        Boolean isRoute=false;
        Cursor cur=null;
        try {
            cur=db.rawQuery("Select * from tblRouteListMaster",null);
            if(cur.getCount()>0)
            {
                isRoute=true;
            }
        }catch(SQLiteException exception)
        {
            exception.printStackTrace();
        }
        finally
        {
            if(cur!=null)
            {
                cur.close();
            }
           // close();
            return isRoute;
        }
    }

    public static String getOtherReason(String StoreID,String StoreVisitCode)
    {
        //open();
        String list="00^NA";
        try
        {
            Cursor cur=db.rawQuery("Select ReasonID,ReasonDescr from tblStoreCloseReasonSaving where StoreID='"+StoreID+"' AND StoreVisitCode='"+StoreVisitCode+"'",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        list=cur.getString(0)+"^"+cur.getString(1);
                        cur.moveToNext();
                    }
                }
            }
        }
        catch(Exception e)
        {
            System.out.println("Error getOtherReason = "+e.toString());
        }
        finally
        {
           // close();
            return list;
        }
    }

    //changes
    public static String getLatLongForDistrbtrMap(String DistribtrId)
    {
        //open();
        String list="NA";
        try
        {
            Cursor cur=db.rawQuery("Select fnLati,fnLongi from tblSuplierMapping where SuplierId='"+DistribtrId+"'",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        list=cur.getString(0)+"^"+cur.getString(1);
                        cur.moveToNext();
                    }
                }
            }
        }
        catch(Exception e)
        {
            System.out.println("Error getLatLongForDistrbtrMap = "+e.toString());
        }
        finally
        {
            //close();
            return list;
        }
    }

    public static long inserttblStoreCloseReasonSaving(String storeId,String ReasonID,String ReasonDescr,int Sstat,String StoreVisitCode)
    {
        //open();
        ContentValues initialValues = new ContentValues();
        initialValues.put("StoreID", storeId.trim());
        initialValues.put("ReasonID", ReasonID.trim());
        initialValues.put("ReasonDescr", ReasonDescr.trim());
        initialValues.put("StoreVisitCode", StoreVisitCode);
        initialValues.put("Sstat", Sstat);

        long inserted=db.insert(DATABASE_TABLE_tblStoreCloseReasonSaving, null, initialValues);
       // close();
        return inserted;
    }

    //map distributor
    public static long  savetblIsDBRStockSubmitted(int IsDBRStockSubmitted)
    {
        ContentValues initialValues = new ContentValues();

        initialValues.put("IsDBRStockSubmitted", IsDBRStockSubmitted);


        return db.insert(TABLE_tblIsDBRStockSubmitted, null, initialValues);
    }

    public static int fetchtblIsDBRStockSubmitted()
    {
        //open();
        int retVal=0;
        try
        {
            Cursor cur=db.rawQuery("Select IsDBRStockSubmitted from tblIsDBRStockSubmitted",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        retVal=Integer.parseInt(cur.getString(0));
                        cur.moveToNext();
                    }
                }
            }
        }
        catch(Exception e)
        {
            System.out.println("Error getOtherReason = "+e.toString());
        }
        finally
        {
           // close();
            return retVal;
        }
    }

    public static int counttblSupplierMstrList()//If fnChkFlgTodayRoute=1 it will get added to Actual Call On Route Else get Added in Off Route
    {

        //open();
        int ActualCall = 0;
        Cursor cursor2= db.rawQuery("SELECT Count(*) FROM tblSupplierMstrList", null);
        try {
            if(cursor2.getCount()>0)
            {
                if (cursor2.moveToFirst())
                {
                    for (int i = 0; i < cursor2.getCount(); i++)
                    {

                        if (!cursor2.isNull(0))
                        {
                            ActualCall =Integer.parseInt(cursor2.getString(0).toString());
                            cursor2.moveToNext();
                        }
                    }
                }
            }

            return ActualCall;
        } finally {
            cursor2.close();
            //close();
        }
    }

    public static LinkedHashMap<String, String> fnGetPaymentMode()
    {
        LinkedHashMap<String, String> hmapQuestionMstr=new LinkedHashMap<String, String>();
        //open();
        // Cursor cursor = db.rawQuery("SELECT SST_NameId,SST_Name_des from tbl_SST_NameMstr Order By Sequence ASC  ", null);// Where PNodeID='"+TSIID+"'
        Cursor cursor = db.rawQuery("SELECT InstrumentModeId,InstrumentMode from tblInstrumentMaster   ", null);// Where PNodeID='"+TSIID+"'
        // (String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString()+"^"+(String) cursor.getString(2).toString()+"^"+(String) cursor.getString(3).toString()+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(5).toString()+"^"+(String) cursor.getString(6).toString()+"^"+(String) cursor.getString(7).toString()+"^"+(String) cursor.getString(8).toString()+"^"+(String) cursor.getString(9).toString()+"^"+(String) cursor.getString(10).toString()
        // close();
        try {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapQuestionMstr.put((String) cursor.getString(0).toString(),(String) cursor.getString(1).toString());
                        //    System.out.println("QuestID:"+(String)cursor.getString(0).toString()+"QuestCode:"+(String) cursor.getString(1).toString()+"QuestDesc:"+(String) cursor.getString(2).toString()+"QuestType:"+(String) cursor.getString(3).toString()+"AnsControlType:"+(String) cursor.getString(4).toString()+"AnsControlInputTypeID:"+(String) cursor.getString(5).toString()+"AnsControlInputTypeMaxLength:"+(String) cursor.getString(6).toString()+"AnsMustRequiredFlg:"+(String) cursor.getString(7).toString()+"QuestBundleFlg:"+(String) cursor.getString(8).toString()+"ApplicationTypeID:"+(String) cursor.getString(9).toString()+"Sequence:"+(String) cursor.getString(10).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return hmapQuestionMstr;
        }
        finally
        {
            cursor.close();
           // close();
        }
    }

    public static LinkedHashMap<String, String> fnGetBankIdData()
    {
        LinkedHashMap<String, String> hmapQuestionMstr=new LinkedHashMap<String, String>();
        //open();
        // Cursor cursor = db.rawQuery("SELECT SST_NameId,SST_Name_des from tbl_SST_NameMstr Order By Sequence ASC  ", null);// Where PNodeID='"+TSIID+"'
        Cursor cursor = db.rawQuery("SELECT BankId,BankName from tblBankMaster   ", null);// Where PNodeID='"+TSIID+"'
        // (String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString()+"^"+(String) cursor.getString(2).toString()+"^"+(String) cursor.getString(3).toString()+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(5).toString()+"^"+(String) cursor.getString(6).toString()+"^"+(String) cursor.getString(7).toString()+"^"+(String) cursor.getString(8).toString()+"^"+(String) cursor.getString(9).toString()+"^"+(String) cursor.getString(10).toString()
        // close();
        try {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapQuestionMstr.put((String) cursor.getString(0).toString(),(String) cursor.getString(1).toString());
                        //    System.out.println("QuestID:"+(String)cursor.getString(0).toString()+"QuestCode:"+(String) cursor.getString(1).toString()+"QuestDesc:"+(String) cursor.getString(2).toString()+"QuestType:"+(String) cursor.getString(3).toString()+"AnsControlType:"+(String) cursor.getString(4).toString()+"AnsControlInputTypeID:"+(String) cursor.getString(5).toString()+"AnsControlInputTypeMaxLength:"+(String) cursor.getString(6).toString()+"AnsMustRequiredFlg:"+(String) cursor.getString(7).toString()+"QuestBundleFlg:"+(String) cursor.getString(8).toString()+"ApplicationTypeID:"+(String) cursor.getString(9).toString()+"Sequence:"+(String) cursor.getString(10).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return hmapQuestionMstr;
        }
        finally
        {
            cursor.close();
           // close();
        }
    }

    public static LinkedHashMap<String, String> fnGettblBankMaster()
    {
        LinkedHashMap<String, String> hmapQuestionMstr=new LinkedHashMap<String, String>();
        //open();
        // Cursor cursor = db.rawQuery("SELECT SST_NameId,SST_Name_des from tbl_SST_NameMstr Order By Sequence ASC  ", null);// Where PNodeID='"+TSIID+"'
        Cursor cursor = db.rawQuery("SELECT BankId,BankName from tblBankMaster   ", null);// Where PNodeID='"+TSIID+"'
        // (String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString()+"^"+(String) cursor.getString(2).toString()+"^"+(String) cursor.getString(3).toString()+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(5).toString()+"^"+(String) cursor.getString(6).toString()+"^"+(String) cursor.getString(7).toString()+"^"+(String) cursor.getString(8).toString()+"^"+(String) cursor.getString(9).toString()+"^"+(String) cursor.getString(10).toString()
        // close();
        try {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapQuestionMstr.put((String) cursor.getString(1).toString(),(String) cursor.getString(0).toString());
                        //    System.out.println("QuestID:"+(String)cursor.getString(0).toString()+"QuestCode:"+(String) cursor.getString(1).toString()+"QuestDesc:"+(String) cursor.getString(2).toString()+"QuestType:"+(String) cursor.getString(3).toString()+"AnsControlType:"+(String) cursor.getString(4).toString()+"AnsControlInputTypeID:"+(String) cursor.getString(5).toString()+"AnsControlInputTypeMaxLength:"+(String) cursor.getString(6).toString()+"AnsMustRequiredFlg:"+(String) cursor.getString(7).toString()+"QuestBundleFlg:"+(String) cursor.getString(8).toString()+"ApplicationTypeID:"+(String) cursor.getString(9).toString()+"Sequence:"+(String) cursor.getString(10).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return hmapQuestionMstr;
        }
        finally
        {
            cursor.close();
           // close();
        }
    }

    public static void deleteWhereStoreId(String StoreID,String OrderPDAID,String TmpInvoiceCodePDA )
    {

        db.execSQL("DELETE FROM tblAllCollectionData WHERE StoreID ='" + StoreID +"'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'");
    }

    public static long savetblAllCollectionData(String StoreVisitCode,String StoreID, String paymentMode,String PaymentModeID, String Amount,
                                         String RefNoChequeNoTrnNo, String Date, String Bank,String TmpInvoiceCodePDA,String CollectionCode)
    {
        ContentValues initialValues = new ContentValues();
        initialValues.put("StoreVisitCode", StoreVisitCode);
        initialValues.put("StoreID", StoreID.toString().trim());
        initialValues.put("PaymentMode", paymentMode.toString().trim());
        initialValues.put("PaymentModeID", PaymentModeID.toString().trim());
        initialValues.put("Amount", Amount.toString().trim());
        initialValues.put("RefNoChequeNoTrnNo", RefNoChequeNoTrnNo.toString().trim());
        initialValues.put("Date", Date.toString().trim());
        initialValues.put("Bank", Bank.toString().trim());
        initialValues.put("Sstat", "1");
        initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
        initialValues.put("CollectionCode", CollectionCode);
       /* initialValues.put("AmountChequesOrDD", AmountSecondString.toString().trim());
        initialValues.put("CashID", "1");
        initialValues.put("RefNoChequeNoTrnNo", ChequeNoSecondString.toString().trim());
        initialValues.put("DateChequesOrDD", DateSecondString.toString().trim());
        initialValues.put("BankChequesOrDD", BankSecondString.toString().trim());

        initialValues.put("ElectronicID", "3");
        initialValues.put("PaymentModeElectronic", paymentModeThirdString.toString().trim());
        initialValues.put("AmountElectronic", AmountThirdString.toString().trim());
        initialValues.put("RefNoChequeNoTrnNoElectronic", ChequeNoThirdString.toString().trim());
        initialValues.put("DateElectronic", DateThirdString.toString().trim());
        initialValues.put("BankElectronic",  BankThirdString.toString().trim());
        initialValues.put("Sstat", "1");
        initialValues.put("OrderPDAID", OrderPDAID);*/


        return db.insert(DATABASE_TABLE_tblAllCollectionData, null, initialValues);
    }

    public static String  fnRetrieveCollectionDataBasedOnStoreID(String StoreVisitCode,String StoreID,String OrderPDAID,String TmpInvoiceCodePDA)
    {
        String flag="0";
        try {
            //open();
            Cursor cursor = db.rawQuery("SELECT PaymentMode, PaymentModeID,Amount,RefNoChequeNoTrnNo,Date,Bank from tblAllCollectionData where StoreID = '"+StoreID +"' and StoreVisitCode='"+StoreVisitCode +"'", null);

            if(cursor.getCount()>0){
                if (cursor.moveToFirst()){
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        if(flag.equals("0")){
                            flag=	cursor.getString(0).toString()+"^"+cursor.getString(1).toString()+"^"+cursor.getString(2).toString()+"^"+cursor.getString(3).toString()+"^"+cursor.getString(4).toString()+"^"+cursor.getString(5).toString();

                        }
                        else{
                            flag=flag+"$"+	cursor.getString(0).toString()+"^"+cursor.getString(1).toString()+"^"+cursor.getString(2).toString()+"^"+cursor.getString(3).toString()+"^"+cursor.getString(4).toString()+"^"+cursor.getString(5).toString();
                        }
                        cursor.moveToNext();
                    }

                }}
            return flag;
        }catch(Exception e)
        {

        }

        finally
        {

           // close();
            return flag;
        }
    }

    public static void deleteAllCollectionTables()
    {

        db.execSQL("DELETE FROM tblBankMaster");
        db.execSQL("DELETE FROM tblInstrumentMaster");
        db.execSQL("DELETE FROM tblAllCollectionData");


    }

    //Activity Amount Collection Functions


    public static String  fnCheckNewOrUpdateAndRetrieveCollectionData(String StoreID)
    {
        String flag="NEW";
        try {
            //open();
            Cursor cursor = db.rawQuery("SELECT PaymentMode, Amount,RefNoChequeNoTrnNo,Date,Bank from tblAllCollectionData where StoreID = '"+StoreID +"'", null);

            if(cursor.getCount()>0){
                if (cursor.moveToFirst()){
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        if(flag.equals("NEW")){
                            flag=	cursor.getString(0).toString()+"^"+cursor.getString(1).toString()+"^"+cursor.getString(2).toString()+"^"+cursor.getString(3).toString()+"^"+cursor.getString(4).toString();
                        }
                        else{
                            flag=flag+"~"+cursor.getString(0).toString()+"^"+cursor.getString(1).toString()+"^"+cursor.getString(2).toString()+"^"+cursor.getString(3).toString()+"^"+cursor.getString(4).toString();
                        }
                        cursor.moveToNext();
                    }

                }}
            return flag;
        }catch(Exception e)
        {

        }

        finally
        {

            //close();
            return flag;
        }
    }

    public static int fetchTblStockOut()
    {
        //open();
        int retVal=0;
        try
        {
            Cursor cur=db.rawQuery("Select flgStockOutEntryDone from tblDistributorStockOutFlg",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        retVal=Integer.parseInt(cur.getString(0));
                        cur.moveToNext();
                    }
                }
            }
        }
        catch(Exception e)
        {
            System.out.println("Error getOtherReason = "+e.toString());
        }
        finally
        {
           // close();
            return retVal;
        }
    }

    public static void inserttblStockUploadedStatus(Integer flgStockTrans,Integer VanLoadUnLoadCycID,String CycleTime,Integer statusId,Integer flgDayEnd)
    {

        ContentValues values=new ContentValues();
//tblStockUploadedStatus(flgStockTrans int null,VanLoadUnLoadCycID int null,CycleTime text null);";
        values.put("flgStockTrans",flgStockTrans);
        values.put("VanLoadUnLoadCycID",VanLoadUnLoadCycID);
        values.put("CycleTime",CycleTime);
        values.put("StatusId",statusId);
        values.put("flgDayEnd",flgDayEnd);


        db.insert(DATABASE_TABLE_tblStockUploadedStatus,null,values);



    }

    public static int fetchtblStockUploadedStatus()
    {
        //open();
        int retVal=0;
        try
        {
            Cursor cur=db.rawQuery("Select flgStockTrans from tblStockUploadedStatus",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        retVal=Integer.parseInt(cur.getString(0));
                        cur.moveToNext();
                    }
                }
            }
        }
        catch(Exception e)
        {
            System.out.println("Error getOtherReason = "+e.toString());
        }
        finally
        {
            //close();
            return retVal;
        }
    }

    public static int fetchtblDayEndStatus()
    {
        //open();
        int retVal=0;
        try
        {
            Cursor cur=db.rawQuery("Select flgDayEnd from tblStockUploadedStatus",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {

                        retVal=cur.getInt(0);
                        cur.moveToNext();

                }
            }
        }
        catch(Exception e)
        {
            System.out.println("Error getOtherReason = "+e.toString());
        }
        finally
        {
            //close();
            return retVal;
        }
    }

    public static String[] getAllStoreClosePhotoDetail()
    {

        int SnamecolumnIndex1 = 0;


        Cursor cursor = db.rawQuery("SELECT DISTINCT(StoreID) FROM tblStoreClosedPhotoDetail where Sstat=5", null);
        //Cursor cursor = db.rawQuery("SELECT StoreID FROM tblStoreMaterialPhotoDetail", null);
        try
        {
            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst())
            {
                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1).toString();
                    cursor.moveToNext();
                }
            }

            return StoreName;
        }
        finally
        {
            cursor.close();
        }

    }

    public static int getExistingPicNosForStoreClose(String StoreID)
    {

        int ScodecolumnIndex = 0;
       // tblStoreClosedPhotoDetail
        Cursor cursor = db.rawQuery("SELECT Count(StoreID) FROM tblStoreClosedPhotoDetail where StoreID='" + StoreID + "'", null);
        try {
            int strProdStockQty = 0;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    if (!cursor.isNull(ScodecolumnIndex)) {
                        strProdStockQty = Integer.parseInt(cursor.getString(ScodecolumnIndex).toString());
                        cursor.moveToNext();
                    }

                }
            }
            return strProdStockQty;
        } finally {
            cursor.close();
        }
    }

    public static String[] getImgsPathForStoreClose(String StoreID)
    {

        int SnamecolumnIndex1 = 0;

        Cursor cursor = db.rawQuery("SELECT PhotoName FROM tblStoreClosedPhotoDetail WHERE StoreID ='"+ StoreID + "'", null);
        try
        {

            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {

                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1).toString();
                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }

    }

    public static void updateImageRecordsSyncdForStoreClose(String PhotoName)
    {

        try
        {
            //open();
            //System.out.println("Sunil Doing Testing Response after sending Image inside BD" + PhotoName);
            final ContentValues values = new ContentValues();
            values.put("Sstat", 4);

            int affected3 = db.update("tblStoreClosedPhotoDetail", values, "PhotoName=?",new String[] { PhotoName });
        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }
        finally
        {
            //close();
        }


    }

    public static void UpdateStoreClosephotoFlag(String sID, int flag2set)
    {
        try
        {
            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);
            int affected16 = db.update("tblStoreClosedPhotoDetail", values,"StoreID=?", new String[] { sID });
        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }
    }

    public static LinkedHashMap<String,String> getPrdctIdAndSkuWrehouse()
    {
        //private static final String CREATE_TABLE_tblDistributorDayReport="
        // create table tblDistributorDayReport(ProductNodeID text null, ProductNodeType text null, SKUName text null, FlvShortName text null,StockDate text null,DistributorNodeID int null,DistributorNodeType int null);";
        LinkedHashMap<String,String> hmapGetData = new LinkedHashMap<>();
        int LoncolumnIndex = 0;

        Cursor cursor2=null;
        try {
            cursor2 = db.rawQuery("SELECT ProductNodeID,FlvShortName  FROM tblDistributorDayReport ", null);


            if (cursor2.moveToFirst())
            {
                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    hmapGetData.put(cursor2.getString(0),cursor2.getString(1));
                    cursor2.moveToNext();
                }

            }
            return hmapGetData;
        } finally {
            if(cursor2!=null) {
                cursor2.close();
            }
        }
    }

    public static void deleteConfirmWArehouse()
    {
        //open();
        db.execSQL("Delete from tblStockConfirm");
        //close();
    }

    public static void insertConfirmWArehouse(String UserId,String confirmFlg)
    {

        //open();
        deleteVanConfirmFlag();
        ContentValues values=new ContentValues();
        values.put("UserId",UserId);
        values.put("confirmFlg",confirmFlg);
        db.insert(DATABASE_TABLE_tblStockConfirm,null,values);
        db.execSQL("DELETE FROM tblDistributorProductStock");
//PrdctId text null,StockQntty text null,DistributorNodeIdNodeType text null,SKUName text null,OpeningStock text null,TodaysAddedStock text null,CycleAddedStock text null,NetSalesQty text null,TodaysUnloadStk text null,CycleUnloadStk text null,CategoryID
        db.execSQL("INSERT INTO " + DATABASE_TABLE_DISTRIBUTOR_STOCK + " SELECT * FROM " + DATABASE_TABLE_TMP_DISTRIBUTOR_STOCK);
        db.execSQL("DELETE FROM tblTmpDistributorStock");
        updateInvoiceExecuted();

        if (SplashScreen.sPrefVanStockChanged != null) {
            Editor editor = SplashScreen.sPrefVanStockChanged.edit();
            editor.clear();
            editor.commit();
        }
        CommonInfo.VanLoadedUnloaded=0;
        //DATABASE_TABLE_TMP_DISTRIBUTOR_STOCK
        //  DATABASE_TABE_DISTRIBUTOR_STOCK

        //close();

    }


    public static void updateInvoiceExecuted()
    {
       // flgProcessedInvoice,InvoiceNumber
        //tblDistributorIDOrderIDLeft(DistributorNodeIdNodeType text null,OrderId text null,flgProcessedInvoice int not null);";
        //tblInvoiceHeader (StoreVisitCode text not null,InvoiceNumber int not null,TmpInvoiceCodePDA text null, StoreID text not null, InvoiceDate string not null, TotalBeforeTaxDis real not null, TaxAmt real not null, TotalDis real not null, InvoiceVal real not null, FreeTotal integer not null, Sstat integer not null, InvAfterDis real not null, AddDis real not null,  NoCoupon int null, TotalCoupunAmount real null,TransDate string not null,FlgInvoiceType text not null,flgWholeSellApplicable int null,flgProcessedInvoice int not null,CycleID  int not null);";
        db.execSQL("UPDATE tblInvoiceHeader SET flgProcessedInvoice=(Select flgProcessedInvoice from tblDistributorIDOrderIDLeft Where (tblInvoiceHeader.InvoiceNumber=tblDistributorIDOrderIDLeft.OrderId))");

    }

    public static void deleteVanConfirmFlag()
    {

        db.execSQL("DELETE FROM tblStockConfirm");

    }

    public static int flgConfirmedWareHouse()
    {
        int flgConfirm=0;
        //open();
        try{


            Cursor cur=db.rawQuery("Select * from tblStockConfirm",null);
            if(cur.getCount()>0)
            {
                flgConfirm=1;
            }
        }catch(SQLException exception)
        {

        }
        finally
        {
            //close();
            return flgConfirm;
        }
    }

    public static double fnGettblPriceApplycutoffvalue(String storeID)
    {
        //open();
        Double cutoffvalue=0.0;
        Cursor cursor=db.rawQuery("Select ifnull(cutoffvalue,0.0) from tblPriceApplyType",null);

        if(cursor.getCount()>0)
        {
            if(cursor.moveToFirst())
            {
                cutoffvalue=Double.parseDouble(cursor.getString(0));
                //cutoffvalue=Double.parseDouble(decimalFormat.format(cutoffvalue));
            }
        }
        if(cursor!=null) {
            cursor.close();
        }
       // close();
        return cutoffvalue;
    }

    public static LinkedHashMap<String, String> fetch_Store_RemaningStockStatus()
    {

        //open();
        LinkedHashMap<String, String> hmapCatgry = new LinkedHashMap<String, String>();
//tblDistributorProductStock(PrdctId text null,StockQntty text null,DistributorNodeIdNodeType text null,SKUName text null,OpeningStock text null,TodaysAddedStock text null,CycleAddedStock text null,NetSalesQty text null,TodaysUnloadStk text null,CycleUnloadStk text null,CategoryID text null);";
        Cursor cursor= db.rawQuery("Select DISTINCT S.SKUName,S.StockQntty-ifnull(D.OrderQty,0) AS StockAvailable,((S.OpeningStock+S.TodaysAddedStock)-S.TodaysUnloadStk) As openingStk,S.NetSalesQty+ifnull(D.OrderQty,0) from tblDistributorProductStock S left outer join (SELECT ID.ProdID,SUM(ID.OrderQty) OrderQty FROM tblInvoiceHeader AS I INNER JOIN tblInvoiceDetails AS ID ON ID.InvoiceNumber=I.InvoiceNumber  WHERE I.flgProcessedInvoice=0 GROUP BY ID.ProdID) D ON D.ProdID=S.PrdctId", null);

//Cursor cur=db.rawQuery("Select PrdctId,OriginalStock from tblDistributorProductStock where DistributorNodeIdNodeType='"+distId+"'",null);
      //  Cursor	cursor = db.rawQuery("SELECT Distinct ProductShortName,IFNULL(StockQntty,0),IFNULL(OriginalStock,0) from tblDistributorProductStock inner join tblProductListMaster on tblDistributorProductStock.PrdctId=tblProductListMaster.ProductID", null); //order by AutoIdOutlet Desc
//Cursor	cursor = db.rawQuery("SELECT tblStoreList.StoreID, tblStoreList.StoreName, IFNULL(tblTmpInvoiceHeader.InvoiceVal,0) FROM tblStoreList left outer join tblTmpInvoiceHeader on tblStoreList.StoreID=tblTmpInvoiceHeader.StoreID", null); //order by AutoIdOutlet Desc
        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        //hmapCatgry.put(cursor.getString(0).toString(),cursor.getString(1).toString() + "( Order Value:-"+cursor.getString(2).toString()+")");
                        // hmapCatgry.put((i+1)+")  "+cursor.getString(0).toString(), "[Stock Left: "+cursor.getString(2).toString()+"]");//[Stock Loaded:->"+cursor.getString(1).toString()+ "]
                        hmapCatgry.put((i+1)+")  "+cursor.getString(0).toString(), cursor.getString(1).toString()+"^"+cursor.getString(2).toString()+"^"+cursor.getString(3).toString());//[Stock Loaded:->"+cursor.getString(1).toString()+ "]

                        cursor.moveToNext();
                    }
                }

            }

            else
            {
                hmapCatgry.put("No Stock", "0");
            }
            return hmapCatgry;
        }
        finally
        {
            if(cursor!=null) {
                cursor.close();
            }
            //close();
        }
    }

    public static Double fetch_Store_MaxCollectionAmount(String StoreID,String TmpInvoiceCodePDA)
    {
//tv_GrossInvVal
        //open();
        Double dblMaxCollectionAmount = 0.0;
        Cursor	cursor = db.rawQuery("SELECT ifnull(tblLastOutstanding.Outstanding,'0.0'),tblTmpInvoiceHeader.InvoiceVal from tblTmpInvoiceHeader left outer join tblLastOutstanding on tblTmpInvoiceHeader.StoreID=tblLastOutstanding.StoreID WHERE tblTmpInvoiceHeader.StoreID='"+StoreID+"' AND tblTmpInvoiceHeader.TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'", null); //order by AutoIdOutlet Desc
        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        //hmapCatgry.put(cursor.getString(0).toString(),cursor.getString(1).toString() + "( Order Value:-"+cursor.getString(2).toString()+")");
                        dblMaxCollectionAmount=Double.parseDouble(cursor.getString(0).toString())+Double.parseDouble(cursor.getString(1).toString());

                        cursor.moveToNext();
                    }
                }

            }

            else
            {
                dblMaxCollectionAmount=0.0;
            }
            return dblMaxCollectionAmount;
        }
        finally
        {
            if(cursor!=null) {
                cursor.close();
            }
            //close();
        }
    }

    public static Double fetch_Store_InvValAmount(String StoreID,String TmpInvoiceCodePDA)
    {
//tv_GrossInvVal
        //open();
        Double dblMaxCollectionAmount = 0.0;
       // Cursor   cursor = db.rawQuery("SELECT tblTmpInvoiceHeader.InvoiceVal from tblTmpInvoiceHeader WHERE tblTmpInvoiceHeader.StoreID='"+StoreID+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'", null); //order by AutoIdOutlet Desc
        Cursor cursor = db.rawQuery("SELECT tblTmpInvoiceHeader.InvoiceVal from tblTmpInvoiceHeader WHERE tblTmpInvoiceHeader.StoreID='"+StoreID+"'", null); //order by AutoIdOutlet Desc
        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        //hmapCatgry.put(cursor.getString(0).toString(),cursor.getString(1).toString() + "( Order Value:-"+cursor.getString(2).toString()+")");
                        dblMaxCollectionAmount=Double.parseDouble(cursor.getString(0).toString());

                        cursor.moveToNext();
                    }
                }

            }

            else
            {
                dblMaxCollectionAmount=0.0;
            }
            return dblMaxCollectionAmount;
        }
        finally
        {
            if(cursor!=null) {
                cursor.close();
            }
           // close();
        }
    }




    public static double fnGetStoretblLastOutstanding(String storeID)
    {
        //open();
        double LastOutstanding=0.0;
        Cursor cursor=db.rawQuery("Select ifnull(Outstanding,'0.0') from tblLastOutstanding WHERE StoreID='"+storeID+"'",null);

        if(cursor.getCount()>0)
        {
            if(cursor.moveToFirst())
            {
                LastOutstanding=Double.parseDouble(cursor.getString(0));
            }
        }
        if(cursor!=null) {
            cursor.close();
        }
       // close();
        return LastOutstanding;
    }

    public static Double  fnTotCollectionAmtAgainstStore(String StoreID,String TmpInvoiceCodePDA,String StoreVisitCode)
    {
        //open();
        Double TotCollectionAmt=0.0;
        try {

            Cursor cursor = db.rawQuery("SELECT  SUM(IFNULL(Amount,0.0)) from tblAllCollectionData where StoreID = '"+StoreID +"' AND StoreVisitCode='"+StoreVisitCode+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'", null);
            if(cursor.getCount()>0){
                if (cursor.moveToFirst()){
                    TotCollectionAmt=Double.parseDouble(cursor.getString(0).toString());
                }
            }
        }catch(Exception e)
        {

        }
        finally
        {
            if(cursor!=null)
            {
                cursor.close();;
            }
           // close();
            // return flag;
        }
        return TotCollectionAmt;
    }

    public static String[] fetch_Store_tblInvoiceLastVisitDetails(String StoreID)
    {
//tv_GrossInvVal
        //open();

        Cursor	cursor = db.rawQuery("SELECT ifnull(tblInvoiceLastVisitDetails.InvCode,'0.0'),ifnull(tblInvoiceLastVisitDetails.InvDate,'NA'),ifnull(tblInvoiceLastVisitDetails.OutstandingAmt,'0.0'),ifnull(tblInvoiceLastVisitDetails.AmtOverdue,'0.0') from tblInvoiceLastVisitDetails WHERE tblInvoiceLastVisitDetails.StoreID='"+StoreID+"'", null); //order by AutoIdOutlet Desc
        String InvoiceLastVisitDetails[]= new String[cursor.getCount()];
        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        InvoiceLastVisitDetails[i]=cursor.getString(0).toString()+"^"+cursor.getString(1).toString()+"^"+cursor.getString(2).toString()+"^"+cursor.getString(3).toString();
                        cursor.moveToNext();
                    }
                }
            }
            return InvoiceLastVisitDetails;
        }
        finally
        {
            if(cursor!=null) {
                cursor.close();
            }
           // close();
        }
    }

    public static long savetblInvoiceCaption(String INVPrefix,int VanIntialInvoiceIds,String INVSuffix)
    {
        ContentValues initialValues = new ContentValues();
        initialValues.put("INVPrefix", INVPrefix);
        initialValues.put("VanIntialInvoiceIds", VanIntialInvoiceIds);
        initialValues.put("INVSuffix", INVSuffix);
        return db.insert(DATABASE_TABLE_tblInvoiceCaption, null, initialValues);
    }

    public static void Delete_tblInvoiceCaption()
    {
        db.execSQL("DELETE FROM tblInvoiceCaption");

    }

    public static int fnCheckForNewInvoiceOrPreviousValue(String StoreID,String StoreVisitCode)
    {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT * FROM tblTmpInvoiceHeader WHERE StoreID='" + StoreID + "' AND StoreVisitCode='"+StoreVisitCode+"' AND Sstat=1", null);
        int chkI = 0;
        try {
            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst()) {
                    chkI = 1;
                }
            }
        } finally {
            if(cursorE2!=null) {
                cursorE2.close();
            }
           // close();
        }
        return chkI;
    }

  /*  public static String fnGettblInvoiceCaption(String StoreID)
    {
        //open();
        String VanInvoiceGeneratedNumber="";
        Cursor cursor=db.rawQuery("Select INVPrefix,VanIntialInvoiceIds from tblInvoiceCaption",null);

        if(cursor.getCount()>0)
        {
            if(cursor.moveToFirst())
            {
                VanInvoiceGeneratedNumber=(cursor.getString(0))+(Integer.parseInt(cursor.getString(1)));
            }
        }
        if(cursor!=null) {
            cursor.close();
        }
        close();
        return VanInvoiceGeneratedNumber;
    }
*/

    /*public static int fnGettblInvoiceIds()
    {
        //open();
        int VanInvoiceIds=0;
        Cursor cursor=null;
        try {
            cursor   =db.rawQuery("Select VanIntialInvoiceIds from tblInvoiceCaption",null);

            if(cursor.getCount()>0)
            {
                if(cursor.moveToFirst())
                {
                    VanInvoiceIds=Integer.parseInt(cursor.getString(0));
                }
            }
        }
        catch(Exception ex)
        {

        }
        finally
        {
            if(cursor!=null) {
                cursor.close();
            }
            close();
        }

        return VanInvoiceIds;
    }*/
   /* public static void updatetblInvoiceCaption(String VanID)
    {
        int VanInvoiceIds=fnGettblInvoiceIds();
        //open();
//tblInvoiceCaption(INVPrefix text null,VanIntialInvoiceIds int null,FinalAllotedInvoiceIds int null);";
        db.execSQL("Update tblInvoiceCaption Set  VanIntialInvoiceIds="+(VanInvoiceIds+1));

        close();
    }*/

  /*  public static int fnCheckForNewInvoiceOrPreviousValue(String StoreID)
    {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT * FROM tblTmpInvoiceHeader WHERE StoreID='" + StoreID + "' AND Sstat=1", null);
        int chkI = 0;
        try {
            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst()) {
                    chkI = 1;
                }
            }
        } finally {
            if(cursorE2!=null) {
                cursorE2.close();
            }
            close();
        }
        return chkI;
    }*/
    public static String fnGetExistingInvoiceNumber (String StoreID)
    {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT TmpInvoiceCodePDA FROM tblTmpInvoiceHeader WHERE StoreID='" + StoreID + "' AND Sstat=1", null);
        String TmpInvoiceCodePDA = "0";
        try {
            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst()) {
                    TmpInvoiceCodePDA = cursorE2.getString(0).toString();
                }
            }
        } finally {
            if(cursorE2!=null) {
                cursorE2.close();
            }
           // close();
        }
        return TmpInvoiceCodePDA;
    }

    public static void updateOutstandingOfStore(String StoreID,Double OutStandingAmt)
    {

        //open();
        //
        try
        {
            db.execSQL("Update tblLastOutstanding Set  Outstanding="+OutStandingAmt+" WHERE StoreID='"+StoreID+"'");
        }
        catch (Exception ex)
        {

        }



       // close();
    }

    public static void deletetblDistributorOrderPdaId()
    {


        db.execSQL("DELETE FROM tblDistributorOrderPdaId");
        //db.execSQL("DELETE FROM tblDistributorProductStock");
        db.execSQL("DELETE FROM tblDistributorIDOrderIDLeft");
        //db.execSQL("DELETE FROM tblDistributorOrderPdaId");

        db.execSQL("DELETE FROM tblDistributorStockOutFlg");


    }

    public static HashMap<String, String> checkForStoreIdVisitStatus()
    {
        Cursor cursor=db.rawQuery("Select StoreID,VisitTypeStatus from tblStoreVisitMstr",null);
        HashMap<String, String> hmapStoreIdVisitStatus=new HashMap<String, String>();
        if(cursor.getCount()>0)
        {
            if(cursor.moveToFirst())
            {
                for(int index=0;index<cursor.getCount();index++)
                {
                    hmapStoreIdVisitStatus.put(cursor.getString(0), cursor.getString(1));
                    cursor.moveToNext();
                }
            }
        }
        return hmapStoreIdVisitStatus;
    }

    public static void updateVisitTypeStatusOfStore(String StoreID,String VisitTypeStatus,String StoreVisitCode)
    {
        //open();
        try
        {
            db.execSQL("Update tblStoreVisitMstr Set  VisitTypeStatus="+VisitTypeStatus+" WHERE StoreID='"+StoreID+"' and StoreVisitCode='"+StoreVisitCode+"'");
        }
        catch (Exception ex)
        {

        }
       // close();
    }

    public static int fnStoreCountWithVisitTypeStatus()
    {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT Count(VisitTypeStatus) FROM tblStoreVisitMstr WHERE VisitTypeStatus=1 OR VisitTypeStatus=3", null);
        int chkI = 0;
        try {
            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst()) {
                    chkI = Integer.valueOf(cursorE2.getCount());
                }
            }
        } finally {
            if(cursorE2!=null) {
                cursorE2.close();
            }
            //close();
        }
        return chkI;
    }

    public static int fnStoreCountWithsStatStatus()
    {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT Count(Sstat) FROM tblStoreList WHERE Sstat=1", null);
        int chkI = 0;
        try {
            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst()) {
                    chkI = Integer.valueOf(cursorE2.getCount());
                }
            }
        } finally {
            if(cursorE2!=null) {
                cursorE2.close();
            }
            //close();
        }
        return chkI;
    }

    public static void UpdateStoreFlagAtDayEndOrChangeRouteWithOnlyVistOrCollection(String sID, int flag2set)
    {

        try
        {

            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);

            int affected24 = db.update("tblStoreOrderBillAddressDetails", values, "StoreID=?",new String[] { sID });
            int affected25 = db.update("tblStoreSalesOrderPaymentDetails", values, "StoreId=?",new String[] { sID });
            int affected26 = db.update("tblRateDistribution", values,"StoreId=?", new String[] { sID });
            // int affected27 = db.update("tableImage", values,"StoreID=?", new String[] { sID });

            //tblNewStoreSalesQuotePaymentDetails (StoreId text null,PymtStageId text null,Sstat text null);";
            int affected23 = db.update("tblNewStoreSalesQuotePaymentDetails", values,"StoreId=?", new String[] { sID });

            //tblOutletQuestAnsMstr
            ////// System.out.println("Updating Status for Store ID: " + sID);
            int affected = db.update("tblStoreList", values, "StoreID=?",new String[] { sID });
            int affected61 = db.update("tblStoreCheckInPic", values, "StoreID=?",new String[] { sID });
            int affected121 = db.update("tblNewAddedStoreLocationDetails", values, "StoreID=?",new String[] { sID });
            //int affected2 = db.update("tblTransac", values, "StoreID=?",new String[] { sID });

            int affected4 = db.update("tblNewStoreListEntries", values,"StoreID=?", new String[] { sID });

            //int affected4 = db.update("tblDistributionStoreProductWiseDetails", values, "StoreID=?",new String[] { sID });
            //int affected5 = db.update("tblDistributionStoreProductMstr", values, "StoreID=?",new String[] { sID });

            int affected9 = db.update("tblNewStoreEntries", values,"StoreID=?", new String[] { sID });
            int affected10 = db.update("tblTemp", values,"StoreID=?", new String[] { sID });

         //   int affected3 = db.update("tblTmpInvoiceHeader", values, "StoreID=? ",new String[] { sID });

            //int affected4 = db.update("tblDistributionStoreProductWiseDetails", values, "StoreID=?",new String[] { sID });
            //int affected5 = db.update("tblDistributionStoreProductMstr", values, "StoreID=?",new String[] { sID });
            int affected5 = db.update("tblPDAProductReturnMstr", values,
                    "StoreID=? ", new String[] { sID });

           // int affected7 = db.update("tblTmpInvoiceDetails", values,"StoreID=?  ", new String[] { sID });
            int affected8 = db.update("tblStoreProductAppliedSchemesBenifitsRecords", values,"StoreID=? ", new String[] { sID });



            int affected11 = db.update("tblStoreReturnDetail", values,"StoreID=? ", new String[] { sID });

            //int affected12 = db.update("tblStoreReturnDetail", values,"StoreID=?", new String[] { sID });
            int affected13 = db.update("tblProductMappedWithSchemeSlabApplied", values,"StoreId=? ", new String[] { sID });
            //StoreId text null,ProductID text null,schSlabId text null,schmIdMapped text null,Sstat int null);";
            int affected14 = db.update("tblStoreProductPhotoDetail", values,"StoreID=? ", new String[] { sID });

            int affected21 = db.update("tblOutletQuestAnsMstr", values,"OutletID=?", new String[] { sID });


            int affected17 = db.update("tblSalesQuotePersonMeetMstr", values,"StoreId=?", new String[] { sID });

            //int affected171 = db.update("tblAllCollectionData", values,"StoreID=?", new String[] { sID });

            // int affected19 = db.update("tblDsrRegDetails", values, "StoreID=?",new String[] { sID });

            db.execSQL("UPDATE tblDsrRegDetails SET Sstat="+flag2set);

            LinkedHashMap<String, String> hmapDistinctSalesQuotePersonMeetMstr= fngetDistinctSalesQuotePersonMeetMstrForSstatUpdate(sID);


            Iterator it11new = hmapDistinctSalesQuotePersonMeetMstr.entrySet().iterator();

            while (it11new.hasNext()) {
                Entry pair = (Entry)it11new.next();
                if(hmapDistinctSalesQuotePersonMeetMstr.containsKey(pair.getKey().toString())){
                    //crntPID	=pair.getKey().toString();
                    int affected18 = db.update("tblSalesQuoteProductsMstr", values,"SalesQuoteId=?", new String[] { pair.getKey().toString() });
                }

            }


            int chkValue = fnChkStoreIdExistsInReturnMstrDayEndChangeRoute(sID);

            if (chkValue == 1)
            {
                int productreturnmstrid = fnGetAutoIdStoreOnReturnPAge(sID);

                int chkValueReturnDetails = fnChkAutoIdMstrForReturnDetailsChangeRouteDayEnd(productreturnmstrid);
                if (chkValueReturnDetails == 1)
                {
                    int affected6 = db.update("tblPDAProductReturnDetails",
                            values, "ReturnIdMstr=? ", new String[] { ""
                                    + productreturnmstrid });
                }
            }

            Log.w(TAG, "affected records: " + affected);

            Log.w(TAG, "Record(s) Updated..");

        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }

    }

    public static LinkedHashMap<String,String> fnGetStoreListToProcessWithoutAlret()
    {
        //open();
        int LoncolumnIndex = 0;
        int LoncolumnIndex2 = 1;
        LinkedHashMap<String,String> hmapStoreListToProcessWithoutAlret=new LinkedHashMap<String,String>();
        //Cursor cursor2 = db.rawQuery("SELECT StoreID, StoreName FROM tblStoreList WHERE (Sstat = 1  OR StoreNextDay = 1) and Sstat<>4  and Sstat<>5 and Sstat<>6",null);//OR StoreClose = 1
        Cursor cursor2 = db.rawQuery("SELECT tblStoreVisitMstr.StoreID, tblStoreList.StoreName FROM tblStoreVisitMstr inner join tblStoreList On tblStoreVisitMstr.StoreID=tblStoreList.StoreID WHERE tblStoreVisitMstr.Sstat = 1 AND (VisitTypeStatus='1' OR VisitTypeStatus='3')",null);//OR StoreClose = 1
        try
        {
            String strAreaIdsDetais[] = new String[cursor2.getCount()];
            ////// System.out.println("records count[ProcessStoreReq]: "+cursor2.getCount());
            if (cursor2.moveToFirst())
            {
                for (int i = 0; i < cursor2.getCount(); i++)
                {
                    hmapStoreListToProcessWithoutAlret.put((String) cursor2.getString(LoncolumnIndex),(String) cursor2.getString(LoncolumnIndex2)); //(String) cursor2.getString(LoncolumnIndex)+ "%"+ (String) cursor2.getString(LoncolumnIndex2);
                    ////// System.out.println("VAL1: "+(String) cursor2.getString(LoncolumnIndex) + "  "+"VAL2: "+(String) cursor2.getString(LoncolumnIndex2));
                    cursor2.moveToNext();
                }
            }
            return hmapStoreListToProcessWithoutAlret;
        }
        finally
        {
            if(cursor2!=null)
            {
                cursor2.close();
            }
           // close();
        }

    }

    public static int fnCounttblDistributorProductLeft()
    {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT * FROM tblDistributorIDOrderIDLeft", null);
        int chkI = 0;
        try {
            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst()) {
                    chkI = Integer.valueOf(cursorE2.getCount());
                }
            }
        }
        catch(Exception ex)
        {

        }
        finally {
            if(cursorE2!=null) {
                cursorE2.close();
            }
            //close();
        }
        return chkI;
    }

    public static String fnGetRouteIDWhilePurshase()
    {
        int LoncolumnIndex = 0;


        Cursor cursor3 = null;
        try
        {
            //cursor2 = db.rawQuery("SELECT ID FROM tblRouteListMaster WHERE flgTodayRoute = 1 Limit 1", null);
            cursor3 = db.rawQuery("SELECT ID FROM tblRouteListMaster WHERE flgTodayRoute = 0 Limit 1", null);


            String activeRouteID = "0";
            if (cursor3.moveToFirst()) {

                for (int i = 0; i < cursor3.getCount(); i++)
                {
                    activeRouteID = cursor3.getString(LoncolumnIndex);
                    cursor3.moveToNext();

                }

            }
            return activeRouteID;
        } finally {
            if(cursor3!=null) {
                cursor3.close();
            }

        }

    }

    public static LinkedHashMap<String, String> fetch_Category_ForWarehouseCheckIn()
    {
        //open();
        LinkedHashMap<String, String> hmapCatgry = new LinkedHashMap<String, String>();
        Cursor cursor = db.rawQuery("SELECT DISTINCT CategoryID,CategoryDescr FROM tblCategoryMaster  Order by CatOrdr",null);
      //  Cursor cursorStock = db.rawQuery("SELECT DISTINCT tblDistributorProductStock.CategoryID,tblCategoryMaster.CategoryDescr FROM tblCategoryMaster inner join tblDistributorProductStock ON tblDistributorProductStock.CategoryID=tblCategoryMaster.CategoryID Order by tblCategoryMaster.CatOrdr",null);
        //"Select PrdctId,SKUName,OriginalStock,OpeningStock,AddedStock,NetStockQty,CategoryID from tblDistributorProductStock",null);
       // System.out.println("Count to ="+cursorCat.getCount()+" : "+cursorStock.getCount());
       // Cursor cursor = db.rawQuery("SELECT DISTINCT tblDistributorProductStock.CategoryID,CategoryDescr FROM tblCategoryMaster inner join tblDistributorProductStock ON tblDistributorProductStock.CategoryID=tblCategoryMaster.CategoryID Order by CatOrdr",null);
        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {

                        hmapCatgry.put(cursor.getString(1).toString(),cursor.getString(0).toString());
                        cursor.moveToNext();
                    }
                }

            }

            else
            {
                hmapCatgry.put("No Category", "0");
            }
            return hmapCatgry;
        }
        finally
        {
            if(cursor!=null) {
                cursor.close();
            }
            //close();
        }
    }

   /* public static String fnGetFinalAllotedInvoiceIds(String StoreID)
    {
        //open();
        String VanFinalAllotedInvoiceId="";
        Cursor cursor=db.rawQuery("Select INVPrefix,VanIntialInvoiceIds from tblInvoiceCaption",null);

        if(cursor.getCount()>0)
        {
            if(cursor.moveToFirst())
            {
                VanFinalAllotedInvoiceId=(cursor.getString(0))+(Integer.parseInt(cursor.getString(1)));
            }
        }
        if(cursor!=null) {
            cursor.close();
        }
        close();
        return VanFinalAllotedInvoiceId;
    }*/
   /* public static void updateFinalAllotedInvoiceIdstblInvoiceCaption()
    {
        int FinalAllotedInvoiceIds=fnGettblInvoiceAllotmentId();
        //open();
///tblInvoiceCaption(INVPrefix text null,VanIntialInvoiceIds int null,FinalAllotedInvoiceIds int null);";
        db.execSQL("Update tblInvoiceCaption Set  VanIntialInvoiceIds="+(FinalAllotedInvoiceIds+1));
      //  db.execSQL("Update tblInvoiceCaption Set  VanIntialInvoiceIds="+(FinalAllotedInvoiceIds+1));

        close();
    }*/
    public static int fnGettblInvoiceAllotmentId()
    {

        int VanInvoiceIds=0;
        Cursor cursor=null;
        try {
            cursor   =db.rawQuery("Select VanIntialInvoiceIds from tblInvoiceCaption",null);

            if(cursor.getCount()>0)
            {
                if(cursor.moveToFirst())
                {
                    VanInvoiceIds=Integer.parseInt(cursor.getString(0));
                }
            }
        }
        catch(Exception ex)
        {

        }
        finally
        {
            if(cursor!=null) {
                cursor.close();
            }

        }

        return VanInvoiceIds;
    }

  /*  public static String fnGetFinalAllotedInvoiceIdsAgainstInvoiceTable(String StoreID)
    {
        //open();
        String VanFinalAllotedInvoiceId="NA";
        Cursor cursor=db.rawQuery("Select INVPrefix,VanIntialInvoiceIds from tblInvoiceCaption",null);

        if(cursor.getCount()>0)
        {
            if(cursor.moveToFirst())
            {
                VanFinalAllotedInvoiceId=(cursor.getString(0))+(Integer.parseInt(cursor.getString(1)));
            }
        }
        if(cursor!=null) {
            cursor.close();
        }
        close();
        return VanFinalAllotedInvoiceId;
    }*/
    public static int fnGetStoreCurrentOutsStat(String StoreID)
    {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT Sstat FROM  tblStoreList where StoreID='"+StoreID+"'", null);
        int StoreCurrentOutsStat = 0;

        try {
            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst())
                {


                    StoreCurrentOutsStat = (Integer.parseInt(cursorE2.getString(0).toString()));


                }
            }
            return StoreCurrentOutsStat;
        } finally {
            if(cursorE2!=null) {
                cursorE2.close();
            }
            //close();
        }

    }

    public static String fnGetStoreVisitCode(String StoreID)
    {
        //open();
        String StoreVisitCode="NA";
        Cursor cursor=db.rawQuery("Select StoreVisitCode from tblStoreVisitMstr Where StoreID='"+StoreID+"' AND Sstat=1",null);

        if(cursor.getCount()>0)
        {
            if(cursor.moveToFirst())
            {
                StoreVisitCode=cursor.getString(0);
            }
        }
        if(cursor!=null) {
            cursor.close();
        }
        //close();
        return StoreVisitCode;
    }

    public static void fnInsertOrUpdate_tblStoreVisitMstr(String StoreVisitCode,String StoreID,int Sstat,String ForDate,String ActualLatitude,String ActualLongitude,String VisitTimeOutSideStore,String VisitTimeInSideStore,String VisitTimeCheckStore,String VisitEndTS,String LocProvider,String Accuracy,String BateryLeftStatus,int StoreClose,int StoreNextDay,int ISNewStore,int IsNewStoreDataCompleteSaved,int flgFromWhereSubmitStatus,int flgSubmitFromQuotation,int flgLocationServicesOnOff,int flgGPSOnOff,int flgNetworkOnOff,int flgFusedOnOff,int flgInternetOnOffWhileLocationTracking,int flgStoreOrder,int flgRetailerCreditBalnce,int VisitTypeStatus,int flgVisitCollectionMarkedStatus)
    {

        //open();
        try {
            Cursor cursor = db.rawQuery("SELECT StoreVisitCode FROM tblStoreVisitMstr where StoreVisitCode='"+StoreVisitCode +"' AND StoreID='"+StoreID+"' AND Sstat=1" , null);
            ContentValues initialValues = new ContentValues();
            initialValues.put("IMEINumber", CommonInfo.imei.toString());
            initialValues.put("Sstat", Sstat);

            initialValues.put("VisitEndTS", VisitEndTS);
            initialValues.put("flgFromWhereSubmitStatus", flgFromWhereSubmitStatus);
           // initialValues.put("flgOrderType", flgOrderType);
            //flgOrderType
            //flgFromWhereSubmitStatus
            if(cursor.getCount()>0)
            {
                int affected = db.update(DATABASE_TABLE_STOREVISIT, initialValues, "StoreID=? AND StoreVisitCode=?",new String[] {StoreID,StoreVisitCode});
            }
            else
            {
                initialValues.put("BateryLeftStatus", BateryLeftStatus);
                initialValues.put("IsNewStoreDataCompleteSaved", 0);
                initialValues.put("StoreVisitCode", StoreVisitCode);
                initialValues.put("StoreID", StoreID);
                initialValues.put("ForDate", ForDate);
                initialValues.put("ActualLatitude", ActualLatitude);
                initialValues.put("ActualLongitude", ActualLongitude);
                initialValues.put("VisitTimeOutSideStore", VisitTimeOutSideStore);
                initialValues.put("VisitTimeInSideStore", VisitTimeInSideStore);
                initialValues.put("VisitTimeCheckStore", VisitTimeCheckStore);//01-JAN-1900
                initialValues.put("LocProvider", LocProvider);
                initialValues.put("Accuracy", Accuracy);
                initialValues.put("StoreClose", StoreClose);
                initialValues.put("StoreNextDay", StoreNextDay);
                initialValues.put("ISNewStore", ISNewStore);
                // initialValues.put("IsNewStoreDataCompleteSaved", IsNewStoreDataCompleteSaved);
                initialValues.put("flgSubmitFromQuotation", flgSubmitFromQuotation);
                initialValues.put("flgLocationServicesOnOff", flgLocationServicesOnOff);
                initialValues.put("flgGPSOnOff", flgGPSOnOff);
                initialValues.put("flgNetworkOnOff", flgNetworkOnOff);
                initialValues.put("flgFusedOnOff", flgFusedOnOff);
                initialValues.put("flgInternetOnOffWhileLocationTracking", flgInternetOnOffWhileLocationTracking);
                initialValues.put("flgStoreOrder", flgStoreOrder);
                initialValues.put("flgRetailerCreditBalnce", flgRetailerCreditBalnce);
                initialValues.put("flgInternetOnOffWhileLocationTracking", flgInternetOnOffWhileLocationTracking);
                initialValues.put("VisitTypeStatus", VisitTypeStatus);
                initialValues.put("flgVisitCollectionMarkedStatus", flgVisitCollectionMarkedStatus);
                initialValues.put("SelfCreditNote", 0.0);

                db.insert(DATABASE_TABLE_STOREVISIT, null, initialValues);
            }
        } finally {
           // close();
        }
    }



    public static LinkedHashMap<String, String> fngetStoreBasicDetails(String StoreID)
    {
        LinkedHashMap<String, String> hmapStoreBasicDetails=new LinkedHashMap<String, String>();//=null;
        Cursor cur=null;
        //open();
        try {
            cur=db.rawQuery("Select ifnull(StoreName,'NA'),ifnull(OwnerName,'NA'),ifnull(StoreContactNo,'NA'),ifnull(StoreAddress,'NA'),ifnull(StoreCatType,'NA'),ifnull(SalesPersonName,'NA'),ifnull(SalesPersonContact,'NA') from tblStoreList where StoreID = '"+StoreID+"'", null);//
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    // System.out.println("System Value :"+cur.getString(0)+"="+ cur.getString(1)+"~"+cur.getString(2));
                    hmapStoreBasicDetails.put("StoreName", cur.getString(0));
                    hmapStoreBasicDetails.put("OwnerName", cur.getString(1));
                    hmapStoreBasicDetails.put("StoreContactNo", cur.getString(2));
                    hmapStoreBasicDetails.put("StoreAddress", cur.getString(3));
                    hmapStoreBasicDetails.put("StoreCatType", cur.getString(4));
                    hmapStoreBasicDetails.put("SalesPersonName", cur.getString(5));
                    hmapStoreBasicDetails.put("SalesPersonContact", cur.getString(6));

                }

            }

        }
        catch(Exception ex)
        {
            hmapStoreBasicDetails.put("StoreName", "NA");
            hmapStoreBasicDetails.put("OwnerName", "NA");
            hmapStoreBasicDetails.put("StoreContactNo","NA");
            hmapStoreBasicDetails.put("StoreAddress", "NA");
            hmapStoreBasicDetails.put("StoreCatType", "NA");
        }
        finally {
            if (cur != null) {
                cur.close();
            }
            //close();
        }
        return hmapStoreBasicDetails;
    }

    public static String fnGetInvoiceCodePDA (String StoreID,String StoreVisitCode)
    {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT TmpInvoiceCodePDA FROM tblTmpInvoiceHeader WHERE StoreID='" + StoreID + "' AND StoreVisitCode='"+StoreVisitCode+"' AND Sstat=1", null);
        String InvoiceCodePDA = "0";
        try {
            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst()) {
                    InvoiceCodePDA = cursorE2.getString(0).toString();
                }
            }
        } finally {
            if(cursorE2!=null) {
                cursorE2.close();
            }
           // close();
        }
        return InvoiceCodePDA;
    }


    // function given by Abhianv Sir Start

    public static long saveStoreTempInvoice(String StoreVisitCode,String TmpInvoiceCodePDA,String storeID,String pickerDate,Double TBtaxDis,Double TAmt,Double Dis,Double INval,
                                     int Ftotal,Double InvAfterDis,Double AddDis,int  NoOfCouponValue,Double TotalCoupunAmount,String pickerDateWithTime,int flgTransType,
                                     int flgWholeSellApplicable,int flgRuleTaxVal,int Outstat,int flgTransferStatus)// , Double CreditAmt, Double

    {


        ContentValues initialValues = new ContentValues();

        initialValues.put("StoreVisitCode", StoreVisitCode);
        initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
        initialValues.put("StoreID", storeID);
        initialValues.put("InvoiceDate", pickerDate);
        initialValues.put("TotalBeforeTaxDis", TBtaxDis);
        initialValues.put("TaxAmt", TAmt);
        initialValues.put("TotalDis", Dis);
        initialValues.put("InvoiceVal", INval);
        initialValues.put("FreeTotal", Ftotal);
        initialValues.put("InvAfterDis", InvAfterDis);
        initialValues.put("AddDis", AddDis);
        initialValues.put("NoCoupon", NoOfCouponValue);
        initialValues.put("TotalCoupunAmount", TotalCoupunAmount);
        initialValues.put("TransDate", pickerDateWithTime);
        initialValues.put("FlgInvoiceType", flgTransType);
        initialValues.put("flgWholeSellApplicable", flgWholeSellApplicable);
        initialValues.put("flgTransferStatus", flgTransferStatus);
      //  initialValues.put("flgRuleTaxVal", flgRuleTaxVal);
        //flgTransferStatus
        initialValues.put("Sstat", Outstat);

        return db.insert(DATABASE_TABLE_MAIN32, null, initialValues);
    }

    public static long fnsaveStoreFinalInvoiceSummaryEntry(String StoreVisitCode,String TmpInvoiceCodePDA,String storeID,String pickerDate,Double TBtaxDis,Double TAmt,Double Dis,Double INval,
                                                    int Ftotal,Double InvAfterDis,Double AddDis,int  NoOfCouponValue,Double TotalCoupunAmount,String pickerDateWithTime,int flgTransType,
                                                    int flgWholeSellApplicable,int flgRuleTaxVal,int Outstat,String FinalInvoiceNumberGenerated)// , Double CreditAmt, Double

    {
        int CycleID=fetchtblVanCycleIdForInvoiceHeader();

        ContentValues initialValues = new ContentValues();

        initialValues.put("StoreVisitCode", StoreVisitCode);
        initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
        initialValues.put("StoreID", storeID);
        initialValues.put("InvoiceDate", pickerDate);
        initialValues.put("TotalBeforeTaxDis", TBtaxDis);
        initialValues.put("TaxAmt", TAmt);
        initialValues.put("TotalDis", Dis);
        initialValues.put("InvoiceVal", INval);
        initialValues.put("FreeTotal", Ftotal);
        initialValues.put("InvAfterDis", InvAfterDis);
        initialValues.put("AddDis", AddDis);
        initialValues.put("NoCoupon", NoOfCouponValue);
        initialValues.put("TotalCoupunAmount", TotalCoupunAmount);
        initialValues.put("TransDate", pickerDateWithTime);
        initialValues.put("FlgInvoiceType", flgTransType);
        initialValues.put("flgWholeSellApplicable", flgWholeSellApplicable);
        //initialValues.put("flgRuleTaxVal", flgRuleTaxVal);
        initialValues.put("InvoiceNumber", FinalInvoiceNumberGenerated);

        initialValues.put("flgProcessedInvoice", 0);
        initialValues.put("CycleID", CycleID);
        initialValues.put("Sstat", Outstat);
        return db.insert(DATABASE_TABLE_INVOICE_HEADER, null, initialValues);


    }

    public static long saveStoreFinalInvoiceDetails(String TmpInvoiceCodePDA,String storeID,String PCateId,String ProductID,Double PRate,Double TaxRate,int flgRuleTaxVal,int OrderQTY,int SelectedUOMId,Double LineValBfrTxAftrDscnt,Double LineValAftrTxAftrDscnt,                                                 int OrderFreeQty,Double OrderDisVal,int SampleQTY,String PName,Double TaxValue,String strGlobalOrderID,int flgIsQuoteRateApplied,int PriceApplyDiscountLevelType,String distID,int Outstat,String FinalInvoiceNumberGenerated)
    {
        ContentValues initialValues = new ContentValues();
        initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
        initialValues.put("StoreID", storeID);
        initialValues.put("CatID", PCateId);
        initialValues.put("ProdID", ProductID);
        initialValues.put("ProductPrice", PRate);
        initialValues.put("TaxRate", TaxRate);
        initialValues.put("flgRuleTaxVal", flgRuleTaxVal);
        initialValues.put("OrderQty", OrderQTY);
        initialValues.put("UOMId", SelectedUOMId);

        initialValues.put("LineValBfrTxAftrDscnt", LineValBfrTxAftrDscnt);

        initialValues.put("LineValAftrTxAftrDscnt", LineValAftrTxAftrDscnt);
        initialValues.put("FreeQty", OrderFreeQty);
        initialValues.put("DisVal", OrderDisVal);
        initialValues.put("SampleQuantity", SampleQTY);
        initialValues.put("ProductShortName", PName);

        initialValues.put("TaxValue", TaxValue);
        initialValues.put("OrderIDPDA", strGlobalOrderID);
        initialValues.put("flgIsQuoteRateApplied", flgIsQuoteRateApplied);
        initialValues.put("ServingDBRId", distID);
        initialValues.put("flgWholeSellApplicable", PriceApplyDiscountLevelType);
        //initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
        initialValues.put("InvoiceNumber", FinalInvoiceNumberGenerated);
        initialValues.put("Sstat", Outstat);

        return db.insert(DATABASE_TABLE_INVOICE_DETAILS, null, initialValues);
    }

    public static String fnGetDateTimeString() {
        long  syncTIMESTAMP = System.currentTimeMillis();
        Date dateobj = new Date(syncTIMESTAMP);
        SimpleDateFormat df = new SimpleDateFormat("dd-MMM-yyyy HH:mm:ss",Locale.ENGLISH);
        String StampEndsTime = df.format(dateobj);

        return StampEndsTime;
    }

    public static void UpdateStoreActualLatLongi(String StoreID,
                                          String ActualLatitude, String ActualLongitude, String Accuracy,
                                          String LocProvider, int flgLocationServicesOnOff, int flgGPSOnOff, int flgNetworkOnOff, int flgFusedOnOff, int flgInternetOnOffWhileLocationTracking, int flgRestart, int flgStoreOrder,String StoreVisitCode,String VisitTimeInSideStore)
    {
        String GetDateTimeString=fnGetDateTimeString();
        //open();
        final ContentValues values = new ContentValues();
        values.put("ActualLatitude", ActualLatitude);
        values.put("ActualLongitude", ActualLongitude);
        values.put("Accuracy", Accuracy);
        values.put("LocProvider", LocProvider);
        values.put("VisitTimeInSideStore", VisitTimeInSideStore);
        values.put("VisitEndTS", GetDateTimeString);
        values.put("VisitTimeCheckStore", "01-Jan-1900");
        values.put("flgLocationServicesOnOff", flgLocationServicesOnOff);
        values.put("flgGPSOnOff", flgGPSOnOff);
        values.put("flgNetworkOnOff", flgNetworkOnOff);
        values.put("flgFusedOnOff", flgFusedOnOff);
        values.put("flgInternetOnOffWhileLocationTracking", flgInternetOnOffWhileLocationTracking);
       // values.put("flgRestart", flgRestart);


        int affected = db.update("tblStoreVisitMstr", values, "StoreID=? AND StoreVisitCode=?",new String[] { StoreID,StoreVisitCode });
       // close();
        Log.w(TAG, "affected records: " + affected);

        Log.w(TAG, "UpdateStoreActualLatLongi added..");
    }

    public static long fnsaveStoreTempOrderEntryDetails(String TmpInvoiceCodePDA,String storeID,String PCateId,String ProductID,Double PRate,Double TaxRate,int flgRuleTaxVal,int OrderQTY,int SelectedUOMId,Double LineValBfrTxAftrDscnt,Double LineValAftrTxAftrDscnt,
                                                 int OrderFreeQty,Double OrderDisVal,int SampleQTY,String PName,Double TaxValue,String strGlobalOrderID,int flgIsQuoteRateApplied,int PriceApplyDiscountLevelType,String distID,int Outstat,int ProductExtraOrder)
    {
        ContentValues initialValues = new ContentValues();
        initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
        initialValues.put("StoreID", storeID);
        initialValues.put("CatID", PCateId);
        initialValues.put("ProdID", ProductID);
        initialValues.put("ProductPrice", PRate);
        initialValues.put("TaxRate", TaxRate);
        initialValues.put("flgRuleTaxVal", flgRuleTaxVal);
        initialValues.put("OrderQty", OrderQTY);
        initialValues.put("UOMId", SelectedUOMId);

        initialValues.put("LineValBfrTxAftrDscnt", LineValBfrTxAftrDscnt);

        initialValues.put("LineValAftrTxAftrDscnt", LineValAftrTxAftrDscnt);
        initialValues.put("FreeQty", OrderFreeQty);
        initialValues.put("DisVal", OrderDisVal);
        initialValues.put("SampleQuantity", SampleQTY);
        initialValues.put("ProductShortName", PName);

        initialValues.put("TaxValue", TaxValue);
        initialValues.put("OrderIDPDA", strGlobalOrderID);
        initialValues.put("flgIsQuoteRateApplied", flgIsQuoteRateApplied);
        initialValues.put("ServingDBRId", distID);
        initialValues.put("flgWholeSellApplicable", PriceApplyDiscountLevelType);
        initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
        initialValues.put("ProductExtraOrder", ProductExtraOrder);
        initialValues.put("Sstat", Outstat);

        return db.insert(DATABASE_TABLE_MAIN210, null, initialValues);
    }

    public static LinkedHashMap<String,Integer> fnGetFinalInvoiceQtyProductWise()
    {
        LinkedHashMap<String,Integer> hmapFinalInvoiceQtyProductWise=new LinkedHashMap<String,Integer>();
        //open();
        Cursor cursor= db.rawQuery("SELECT DISTINCT S.PrdctId,S.StockQntty-ifnull(D.OrderQty,0) AS StockAvailable  from tblDistributorProductStock S left outer join (SELECT ID.ProdID,SUM(ID.OrderQty) OrderQty FROM tblInvoiceHeader AS I INNER JOIN tblInvoiceDetails AS ID ON ID.InvoiceNumber=I.InvoiceNumber  WHERE I.flgProcessedInvoice=0 GROUP BY ID.ProdID) D ON D.ProdID=S.PrdctId", null);
        try {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapFinalInvoiceQtyProductWise.put((String) cursor.getString(0).toString(),Integer.parseInt(cursor.getString(1)));
                        cursor.moveToNext();
                    }
                }
            }
        }
        finally
        {
            if(cursor!=null) {
                cursor.close();
            }
            //close();
        }

        return hmapFinalInvoiceQtyProductWise;
    }

    public static void UpdateStoreVisitWiseTables(String sID, int flag2set,String StoreVisitCode,String TmpInvoiceCodePDA)
    {

        try
        {
//open();
            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);


            //int affected = db.update("tblStoreList", values, "StoreID=?",new String[] { sID });
            int affected1 = db.update("tblAllCollectionData", values,"StoreID=? AND StoreVisitCode=? AND TmpInvoiceCodePDA=?", new String[] { sID,StoreVisitCode,TmpInvoiceCodePDA });
            int affected2 = db.update("tblInvoiceHeader", values,"StoreID=? AND StoreVisitCode=? AND TmpInvoiceCodePDA=?", new String[] { sID,StoreVisitCode,TmpInvoiceCodePDA });
            int affected3 = db.update("tblInvoiceDetails", values,"StoreID=? AND TmpInvoiceCodePDA=?", new String[] { sID,TmpInvoiceCodePDA });
            int affected4 = db.update("tblStoreVisitMstr", values,"StoreID=? AND StoreVisitCode=?", new String[] { sID,StoreVisitCode });
            int affected71 = db.update("tblStoreCloseLocationDetails", values, "StoreID=? AND StoreVisitCode=?", new String[] { sID,StoreVisitCode });

            int affected72 = db.update("tblStoreClosedPhotoDetail", values, "StoreID=? AND StoreVisitCode=?", new String[] { sID,StoreVisitCode });

            int affected73 = db.update("tblStoreCloseReasonSaving", values, "StoreID=? AND StoreVisitCode=?", new String[] { sID,StoreVisitCode });






        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }
//close();
    }

    // function given by Abhianv Sir End

    public static void UpdateStoreVisitMStrTable(String sID, int flag2set,String StoreVisitCode)
    {
        //open();
        try
        {

            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);

                 int affected4 = db.update("tblStoreVisitMstr", values,"StoreID=? AND StoreVisitCode=?", new String[] { sID,StoreVisitCode });






        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }
        finally {
           // close();
        }

    }

    public static String fetchtblVanCycStartTime()
    {
        //open();
        String CycStartTime="";
        try
        {
            //tblCycleID(CycleID int null,Sstat int null,CycStartTime text null,CycleTime text null);";
            Cursor cur=db.rawQuery("Select CycStartTime from tblCycleID",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        CycStartTime=cur.getString(0);
                        cur.moveToNext();
                    }
                }
            }
        }
        catch(Exception e)
        {
            System.out.println("Error getOtherReason = "+e.toString());
        }
        finally
        {
           // close();
            return CycStartTime;
        }
    }

    public static String fetchtblStatusCycleTime() {
        //open();
        String CycStartTime = "0";
        try {
            //tblStockUploadedStatus(flgStockTrans int null,VanLoadUnLoadCycID int null,CycleTime text null,StatusID int null);";
            Cursor cur = db.rawQuery("Select CycleTime from tblStockUploadedStatus", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        CycStartTime = cur.getString(0);
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println("Error getOtherReason = " + e.toString());
        } finally {
          //  close();
            return CycStartTime;
        }
    }

    public static String fnGetInvoiceCodePDAWhileSync (String StoreID,String StoreVisitCode)
    {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT TmpInvoiceCodePDA FROM tblInvoiceHeader WHERE StoreID='" + StoreID + "' AND StoreVisitCode='"+StoreVisitCode+"' AND Sstat=1", null);
        String InvoiceCodePDA = "0";
        try {
            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst()) {
                    InvoiceCodePDA = cursorE2.getString(0).toString();
                }
            }
        } finally {
            if(cursorE2!=null) {
                cursorE2.close();
            }
            //close();
        }
        return InvoiceCodePDA;
    }

    public static void UpdateStoreClose(String sID, int flag2set)
    {

        try
        {

            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);


            int affected = db.update("tblStoreList", values, "StoreID=?",new String[] { sID });



        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }

    }

    public static void fnInsert_tblNewAddedStoreLocationDetails(String StoreID,int Sstat,String ActualLatitude,String ActualLongitude,String VisitEndTS,String LocProvider,String Accuracy,String BateryLeftStatus,int flgLocationServicesOnOff,int flgGPSOnOff,int flgNetworkOnOff,int flgFusedOnOff,int flgInternetOnOffWhileLocationTracking)
    {




        try {

           //// "create table tblNewAddedStoreLocationDetails(StoreID text not null, VisitEndTS text null, LocProvider text null,
           /// Accuracy text null, BateryLeftStatus text null,flgLocationServicesOnOff int null," +
              //      "flgGPSOnOff int null,flgNetworkOnOff int null,flgFusedOnOff int null,flgInternetOnOffWhileLocationTracking int null, Sstat integer not null);";

                ContentValues initialValues = new ContentValues();

                initialValues.put("StoreID", StoreID);
                initialValues.put("VisitEndTS", VisitEndTS);
                initialValues.put("LocProvider", LocProvider);
                initialValues.put("Accuracy", Accuracy);
                initialValues.put("BateryLeftStatus", BateryLeftStatus);

                initialValues.put("flgLocationServicesOnOff", flgLocationServicesOnOff);
                initialValues.put("flgGPSOnOff", flgGPSOnOff);
                initialValues.put("flgNetworkOnOff", flgNetworkOnOff);
                initialValues.put("flgFusedOnOff", flgFusedOnOff);
                initialValues.put("flgInternetOnOffWhileLocationTracking", flgInternetOnOffWhileLocationTracking);

                initialValues.put("Sstat", 3);

                db.insert(DATABASE_TABLE_NewAddedStoreLocationDetails, null, initialValues);



        } finally {

        }

    }

    public static void inserttblDayCheckIn(int confirmFlg)
    {

        //open();
        long  syncTIMESTAMP = System.currentTimeMillis();
        Date dateobj = new Date(syncTIMESTAMP);
        SimpleDateFormat	sdfPDaDate = new SimpleDateFormat("dd-MMM-yyyy",Locale.ENGLISH);
        String DateOfDayCheckIn = sdfPDaDate.format(dateobj).toString().trim();
        ContentValues values=new ContentValues();
        values.put("DateOfDayCheckIn",DateOfDayCheckIn);
        values.put("flgDayDayCheckIn",confirmFlg);
        db.insert(DATABASE_TABLE_DayCheckIn,null,values);

       // close();

    }

    public static int fnCkechDayStart()
    {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT * FROM tblDayCheckIn", null);
        int flgCkechDayStart = 0;
        try {
            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst()) {
                    flgCkechDayStart = 1;
                }
            }
        } finally {
            if(cursorE2!=null) {
                cursorE2.close();
            }
            //close();
        }
        return flgCkechDayStart;
    }

    public static int confirmedStock()
    {
        int statusId=0;
      //tblStockUploadedStatus(flgStockTrans int null,VanLoadUnLoadCycID int null,CycleTime text null,StatusID int null);";
        //open();
        try {
            Cursor cur=db.rawQuery("Select StatusID from tblStockUploadedStatus",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    statusId=cur.getInt(0);
                }

            }
        }
        catch(Exception excptn)
        {
            System.out.println("Error = "+excptn.toString());
        }
        finally
        {
           // close();
            return statusId;
        }

    }

    public static int CheckStoreListPresentOrNot()
    {
        Cursor cursorE2 = null;
        int chkI = 0;

        try
        {
            //open();
            cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblStoreList", null);

            if (cursorE2.moveToFirst())
            {
                if (Integer.parseInt(cursorE2.getString(0)) > 0)
                {
                    chkI = 1;
                }
                else
                {
                    chkI = 0;
                }
            }

        }
        finally
        {
            if(cursorE2 != null)
            {
                cursorE2.close();
            }
           // close();
        }
        return chkI;
    }

    public static int fnCheckForPendingImages()
    {
        //open();
        Cursor cursor =null;
        int check=0;
        try {

            cursor= db.rawQuery("SELECT StoreID FROM tableImage WHERE  Sstat =5", null);
            if (cursor.getCount() > 0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        check=1;
                        cursor.moveToNext();
                    }
                }

            }


        } catch (Exception e) {

        }
        finally {
            cursor.close();
            //close();
        }
        return check;
    }

    // function by Sunil

    public static ArrayList<String> getImageDetails(int sStat)
    {
        //open();
        ArrayList<String> listImageDetails=new ArrayList<String>();
        try
        {
            Cursor cursor=db.rawQuery("Select StoreID,imagePath,imageName from tableImage where Sstat='"+sStat+"'", null);

            if(cursor.getCount()>0)
            {
                if(cursor.moveToFirst())
                {
                    for(int i=0;i<cursor.getCount();i++)
                    {
                        listImageDetails.add(cursor.getString(0)+"^"+cursor.getString(1)+"^"+cursor.getString(2));
                        cursor.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            // TODO: handle exception
        }
        finally
        {
          //  close();
            return listImageDetails;
        }
    }





    public static ArrayList<String> getStoreCheckInImages(int sStat)
    {
        //open();
        ArrayList<String> listImageDetails=new ArrayList<String>();
        try
        {
            Cursor cursor=db.rawQuery("Select StoreID,picClkdPath,imageName from tblStoreCheckInPic where Sstat='"+sStat+"'", null);

            if(cursor.getCount()>0)
            {
                if(cursor.moveToFirst())
                {
                    for(int i=0;i<cursor.getCount();i++)
                    {
                        listImageDetails.add(cursor.getString(0)+"^"+cursor.getString(1)+"^"+cursor.getString(2));
                        cursor.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            // TODO: handle exception
        }
        finally
        {
            //  close();
            return listImageDetails;
        }
    }


    public static ArrayList<String> getStoreClosedImages(int sStat)
    {
        //open();
        ArrayList<String> listImageDetails=new ArrayList<String>();
        try
        {
            Cursor cursor=db.rawQuery("Select StoreID,PDAPhotoPath,PhotoName from tblStoreClosedPhotoDetail where Sstat='"+sStat+"'", null);

            if(cursor.getCount()>0)
            {
                if(cursor.moveToFirst())
                {
                    for(int i=0;i<cursor.getCount();i++)
                    {
                        listImageDetails.add(cursor.getString(0)+"^"+cursor.getString(1)+"^"+cursor.getString(2));
                        cursor.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            // TODO: handle exception
        }
        finally
        {
            //  close();
            return listImageDetails;
        }
    }
    public static void updateSSttImage(String imageName,int sStat)
    {
        //open();
        Cursor cursorImage=db.rawQuery("Select StoreID from tableImage where imageName='"+imageName+"'", null);
        if(cursorImage.getCount()>0)
        {
            ContentValues value=new ContentValues();
            value.put("Sstat", sStat);
            db.update(TABLE_IMAGE, value, "imageName=?", new String[]{imageName});
        }

        //close();
    }

    public static void updateSSttStoreCheckImageImage(String imageName,int sStat)
    {
        //open();
        Cursor cursorImage=db.rawQuery("Select StoreID from tblStoreCheckInPic where imageName='"+imageName+"'", null);
        if(cursorImage.getCount()>0)
        {
            ContentValues value=new ContentValues();
            value.put("Sstat", sStat);
            db.update(DATABASE_TABLE_tblStoreCheckInPic, value, "imageName=?", new String[]{imageName});
        }

        //close();
    }

    public static void fndeleteSbumittedStoreImagesOfSotre(int Sstat)
    {

        //open();

        db.execSQL("DELETE FROM tblStoreCheckInPic WHERE  Sstat='"+Sstat+"'");

       // close();
    }
    public static void fndeleteSbumittedStoreImagesOfSotreCheckIn(int Sstat)
    {

        //open();

        db.execSQL("DELETE FROM tableImage WHERE  Sstat='"+Sstat+"'");

        // close();
    }
    public static int fnCheckForPendingXMLFilesInTable()
    {
        //open();
        Cursor cursor =null;
        int check=0;
        try {


            cursor= db.rawQuery("SELECT XmlFileName FROM tbl_XMLfiles WHERE  Sstat=3", null);
            if (cursor.getCount() > 0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        check=1;
                        cursor.moveToNext();
                    }
                }

            }


        } catch (Exception e) {

        }
        finally {
            cursor.close();
           // close();
        }
        return check;
    }

    public static void fnUpdateProcessedInvoiceflg(String InvoiceNumber, int flag2set)
    {

        try
        {

            final ContentValues values = new ContentValues();
            values.put("flgProcessedInvoice", flag2set);


            int affected = db.update("tblInvoiceHeader", values, "InvoiceNumber=?",new String[] { InvoiceNumber });



        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }

    }

    public static String[] deletFromSDcCardPhotoNewStoreValidationBasedSstat(String Sstat) {

        String[] imageNameToBeDeleted = null;
        //open();

        Cursor cursor = db.rawQuery("SELECT  imageName from tableImage where Sstat='"+Sstat+"'", null);
        try{
            if(cursor.getCount()>0)
            {
                imageNameToBeDeleted=new String[cursor.getCount()];
                if(cursor.moveToFirst())
                {
                    for(int i=0;i<cursor.getCount();i++)
                    {
                        imageNameToBeDeleted[i]=cursor.getString(0);
                        cursor.moveToNext();
                    }
                }
            }
            else
            {
                imageNameToBeDeleted=new String[1];
                imageNameToBeDeleted[0]="No Data";
            }
        }finally
        {
            cursor.close();
           // close();
        }



        return imageNameToBeDeleted;
    }

    public static int fetchtblVanCycleIdForInvoiceHeader()
    {

        int retVal=-1;
        Cursor cur=null;
        try
        {
            //tblCycleID(CycleID int null,Sstat int null,CycStartTime text null);";
            cur=db.rawQuery("Select CycleID from tblCycleID",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        retVal=Integer.parseInt(cur.getString(0));
                        cur.moveToNext();
                    }
                }
            }
        }
        catch(Exception e)
        {
            System.out.println("Error getOtherReason = "+e.toString());
        }
        finally
        {
            if(cur!=null)
            {
                cur.close();
            }
            //close();
            return retVal;
        }
    }

    public static int fetchtblInvoiceReviewLineCount(String sID,String TmpInvoiceCodePDA)
    {
        //open();
        int retVal=0;
        Cursor cur=null;
        try
        {
            //tblCycleID(CycleID int null,Sstat int null,CycStartTime text null);";
            cur=db.rawQuery("Select DISTINCT ifnull(COUNT(ProdID),0) from tblTmpInvoiceDetails Where StoreID='"+sID+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        retVal=Integer.parseInt(cur.getString(0));
                        cur.moveToNext();
                    }
                }
            }
        }
        catch(Exception e)
        {
            System.out.println("Error fetchtblInvoiceReviewLineCount = "+e.toString());
        }
        finally
        {
            if(cur!=null)
            {
                cur.close();
            }
            //close();
            return retVal;
        }
    }

    public static int fetchtblInvoiceReviewCount(String sID,String TmpInvoiceCodePDA)
    {
        //open();
        int retVal=0;
        Cursor cur=null;
        try
        {
            //tblCycleID(CycleID int null,Sstat int null,CycStartTime text null);";
            cur=db.rawQuery("Select ifnull(SUM(OrderQty),0) from tblTmpInvoiceDetails Where StoreID='"+sID+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        retVal=Integer.parseInt(cur.getString(0));
                        cur.moveToNext();
                    }
                }
            }
        }
        catch(Exception e)
        {
            System.out.println("Error fetchtblInvoiceReviewCount = "+e.toString());
        }
        finally
        {
            if(cur!=null)
            {
                cur.close();
            }
          //  close();
            return retVal;
        }
    }

    public static void getInvoiceNumber()
    {
        //tblInvoiceHeader (StoreVisitCode text not null,InvoiceNumber text not null,TmpInvoiceCodePDA text null, StoreID text not null, InvoiceDate string not null, TotalBeforeTaxDis real not null, TaxAmt real not null, TotalDis real not null, InvoiceVal real not null, FreeTotal integer not null, Sstat integer not null, InvAfterDis real not null, AddDis real not null,  NoCoupon int null, TotalCoupunAmount real null,TransDate string not null,FlgInvoiceType text not null,flgWholeSellApplicable int null,flgProcessedInvoice int not null,CycleID  int not null);";
    }

    public static void UpdateStoreVisitWiseTablesAfterSync(int flag2set)
    {

        try
        {
            //open();
            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);


            //int affected = db.update("tblStoreList", values, "StoreID=?",new String[] { sID });
            int affected1 = db.update("tblAllCollectionData", values, "Sstat=?",  new String[] { "5" });
            int affected2 = db.update("tblInvoiceHeader", values, "Sstat=?",  new String[] { "5" });
            int affected3 = db.update("tblInvoiceDetails", values, "Sstat=?",  new String[] { "5" });
            int affected4 = db.update("tblStoreVisitMstr", values, "Sstat=?",  new String[] { "5" });
            int affected71 = db.update("tblStoreCloseLocationDetails", values, "Sstat=?",  new String[] { "5" });

            int affected72 = db.update("tblStoreClosedPhotoDetail", values, "Sstat=?",  new String[] { "5" });

            int affected73 = db.update("tblStoreCloseReasonSaving", values, "Sstat=?",  new String[] { "5" });
            int affected74 = db.update("tblNewAddedStoreLocationDetails", values, "Sstat=?",  new String[] { "3" });





        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }
       // close();
    }

    public static int checkVisitTypeStatus(String  StoreID,String StoreVisitCode)
    {
//open();
        int check=0;
        Cursor cursor = db.rawQuery("SELECT VisitTypeStatus FROM tblStoreVisitMstr WHERE  StoreID ='"+ StoreID + "' and StoreVisitCode='"+StoreVisitCode+"'", null);

        try {



            if (cursor.getCount() > 0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        check=Integer.parseInt(cursor.getString(0).toString());
                        cursor.moveToNext();
                    }
                }

            }
            return check;

        } finally {
            cursor.close();
           // close();
        }

    }

    public static void fnTransferDataFromTempToPermanent(String storeID,String StoreVisitCode,String TmpInvoiceCodePDA)
    {
        //open();
        int InvoiceNumber = 0;
        int CycleID = 0;

        if(CommonInfo.flgDrctslsIndrctSls==1)
        {
             InvoiceNumber = fnFetchInvoiceNumber();
             CycleID = fetchtblVanCycleIdForInvoiceHeader();
        }
    try {
        int flgTransferStatus=1;
        fnUpdateflgTransferStatusInInvoiceHeader(storeID,StoreVisitCode,TmpInvoiceCodePDA,flgTransferStatus);
        db.execSQL("INSERT INTO tblInvoiceHeader(StoreVisitCode,TmpInvoiceCodePDA,StoreID,InvoiceDate,TotalBeforeTaxDis,TaxAmt,TotalDis,InvoiceVal,FreeTotal,Sstat,InvAfterDis,AddDis,NoCoupon,TotalCoupunAmount,TransDate,FlgInvoiceType,flgWholeSellApplicable,InvoiceNumber,flgProcessedInvoice,CycleID) SELECT StoreVisitCode,TmpInvoiceCodePDA,StoreID,InvoiceDate,TotalBeforeTaxDis,TaxAmt,TotalDis,InvoiceVal,FreeTotal,3,InvAfterDis,AddDis,NoCoupon,TotalCoupunAmount,TransDate,FlgInvoiceType,flgWholeSellApplicable,"+InvoiceNumber+",0,"+CycleID+" FROM tblTmpInvoiceHeader Where tblTmpInvoiceHeader.StoreVisitCode='"+StoreVisitCode+"' AND  tblTmpInvoiceHeader.TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"' AND tblTmpInvoiceHeader.StoreID='"+storeID+"'");

        db.execSQL("INSERT INTO tblInvoiceDetails(InvoiceNumber,TmpInvoiceCodePDA,StoreID,CatID,ProdID,ProductPrice,TaxRate,flgRuleTaxVal,OrderQty,UOMId,LineValBfrTxAftrDscnt,LineValAftrTxAftrDscnt,FreeQty,DisVal,Sstat,SampleQuantity,ProductShortName,TaxValue,OrderIDPDA,flgIsQuoteRateApplied,ServingDBRId,flgWholeSellApplicable,ProductExtraOrder) SELECT "+InvoiceNumber+",TmpInvoiceCodePDA,StoreID,CatID,ProdID,ProductPrice,TaxRate,flgRuleTaxVal,OrderQty,UOMId,LineValBfrTxAftrDscnt,LineValAftrTxAftrDscnt,FreeQty,DisVal,3,SampleQuantity,ProductShortName,TaxValue,OrderIDPDA,flgIsQuoteRateApplied,ServingDBRId,flgWholeSellApplicable,ProductExtraOrder FROM tblTmpInvoiceDetails Where tblTmpInvoiceDetails.TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"' AND tblTmpInvoiceDetails.StoreID='"+storeID+"'");

        flgTransferStatus=2;
        fnUpdateflgTransferStatusInInvoiceHeader(storeID,StoreVisitCode,TmpInvoiceCodePDA,flgTransferStatus);
       // fnUpdateInvoiceNumber(storeID,StoreVisitCode,TmpInvoiceCodePDA,InvoiceNumber);
    }
    catch (Exception ex)
    {
        System.out.println("Error While trnasfering data from temp to permanent.");
    }
    finally {
    //close();
    }

    }

public static void fnUpdateflgTransferStatusInInvoiceHeader(String storeID,String StoreVisitCode,String TmpInvoiceCodePDA,int flgTransferStatus)
{
            final ContentValues values = new ContentValues();
            values.put("flgTransferStatus", flgTransferStatus);
            int affected1 = db.update("tblTmpInvoiceHeader", values,"StoreID=? AND StoreVisitCode=? AND TmpInvoiceCodePDA=?", new String[] { storeID,StoreVisitCode,TmpInvoiceCodePDA });
}

        public static int fnFetchInvoiceNumber()
        {

            int flCheckPrevoiusInvoiceNumberIfAnyGenerated=0;
            int InNumber=0;
            flCheckPrevoiusInvoiceNumberIfAnyGenerated=fnCheckForPrevoiusInvoiceNumberIfAnyGenerated();
            if(flCheckPrevoiusInvoiceNumberIfAnyGenerated==0)
            {
                InNumber=fnGettblInvoiceAllotmentId();
            }
            else
            {
                InNumber= fnGetMaxInvoiceNumberIfAnyGenerated();
            }
            return  InNumber;
        }

        public static int fnCheckForPrevoiusInvoiceNumberIfAnyGenerated()
{
    int flCheckPrevoiusInvoiceNumberIfAnyGenerated=0;
    Cursor cursor = db.rawQuery("SELECT InvoiceNumber FROM tblInvoiceHeader", null);

    try {



        if (cursor.getCount() > 0)
        {
            if (cursor.moveToFirst())
            {

                flCheckPrevoiusInvoiceNumberIfAnyGenerated=1;

            }

        }
        return flCheckPrevoiusInvoiceNumberIfAnyGenerated;

    } finally {
        cursor.close();

    }


}

    public static int fnGetMaxInvoiceNumberIfAnyGenerated()
    {
        int MaxInvoiceNumberGenerated=0;
        Cursor cursor = db.rawQuery("SELECT Max(InvoiceNumber) FROM tblInvoiceHeader", null);

        try {



            if (cursor.getCount() > 0)
            {
                if (cursor.moveToFirst())
                {

                    MaxInvoiceNumberGenerated=Integer.parseInt(cursor.getString(0))+1;

                }

            }
            return MaxInvoiceNumberGenerated;

        } finally {
            cursor.close();

        }


    }

    public static LinkedHashMap<String,String> fetch_InvoiceCaptionPrefixAndSuffix()
    {

      // //open();
       LinkedHashMap<String,String>hmapInvoiceCaptionPrefixAndSuffix=new LinkedHashMap<String,String>();



        Cursor	cursor = db.rawQuery("SELECT ifnull(INVPrefix,''),ifnull(INVSuffix,'') FROM tblInvoiceCaption", null); //order by AutoIdOutlet Desc

        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    hmapInvoiceCaptionPrefixAndSuffix.put("INVPrefix",cursor.getString(0));
                    hmapInvoiceCaptionPrefixAndSuffix.put("INVSuffix",cursor.getString(1));

                }
            }
            else
            {
                hmapInvoiceCaptionPrefixAndSuffix.put("INVPrefix","");
                hmapInvoiceCaptionPrefixAndSuffix.put("INVSuffix","");
            }

            return hmapInvoiceCaptionPrefixAndSuffix;
        }
        finally
        {
            if(cursor!=null) {
                cursor.close();
            }
         //   close();
        }
    }

    public static ArrayList<String> getImageNameToDel(String StoreID)
    {
        //open();
        ArrayList<String> listImagePath=new ArrayList<String>();
        try {
//
            //tableImage(StoreID text null,QstIdAnsCntrlTyp text null,imageName text null,imagePath text null,ImageClicktime text null,Sstat integer null);";
            //imagButtonTag+"~"+tempId+"~"+uriSavedImage.toString()+"~"+clkdTime+"~"+"2";
            Cursor cursor=db.rawQuery("Select imageName from tableImage where StoreID='"+StoreID+"'", null);

            if(cursor.getCount()>0)
            {
                if(cursor.moveToFirst())
                {
                    for(int i=0;i<cursor.getCount();i++)
                    {
                        listImagePath.add(cursor.getString(0));
                        cursor.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            // TODO: handle exception
        }
        finally
        {
          //  close();
            return listImagePath;
        }
    }

    public static void deleteImageDataCanceled(String storeId)
    {
        //tableImage(tempId text null,QstIdAnsCntrlTyp text null,imageName text null,imagePath text null,Sstat integer null);";
        //open();
        Cursor cur=db.rawQuery("Select imageName from tableImage where StoreID='"+storeId+"'", null);
        if(cur.getCount()>0)
        {
            db.delete(TABLE_IMAGE, "StoreID=?", new String[]{storeId});
        }
        if(cur!=null)
        {
            cur.close();
        }
        //close();
    }

    public static int fnCheckflgTransferStatus(String storeID,String StoreVisitCode,String TmpInvoiceCodePDA)
    {
        //open();
        int flgTransferStatus=0;
        Cursor cursor = db.rawQuery("SELECT ifnull(flgTransferStatus,0) FROM tblTmpInvoiceHeader WHERE tblTmpInvoiceHeader.StoreVisitCode='"+StoreVisitCode+"' AND  tblTmpInvoiceHeader.TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"' AND tblTmpInvoiceHeader.StoreID=='"+storeID+"'", null);

        try {



            if (cursor.getCount() > 0)
            {
                if (cursor.moveToFirst())
                {

                    flgTransferStatus=Integer.parseInt(cursor.getString(0));

                }

            }
            return flgTransferStatus;

        } finally {
            if(cursor!=null) {
                cursor.close();
            }
//close();
        }


    }

    public static  void deleteMasterTblFromParmanentInvoiceTables(String StoreID,String TmpInvoiceCodePDA)
    {
        //open();
        db.execSQL("DELETE FROM tblInvoiceHeader WHERE StoreID='"+ StoreID +"'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'");
        db.execSQL("DELETE FROM tblInvoiceDetails WHERE StoreID='"+ StoreID +"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'");
       // close();
    }

    public static LinkedHashMap<String,String> getPerUnitName()
    {
        LinkedHashMap<String,String> hmapPerUnitName=new LinkedHashMap<>();
        //open();
        //tblProductListMaster(ProductID text  null,RptUnitName text null,PerbaseUnit text null);";
        Cursor cur=null;
        try {
            cur=db.rawQuery("Select ProductID,'('||RptUnitName ||' : '||PerbaseUnit||')' As perUnitName from tblProductListMaster",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        hmapPerUnitName.put(cur.getString(0),cur.getString(1));
                        cur.moveToNext();
                    }
                }
            }
        }catch(Exception excptn)
        {
            System.out.println("Error getPerUnitName= "+excptn.toString());
        }
        finally
        {
            if(cur!=null)
            {
                cur.close();
            }
           // close();
            return hmapPerUnitName;
        }

    }

    public static LinkedHashMap<String,String> getPerBaseQty()
    {
        LinkedHashMap<String,String> hmapPerBaseQty=new LinkedHashMap<>();
        //open();
        //tblProductListMaster(ProductID text  null,RptUnitName text null,PerbaseUnit text null);";
        Cursor cur=null;
        try {
            cur=db.rawQuery("Select ProductID,PerbaseUnit from tblProductListMaster",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        hmapPerBaseQty.put(cur.getString(0),cur.getString(1));
                        cur.moveToNext();
                    }
                }
            }
        }catch(Exception excptn)
        {
            System.out.println("Error getPerUnitName= "+excptn.toString());
        }
        finally
        {
            if(cur!=null)
            {
                cur.close();
            }
            //close();
            return hmapPerBaseQty;
        }

    }

    public static void UpdateStorWhileAdding(String sID, int flag2set)
    {
        //open();
        try
        {

            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);
            int affected1 = db.update("tblStoreList", values,"StoreID=?", new String[] { sID });
            int affected2 = db.update("tblNewAddedStoreLocationDetails", values,"StoreID=?", new String[] { sID });
            int affected3 = db.update("tblNewStoreListEntries", values,"StoreID=?", new String[] { sID });
            int affected4 = db.update("tblNewStoreSalesQuotePaymentDetails", values,"StoreId=?", new String[] { sID });
            int affected5 = db.update("tblOutletQuestAnsMstr", values,"OutletID=?", new String[] { sID });
            int affected6 = db.update("tableImage", values,"StoreID=?", new String[] { sID });
        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }
        //close();

    }
    // ---opens the database---
    public PRJDatabase(Context ctx) {
        this.context = ctx;
        this.contextForRecreate=ctx;
        DBHelper = new DatabaseHelper(this.context);
    }
    public PRJDatabase open() throws SQLException
    {
        db = DBHelper.getWritableDatabase();
        isDBOpenflag = true;
        return this;
    }
    public static void close() {
        DBHelper.close();
    }

    private static class DatabaseHelper extends SQLiteOpenHelper {
        DatabaseHelper(Context context) {
            super(context, DATABASE_NAME, null, DATABASE_VERSION);
        }

        public void onCreate(SQLiteDatabase db)
        {

            try
            {
                db.execSQL(DATABASE_CREATE_tblAllServicesCalledSuccessfull);
                db.execSQL(DATABASE_CREATE_TABLE_tblDAGetAddedOutletSummaryReport);
                db.execSQL(DATABASE_CREATE_TABLE_tblCollectionReportChequeChange);
                db.execSQL(DATABASE_CREATE_TABLE_tblCollectionReportCashChange);
                db.execSQL(DATABASE_CREATE_TABLE_tblUOMMstr);
                db.execSQL(DATABASE_CREATE_TABLE_tblUOMMapping);
                db.execSQL(DATABASE_CREATE_TABLE_tblStockReq);

                db.execSQL(DATABASE_CREATE_TABLE_tblStoreLastDeliveryNoteNumber);
                db.execSQL(DATABASE_CREATE_TABLE_tblAppMasterFlags);
                db.execSQL(DATABASE_CREATE_TABLE_tblWarehouseMstr);
                db.execSQL(DATABASE_CREATE_TABLE_tblStoreCheckInPic);
                db.execSQL(DATABASE_CREATE_TABLE_tblUserName);
                db.execSQL(DATABASE_CREATE_TABLE_tblStoreCountDetails);
                db.execSQL(DATABASE_CREATE_TABLE_tblPreAddedStores);
                db.execSQL(DATABASE_CREATE_TABLE_tblPreAddedStoresDataDetails);

                db.execSQL(DATABASE_CREATE_TABLE_tblActualVisitStock);
                db.execSQL(DATABASE_CREATE_TABLEtblProductListLastVisitStockOrOrderMstr);
                db.execSQL(DATABASE_CREATE_TABLE_tblAttandanceDetails);
                db.execSQL(DATABASE_CREATE_TABLE_tblStateCityMaster);
                db.execSQL(DATABASE_CREATE_TABLE_DayCheckIn);
                db.execSQL(DATABASE_CREATE_TABLE_TEMP_DISTRIBUTOR_STOCK);
                db.execSQL(DATABASE_CREATE_TABLE_CYCLEID);

                db.execSQL(DATABASE_CREATE_TABLE_INVOICE_HEADER);
                db.execSQL(DATABASE_CREATE_TABLE_INVOICE_DETAILS);


                db.execSQL(DATABASE_CREATE_TABLE_STOREVISIT);
                db.execSQL(DATABASE_CREATE_tblStoreOrderVisitDayActivity);
                db.execSQL(DATABASE_CREATE_TABLE_tblPriceApplyType);

                db.execSQL(DATABASE_CREATE_TABLE_tblInvoiceCaption);
                db.execSQL(DATABASE_CREATE_TABLE_tblLastOutstanding);
                db.execSQL(DATABASE_CREATE_TABLE_tblInvoiceLastVisitDetails);

                db.execSQL(DATABASE_CREATE_TABLE_tblStockConfirm);
                db.execSQL(DATABASE_CREATE_TABLE_tblStockUploadedStatus);
                //stock out flg
                db.execSQL(DATABASE_CREATE_TABLE_tblStockOut);


                //Amount Collection
                db.execSQL(DATABASE_CREATE_TABLE_tblBankMaster);
                db.execSQL(DATABASE_CREATE_TABLE_tblInstrumentMaster);
                db.execSQL(DATABASE_CREATE_TABLE_tblAllCollectionData);

                //store close info



                db.execSQL(DATABASE_CREATE_TABLE_tblIsDBRStockSubmitted);
                db.execSQL(DATABASE_CREATE_TABLE_tblStoreCloseLocationDetails);
                db.execSQL(DATABASE_CREATE_TABLE_tblStoreClosedPhotoDetail);
                db.execSQL(DATABASE_CREATE_TABLE_tblStoreCloseReasonMaster );
                db.execSQL(DATABASE_CREATE_TABLE_tblStoreCloseReasonSaving );

                // Splash Screen Tables
                db.execSQL(DATABASE_CREATE_TABLE_tblSupplierMstrList);

                db.execSQL(DATABASE_CREATE_TABLE_tblSuplierMapping);

                db.execSQL(DATABASE_CREATE_TABLE_DISTRIBUTOR_ORDERPDAID);
                db.execSQL(DATABASE_CREATE_TABLE_DISTRIBUTOR_LEFTPRODUCT);
                db.execSQL(DATABASE_CREATE_TABLE_DISTRIBUTOR_STOCK);

                db.execSQL(DATABASE_CREATE_TABLE_tblSameLocationForStoreRestartDone);
                db.execSQL(DATABASE_CREATE_TABLE_23);

                db.execSQL(DATABASE_CREATE_TABLE_DayAndSummary);

                db.execSQL(DATABASE_CREATE_TABLE_235);
                db.execSQL(DATABASE_CREATE_TABLE_236);


                db.execSQL(DATABASE_CREATE_TABLE_271);

                db.execSQL(CREATE_TABLE_tblDistributorDayReport);
                db.execSQL(CREATE_TABLE_tblDistributorDayReportColumnsDesc);
                db.execSQL(CREATE_TABLE_tblDistributorSavedData);
                db.execSQL(CREATE_TABLE_tblDistributorOldStockData);

                db.execSQL(CREATE_tblIncentiveMsgToDisplay_Definition);
                db.execSQL(CREATE_TABLE_tblIncentiveMaster);
                //db.execSQL(CREATE_TABLE_tblIncentiveDetailsData);
                db.execSQL(CREATE_TABLE_tblIncentiveDetailsColumnsDesc);
                db.execSQL(CREATE_TABLE_tblTotalEarning);
                db.execSQL(CREATE_TABLE_tblIncentivePastDetailsColumnsDesc);




                db.execSQL(TABLE_tblUserAuthenticationMstr_Definition);
                db.execSQL(DATABASE_CREATE_TABLE_tblBloodGroup);
                db.execSQL(DATABASE_CREATE_TABLE_tblEducationQuali);
                db.execSQL(DATABASE_CREATE_TABLE_tblDsrRegDetails);
                db.execSQL(DATABASE_CREATE_TABLE_tblUserRegistarationStatus);


                db.execSQL(TABLE_tblAvailableVersionMstr_Definition);
                db.execSQL(TABLE_tblRouteListMaster_Definition);
                db.execSQL(TABLE_tblPDANotificationMaster_Definition);
                db.execSQL(TABLE_tblDayStartAttendanceOptions_Definition);
                db.execSQL(TABLE_tblNoVisitStoreDetails_Definition);

                db.execSQL(DATABASE_CREATE_TABLE_QSTOUTCHANNEL);
                db.execSQL(DATABASE_CREATE_TABLE_QST_NAME);
                db.execSQL(DATABASE_CREATE_TABLE_QUESTIONMstr);
                db.execSQL(DATABASE_CREATE_TABLE_QuestGrpMappingMstr);
                db.execSQL(DATABASE_CREATE_TABLE_QUESTION_OPTION_DEPENDENTMstr);
                db.execSQL(DATABASE_CREATE_TABLE_QUESTION_OPTION_VAL_DEPENDENTMstr);

                db.execSQL(DATABASE_CREATE_TABLE_Image);
                db.execSQL(DATABASE_CREATE_TABLE_tblLocationDetails);




                db.execSQL(DATABASE_NewStoreSalesQuotePaymentDetails);
                db.execSQL(DATABASE_StoreSalesOrderPaymentDetails);
                db.execSQL(DATABASE_StoreAddressMapDetailsMstr);
                db.execSQL(DATABASE_StoreOrderBillAddressDetails);

                db.execSQL(DATABASE_StoreSomeProdQuotePriceMstr);

                db.execSQL(DATABASE_CREATE_TABLE_RETURNREASON);

                //db.execSQL(DATABASE_CREATE_TABLE_QuestGrpMappingMstr);
                db.execSQL(DATABASE_CREATE_TABLE_XMLfiles);
                db.execSQL(DATABASE_CREATE_TABLE_13);

                db.execSQL(DATABASE_CREATE_TABLE_NewAddedStoreLocationDetails);


                db.execSQL(DATABASE_CREATE_TABLE_OutletPhotoDetail);
                // db.execSQL(DATABASE_CREATE_TABLE_QUESTIONMstr);
                db.execSQL(DATABASE_CREATE_TABLE_OutletChannelBusinessSegmentMasterr);
                db.execSQL(DATABASE_CREATE_TABLE_OPTIONMstr);
                db.execSQL(DATABASE_CREATE_TABLE_tblOutletMstr);
                db.execSQL(DATABASE_CREATE_TABLE_tblOutletQuestAnsMstr);
                db.execSQL( DATABASE_CREATE_TABLE_tblViewOutletQuestAnsMstr);

                db.execSQL(  DATABASE_CREATE_TABLE_ViewOutletNameAndId);


                db.execSQL(DATABASE_CREATE_TABLE_QUESTION_DEPENDENTMstr);




                db.execSQL(DATABASE_CREATE_TABLE_11);
                db.execSQL(DATABASE_CREATE_TABLE_12);

                db.execSQL(DATABASE_CREATE_TABLE_14);
                db.execSQL(DATABASE_CREATE_TABLE_ProductSegementMap);
                db.execSQL(DATABASE_CREATE_TABLE_15);

                db.execSQL(DATABASE_CREATE_TABLE_UOMMstr);
                db.execSQL(DATABASE_CREATE_TABLE_SalesQuotePrcsMstr);
                db.execSQL(DATABASE_SalesQuotePersonMeetMstr);
                db.execSQL(DATABASE_CREATE_SalesQuoteProductsMstr);
                db.execSQL(DATABASE_CREATE_TABLE_tblSalesQuotePaymentModeMstr);
                db.execSQL(DATABASE_CREATE_TABLE_tblSalesQuotePaymentStageMstr);
                db.execSQL(DATABASE_CREATE_TABLE_tblSalesQuoteTypeMstr);
                db.execSQL(DATABASE_CREATE_TABLE_tblSalesQuotePaymentStageModeMapMstr);
                //db.execSQL(DATABASE_CREATE_TABLE_5);
                //db.execSQL(DATABASE_CREATE_TABLE_7);
                db.execSQL(DATABASE_CREATE_TABLE_9);
                db.execSQL(DATABASE_CREATE_TABLE_10);
                db.execSQL(DATABASE_CREATE_TABLE_16);
                db.execSQL(DATABASE_CREATE_TABLE_17);
                db.execSQL(DATABASE_CREATE_TABLE_18);
                db.execSQL(DATABASE_CREATE_TABLE_19);
                db.execSQL(DATABASE_CREATE_TABLE_20);
                db.execSQL(DATABASE_CREATE_TABLE_31);
                db.execSQL(DATABASE_CREATE_TABLE_32);

                db.execSQL(DATABASE_CREATE_TABLE_StoreProductMap);
                db.execSQL(DATABASE_CREATE_TABLE_51);
                db.execSQL(DATABASE_CREATE_TABLE_52);
                db.execSQL(DATABASE_CREATE_TABLE_53);
                db.execSQL(DATABASE_CREATE_TABLE_54);
                db.execSQL(DATABASE_CREATE_TABLE_55);
                db.execSQL(DATABASE_CREATE_TABLE_56);
                db.execSQL(DATABASE_CREATE_TABLE_61);
                db.execSQL(DATABASE_CREATE_TABLE_62);
                db.execSQL(DATABASE_CREATE_TABLE_63);
                db.execSQL(DATABASE_CREATE_TABLE_71);
                db.execSQL(DATABASE_CREATE_TABLE_72);
                db.execSQL(DATABASE_CREATE_TABLE_81);
                db.execSQL(DATABASE_CREATE_TABLE_82);
                db.execSQL(DATABASE_CREATE_TABLE_91);
                db.execSQL(DATABASE_CREATE_TABLE_92);

                db.execSQL(DATABASE_CREATE_TABLE_94);

                db.execSQL(DATABASE_CREATE_tblDaySummaryNew);


                db.execSQL(DATABASE_CREATE_TABLE_101);
                db.execSQL(DATABASE_CREATE_TABLE_102);
                db.execSQL(DATABASE_CREATE_TABLE_103);


                db.execSQL(DATABASE_CREATE_TABLE_111);
                db.execSQL(DATABASE_CREATE_TABLE_112);
                db.execSQL(DATABASE_CREATE_TABLE_113);
                db.execSQL(DATABASE_CREATE_TABLE_114);


                db.execSQL(DATABASE_CREATE_TABLE_141);
                db.execSQL(DATABASE_CREATE_TABLE_142);
                db.execSQL(DATABASE_CREATE_TABLE_143);
                db.execSQL(DATABASE_CREATE_TABLE_144);
                db.execSQL(DATABASE_CREATE_TABLE_145);
                db.execSQL(DATABASE_CREATE_TABLE_146);
                db.execSQL(DATABASE_CREATE_TABLE_147);

                db.execSQL(DATABASE_CREATE_TABLE_151);

                db.execSQL(DATABASE_CREATE_TABLE_161);
                db.execSQL(DATABASE_CREATE_TABLE_162);
                db.execSQL(DATABASE_CREATE_TABLE_163);
                db.execSQL(DATABASE_CREATE_TABLE_164);

                db.execSQL(DATABASE_CREATE_TABLE_165);
                db.execSQL(DATABASE_CREATE_TABLE_166);


                db.execSQL(DATABASE_CREATE_TABLE_201);
                db.execSQL(DATABASE_CREATE_TABLE_202);
                db.execSQL(DATABASE_CREATE_TABLE_203);
                db.execSQL(DATABASE_CREATE_TABLE_204);
                db.execSQL(DATABASE_CREATE_TABLE_205);
                db.execSQL(DATABASE_CREATE_TABLE_206);
                db.execSQL(DATABASE_CREATE_TABLE_207);
                db.execSQL(DATABASE_CREATE_TABLE_208);
                db.execSQL(DATABASE_CREATE_TABLE_209);
                db.execSQL(DATABASE_CREATE_TABLE_210);
                db.execSQL(DATABASE_CREATE_TABLE_211);

                db.execSQL(DATABASE_CREATE_TABLE_221);
                db.execSQL(DATABASE_CREATE_TABLE_222);
                db.execSQL(DATABASE_CREATE_TABLE_223);

                db.execSQL(DATABASE_CREATE_TABLE_231);
                db.execSQL(DATABASE_CREATE_TABLE_232);
                db.execSQL(DATABASE_CREATE_TABLE_233);
                db.execSQL(DATABASE_CREATE_TABLE_234);

                db.execSQL(DATABASE_CREATE_TABLE_251);




                db.execSQL(DATABASE_CREATE_TABLE_21);
                db.execSQL(DATABASE_CREATE_TABLE_22);

                db.execSQL(DATABASE_CREATE_TABLE_212);

                db.execSQL(DATABASE_CREATE_TABLE_213);

                db.execSQL(DATABASE_CREATE_TABLE_214);
                db.execSQL(DATABASE_CREATE_TABLE_215);

                db.execSQL(DATABASE_CREATE_TABLE_tblSalesQuoteSponsorMstr);
                db.execSQL(DATABASE_CREATE_TABLE_tblManufacturerMstrMain);
                db.execSQL(DATABASE_CREATE_TABLE_tblRateDistribution);


                db.execSQL(DATABASE_CREATE_TABLE_261);
                db.execSQL(DATABASE_CREATE_TABLE_262);

            } catch (Exception e) {
                Log.e(TAG, "Error: onCreate db");
            }
        }


        public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
            try
            {
                db.execSQL("DROP TABLE IF EXISTS tblAllServicesCalledSuccessfull");
                db.execSQL("DROP TABLE IF EXISTS tblCollectionReportChequeChange");
                db.execSQL("DROP TABLE IF EXISTS tblCollectionReportCashChange");

                db.execSQL("DROP TABLE IF EXISTS tblDAGetAddedOutletSummaryReport");
                db.execSQL("DROP TABLE IF EXISTS tblUOMMaster");
                db.execSQL("DROP TABLE IF EXISTS tblUOMMapping");
                db.execSQL("DROP TABLE IF EXISTS tblStockRqst");

                db.execSQL("DROP TABLE IF EXISTS tblStoreLastDeliveryNoteNumber");
                db.execSQL("DROP TABLE IF EXISTS tblWarehouseMstr");
                db.execSQL("DROP TABLE IF EXISTS tblAppMasterFlags");
                db.execSQL("DROP TABLE IF EXISTS tblStoreCheckInPic");

                db.execSQL("DROP TABLE IF EXISTS tblUserName");
                db.execSQL("DROP TABLE IF EXISTS tblStoreCountDetails");
                db.execSQL("DROP TABLE IF EXISTS tblPreAddedStores");
                db.execSQL("DROP TABLE IF EXISTS tblPreAddedStoresDataDetails");
                db.execSQL("DROP TABLE IF EXISTS tblActualVisitStock");
                db.execSQL("DROP TABLE IF EXISTS tblProductListLastVisitStockOrOrderMstr");
                db.execSQL("DROP TABLE IF EXISTS tblStateCityMaster");
                db.execSQL("DROP TABLE IF EXISTS tblDayCheckIn");
                db.execSQL("DROP TABLE IF EXISTS tblTmpDistributorStock");
                db.execSQL("DROP TABLE IF EXISTS tblCycleID");
                db.execSQL("DROP TABLE IF EXISTS tblTmpInvoiceHeader");
                db.execSQL("DROP TABLE IF EXISTS tblStoreVisitMstr");
                db.execSQL("DROP TABLE IF EXISTS tblStoreOrderVisitDayActivity");
                db.execSQL("DROP TABLE IF EXISTS tblPriceApplyType");
                db.execSQL("DROP TABLE IF EXISTS tblInvoiceCaption");

                db.execSQL("DROP TABLE IF EXISTS tblLastOutstanding");

                db.execSQL("DROP TABLE IF EXISTS tblInvoiceLastVisitDetails");


                db.execSQL("DROP TABLE IF EXISTS tblStockConfirm");
                db.execSQL("DROP TABLE IF EXISTS tblStockUploadedStatus");
                //stock out flg
                db.execSQL("DROP TABLE IF EXISTS tblDistributorStockOutFlg");

                //Amount Collection
                db.execSQL("DROP TABLE IF EXISTS tblBankMaster");
                db.execSQL("DROP TABLE IF EXISTS tblInstrumentMaster");
                db.execSQL("DROP TABLE IF EXISTS tblAllCollectionData");



                //store close info
                db.execSQL("DROP TABLE IF EXISTS tblIsDBRStockSubmitted");
                db.execSQL("DROP TABLE IF EXISTS tblStoreCloseLocationDetails");
                db.execSQL("DROP TABLE IF EXISTS tblStoreClosedPhotoDetail");
                db.execSQL("DROP TABLE IF EXISTS tblStoreCloseReasonMaster");
                db.execSQL("DROP TABLE IF EXISTS tblStoreCloseReasonSaving");

                db.execSQL("DROP TABLE IF EXISTS tblSupplierMstrList");

                db.execSQL("DROP TABLE IF EXISTS tblDistributorOrderPdaId");
                db.execSQL("DROP TABLE IF EXISTS tblDistributorProductStock");
                db.execSQL("DROP TABLE IF EXISTS tblDistributorIDOrderIDLeft");

                db.execSQL("DROP TABLE IF EXISTS tblsameLocationForStoreRestartDone");
                db.execSQL("DROP TABLE IF EXISTS tblLatLongDetails");
                db.execSQL("DROP TABLE IF EXISTS tblTargetVsAchievedNote");
                db.execSQL("DROP TABLE IF EXISTS tblDistributorOldStockData");

                db.execSQL("DROP TABLE IF EXISTS tblDistributorDayReport");
                db.execSQL("DROP TABLE IF EXISTS tblDistributorDayReportColumnsDesc");
                db.execSQL("DROP TABLE IF EXISTS tblDistributorSavedData");


                db.execSQL("DROP TABLE IF EXISTS tblDayStartAttendanceOptions");

                db.execSQL("DROP TABLE IF EXISTS tblNoVisitStoreDetails");

                db.execSQL("DROP TABLE IF EXISTS tblManagerMstr");
                db.execSQL("DROP TABLE IF EXISTS tblSelectedManagerDetails");
                db.execSQL("DROP TABLE IF EXISTS tblTargetVsAchievedSummary");

                db.execSQL("DROP TABLE IF EXISTS tblStoreWiseTarget");



                db.execSQL("DROP TABLE IF EXISTS tblStoreSomeProdQuotePriceMstr");


                db.execSQL("DROP TABLE IF EXISTS tblNewStoreSalesQuotePaymentDetails");
                db.execSQL("DROP TABLE IF EXISTS tblStoreSalesOrderPaymentDetails");
                db.execSQL("DROP TABLE IF EXISTS tblStoreAddressMapDetailsMstr");
                db.execSQL("DROP TABLE IF EXISTS tblStoreOrderBillAddressDetails");


                db.execSQL("DROP TABLE IF EXISTS tblGetReturnsReasonForPDAMstr");
                db.execSQL("DROP TABLE IF EXISTS tbl_XMLfiles");
                db.execSQL("DROP TABLE IF EXISTS tblUserAuthenticationMstr");
                db.execSQL("DROP TABLE IF EXISTS tblBloodGroup");
                db.execSQL("DROP TABLE IF EXISTS tblEducationQuali");
                db.execSQL("DROP TABLE IF EXISTS tblDsrRegDetails");
                db.execSQL("DROP TABLE IF EXISTS tblUserRegistarationStatus");

                db.execSQL("DROP TABLE IF EXISTS tblAvailableVersion");
                db.execSQL("DROP TABLE IF EXISTS tblRouteListMaster");
                db.execSQL("DROP TABLE IF EXISTS tblPDANotificationMaster");
                //surbhi
                db.execSQL("DROP TABLE IF EXISTS tblUOMMstr");
                db.execSQL("DROP TABLE IF EXISTS tblSalesQuotePrcsMstr");
                db.execSQL("DROP TABLE IF EXISTS tblSalesQuotePersonMeetMstr");
                db.execSQL("DROP TABLE IF EXISTS tblSalesQuoteProductsMstr");
                db.execSQL("DROP TABLE IF EXISTS tblSalesQuotePaymentModeMstr");
                db.execSQL("DROP TABLE IF EXISTS tblSalesQuotePaymentStageMstr");
                db.execSQL("DROP TABLE IF EXISTS tblSalesQuoteTypeMstr");
                db.execSQL("DROP TABLE IF EXISTS tblSalesQuotePaymentStageModeMapMstr");



                db.execSQL("DROP TABLE IF EXISTS tblGetPDAQuestGrpMapping");


                db.execSQL("DROP TABLE IF EXISTS tblStoreList");
                db.execSQL("DROP TABLE IF EXISTS tblNewAddedStoreLocationDetails");
                db.execSQL("DROP TABLE IF EXISTS tblProductListMaster");
                db.execSQL("DROP TABLE IF EXISTS tblProductSegementMap");
                db.execSQL("DROP TABLE IF EXISTS tblCategoryMaster");
                //db.execSQL("DROP TABLE IF EXISTS tblCategoryQuestionInformation");
                db.execSQL("DROP TABLE IF EXISTS tblVisibilityMstr");
                db.execSQL("DROP TABLE IF EXISTS tblVisibilityDetails");
                db.execSQL("DROP TABLE IF EXISTS tblTransac");
                db.execSQL("DROP TABLE IF EXISTS tblInvoiceHeader");
                db.execSQL("DROP TABLE IF EXISTS tblPDALastInvoiceDet");
                db.execSQL("DROP TABLE IF EXISTS tblStoreProductMap");
                db.execSQL("DROP TABLE IF EXISTS tblSelectedStoreIDinChangeRouteCase");
                db.execSQL("DROP TABLE IF EXISTS tblDayStartEndDetails");
                db.execSQL("DROP TABLE IF EXISTS tblSysVisitID");
                db.execSQL("DROP TABLE IF EXISTS tblDaySummaryNew");

                db.execSQL("DROP TABLE IF EXISTS tblFirstOrderDetailsOnLastVisitDetailsActivity");
                db.execSQL("DROP TABLE IF EXISTS tblSecondVisitDetailsOnLastVisitDetailsActivity");
                db.execSQL("DROP TABLE IF EXISTS tblPDAGetLODQty");


                db.execSQL("DROP TABLE IF EXISTS tblPendingInvoices");
                db.execSQL("DROP TABLE IF EXISTS tblInvoiceExecutionProductList");
                db.execSQL("DROP TABLE IF EXISTS tblProductWiseInvoice");
                db.execSQL("DROP TABLE IF EXISTS tblInvoiceButtonTransac");
                db.execSQL("DROP TABLE IF EXISTS tblPdaDate");
                //db.execSQL("DROP TABLE IF EXISTS tblPDANotificationMaster");

                db.execSQL("DROP TABLE IF EXISTS tblPDAGetLastVisitDate");
                db.execSQL("DROP TABLE IF EXISTS tblPDAGetLastOrderDate");
                db.execSQL("DROP TABLE IF EXISTS tblPDAGetLastVisitDetails");
                db.execSQL("DROP TABLE IF EXISTS tblPDAGetLastOrderDetails");
                db.execSQL("DROP TABLE IF EXISTS tblPDAGetLastOrderDetailsTotalValues");
                db.execSQL("DROP TABLE IF EXISTS tblPDAGetExecutionSummary");
                db.execSQL("DROP TABLE IF EXISTS tblStoreSchemeFreeProQtyOtherDetails");

                db.execSQL("DROP TABLE IF EXISTS tblProductListForAvailableStock");
                db.execSQL("DROP TABLE IF EXISTS tblCatagoryMstrForDailyTarget");

                db.execSQL("DROP TABLE IF EXISTS tblSchemeStoreMapping");
                db.execSQL("DROP TABLE IF EXISTS tblSchemeMstr");
                db.execSQL("DROP TABLE IF EXISTS tblSchemeSlabDetail");
                db.execSQL("DROP TABLE IF EXISTS tblSchemeSlabBucketDetails");
                db.execSQL("DROP TABLE IF EXISTS tblSchemeSlabBucketProductMapping");
                db.execSQL("DROP TABLE IF EXISTS tblSchemeSlabBenefitsBucketDetails");
                db.execSQL("DROP TABLE IF EXISTS tblSchemeSlabBenefitsProductMappingDetail");
                db.execSQL("DROP TABLE IF EXISTS tblSchemeSlabBenefitsValueDetail");
                db.execSQL("DROP TABLE IF EXISTS tblProductRelatedScheme");
                db.execSQL("DROP TABLE IF EXISTS tblTmpInvoiceDetails");
                db.execSQL("DROP TABLE IF EXISTS tblInvoiceDetails");
                db.execSQL("DROP TABLE IF EXISTS tblStoreProductAppliedSchemesBenifitsRecords");

                db.execSQL("DROP TABLE IF EXISTS tblStoreReturnDetail");

                db.execSQL("DROP TABLE IF EXISTS tblStoreTypeMstr");
                db.execSQL("DROP TABLE IF EXISTS tblStoreProductClassificationTypeListMstr");
                db.execSQL("DROP TABLE IF EXISTS tblTradeChannelMstr");

                db.execSQL("DROP TABLE IF EXISTS tblNewStoreEntries");
                db.execSQL("DROP TABLE IF EXISTS tblTemp");


                db.execSQL("DROP TABLE IF EXISTS tblStoreProductPhotoDetail");



                db.execSQL("DROP TABLE IF EXISTS tblSKUWiseDaySummary");
                db.execSQL("DROP TABLE IF EXISTS tblStoreWiseDaySummary");
                db.execSQL("DROP TABLE IF EXISTS tblStoreSKUWiseDaySummary");

                db.execSQL("DROP TABLE IF EXISTS tblProductMappedWithSchemeSlabApplied");
                db.execSQL("DROP TABLE IF EXISTS tblAlrtVal");
                db.execSQL("DROP TABLE IF EXISTS tblAllSummary");


                db.execSQL("DROP TABLE IF EXISTS tblPOSMaterialMstr");
                db.execSQL("DROP TABLE IF EXISTS tblStoreIDAndMaterialIDMap");
                db.execSQL("DROP TABLE IF EXISTS tblStoreMaterialDetail");
                db.execSQL("DROP TABLE IF EXISTS tblStoreMaterialPhotoDetail");

                db.execSQL("DROP TABLE IF EXISTS tblDayStartAttendanceOptions");
                //
                db.execSQL("DROP TABLE IF EXISTS tblNoVisitStoreDetails");
                db.execSQL("DROP TABLE IF EXISTS tblSalesQuoteSponsorMstr");
                db.execSQL("DROP TABLE IF EXISTS tblManufacturerMstrMain");
                db.execSQL("DROP TABLE IF EXISTS tblRateDistribution");

                onCreate(db);

            } catch (Exception e) {
                Log.e(TAG, "Error: onUpgrade db");
            }
        }
    }

    //sunil




    public static void UpdateXMLCreatedFilesTablesFlag(int flag2set)
    {
        //open();
        try
        {

            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);//
            int affected1 = db.update("tblStoreList", values,"Sstat=?", new String[] { "3" });
            int affected61 = db.update("tblStoreCheckInPic", values,"Sstat=?", new String[] { "3" });
            int affected20 = db.update("tblActualVisitStock", values,"Sstat=?", new String[] { "3" });
            int affected2 = db.update("tblNewAddedStoreLocationDetails", values,"Sstat=?", new String[] { "3" });
            int affected3 = db.update("tblNewStoreListEntries", values,"Sstat=?", new String[] { "3" });
            int affected4 = db.update("tblNewStoreSalesQuotePaymentDetails", values,"Sstat=?", new String[] { "3" });
            int affected5 = db.update("tblOutletQuestAnsMstr", values,"Sstat=?", new String[] { "3" });
            int affected6 = db.update("tableImage", values,"Sstat=?", new String[] { "3" });


            int affected7 = db.update("tblStoreVisitMstr", values,"Sstat=?", new String[] { "3" });
            int affected8 = db.update("tblInvoiceDetails", values,"Sstat=?", new String[] { "3" });
            int affected9 = db.update("tblInvoiceHeader", values,"Sstat=?", new String[] { "3" });
            int affected10 = db.update("tblAllCollectionData", values,"Sstat=?", new String[] { "3" });
            int affected11= db.update("tblStoreProductPhotoDetail", values,"Sstat=?", new String[] { "3" });
            int affected12 = db.update("tblNewStoreEntries", values,"Sstat=?", new String[] { "3" });
            int affected13 = db.update("tblNoVisitStoreDetails", values,"Sstat=?", new String[] { "3" });
            int affected14= db.update("tblSelectedManagerDetails", values,"Sstat=?", new String[] { "3" });
            int affected15= db.update("tblLatLongDetails", values,"Sstat=?", new String[] { "3" });
            int affected16= db.update("tblStoreCloseLocationDetails", values,"Sstat=?", new String[] { "3" });
            int affected17= db.update("tblStoreClosedPhotoDetail", values,"Sstat=?", new String[] { "3" });
            int affected18= db.update("tblStoreCloseReasonSaving", values,"Sstat=?", new String[] { "3" });



        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }
      //  close();

    }




    public static int fnGetCollectionOutSstat(String StoreID)
    {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT Sstat FROM  tblAllCollectionData where StoreID='"+StoreID+"'", null);
        int StoreCurrentOutsStat = 0;

        try {
            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst())
                {


                    StoreCurrentOutsStat = (Integer.parseInt(cursorE2.getString(0).toString()));


                }
            }
            return StoreCurrentOutsStat;
        } finally {
            if(cursorE2!=null) {
                cursorE2.close();
            }
          //  close();
        }

    }




    public static String fnGetStoreCollectionCode(String StoreID)
    {
        //open();
        String StoreCollectionCode="NA";
        Cursor cursor=db.rawQuery("Select CollectionCode from tblAllCollectionData Where StoreID='"+StoreID+"' AND Sstat=1",null);

        if(cursor.getCount()>0)
        {
            if(cursor.moveToFirst())
            {
                StoreCollectionCode=cursor.getString(0);
            }
        }
        if(cursor!=null) {
            cursor.close();
        }
        //close();
        return StoreCollectionCode;
    }



    public static int checkflgVisitCollectionMarkedStatus(String  StoreID,String StoreVisitCode)
    {
        //open();
        int check=0;
        Cursor cursor = db.rawQuery("SELECT flgVisitCollectionMarkedStatus FROM tblStoreVisitMstr WHERE  StoreID ='"+ StoreID + "' and StoreVisitCode='"+StoreVisitCode+"'", null);

        try {



            if (cursor.getCount() > 0)
            {
                if (cursor.moveToFirst())
                {

                        check=Integer.parseInt(cursor.getString(0).toString());

                }

            }
            return check;

        } finally {
            cursor.close();
           // close();
        }

    }
    public static void fnUpdateflgVisitCollectionMarkedStatus(String storeID,String StoreVisitCode,String TmpInvoiceCodePDA,int flgVisitCollectionMarkedStatus)
    {
        // Cursor cursor = db.rawQuery("SELECT flgVisitCollectionMarkedStatus FROM tblStoreVisitMstr WHERE  StoreID ='"+ StoreID + "' and StoreVisitCode='"+StoreVisitCode+"'", null);
        //open();
        final ContentValues values = new ContentValues();
        values.put("flgVisitCollectionMarkedStatus", flgVisitCollectionMarkedStatus);
        int affected1 = db.update("tblStoreVisitMstr", values,"StoreID=? AND StoreVisitCode=?", new String[] { storeID,StoreVisitCode });
       // close();
    }


    public static String getDefaultCity()
    {
        //open();
        String defaultCity="";
        Cursor cur=null;
        try {
            cur=db.rawQuery("Select City from tblStateCityMaster where CityDefault=1",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    defaultCity=cur.getString(0);
                }
            }
        }catch(SQLiteException exception)
        {

        }
        finally
        {
            if(cur!=null)
            {
                cur.close();
            }
          //  close();
            return defaultCity;
        }
    }
    public static LinkedHashMap<String,String> getCityAgainstState()
    {
        //open();
        LinkedHashMap<String,String> hmapCityAgainstState=new LinkedHashMap<String,String>();
        Cursor cur=null;
        try {
            cur=db.rawQuery("Select City,State from tblStateCityMaster",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        hmapCityAgainstState.put(cur.getString(0),cur.getString(1));
                        cur.moveToNext();
                    }
                }
            }
        }catch(SQLiteException exception)
        {

        }
        finally
        {
            if(cur!=null)
            {
                cur.close();
            }
            //close();
            return hmapCityAgainstState;

        }
    }

    public static LinkedHashMap<String, String> fngetCityList()
    {

        //open();
        Cursor cur=null;
        LinkedHashMap<String, String> hmapCityList=new LinkedHashMap<String, String>();
        try {
            cur=db.rawQuery("Select CityID,City from tblStateCityMaster", null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        hmapCityList.put(cur.getString(1).trim(), cur.getString(0));
                        cur.moveToNext();
                    }
                }

            }

        } catch (Exception e) {
            // TODO: handle exception
        }
        finally
        {
            if(cur!=null)
            {
                cur.close();
            }
           // close();
            return hmapCityList;
        }
    }

    public static LinkedHashMap<String, String> fngetDistinctState()
    {

        //open();
        Cursor cur=null;
        LinkedHashMap<String, String> hmapDistinctStates=new LinkedHashMap<String, String>();
        try {
            cur=db.rawQuery("Select Distinct StateID,State from tblStateCityMaster", null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        hmapDistinctStates.put(cur.getString(1), cur.getString(0));
                        cur.moveToNext();
                    }
                }

            }

        } catch (SQLiteException e) {
            // TODO: handle exception
        }
        finally
        {
            if(cur!=null)
            {
                cur.close();
            }
          //  close();
            return hmapDistinctStates;
        }
    }
    public static void updateAllDefaultCity(String cityId)
    {
        //open();
        try {


            db.execSQL("UPDATE tblStateCityMaster SET CityDefault=0" );
            ContentValues values=new ContentValues();
            values.put("CityDefault",1);
            db.update(TABLE_tblStateCityMaster,values,"CityID=?",new String[]{cityId});
        }catch(SQLiteException exception)
        {

        }finally
        {
           // close();
        }

    }
    public static void deletetblStateCityMaster()
    {

        db.execSQL("DELETE FROM tblStateCityMaster");

    }
    public static void fnsavetblStateCityMaster(String StateID, String State, String CityID, String City,int cityDefault)
    {

        ContentValues values=new ContentValues();
        values.put("StateID", Integer.parseInt(StateID));
        values.put("State", State);
        values.put("CityID", Integer.parseInt(CityID));
        values.put("City", City);
        values.put("CityDefault", cityDefault);

        db.insert(TABLE_tblStateCityMaster , null, values);

    }

    public static LinkedHashMap<Integer, String> fetch_Reason_List_for_option()
    {
        //open();
        LinkedHashMap<Integer, String> hmapCatgry = new LinkedHashMap<Integer, String>();
        Cursor cursor = db.rawQuery("SELECT ReasonId,ReasonDescr FROM tblDayStartAttendanceOptions where flgDSRApplicable='"+1+"' and flgNoVisitOption='"+0+"' order by SeqNo asc",null);
        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        hmapCatgry.put(Integer.parseInt(cursor.getString(0).toString()),cursor.getString(1).toString());
                        cursor.moveToNext();
                    }
                }

            }

            else
            {
                // hmapCatgry.put(0, "No Reason");
            }
            return hmapCatgry;
        }
        finally
        {
            cursor.close();
           // close();
        }
    }
    public static LinkedHashMap<Integer, String> fetch_NoWorking_Reason_List()
    {
        //open();
        LinkedHashMap<Integer, String> hmapCatgry = new LinkedHashMap<Integer, String>();
        Cursor cursor = db.rawQuery("SELECT ReasonId,ReasonDescr FROM tblDayStartAttendanceOptions where flgDSRApplicable='"+1+"' and flgNoVisitOption="+1,null);
        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    // hmapCatgry.put("Select Reason", "0");
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        hmapCatgry.put(Integer.parseInt(cursor.getString(0).toString()),cursor.getString(1).toString());
                        cursor.moveToNext();
                    }
                }

            }

            else
            {
                // hmapCatgry.put(0, "No Reason");
            }
            return hmapCatgry;
        }
        finally
        {
            cursor.close();
            //close();
        }
    }

    public static void fnSettblAttandanceDetails() {

        try
        {

            //open();
            db.execSQL("UPDATE tblAttandanceDetails SET Sstat= 4" );
        }
        catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }
        finally {
            //close();
        }

    }

    public static long savetblAttandanceDetails(String AttandanceTime,String PersonNodeID,String  PersonNodeType ,String PersonName ,
                                         String OptionID,String OptionDesc ,String ReasonID,String ReasonDesc,
                                         String Address,
                                         String PinCode,String City,String State,String fnLati,
                                         String fnLongi ,String fnAccuracy ,String flgLocNotFound,String fnAccurateProvider,
                                         String AllProvidersLocation ,String fnAddress ,String GpsLat ,String  GpsLong ,
                                         String GpsAccuracy ,String GpsAddress ,String NetwLat ,String NetwLong ,
                                         String NetwAccuracy ,String  NetwAddress ,String  FusedLat ,String  FusedLong ,
                                         String FusedAccuracy ,String  FusedAddress ,String FusedLocationLatitudeWithFirstAttempt,
                                         String FusedLocationLongitudeWithFirstAttempt ,String FusedLocationAccuracyWithFirstAttempt,
                                         int Sstat,int flgLocationServicesOnOff,int flgGPSOnOff,int flgNetworkOnOff,
                                         int flgFusedOnOff,int flgInternetOnOffWhileLocationTracking,int flgRestart
            ,String CityId,String StateId,String MapAddress,String MapCity,String MapPinCode,String MapState)
    {
        try
        {
            db.execSQL("DELETE FROM tblAttandanceDetails");
        }
        catch(Exception e)
        {

        }

        ContentValues initialValues = new ContentValues();
        String aa= fnGetPersonNodeIDAndPersonNodeType();


        initialValues.put("AttandanceTime", AttandanceTime.trim());
        initialValues.put("PersonNodeID", aa.split(Pattern.quote("^"))[0].trim());
        initialValues.put("PersonNodeType", aa.split(Pattern.quote("^"))[1].trim());

        initialValues.put("OptionID", OptionID.trim());
        initialValues.put("OptionDesc", OptionDesc.trim());
        initialValues.put("ReasonID", ReasonID.trim());
        initialValues.put("ReasonDesc", ReasonDesc.trim());

        initialValues.put("Address", Address.trim());
        initialValues.put("PinCode", PinCode.trim());
        initialValues.put("City", City.trim());
        initialValues.put("State", State.trim());

        initialValues.put("fnLati", fnLati.trim());
        initialValues.put("fnLongi", fnLongi.trim());
        initialValues.put("fnAccuracy", fnAccuracy.trim());
        initialValues.put("flgLocNotFound", flgLocNotFound.trim());
        initialValues.put("fnAccurateProvider", fnAccurateProvider.trim());
        initialValues.put("AllProvidersLocation", AllProvidersLocation.trim());
        initialValues.put("fnAddress", fnAddress.trim());

        initialValues.put("GpsLat", GpsLat.trim());
        initialValues.put("GpsLong", GpsLong.trim());
        initialValues.put("GpsAccuracy", GpsAccuracy.trim());
        initialValues.put("GpsAddress", GpsAddress.trim());

        initialValues.put("NetwLat", NetwLat.trim());
        initialValues.put("NetwLong", NetwLong.trim());
        initialValues.put("NetwAccuracy", NetwAccuracy.trim());
        initialValues.put("NetwAddress", NetwAddress.trim());

        initialValues.put("FusedLat", FusedLat.trim());
        initialValues.put("FusedLong", FusedLong.trim());
        initialValues.put("FusedAccuracy", FusedAccuracy.trim());
        initialValues.put("FusedAddress", FusedAddress.trim());

        initialValues.put("FusedLocationLatitudeWithFirstAttempt", FusedLocationLatitudeWithFirstAttempt.trim());
        initialValues.put("FusedLocationLongitudeWithFirstAttempt", FusedLocationLongitudeWithFirstAttempt.trim());
        initialValues.put("FusedLocationAccuracyWithFirstAttempt", FusedLocationAccuracyWithFirstAttempt.trim());
        initialValues.put("Sstat", Sstat);

        initialValues.put("flgLocationServicesOnOff", flgLocationServicesOnOff);
        initialValues.put("flgGPSOnOff", flgGPSOnOff);
        initialValues.put("flgNetworkOnOff", flgNetworkOnOff);
        initialValues.put("flgFusedOnOff", flgFusedOnOff);
        initialValues.put("flgInternetOnOffWhileLocationTracking", flgInternetOnOffWhileLocationTracking);
        initialValues.put("flgRestart", flgRestart);

        initialValues.put("MapAddress", MapAddress);
        initialValues.put("MapCity", MapCity);
        initialValues.put("MapPinCode", MapPinCode);
        initialValues.put("MapState", MapState);
        initialValues.put("CityId", CityId);
        initialValues.put("StateId", StateId);
        initialValues.put("DistributorId", "0");
        initialValues.put("DistributorNodeType", "0");
        initialValues.put("DistributorName", "NA");

        return db.insert(TABLE_tblAttandanceDetails, null, initialValues);
    }
    public static void updatetblAttandanceDetails(String OptionID,String OptionDesc,String ReasonID,String ReasonDesc,
                                           String Comment,String DistributorId,String DistributorNodeType,String DistributorName )
    {
        //open();
        try {


            ContentValues values=new ContentValues();
            values.put("OptionID",OptionID.trim());
            values.put("OptionDesc",OptionDesc.trim());
            values.put("ReasonID",ReasonID.trim());
            values.put("ReasonDesc",ReasonDesc);
            values.put("Comment",Comment);

            values.put("DistributorId",DistributorId.trim());
            values.put("DistributorNodeType",DistributorNodeType);
            values.put("DistributorName",DistributorName);

            db.update(TABLE_tblAttandanceDetails,values,"",new String[]{});
        }catch(SQLiteException exception)
        {

        }finally
        {
            //close();
        }

    }
    public static String fnGetPersonNodeIDAndPersonNodeType()
    {
        String SONodeIdAndNodeType="0^0";


        Cursor cursor=db.rawQuery("Select PersonNodeID,PersonNodeType from tblUserAuthenticationMstr", null);

        if(cursor.getCount()>0)
        {
            if(cursor.moveToFirst())
            {
                SONodeIdAndNodeType=cursor.getString(0)+"^"+cursor.getString(1);
            }
        }

        return SONodeIdAndNodeType;
    }
    public static int FetchflgPersonTodaysAtt()
    {
        int CatId=0;

        Cursor cursor = db.rawQuery("SELECT flgPersonTodaysAtt from tblUserAuthenticationMstr", null);
        try {

            if (cursor.moveToFirst())
            {

                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {

                    String abc =(String) cursor.getString(0).toString();
                    CatId=Integer.parseInt(abc);
                    cursor.moveToNext();
                }

            }
            return CatId;
        } finally {
            cursor.close();
        }

    }

    public static void deleteActualVisitData(String storeID) {
        //open();
        db.execSQL("DELETE FROM tblActualVisitStock where storeID='"+storeID+"'");
       // close();
    }

    public static void saveTblActualVisitStock(String storeID,String ProductID,String Stock,int sStat)
    {
//(tblActualVisitStock (storeID text null,ProductID text null,Stock text null,Sstat integer null);";
        //open();
        ContentValues initialValues = new ContentValues();
        initialValues.put("storeID",storeID);
        initialValues.put("ProductID", ProductID.trim());
        initialValues.put("Stock", Stock.trim());
        initialValues.put("Sstat", sStat);


        db.insert(DATABASE_TABLE_tblActualVisitStock, null, initialValues);
       // close();
    }

    public static LinkedHashMap<String,String> fetchActualVisitData(String storeID){
//tblActualVisitStock (ProductID text null,Stock text null);";
        LinkedHashMap<String,String> hmapData=new LinkedHashMap<>();
        Cursor cursor=null;

        try {
            cursor = db.rawQuery("SELECT ProductID,Stock from tblActualVisitStock  where storeID='"+storeID+"'", null);
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {

                        hmapData.put(cursor.getString(0),cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }
        } finally {
            if(cursor !=null)
                cursor.close();
            return hmapData;
        }
    }


    public static LinkedHashMap<String,String> fetchProductDataForActualVisit(){
        LinkedHashMap<String,String> hmapData=new LinkedHashMap<>();
        Cursor cursor=null;

        try {
            cursor = db.rawQuery("SELECT ProductID,ProductShortName from tblProductListMaster Order By PrdOrdr", null);
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {

                        hmapData.put(cursor.getString(0),cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }
        } finally {
            if(cursor !=null)
                cursor.close();
            return hmapData;
        }
    }


    public static LinkedHashMap<String,String> fetchProductStockFromPurchaseTable(String storeID){
//tblActualVisitStock (ProductID text null,Stock text null);";
        LinkedHashMap<String,String> hmapData=new LinkedHashMap<>();
        Cursor cursor=null;

        try {
            cursor = db.rawQuery("SELECT ProdID,Stock from tblTmpInvoiceDetails  where StoreID='"+storeID+"'", null);
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {

                        hmapData.put(cursor.getString(0),cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }
        } finally {
            if(cursor !=null)
                cursor.close();
            return hmapData;
        }
    }


    public static LinkedHashMap<String,String>   fetchProductListLastvisitAndOrderBasis(String StoreID){
//tblActualVisitStock (ProductID text null,Stock text null);";
        LinkedHashMap<String,String> hmapData=new LinkedHashMap<>();
        Cursor cursor=null;
        //open();
        try {
            cursor = db.rawQuery("SELECT  Distinct tblProductListLastVisitStockOrOrderMstr.PrdID,tblProductListMaster.ProductShortName from tblProductListLastVisitStockOrOrderMstr inner join tblProductListMaster on tblProductListLastVisitStockOrOrderMstr.PrdID=tblProductListMaster.ProductID   where tblProductListLastVisitStockOrOrderMstr.StoreID='"+StoreID+"'", null);
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {

                        hmapData.put(cursor.getString(0),cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }
        }
        catch (Exception e){
            System.out.println(e);
        }finally {
            if(cursor !=null){
                cursor.close();
            }

            //close();
            return hmapData;
        }
    }

    public static void deletetblProductListLastVisitStockOrOrderMstr()
    {
        db.execSQL("DELETE FROM tblProductListLastVisitStockOrOrderMstr");

    }


    public static String fnGetLastStockDate(String ssStoreID)
    {
        String lstStockDate="";
        //open();
        Cursor cursor = db.rawQuery("SELECT Date123 FROM tblPDAGetLastVisitDetails where StoreID= '" + ssStoreID + "'", null);
        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i < cursor.getCount(); i++) {

                        lstStockDate=cursor.getString(0);
                        cursor.moveToNext();
                    }
                }
            }
            return lstStockDate;
        } finally {
            if(cursor!=null) {
                cursor.close();
            }
           // close();
        }

    }

    public static HashMap<String,String> fnGetLastStockByDMS_Or_SFA(String ssStoreID)
    {
        HashMap<String, String> hmapProductIdLastStock=new HashMap<String, String>();
        //open();
        Cursor cursor = db.rawQuery("SELECT ProductID,Stock FROM tblPDAGetLastVisitDetails where StoreID= '" + ssStoreID + "'", null);
        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i < cursor.getCount(); i++) {

                        hmapProductIdLastStock.put((String) cursor.getString(0).toString(),(String) cursor.getString(1).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return hmapProductIdLastStock;
        } finally {
            if(cursor!=null) {
                cursor.close();
            }
            //close();
        }

    }


    // store list page methods
    public static int fnGetExistingOutletIDFromOutletMstr(String ODescr)
    {
        int existOutID=0;
        //open();
        Cursor cursor = db.rawQuery("SELECT Count(StoreID)  from tblPreAddedStores where StoreName like '"+ODescr+"%'", null);
        // close();
        try {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    if(cursor.getInt(0)>0)
                    {
                        existOutID=1;
                    }

                }
            }
            return existOutID;
        }
        finally
        {
            cursor.close();
           // close();
        }
    }
    public static LinkedHashMap<String, String> fnGeStoreListSM(int DistanceRange)
    {
        LinkedHashMap<String, String> hmapQuestionMstr=new LinkedHashMap<String, String>();
        //open();

        try {

            // Cursor cursor = db.rawQuery("SELECT OutletID,OutletDescr,BeatName,RetailerNo,ifnull(OutletNew,0),Sstat from tblOutletMstr", null);

            // Cursor cursor = db.rawQuery("SELECT StoreID,StoreName,LatCode,LongCode,DateAdded,DistanceNear,flgReMap from tblPreAddedStores WHERE (LatCode<>'0' AND LatCode<>'NA') ORDER BY DistanceNear", null);//
            Cursor cursor = db.rawQuery("SELECT StoreID,StoreName,LatCode,LongCode,DateAdded,DistanceNear,flgReMap from tblPreAddedStores ORDER BY DistanceNear", null);//

            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        String StoreLat="0.00";
                        String StoreLon="0.00";
                        if(!cursor.getString(2).toString().equals("NA"))
                        {
                            StoreLat=(String) cursor.getString(2).toString();
                            StoreLon=(String) cursor.getString(3).toString();
                        }

                        hmapQuestionMstr.put((String) cursor.getString(0).toString(),(String) cursor.getString(1).toString()+"^"+StoreLat+"^"+StoreLon+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(6).toString());

                        cursor.moveToNext();
                    }
                }
            }

        }
        catch (Exception e)
        {
            // System.out.println("Error fnGettblUOMMstr= "+e.toString());
        }
        finally
        {

           // close();
            fnGeNewlyAddedStoreList(hmapQuestionMstr);
            return hmapQuestionMstr;
        }
    }

    public static int fncheckCountNearByStoreExistsOrNotSM(int DistanceRange)
    {
        int flgCheck=0;
        //open();

        try {

            // Cursor cursor = db.rawQuery("SELECT Count(*) from tblPreAddedStores WHERE (LatCode<>'0' AND LatCode<>'NA')    ORDER BY DistanceNear ASC", null);//
            Cursor cursor = db.rawQuery("SELECT Count(*) from tblPreAddedStores  ORDER BY DistanceNear ASC", null);//

            if(cursor.getCount()>0) {
                if (cursor.moveToFirst())
                {
                    if(cursor.getInt(0)>0)
                    {
                        flgCheck=1;
                    }
                }
            }

        }
        catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= "+e.toString());
        }
        finally
        {

           // close();
            if(flgCheck==0)
            {
                flgCheck=fncheckCountNewAddedNearByStoreExistsOrNot(flgCheck);
            }
            return flgCheck;
        }
    }
    public static void UpdateStoreDistanceNearSM(String OutletID, int DistanceNear)
    {
    try
    {

        final ContentValues values = new ContentValues();
        values.put("DistanceNear", DistanceNear);
        int affected = db.update("tblPreAddedStores", values, "StoreID=?", new String[]{OutletID});
    }
    catch(Exception e)
    {

    }
    finally
    {

    }

}
    public static void delete_all_storeDetailTables()
    {
        db.execSQL("DELETE FROM tblUserName");
        db.execSQL("DELETE FROM tblStoreCountDetails");
        db.execSQL("DELETE FROM tblPreAddedStores");
        db.execSQL("DELETE FROM tblPreAddedStoresDataDetails");
        // db.execSQL("DELETE FROM tblLocationDetails");
    }
    public static long saveTblUserName(String UserName)
    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("UserName", UserName);

        return db.insert(DATABASE_TABLE_tblUserName, null, initialValues);
    }
    public static long saveTblStoreCountDetails(String TotStoreAdded,String TodayStoreAdded)
    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("TotStoreAdded", Integer.parseInt(TotStoreAdded.toString().trim()));
        initialValues.put("TodayStoreAdded", Integer.parseInt(TodayStoreAdded.toString().trim()));

        return db.insert(DATABASE_TABLE_tblStoreCountDetails, null, initialValues);
    }


    public static LinkedHashMap<String, String> fnCompleteRouteList()
    {
        LinkedHashMap<String, String> hmapRouteMstr=new LinkedHashMap<String, String>();
        //open();

        try {

            Cursor cursor = db.rawQuery("SELECT ID,Descr from tblRouteListMaster ", null);//

            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        if(i==0){
                            hmapRouteMstr.put("All","0");
                        }

                        hmapRouteMstr.put((String) cursor.getString(1).toString(),(String) cursor.getString(0).toString());

                        cursor.moveToNext();
                    }
                }
            }

        }
        catch (Exception e)
        {
            // System.out.println("Error fnGettblUOMMstr= "+e.toString());
        }
        finally
        {

            //close();

            return hmapRouteMstr;
        }
    }

    public static String getUsername()
    {String userName="0"+"^"+"0";

        //open();
        try {
            Cursor cur=db.rawQuery("Select UserName from tblUserName", null);

            if(cur.getCount()>0)
            {
                StringBuilder sBuilder=new StringBuilder();
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        userName=cur.getString(0);
                        cur.moveToNext();
                    }
                }

            }

        } catch (Exception e) {
            // TODO: handle exception
        } finally
        {
            //close();
            return userName;
        }
    }

    public static LinkedHashMap<String, String> fnGeStoreListAgainstRoute(int RouteID)
    {
        LinkedHashMap<String, String> hmapQuestionMstr=new LinkedHashMap<String, String>();
        //open();

        try {

            Cursor cursor = db.rawQuery("SELECT StoreID,StoreName,LatCode,LongCode,DateAdded,DistanceNear,flgReMap from tblPreAddedStores where RouteID="+RouteID, null);//

            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        String StoreLat="0.00";
                        String StoreLon="0.00";
                        if(!cursor.getString(2).toString().equals("NA"))
                        {
                            StoreLat=(String) cursor.getString(2).toString();
                            StoreLon=(String) cursor.getString(3).toString();
                        }

                        hmapQuestionMstr.put((String) cursor.getString(0).toString(),(String) cursor.getString(1).toString()+"^"+StoreLat+"^"+StoreLon+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(6).toString());

                        cursor.moveToNext();
                    }
                }
            }

        }
        catch (Exception e)
        {
            // System.out.println("Error fnGettblUOMMstr= "+e.toString());
        }
        finally
        {

           // close();
            fnGeNewlyAddedStoreList(hmapQuestionMstr);
            return hmapQuestionMstr;
        }
    }
    public static LinkedHashMap<String,String> fnGetHampGetLastProductExecution(String StoreID)
    {
        LinkedHashMap<String,String> hampGetLastProductExecution=new LinkedHashMap<String,String>();
        //open();
        Cursor cursor = db.rawQuery("SELECT tblProductListMaster.ProductID,ifnull(tblPDAGetLastVisitDetails.ExecutionQty,0) FROM tblProductListMaster left outer join tblPDAGetLastVisitDetails  WHERE tblPDAGetLastVisitDetails.StoreID ='"+ StoreID + "'", null);

        try {


            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hampGetLastProductExecution.put( cursor.getString(0).toString(), cursor.getString(1).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return hampGetLastProductExecution;
        } finally {
            if(cursor!=null) {
                cursor.close();
            }
            //close();
        }

    }


    public static ArrayList<HashMap<String,String>> getDayStartSuplierOtherData()
    {
        ArrayList<HashMap<String,String>> arrDiatributorOtherDetails=new ArrayList<HashMap<String,String>>();
        HashMap<String,String> hmapCurrentDistributorNodeIdType=new HashMap<String,String>();
        HashMap<String,String> hmapDistflgPerviousLocation=new HashMap<String,String>();
        HashMap<String,String> hmapDistLatLocation=new HashMap<String,String>();
        HashMap<String,String> hmapDistLongLocation=new HashMap<String,String>();
        Cursor cursor2=null;
        //open();
        try {
            cursor2 = db.rawQuery("SELECT *  FROM tblSupplierMstrList Where flgDefault=1", null);
            String strStoreTypeNamesDetais[] =null;// new String[cursor2.getCount()];
            if(cursor2.getCount()>0)
            {
                strStoreTypeNamesDetais=new String[cursor2.getCount()+1];
                if (cursor2.moveToFirst())
                {
                    for (int i = 0; i < cursor2.getCount(); i++)
                    {
                        hmapCurrentDistributorNodeIdType.put("CurrentDistribuotrNodeIdType",cursor2.getString(0).toString()+"^"+cursor2.getString(1));
                        hmapDistflgPerviousLocation.put(cursor2.getString(0).toString()+"^"+cursor2.getString(1),cursor2.getString(5));
                        hmapDistLatLocation.put(cursor2.getString(0).toString()+"^"+cursor2.getString(1),cursor2.getString(3));
                        hmapDistLongLocation.put(cursor2.getString(0).toString()+"^"+cursor2.getString(1),cursor2.getString(4));
                        //strStoreTypeNamesDetais[i+1] = cursor2.getString(0).toString()+"^"+cursor2.getString(1)+"^"+cursor2.getString(2);
                        cursor2.moveToNext();
                    }
                }
                arrDiatributorOtherDetails.add(hmapCurrentDistributorNodeIdType);
                arrDiatributorOtherDetails.add(hmapDistflgPerviousLocation);
                arrDiatributorOtherDetails.add(hmapDistLatLocation);
                arrDiatributorOtherDetails.add(hmapDistLongLocation);
            }
            else
            {
                strStoreTypeNamesDetais=new String[1];
                strStoreTypeNamesDetais[0]="0^0^Select Distributor";

            }
            return arrDiatributorOtherDetails;
        } finally {
            if(cursor2!=null) {
                cursor2.close();
            }
           // close();
        }
    }
    public static void UpdateStoreReturnphotoFlagSM(String StoreID, String StoreName,int flgReMap)
    {
        try
        {
            //
            final ContentValues values = new ContentValues();
            values.put("StoreName", StoreName);
            values.put("flgReMap", flgReMap);



            int affected16 = db.update("tblPreAddedStores", values,"StoreID=?", new String[] { StoreID });
        }
        catch (Exception ex) {

        }
    }

    public static Double  fnTotCollectionAmtAgainstStoreIrespectiveOfVisit(String StoreID)
    {
        //open();
        Double TotCollectionAmt=0.0;
        try {

            Cursor cursor = db.rawQuery("SELECT  IFNULL(SUM(Amount),0.0) from tblAllCollectionData  where tblAllCollectionData.StoreID='"+StoreID +"'", null);
            if(cursor.getCount()>0){
                if (cursor.moveToFirst()){
                    TotCollectionAmt=Double.parseDouble(cursor.getString(0).toString());
                }
            }
        }catch(Exception e)
        {

        }
        finally
        {
            if(cursor!=null)
            {
                cursor.close();;
            }
            //close();
            // return flag;
        }
        return TotCollectionAmt;
    }


    public static Double  fnTotInvoicesAmtAgainstStoreIrespectiveOfVisit(String StoreID)
    {
        //open();
        Double TotCollectionAmt=0.0;
        try {

            Cursor cursor = db.rawQuery("SELECT  IFNULL(SUM(InvoiceVal),0.0) from tblInvoiceHeader where tblInvoiceHeader.StoreID = '"+StoreID +"'", null);

            if(cursor.getCount()>0){
                if (cursor.moveToFirst()){
                    TotCollectionAmt=Double.parseDouble(cursor.getString(0).toString());
                }
            }
        }catch(Exception e)
        {

        }
        finally
        {
            if(cursor!=null)
            {
                cursor.close();;
            }
            //close();
            // return flag;
        }
        return TotCollectionAmt;
    }




    public static Double fetch_Store_AllOustandings(String StoreID)
    {
//tv_GrossInvVal
        //open();
        Double TotCollectionAmt=0.0;

        Cursor cursor = db.rawQuery("SELECT ifnull(SUM(tblInvoiceLastVisitDetails.OutstandingAmt),'0.0') from tblInvoiceLastVisitDetails WHERE tblInvoiceLastVisitDetails.StoreID='"+StoreID+"'", null); //order by AutoIdOutlet Desc
        String InvoiceLastVisitDetails[]= new String[cursor.getCount()];
        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        TotCollectionAmt=Double.parseDouble(cursor.getString(0).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return TotCollectionAmt;
        }
        finally
        {
            if(cursor!=null) {
                cursor.close();
            }
            //close();
        }
    }


    public static void insertStoreCheckInPic(String storeId,LinkedHashMap<String,String> hmapPicData)
    {
        //open();
        db.beginTransaction();

        ContentValues value=new ContentValues();
        for(Entry<String,String> entry:hmapPicData.entrySet())
        {
            value.put("StoreID",storeId);
            value.put("imageName",entry.getKey());
            value.put("picClkdPath",entry.getValue().split(Pattern.quote("^"))[0]);
            value.put("clkdDateTime",entry.getValue().split(Pattern.quote("^"))[1]);
            value.put("Sstat",1);
            db.insert(DATABASE_TABLE_tblStoreCheckInPic,null,value);

        }

        db.setTransactionSuccessful();
        db.endTransaction();
        //close();
    }

    public static void validateStoreCheckIn(String StoreID,String imgName)
    {
        //open();
        try
        {
            Cursor cur=db.rawQuery("Select imageName from tblStoreCheckInPic where StoreID='"+StoreID+"' and imageName='"+imgName+"'",null);

            if(cur.getCount()>0)
            {
                db.delete(DATABASE_TABLE_tblStoreCheckInPic,"StoreID=? and imageName=?",
                        new String[] {StoreID,imgName});
            }
        }
        catch (SQLiteException ex)
        {
            System.out.println("validate pic..."+ex);
        }
        finally {
           // close();
        }
    }

    public static ArrayList<String> getImageNameForStoreCheckIn(String StoreID)
    {
        //open();
        ArrayList<String> list=new ArrayList<>();
        try
        {

            Cursor cur=db.rawQuery("Select imageName from tblStoreCheckInPic where StoreID='"+StoreID+"'",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        list.add(cur.getString(0));
                        cur.moveToNext();
                    }
                }
            }
        }
        catch(Exception e)
        {
            System.out.println("Error tblCategoryPhotoDetails = "+e.toString());
        }
        finally
        {
           // close();
            return list;
        }

    }

    public static Double fnGetStoreVisitSelfCreditNote(String StoreID,String StoreVisitCode) {

        Double valSelfCreditNote=0.0;
        //open();
        Cursor cursor2 = db.rawQuery("SELECT ifnull(SelfCreditNote,0.0) FROM tblStoreVisitMstr Where StoreID='"+StoreID+"' AND StoreVisitCode='"+StoreVisitCode+"'", null);
        try {
            if(cursor2.getCount()>0) {
                if (cursor2.moveToFirst()) {
                    valSelfCreditNote = Double.parseDouble(cursor2.getString(0));
                }
            }

        }
        catch(Exception ex)
        {

        } finally{
            if(cursor2!=null) {
                cursor2.close();
            }
            //close();
        }
        return valSelfCreditNote;
    }

    public static void UpdateStoreVisitSelfCreditNote(String StoreID,String StoreVisitCode,Double SelfCreditNote)
    {
        //open();
        final ContentValues values = new ContentValues();
        values.put("SelfCreditNote", SelfCreditNote);
        int affected = db.update("tblStoreVisitMstr", values, "StoreID=? AND StoreVisitCode=?",new String[] {StoreID,StoreVisitCode });
        //close();
    }
    public long  saveWarehouseMstrData(int NodeID, int NodeType, String Descr,String latCode,
                                       String LongCode, int flgMapped,String Address,String State,String City,String PinCode,String PhoneNo,String TaxNumber)
    {
        ContentValues initialValues = new ContentValues();

        initialValues.put("NodeID", NodeID);
        initialValues.put("NodeType", NodeType);
        initialValues.put("Descr", Descr.trim());
        initialValues.put("latCode", latCode.trim());
        initialValues.put("LongCode", LongCode.trim());
        initialValues.put("flgMapped", flgMapped);   //0=Not To be mapped Again,1=Can Map Distributor
        initialValues.put("Address", Address.trim());
        initialValues.put("State", State.trim());
        initialValues.put("City", City.trim());
        initialValues.put("PinCode", PinCode.trim());
        initialValues.put("PhoneNo", PhoneNo.trim());
        initialValues.put("TaxNumber", TaxNumber.trim());

        return db.insert(TABLE_tblWarehouseMstr, null, initialValues);
    }
    public static void Delete_tblWarehouseMstr()
    {
        db.execSQL("DELETE FROM tblWarehouseMstr");
    }

    public static void Delete_tblAppMasterFlags()
    {
        db.execSQL("DELETE FROM tblAppMasterFlags");
    }
    public static ArrayList<LinkedHashMap<String,ArrayList<String>>> fnFetch_InvoiceReportForPrint(String VisitCode,String StoreID,int WarehouseNodeID,int WarehouseNodeType)
    {

        ArrayList<LinkedHashMap<String,ArrayList<String>>> arrResult=new ArrayList<LinkedHashMap<String,ArrayList<String>>>();

        //--------------Ware House Details Starts Here--------------------------------
        LinkedHashMap<String,ArrayList<String>>hmapWareHouseDetails=new LinkedHashMap<String,ArrayList<String>>();
        ArrayList<String> arrWareHouseDetails=new ArrayList<String>();
        arrWareHouseDetails=fnGetWarehouseDataForPrint(VisitCode,StoreID,WarehouseNodeID,WarehouseNodeType);
        hmapWareHouseDetails.put("WarehouseDetails",arrWareHouseDetails);

        //--------------Ware House Details Ends Here--------------------------------
        //--------------Store  Details Starts Here--------------------------------

        LinkedHashMap<String,ArrayList<String>> hmapStoreBasicDetails=fnGetStoreDetailsDataForPrint(VisitCode,StoreID);

        //--------------Store Details Ends Here--------------------------------

        //--------------Store Invoice  Details Starts Here--------------------------------

        LinkedHashMap<String,ArrayList<String>> hmapInvoiceRecodsToPrint=fnGetInvoiceListForPrint(VisitCode,StoreID);

        //--------------Store Invoice Details Ends Here--------------------------------

        //--------------Store Invoice  Before Tax And After Tax Starts Here--------------------------------

        LinkedHashMap<String,ArrayList<String>> hmapTotalBfrAftrTaxVal=fnGetTotalBfrAftrTaxVal(StoreID,VisitCode);

        //--------------Store Invoice Before Tax And After Tax Ends Here--------------------------------

        //--------------Store Invoice  Tax wise Product Details Starts Here--------------------------------

        LinkedHashMap<String,ArrayList<String>> hmapTaxWisePrdctDtlt=fnGetTaxWisePrdctDtl(StoreID,VisitCode);

        //--------------Store Invoice Tax wise Product Details  Ends Here--------------------------------

        //--------------Store Invoice  Tax wise Product Details Starts Here--------------------------------

        LinkedHashMap<String,ArrayList<String>> hmapOverAllProductOrderQtyValue=fnGetOverAllProductOrderQtyValue(StoreID,VisitCode);

        //--------------Store Invoice Tax wise Product Details  Ends Here--------------------------------

        arrResult.add(hmapWareHouseDetails);
        arrResult.add(hmapStoreBasicDetails);
        arrResult.add(hmapInvoiceRecodsToPrint);
        arrResult.add(hmapTotalBfrAftrTaxVal);
        arrResult.add(hmapTaxWisePrdctDtlt);
        arrResult.add(hmapOverAllProductOrderQtyValue);
        return arrResult;
    }

    public static ArrayList<String> fnGetWarehouseDataForPrint(String VisitCode,String StoreID,int WarehouseNodeID,int WarehouseNodeType)
    {
        ArrayList<String> arrWareHouseDetails=new ArrayList<String>();
        try {
            Cursor cursor2 = db.rawQuery("SELECT Descr,ifnull(State,'') AS State,ifnull(Address,'') AS Address,ifnull(City,'') AS City,ifnull(PinCode,'') AS PinCode,ifnull(PhoneNo,'NA') AS PhoneNo,ifnull(TaxNumber,'Not Registered') AS TaxNumber FROM tblWarehouseMstr Where NodeID="+WarehouseNodeID+" and NodeType="+WarehouseNodeType, null);

            if(cursor2.getCount()>0)
            {
                if (cursor2.moveToFirst())
                {
                    arrWareHouseDetails.add(cursor2.getString(0));
                    arrWareHouseDetails.add(cursor2.getString(1));
                    arrWareHouseDetails.add(cursor2.getString(2));
                    arrWareHouseDetails.add(cursor2.getString(3));
                    arrWareHouseDetails.add(cursor2.getString(4));
                    arrWareHouseDetails.add(cursor2.getString(5));
                    arrWareHouseDetails.add(cursor2.getString(6));
                    int IsCompositeStatus=fnGetStoreIsCompositeStatus(StoreID);
                    if(IsCompositeStatus==0){
                        arrWareHouseDetails.add("No");
                    }
                    if(IsCompositeStatus==1){
                        arrWareHouseDetails.add("Yes");
                    }

                }
            }
            else
            {
                arrWareHouseDetails.add("Not Available");
                arrWareHouseDetails.add("Not Available");
                arrWareHouseDetails.add("Not Available");
                arrWareHouseDetails.add("Not Available");
                arrWareHouseDetails.add("Not Available");
                arrWareHouseDetails.add("Not Available");
                arrWareHouseDetails.add("Not Available");
                int IsCompositeStatus=0;
                if(IsCompositeStatus==0){
                    arrWareHouseDetails.add("No");
                }
                if(IsCompositeStatus==1){
                    arrWareHouseDetails.add("Yes");
                }
            }
            return arrWareHouseDetails;
        } finally {

        }
    }
    public static int fnGetStoreIsCompositeStatus(String StoreID)
    {
        int IsCompositeStatus=0;
        try {
            Cursor cursor2 = db.rawQuery("SELECT ifnull(IsComposite,0) AS IsComposite FROM tblStoreList Where StoreID='"+StoreID+"'", null);

            if(cursor2.getCount()>0)
            {
                if (cursor2.moveToFirst())
                {
                    IsCompositeStatus=Integer.parseInt(cursor2.getString(0));
                }
            }
            return IsCompositeStatus;
        } finally {

        }
    }
    public static long  savetblStoreLastDeliveryNoteNumber(int LastDeliveryNoteNumber)
    {
        ContentValues initialValues = new ContentValues();
        initialValues.put("LastDeliveryNoteNumber", LastDeliveryNoteNumber);
        return db.insert(TABLE_tblStoreLastDeliveryNoteNumber, null, initialValues);
    }

    public static void fnupdatetblStoreLastDeliveryNoteNumber()
    {
        int valExistingDeliveryNoteNumber=0;
        valExistingDeliveryNoteNumber=fnGettblStoreLastDeliveryNoteNumber();
        db.execSQL("UPDATE tblStoreLastDeliveryNoteNumber SET LastDeliveryNoteNumber="+(valExistingDeliveryNoteNumber+1)+"");
        fnWriteTextFile(valExistingDeliveryNoteNumber+1);

    }


    public static void Delete_tblStoreLastDeliveryNoteNumber()
    {
        db.execSQL("DELETE FROM tblStoreLastDeliveryNoteNumber");
    }
    public static int fnGettblStoreLastDeliveryNoteNumber()
    {
        int valExistingDeliveryNoteNumber=0;
        Cursor cursor2=null;
        try {
            cursor2 = db.rawQuery("SELECT LastDeliveryNoteNumber FROM tblStoreLastDeliveryNoteNumber", null);

            if(cursor2.getCount()>0)
            {
                if (cursor2.moveToFirst())
                {
                    valExistingDeliveryNoteNumber=Integer.parseInt(cursor2.getString(0));
                }
            }
            return valExistingDeliveryNoteNumber;
        } finally {
            if(cursor2!=null)
            {
                cursor2.close();
            }
        }
    }


    public static LinkedHashMap<String,ArrayList<String>> fnGetStoreDetailsDataForPrint(String StoreVisitCode,String StoreID)
    {
        LinkedHashMap<String,ArrayList<String>> hmapStoreBasicDetails=new LinkedHashMap<String,ArrayList<String>>();

        Cursor cursor2=null;
        ArrayList<String> arrStoreDetails=new ArrayList<String>();
        try {
            cursor2 = db.rawQuery("SELECT StoreName,ifnull(StoreAddress,'') AS StoreAddress,ifnull(StoreState,'') AS StoreState,ifnull(StoreCity,'') AS StoreCity,ifnull(StorePinCode,'') AS StorePinCode,ifnull(StoreContactNo,'') AS StoreContactNo,ifnull(GSTNumber,'Not Registered') AS GSTNumber FROM tblStoreList Where StoreID='"+StoreID+"'", null);
            if(cursor2.getCount()>0)
            {
                if (cursor2.moveToFirst())
                {

                    arrStoreDetails.add(cursor2.getString(0));
                    arrStoreDetails.add(cursor2.getString(1));
                    arrStoreDetails.add(cursor2.getString(2));
                    arrStoreDetails.add(cursor2.getString(3));
                    arrStoreDetails.add(cursor2.getString(4));
                    arrStoreDetails.add(cursor2.getString(5));
                    if(cursor2.getString(6).toString().equals("NA") || cursor2.getString(6).toString().equals("0"))
                    {
                        arrStoreDetails.add("Not Registered");
                    }
                    else {
                        arrStoreDetails.add(cursor2.getString(6));
                    }
                }
            }
            hmapStoreBasicDetails.put("StoreDetails",arrStoreDetails);
            return hmapStoreBasicDetails;
        } finally {
            if(cursor2!=null)
            {
                cursor2.close();
            }
        }
    }
    public static LinkedHashMap<String,ArrayList<String>> fnGetInvoiceListForPrint(String StoreVisitCode,String StoreID)
    {
        LinkedHashMap<String,ArrayList<String>> hmapInvoiceRecodsToPrint=new LinkedHashMap<String,ArrayList<String>>();

        Cursor cursor21=null;
        try {
            cursor21 = db.rawQuery("SELECT tblInvoiceDetails.ProdID,ifnull(tblProductListMaster.HSNCode,'') AS HSNCode,ifnull(tblInvoiceDetails.ProductShortName,'NA') AS ProductShortName,ifnull(tblInvoiceDetails.ProductPrice,'0') AS ProductPrice,ifnull(tblProductSegementMap.VatTax,'0') AS VatTax,ifnull(tblInvoiceDetails.OrderQty,'0') AS OrderQty,ifnull(tblInvoiceDetails.LineValAftrTxAftrDscnt,'0') AS OrdValue FROM tblInvoiceDetails inner join tblProductSegementMap on tblInvoiceDetails.ProdID=tblProductSegementMap.ProductID inner join tblProductListMaster on tblProductListMaster.ProductID=tblInvoiceDetails.ProdID inner join tblInvoiceHeader on tblInvoiceHeader.InvoiceNumber=tblInvoiceDetails.InvoiceNumber Where tblInvoiceHeader.StoreID='"+StoreID+"' AND tblInvoiceHeader.StoreVisitCode='"+StoreVisitCode+"' AND tblInvoiceDetails.OrderQty>0", null);
            if(cursor21.getCount()>0)
            {
                if (cursor21.moveToFirst())
                {
                    for(int i=0;i<cursor21.getCount();i++)
                    {
                        ArrayList<String> arrProductInvoiceDetailsForPrint=new ArrayList<String>();
                        arrProductInvoiceDetailsForPrint.add(cursor21.getString(1));
                        arrProductInvoiceDetailsForPrint.add(cursor21.getString(2));
                        arrProductInvoiceDetailsForPrint.add(cursor21.getString(3));
                        arrProductInvoiceDetailsForPrint.add(cursor21.getString(4)+"%");
                        arrProductInvoiceDetailsForPrint.add(cursor21.getString(5));
                        arrProductInvoiceDetailsForPrint.add(cursor21.getString(6));
                        hmapInvoiceRecodsToPrint.put(cursor21.getString(0).toString().trim(),arrProductInvoiceDetailsForPrint);
                        cursor21.moveToNext();
                    }
                }
            }

            return hmapInvoiceRecodsToPrint;
        } finally {
            if(cursor21!=null)
            {
                cursor21.close();
            }
        }
    }

    private static int round(double d){
        double dAbs = Math.abs(d);
        int i = (int) dAbs;
        double result = dAbs - (double) i;
        if(result<0.5){
            return d<0 ? -i : i;
        }else{
            return d<0 ? -(i+1) : i+1;
        }
    }

    public static LinkedHashMap<String,ArrayList<String>> fnGetTotalBfrAftrTaxVal(String StoreID,String storeVisitCode)
    {
        LinkedHashMap<String,ArrayList<String>> hmapTotalBfrAftrTaxVal=new LinkedHashMap<String,ArrayList<String>>();
        // ArrayList<String> arrTaxWisePrdctDtlt=new ArrayList<String>();
        Cursor cursor21=null;
        try {
            cursor21 = db.rawQuery("Select tblInvoiceHeader.TotalBeforeTaxDis,tblInvoiceHeader.InvoiceVal from tblInvoiceHeader where tblInvoiceHeader.StoreID='"+StoreID+"' AND tblInvoiceHeader.StoreVisitCode='"+storeVisitCode+"'"
                    , null);
            if(cursor21.getCount()>0)
            {
                if (cursor21.moveToFirst())
                {

                    // arrTaxWisePrdctDtlt.add(cursor21.getString(0));
                    ArrayList<String> arrTaxWisePrdctDtlt=new ArrayList<String>();
                    arrTaxWisePrdctDtlt.add(cursor21.getString(0));
                    arrTaxWisePrdctDtlt.add(cursor21.getString(1));

                    Double cntInVal=Double.parseDouble(cursor21.getString(1));
                    cntInVal=Double.parseDouble(new DecimalFormat("##.##").format(cntInVal));

                    int roundAmt= round(cntInVal);
                    Double cntroundAmt=Double.parseDouble(""+roundAmt);

                    Double roundOfVal=0.00;
                    if(cntInVal>cntroundAmt)
                    {
                        roundOfVal=cntInVal-cntroundAmt;
                    }
                    if(cntInVal<cntroundAmt)
                    {
                        roundOfVal=cntroundAmt-cntInVal;
                    }
                    roundOfVal=Double.parseDouble(new DecimalFormat("##.##").format(roundOfVal));
                    arrTaxWisePrdctDtlt.add(""+roundOfVal);

                    arrTaxWisePrdctDtlt.add(""+cntroundAmt);
                    hmapTotalBfrAftrTaxVal.put("TotalInvoiceBeforeAfterTax",arrTaxWisePrdctDtlt);

                }
            }

            return hmapTotalBfrAftrTaxVal;
        } finally {
            if(cursor21!=null)
            {
                cursor21.close();
            }
        }
    }
    public static LinkedHashMap<String,ArrayList<String>> fnGetTaxWisePrdctDtl(String StoreID,String StoreVisitCode)
    {
        LinkedHashMap<String,ArrayList<String>> hmapTaxWisePrdctDtlt=new LinkedHashMap<String,ArrayList<String>>();
        // ArrayList<String> arrTaxWisePrdctDtlt=new ArrayList<String>();
        Cursor cursor21=null;
        try {
            cursor21 = db.rawQuery("Select DISTINCT tblProductSegementMap.VatTax,CASE WHEN ifnull(Sum(tblInvoiceDetails.LineValAftrTxAftrDscnt-tblInvoiceDetails.LineValBfrTxAftrDscnt),'0.0')=0 THEN '0.0' ELSE ifnull(Sum(tblInvoiceDetails.LineValAftrTxAftrDscnt-tblInvoiceDetails.LineValBfrTxAftrDscnt),'0.0') END AS TaxAmtPercent from tblProductSegementMap inner join tblInvoiceDetails On tblProductSegementMap.ProductID=tblInvoiceDetails.ProdID inner join tblInvoiceHeader on tblInvoiceHeader.InvoiceNumber=tblInvoiceDetails.InvoiceNumber where tblInvoiceDetails.StoreID='"+StoreID+"' AND tblInvoiceHeader.StoreVisitCode='"+StoreVisitCode+"' AND tblInvoiceDetails.OrderQty>0 group by tblProductSegementMap.VatTax Order by tblProductSegementMap.VatTax ASC", null);
            if(cursor21.getCount()>0)
            {
                if (cursor21.moveToFirst())
                {
                    for(int i=0;i<cursor21.getCount();i++)
                    {
                        // arrTaxWisePrdctDtlt.add(cursor21.getString(0));
                        ArrayList arrTaxWisePrdctDtlt=new ArrayList<String>();
                        Double TaxSum=Double.parseDouble(cursor21.getString(1).toString());

                        if(TaxSum>0.0)
                        {
                            TaxSum=TaxSum/2.0;
                        }

                        TaxSum=Double.parseDouble(new DecimalFormat("##.##").format(TaxSum));
                        arrTaxWisePrdctDtlt.add(""+TaxSum);

                        Double TaxRateToShow=Double.parseDouble(cursor21.getString(0).toString());

                        if(TaxRateToShow>0.0)
                        {
                            TaxRateToShow=TaxRateToShow/2.0;
                        }
                        TaxRateToShow=Double.parseDouble(new DecimalFormat("##.##").format(TaxRateToShow));

                        hmapTaxWisePrdctDtlt.put("CGST "+TaxRateToShow+"%",arrTaxWisePrdctDtlt);
                        hmapTaxWisePrdctDtlt.put("SGST "+TaxRateToShow+"%",arrTaxWisePrdctDtlt);
                        cursor21.moveToNext();
                    }
                }
            }

            return hmapTaxWisePrdctDtlt;
        } finally {
            if(cursor21!=null)
            {
                cursor21.close();
            }
        }
    }



    public static Double fnCollectionDetailsToPrint(String StoreID,String StoreVisitCode)
    {
        Double valCollectionDetailsToPrint=0.0;
        // ArrayList<String> arrTaxWisePrdctDtlt=new ArrayList<String>();
        Cursor cursor21=null;
        try {

            cursor21 = db.rawQuery("Select DISTINCT ifnull(Sum(tblAllCollectionData.Amount),'0.0') As Amount from tblAllCollectionData where tblAllCollectionData.StoreID='"+StoreID+"' AND tblAllCollectionData.StoreVisitCode='"+StoreVisitCode+"'", null);
            if(cursor21.getCount()>0)
            {
                if (cursor21.moveToFirst())
                {
                        valCollectionDetailsToPrint=Double.parseDouble(cursor21.getString(0).toString().trim());
                        cursor21.moveToNext();
                }
            }

            return valCollectionDetailsToPrint;
        } finally {
            if(cursor21!=null)
            {
                cursor21.close();
            }
        }
    }
    public static ArrayList<String> fnFetch_tblWarehouseMstr()
    {
        ArrayList<String> arrResult=new ArrayList<String>();


      //  Cursor cursor = db.rawQuery("SELECT NodeID ,NodeType from tblWarehouseMstr", null); //order by AutoIdOutlet Desc
        try
        {
            Cursor cursor = db.rawQuery("SELECT NodeID,NodeType from tblWarehouseMstr", null); //order by AutoIdOutlet Desc
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i < cursor.getCount(); i++) {
                        arrResult.add(0,cursor.getString(0));
                        arrResult.add(1,cursor.getString(1));
                       // cursor.moveToNext();
                    }

                }
            }


        }
        catch (Exception e){
            System.out.println(e);
        }
        finally
        {
            if(cursor!=null) {
                cursor.close();
            }
            return arrResult;

        }
    }
    public static String fnFetch_StoreGST_Number(String StoreID)
    {

        String gstNo="0";


        //  Cursor cursor = db.rawQuery("SELECT NodeID ,NodeType from tblWarehouseMstr", null); //order by AutoIdOutlet Desc
        try
        {
            Cursor cursor = db.rawQuery("SELECT StoreID from tblStoreList", null); //order by AutoIdOutlet Desc
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i < cursor.getCount(); i++) {
                        gstNo=cursor.getString(0);
                        // cursor.moveToNext();
                    }

                }
            }


        }
        catch (Exception e){
            System.out.println(e);
        }
        finally
        {
            if(cursor!=null) {
                cursor.close();
            }
            return gstNo;

        }
    }


   public static LinkedHashMap<String,ArrayList<String>> fnGetOverAllProductOrderQtyValue(String StoreID,String StoreVisitCode)
   {
       LinkedHashMap<String,ArrayList<String>> hmapOverAllProductOrderQtyValue=new LinkedHashMap<String,ArrayList<String>>();
       // ArrayList<String> arrTaxWisePrdctDtlt=new ArrayList<String>();
       Cursor cursor21=null;
       try {
           cursor21 = db.rawQuery("Select ifnull(Sum(tblInvoiceDetails.OrderQty),'0') AS OrderQtyCount,ifnull(Sum(tblInvoiceDetails.LineValAftrTxAftrDscnt),'0.00') AS LineValAftrTxAftrDscntValue from tblInvoiceDetails inner join tblInvoiceHeader on tblInvoiceDetails.InvoiceNumber=tblInvoiceHeader.InvoiceNumber where tblInvoiceDetails.StoreID='"+StoreID+"' AND tblInvoiceHeader.StoreVisitCode='"+StoreVisitCode+"' AND tblInvoiceDetails.OrderQty>0", null);
           if(cursor21.getCount()>0)
           {
               if (cursor21.moveToFirst())
               {
                   ArrayList arrOverAllProductOrderQtyValue=new ArrayList<String>();
                   /* Double AllProductOrderQty=Double.parseDouble(cursor21.getString(0).toString());
                    AllProductOrderQty=Double.parseDouble(new DecimalFormat("##.##").format(AllProductOrderQty));*/
                   arrOverAllProductOrderQtyValue.add(cursor21.getString(0).toString());

                   Double AllProductOrderValue=Double.parseDouble(cursor21.getString(1).toString());
                   // AllProductOrderValue=Double.parseDouble(new DecimalFormat("##.##").format(AllProductOrderValue));
                   arrOverAllProductOrderQtyValue.add(""+String.format("%.2f", AllProductOrderValue));

                   hmapOverAllProductOrderQtyValue.put("OverAllProductOrderQtyValue",arrOverAllProductOrderQtyValue);                }
           }
           return hmapOverAllProductOrderQtyValue;
       } finally {
           if(cursor21!=null)
           {
               cursor21.close();
           }
       }
   }



    public static String fnGetExistingInvoiceNumberAgainstInvoiceNumebr (String StoreID,String StoreVisitCode)
    {
        //open();
        LinkedHashMap<String,String>hmapInvoiceCaptionPrefixAndSuffix=fetch_InvoiceCaptionPrefixAndSuffix();
        Cursor cursorE2 = db.rawQuery("SELECT InvoiceNumber FROM tblInvoiceHeader WHERE StoreID='" + StoreID + "' AND StoreVisitCode='"+StoreVisitCode+"'", null);
        String InvoiceNumber = "0";
        try {
            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst()) {
                    InvoiceNumber = hmapInvoiceCaptionPrefixAndSuffix.get("INVPrefix")+"-"+cursorE2.getString(0).toString()+"/"+hmapInvoiceCaptionPrefixAndSuffix.get("INVSuffix");
                }
            }
        } finally {
            if(cursorE2!=null) {
                cursorE2.close();
            }
            // close();
        }
        return InvoiceNumber;
    }




    public static LinkedHashMap<String, String> fetch_Store_Req()
    {

        //open();
        LinkedHashMap<String, String> hmapCatgry = new LinkedHashMap<String, String>();
//tblDistributorProductStock(PrdctId text null,StockQntty text null,DistributorNodeIdNodeType text null,SKUName text null,OpeningStock text null,TodaysAddedStock text null,CycleAddedStock text null,NetSalesQty text null,TodaysUnloadStk text null,CycleUnloadStk text null,CategoryID text null);";
        Cursor cursor= db.rawQuery("Select DISTINCT S.PrdctId,S.StockQntty-ifnull(D.OrderQty,0) AS StockAvailable from tblDistributorProductStock S left outer join (SELECT ID.ProdID,SUM(ID.OrderQty) OrderQty FROM tblInvoiceHeader AS I INNER JOIN tblInvoiceDetails AS ID ON ID.InvoiceNumber=I.InvoiceNumber  WHERE I.flgProcessedInvoice=0 GROUP BY ID.ProdID) D ON D.ProdID=S.PrdctId", null);

//Cursor cur=db.rawQuery("Select PrdctId,OriginalStock from tblDistributorProductStock where DistributorNodeIdNodeType='"+distId+"'",null);
        //  Cursor	cursor = db.rawQuery("SELECT Distinct ProductShortName,IFNULL(StockQntty,0),IFNULL(OriginalStock,0) from tblDistributorProductStock inner join tblProductListMaster on tblDistributorProductStock.PrdctId=tblProductListMaster.ProductID", null); //order by AutoIdOutlet Desc
//Cursor	cursor = db.rawQuery("SELECT tblStoreList.StoreID, tblStoreList.StoreName, IFNULL(tblTmpInvoiceHeader.InvoiceVal,0) FROM tblStoreList left outer join tblTmpInvoiceHeader on tblStoreList.StoreID=tblTmpInvoiceHeader.StoreID", null); //order by AutoIdOutlet Desc
        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        //hmapCatgry.put(cursor.getString(0).toString(),cursor.getString(1).toString() + "( Order Value:-"+cursor.getString(2).toString()+")");
                        // hmapCatgry.put((i+1)+")  "+cursor.getString(0).toString(), "[Stock Left: "+cursor.getString(2).toString()+"]");//[Stock Loaded:->"+cursor.getString(1).toString()+ "]
                        hmapCatgry.put(cursor.getString(0), cursor.getString(1));//[Stock Loaded:->"+cursor.getString(1).toString()+ "]

                        cursor.moveToNext();
                    }
                }

            }

            else
            {
                hmapCatgry.put("No Stock", "0");
            }
            return hmapCatgry;
        }
        finally
        {
            if(cursor!=null) {
                cursor.close();
            }
            //close();
        }
    }

    public static LinkedHashMap<String, String> fetch_Store_Req_Prdct()
    {

        //open();
        LinkedHashMap<String, String> hmapCatgry = new LinkedHashMap<String, String>();
//tblDistributorProductStock(PrdctId text null,StockQntty text null,DistributorNodeIdNodeType text null,SKUName text null,OpeningStock text null,TodaysAddedStock text null,CycleAddedStock text null,NetSalesQty text null,TodaysUnloadStk text null,CycleUnloadStk text null,CategoryID text null);";
        Cursor cursor= db.rawQuery("Select ProductID,ProductShortName from tblProductListMaster", null);

//Cursor cur=db.rawQuery("Select PrdctId,OriginalStock from tblDistributorProductStock where DistributorNodeIdNodeType='"+distId+"'",null);
        //  Cursor	cursor = db.rawQuery("SELECT Distinct ProductShortName,IFNULL(StockQntty,0),IFNULL(OriginalStock,0) from tblDistributorProductStock inner join tblProductListMaster on tblDistributorProductStock.PrdctId=tblProductListMaster.ProductID", null); //order by AutoIdOutlet Desc
//Cursor	cursor = db.rawQuery("SELECT tblStoreList.StoreID, tblStoreList.StoreName, IFNULL(tblTmpInvoiceHeader.InvoiceVal,0) FROM tblStoreList left outer join tblTmpInvoiceHeader on tblStoreList.StoreID=tblTmpInvoiceHeader.StoreID", null); //order by AutoIdOutlet Desc
        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        //hmapCatgry.put(cursor.getString(0).toString(),cursor.getString(1).toString() + "( Order Value:-"+cursor.getString(2).toString()+")");
                        // hmapCatgry.put((i+1)+")  "+cursor.getString(0).toString(), "[Stock Left: "+cursor.getString(2).toString()+"]");//[Stock Loaded:->"+cursor.getString(1).toString()+ "]
                        hmapCatgry.put(cursor.getString(0),cursor.getString(1));//[Stock Loaded:->"+cursor.getString(1).toString()+ "]

                        cursor.moveToNext();
                    }
                }

            }

            else
            {
                hmapCatgry.put("No Stock", "0");
            }
            return hmapCatgry;
        }
        finally
        {
            if(cursor!=null) {
                cursor.close();
            }
            //close();
        }
    }

    public static void insertUOMMstr(int UOMId,String UOM,int flgBaseUnit)
    {

        ContentValues values=new ContentValues();
        values.put("UOMId",UOMId);
        values.put("UOM",UOM);
        values.put("flgBaseUnit",flgBaseUnit);
        db.insert(TABLE_tblUOMMstr,null,values);
    }
    public static void insertUOMMapping(int nodeId,int nodeType,int BaseUnitID,int PackUnitId,Double BaseValue,int flgDefaultUOM)
    {

        ContentValues values=new ContentValues();
        values.put("NodeId",nodeId);
        values.put("NodeType",nodeType);
        values.put("BaseUnitID",BaseUnitID);
        values.put("PackUnitId",PackUnitId);
        values.put("BaseValue",BaseValue);
        values.put("flgDefaultUOM",flgDefaultUOM);

        db.insert(TABLE_tblUOMMapping,null,values);
    }



    public static ArrayList<LinkedHashMap<String,String>> getUOMMstrForRqstStock()
    {
       // open();
        ArrayList<LinkedHashMap<String,String>> listUOMMstr=new ArrayList<LinkedHashMap<String,String>>();
        LinkedHashMap<String,String> hmapUOMMstrNameId=new LinkedHashMap<String,String>();
        LinkedHashMap<String,String> hmapUOMMstrIdName=new LinkedHashMap<String,String>();
        Cursor cur=null;

        try {
            cur=db.rawQuery("Select UOM,UOMId from tblUOMMaster",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        hmapUOMMstrNameId.put(cur.getString(0).trim(),cur.getString(1));
                        hmapUOMMstrIdName.put(cur.getString(1).trim(),cur.getString(0));
                        cur.moveToNext();
                    }
                    listUOMMstr.add(hmapUOMMstrNameId);
                    listUOMMstr.add(hmapUOMMstrIdName);
                }
            }
        }catch(Exception e)
        {
            System.out.println("Error = "+e.toString());
        }
        finally
        {
            if(cur!=null)
            {
                cur.close();
            }
           // close();
        }
        return listUOMMstr;
    }


    public static LinkedHashMap<String,String> getBaseUOMId()
    {
       // open();
           LinkedHashMap<String,String> hmapbaseUomId=new LinkedHashMap<String,String>();
        Cursor cur=null;

        try {
//         cur=db.rawQuery("Select NodeId||'^'||PackUnitId As prdId_packId,BaseValue from tblUOMMapping where BaseUnitID="+baseUOMID+"  Order by NodeId",null);
            cur=db.rawQuery("Select DISTINCT NodeId,BaseUnitID  from tblUOMMapping ",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        hmapbaseUomId.put(cur.getString(0),cur.getString(1));
                        cur.moveToNext();
                    }


                }
            }
        }catch(Exception e)
        {
            System.out.println("Error = "+e.toString());
        }
        finally
        {
            if(cur!=null)
            {
                cur.close();
            }
          //  close();
        }
        return hmapbaseUomId;
    }

    public static LinkedHashMap<String,String> getBaseUOMCalcValue()
    {
        // open();
        LinkedHashMap<String,String> hmapUOMMstrPrdtWise=new LinkedHashMap<String,String>();
        Cursor cur=null;

        try {
            cur=db.rawQuery("Select NodeId||'^'||PackUnitId As prdId_packId,BaseValue from tblUOMMapping  Order by NodeId",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {


                    for(int i=0;i<cur.getCount();i++)
                    {

                        hmapUOMMstrPrdtWise.put(cur.getString(0),cur.getString(1));

                        cur.moveToNext();
                    }
                }
            }
        }catch(Exception e)
        {
            System.out.println("Error = "+e.toString());
        }
        finally
        {
            if(cur!=null)
            {
                cur.close();
            }

        }
        return hmapUOMMstrPrdtWise;
    }



    public static LinkedHashMap<String,ArrayList<String>> getPrdctMpngWithUOM()
    {
        // open();
        LinkedHashMap<String,ArrayList<String>> hmapUOMMstrPrdtWise=new LinkedHashMap<String,ArrayList<String>>();
        Cursor cur=null;

        try {
            cur=db.rawQuery("Select NodeId,BaseUnitID,PackUnitId from tblUOMMapping Order by NodeId",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    ArrayList<String> listUOM=new ArrayList<String>();
                    String prdctId="0",prvsPrdctId="0";
                    for(int i=0;i<cur.getCount();i++)
                    {
                        prdctId=cur.getString(0);
                        if(i==0)
                        {
                            prvsPrdctId=prdctId;
                            //listUOM.add(cur.getString(1));
                            listUOM.add(cur.getString(2));
                        }
                        else
                        {
                            if(prvsPrdctId.equals(prdctId))
                            {
                                listUOM.add(cur.getString(2));
                            }
                            else
                            {
                                hmapUOMMstrPrdtWise.put(prvsPrdctId,listUOM);
                                listUOM=new ArrayList<String>();
                                prvsPrdctId=prdctId;
                               // listUOM.add(cur.getString(1));
                                listUOM.add(cur.getString(2));
                            }
                        }
                        if(i==(cur.getCount()-1))
                        {
                            hmapUOMMstrPrdtWise.put(prvsPrdctId,listUOM);
                        }

                       // hmapUOMMstr.put(cur.getString(0).trim(),cur.getInt(1));
                        cur.moveToNext();
                    }
                }
            }
        }catch(Exception e)
        {
            System.out.println("Error = "+e.toString());
        }
        finally
        {
            if(cur!=null)
            {
                cur.close();
            }

        }
        return hmapUOMMstrPrdtWise;
    }

    public static void insertStockReq(int prdctId,int reqStock,int dfltUOMId,int slctdUOMId)
    {


        ContentValues values=new ContentValues();
        values.put("ProductID",prdctId);
        values.put("ReqStock",reqStock);
        values.put("dfltUOMId",dfltUOMId);
        values.put("SlctdUOMID",slctdUOMId);
        db.insert(TABLE_tbl_StockRqst,null,values);
    }

    public static void deletePrvsStkRqst()
    {
        db.execSQL("Delete from tblStockRqst");
    }
    public static LinkedHashMap<String,String> getStockReq()
    {
        // open();
        LinkedHashMap<String,String> hmapStockReqData=new LinkedHashMap<String,String>();
        Cursor cur=null;

        try {
            cur=db.rawQuery("Select ProductID,ReqStock,SlctdUOMID from tblStockRqst",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        hmapStockReqData.put(cur.getString(0).trim(),cur.getString(1));
                        cur.moveToNext();
                    }
                }
            }
        }catch(Exception e)
        {
            System.out.println("Error = "+e.toString());
        }
        finally
        {
            if(cur!=null)
            {
                cur.close();
            }
            // close();
        }
        return hmapStockReqData;
    }




    public static int fetchtblStockUploadedStatusForRqstStatus()
    {
        //open();
        int retVal=0;
        try
        {
            Cursor cur=db.rawQuery("Select StatusID from tblStockUploadedStatus",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {
                        retVal=Integer.parseInt(cur.getString(0));
                        cur.moveToNext();
                    }
                }
            }
        }
        catch(Exception e)
        {
            System.out.println("Error getOtherReason = "+e.toString());
        }
        finally
        {
            //close();
            return retVal;
        }
    }
    public static String fngetSalesPersonCvrgIdCvrgNdTyp()
    {
        String abcd="0^0";
        Cursor cursor=null;
        try
        {
            //open();
            cursor = db.rawQuery("SELECT CoverageNodeId,CoverageNodeType from tblUserAuthenticationMstr", null);
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        abcd=cursor.getString(0)+"^"+cursor.getString(1);
                        cursor.moveToNext();
                    }
                }
            }
        }catch(Exception e)
        { e.printStackTrace();}
        finally
        {
            if(cursor != null)
            {
                cursor.close();
            }
            //close();
            return abcd;
        }
    }


    public static LinkedHashMap<String,String> getPrdctDfltMpngWithUOM()
    {
        // open();
        LinkedHashMap<String,String> hmapDfltUOMMstrPrdtWise=new LinkedHashMap<String,String>();
        Cursor cur=null;

        try {
            cur=db.rawQuery("Select NodeId,PackUnitId from tblUOMMapping where flgDefaultUOM=1",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount();i++)
                    {

                        hmapDfltUOMMstrPrdtWise.put(cur.getString(0),cur.getString(1));

                        // hmapUOMMstr.put(cur.getString(0).trim(),cur.getInt(1));
                        cur.moveToNext();
                    }
                }
            }
        }catch(Exception e)
        {
            System.out.println("Error = "+e.toString());
        }
        finally
        {
            if(cur!=null)
            {
                cur.close();
            }

        }
        return hmapDfltUOMMstrPrdtWise;
    }


    public static ArrayList<LinkedHashMap<String,ArrayList<String>>> fnGetDayEndOverAllCollectionReport()
    {
        ArrayList<LinkedHashMap<String,ArrayList<String>>> arrList=new ArrayList<LinkedHashMap<String,ArrayList<String>>>();
        Double dblAllInvoiceAmount=fetch_AllInvoiceAmount();
        LinkedHashMap<String,ArrayList<String>> hmapAllInvoiceAmount=new LinkedHashMap<String,ArrayList<String>>();
        ArrayList<String> arrFirstSectionDetails=new ArrayList<String>();
        arrFirstSectionDetails.add(""+dblAllInvoiceAmount);
        //hmapAllInvoiceAmount.put("AllInvValue",arrFirstSectionDetails);
        Double BalAmount=0.0;


        Double ChequeCollectedAmountDetails=fnGetAllChequeCollectedAmountDetails();
        Double CashCollectedAmountDetails=fnGetAllCashCollectedAmountDetails();
        arrFirstSectionDetails.add(""+CashCollectedAmountDetails);
        arrFirstSectionDetails.add(""+ChequeCollectedAmountDetails);

        Double BalanceAmount=dblAllInvoiceAmount-(ChequeCollectedAmountDetails+CashCollectedAmountDetails);
        arrFirstSectionDetails.add(""+BalanceAmount);
        hmapAllInvoiceAmount.put("FirstSectionDetails",arrFirstSectionDetails);
      // Cursor cur=null;

        try {
       /*      cur=db.rawQuery("Select DISTINCT PaymentMode, ifnull(SUM(Amount)) AS CollectedAmtVal FROM tblAllCollectionData GROUP BY PaymentMode",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount()-1;i++)
                    {
                        ArrayList<String> arrAllPaymentModes=new ArrayList<String>();
                        arrAllPaymentModes.add(cur.getString(1));
                        hmapAllInvoiceAmount.put(cur.getString(0),arrAllPaymentModes);
                        cur.moveToNext();
                    }
                }
            }*/
            arrList.add(hmapAllInvoiceAmount);
            LinkedHashMap<String,ArrayList<String>> hmapAllChequeCollectedDetails=fnGetAllChequeCollectedDetails();
            arrList.add(hmapAllChequeCollectedDetails);



        }catch(Exception e)
        {
            System.out.println("Error = "+e.toString());
        }
        finally
        {
          /*  if(cur!=null)
            {
                cur.close();
            }*/

        }
        return arrList;
    }
    public static LinkedHashMap<String,ArrayList<String>> fnGetAllChequeCollectedDetails()
    {
        LinkedHashMap<String,ArrayList<String>> hmapAllChequeCollectedDetails=new LinkedHashMap<String,ArrayList<String>>();
        Cursor cursor = db.rawQuery("SELECT RefNoChequeNoTrnNo,Amount,Date,tblBankMaster.BankName from tblAllCollectionData inner join tblBankMaster ON tblAllCollectionData.Bank=tblBankMaster.BankId WHERE PaymentModeID=2", null); //order by AutoIdOutlet Desc
        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        ArrayList<String> arrChequeDetails=new ArrayList<String>();
                        arrChequeDetails.add(cursor.getString(1)+"^"+cursor.getString(2)+"^"+cursor.getString(3));
                        hmapAllChequeCollectedDetails.put(cursor.getString(0).toString(),arrChequeDetails);
                        cursor.moveToNext();
                    }
                }

            }
            return hmapAllChequeCollectedDetails;
        }
        finally
        {
            if(cursor!=null) {
                cursor.close();
            }
            // close();
        }
    }


    public static double fnGetAllChequeCollectedAmountDetails()
    {
        Double ChequeCollectedAmountDetails=0.0;
        Cursor cursor = db.rawQuery("SELECT ifnull(SUM(Amount),'0.00') CheckAmount from tblAllCollectionData WHERE PaymentModeID=2", null); //order by AutoIdOutlet Desc
        try
        {
            if(cursor.getCount()>0)
            {
                cursor.moveToFirst();
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        ChequeCollectedAmountDetails=Double.parseDouble(cursor.getString(0));
                    }
            }
            return ChequeCollectedAmountDetails;
        }
        finally
        {
            if(cursor!=null) {
                cursor.close();
            }
            // close();
        }
    }


    public static double fnGetAllCashCollectedAmountDetails()
    {
        Double CashCollectedAmountDetails=0.0;
        Cursor cursor = db.rawQuery("SELECT ifnull(SUM(Amount),'0.00') CashAmount from tblAllCollectionData WHERE PaymentModeID=1", null); //order by AutoIdOutlet Desc
        try
        {
            if(cursor.getCount()>0)
            {
                cursor.moveToFirst();
                    CashCollectedAmountDetails=Double.parseDouble(cursor.getString(0));

            }
            return CashCollectedAmountDetails;
        }
        finally
        {
            if(cursor!=null) {
                cursor.close();
            }
            // close();
        }
    }
    public static Double fetch_AllInvoiceAmount()
    {
//tv_GrossInvVal
        //open();
        Double dblAllInvoiceAmount = 0.0;
        // Cursor   cursor = db.rawQuery("SELECT tblTmpInvoiceHeader.InvoiceVal from tblTmpInvoiceHeader WHERE tblTmpInvoiceHeader.StoreID='"+StoreID+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'", null); //order by AutoIdOutlet Desc
        Cursor cursor = db.rawQuery("SELECT ifnull(SUM(tblInvoiceHeader.InvoiceVal),'0.0') from tblInvoiceHeader", null); //order by AutoIdOutlet Desc
        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {

                        //hmapCatgry.put(cursor.getString(0).toString(),cursor.getString(1).toString() + "( Order Value:-"+cursor.getString(2).toString()+")");
                        dblAllInvoiceAmount=Double.parseDouble(cursor.getString(0).toString());

                }

            }

            else
            {
                dblAllInvoiceAmount=0.0;
            }
            return dblAllInvoiceAmount;
        }
        finally
        {
            if(cursor!=null) {
                cursor.close();
            }
            // close();
        }
    }





    public static LinkedHashMap<String,String> fnGetAllStoreWiseCollectionReport()
    {
        LinkedHashMap<String,String> hmapAllStoreWiseCollectionReport=new LinkedHashMap<String,String>();
        LinkedHashMap<String,String> hmapAllStoreWiseCollectionReportModified=new LinkedHashMap<String,String>();
        hmapAllStoreWiseCollectionReportModified=fnGetAllDistinctStoreWithInvoiceOrCollectionModified();

        LinkedHashMap<String,String> hmapAllDistinctStoreWithInvoiceOrCheque=new LinkedHashMap<String,String>();
        hmapAllDistinctStoreWithInvoiceOrCheque=fnGetAllDistinctStoreWithInvoiceOrChequeModified();

        Cursor cursor = db.rawQuery("SELECT StoreName,ifnull(SUM(tblInvoiceHeader.InvoiceVal),'0.00') InvAmount,ifnull((select SUM(tblAllCollectionData.Amount) from tblAllCollectionData  where tblSt.StoreID=tblAllCollectionData.StoreID AND tblAllCollectionData.PaymentModeID='1'),'0.00') CashCollection,ifnull((select SUM(tblAllCollectionData.Amount) from tblAllCollectionData   where tblSt.StoreID=tblAllCollectionData.StoreID AND tblAllCollectionData.PaymentModeID='2'),'0.00')ChequeCollection,'0.00' AS BalAmount,tblSt.StoreID from tblStoreList tblSt inner join tblInvoiceHeader ON tblSt.StoreID=tblInvoiceHeader.StoreID Group By tblSt.StoreID,tblSt.StoreName", null);
        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {

                        String txtInvoiceAmount= cursor.getString(1);
                        String txtCollection= cursor.getString(2);
                        String txtChqAmt= cursor.getString(3);
                        if(hmapAllStoreWiseCollectionReportModified!=null && hmapAllStoreWiseCollectionReportModified.size()>0) {
                            if (hmapAllStoreWiseCollectionReportModified.containsKey(cursor.getString(5) + "^" + cursor.getString(0).toString())) {
                                txtCollection = hmapAllStoreWiseCollectionReportModified.get(cursor.getString(5) + "^" + cursor.getString(0).toString());
                            }
                        }
                        if(hmapAllDistinctStoreWithInvoiceOrCheque!=null && hmapAllDistinctStoreWithInvoiceOrCheque.size()>0) {
                            if (hmapAllDistinctStoreWithInvoiceOrCheque.containsKey(cursor.getString(5) + "^" + cursor.getString(0).toString())) {
                                txtChqAmt = hmapAllDistinctStoreWithInvoiceOrCheque.get(cursor.getString(5) + "^" + cursor.getString(0).toString());
                            }
                        }
                       //Double BalAmt=Double.parseDouble(txtInvoiceAmount)-(Double.parseDouble(txtCollection)+Double.parseDouble(txtChqAmt));
                        Double BalAmt=(Double.parseDouble(txtCollection)+Double.parseDouble(txtChqAmt));


                        hmapAllStoreWiseCollectionReport.put(cursor.getString(5)+"^"+cursor.getString(0).toString(),txtInvoiceAmount+"^"+txtCollection+"^"+txtChqAmt+"^"+BalAmt);

                        cursor.moveToNext();
                    }
                }

            }
           // hmapAllStoreWiseCollectionReport.putAll(hmapAllStoreWiseCollectionReportModified);
           /* if(hmapAllStoreWiseCollectionReportModified.containsKey(cursor.getString(5)+"^"+cursor.getString(0).toString()))
            {
                hmapAllStoreWiseCollectionReport.put(cursor.getString(5)+"^"+cursor.getString(0).toString(),hmapAllStoreWiseCollectionReportModified.get(cursor.getString(5)+"^"+cursor.getString(0).toString()));
            }*/
            return hmapAllStoreWiseCollectionReport;
        }
        finally
        {
            if(cursor!=null) {
                cursor.close();
            }
            // close();
        }
    }
    public static void fnWriteTextFile(int VanIntialInvoiceIdNum)
    {

        try {

            JSONArray jArray=new JSONArray();
            JSONObject jsonObjMain=new JSONObject();
            JSONObject jOnew = new JSONObject();
            jOnew.put( "VanIntialInvoiceIdNum",VanIntialInvoiceIdNum);
            jArray.put(jOnew);
            jsonObjMain.put(CommonInfo.TextFileArrayName, jArray);
            File jsonTxtFolder = new File(Environment.getExternalStorageDirectory(), CommonInfo.TextFileFolder);
            if (!jsonTxtFolder.exists())
            {
                jsonTxtFolder.mkdirs();

            }
            String txtFileNamenew= CommonInfo.TextFileName;
            File file = new File(jsonTxtFolder,txtFileNamenew);
            // If file does not exists, then create it
            if (!file.exists()) {
                try {
                    file.createNewFile();
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
            }


            FileWriter fw;
            try {
                fw = new FileWriter(file.getAbsoluteFile());

                BufferedWriter bw = new BufferedWriter(fw);

                bw.write(jsonObjMain.toString());

                bw.close();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

        } catch (JSONException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        finally{

        }
    }

    public static HashMap<String, String> fnGetProductPurchaseList(String StoreID,String TmpInvoiceCodePDA)
    {
        //open();
        HashMap<String, String> hmapPrdctOdrQty=new HashMap<String, String>();
        Cursor cursor = db.rawQuery("SELECT ProdID,OrderQty From tblTmpInvoiceDetails where StoreID='"+StoreID+"'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'" , null);
        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapPrdctOdrQty.put( cursor.getString(0),cursor.getString(1)) ;
                        cursor.moveToNext();
                    }
                }
            }
            return hmapPrdctOdrQty;

        } finally {
            cursor.close();
            // close();
        }
    }




    public static String[] FetchAllStoreListForCollectionReport()
    {
        int ScodecolumnIndex = 0;
        int SnamecolumnIndex = 1;

        //Cursor cursor = db.rawQuery("SELECT StoreID, StoreName FROM tblStoreList   ORDER BY DistanceNear", null); //where StoreRouteID='"+ rID +"'
        Cursor cursor = db.rawQuery("SELECT StoreID, StoreName FROM tblStoreList", null); //where StoreRouteID='"+ rID +"'

        try
        {
            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst())
            {
                for (int i = 0; i <= (cursor.getCount() - 1); i++)
                {
                    StoreName[i] = (String) cursor.getString(ScodecolumnIndex).toString()+ "_"+ (String) cursor.getString(SnamecolumnIndex).toString();
                    cursor.moveToNext();
                }

            }
            return StoreName;
        }
        finally
        {
            cursor.close();
        }
    }


    public static void fnDeleteInsertCollectionReportCashChange(String StoreID,String PreviousCashCollectionAmt,String ModifiedCashCollectionAmt,String Sstat)
    {
        db.execSQL("DELETE FROM tblCollectionReportCashChange Where StoreID='"+StoreID+"'");
        ContentValues values=new ContentValues();
        values.put("StoreID", StoreID);
        values.put("PreviousCashCollectionAmt", PreviousCashCollectionAmt);
        values.put("ModifiedCashCollectionAmt", ModifiedCashCollectionAmt);
        values.put("Sstat", Sstat);
        db.insert(TABLE_tblCollectionReportCashChange, null, values);
    }

    public static void fnDeletetblCollectionReportChequeChange(String StoreID)
    {
        db.execSQL("DELETE FROM tblCollectionReportChequeChange Where StoreID='"+StoreID+"'");
    }




    public static long fnsavetblCollectionReportChequeChange(String StoreID, String PaymentMode_Old,String PaymentModeID_Old, String Amount_Old,
                                                             String RefNoChequeNoTrnNo_Old, String Date_Old, String Bank_Old,String PaymentMode_New,String PaymentModeID_New, String Amount_New,
                                                             String RefNoChequeNoTrnNo_New, String Date_New, String Bank_New,int flgDeleteModifyNew)
    {
        //db.execSQL("DELETE FROM tblCollectionReportChequeChange Where StoreID='"+StoreID+"'");
        ContentValues initialValues = new ContentValues();
        initialValues.put("StoreID", StoreID.toString().trim());
        initialValues.put("PaymentMode_Old", PaymentMode_Old.toString().trim());
        initialValues.put("PaymentModeID_Old", PaymentModeID_Old.toString().trim());
        initialValues.put("Amount_Old", Amount_Old.toString().trim());
        initialValues.put("RefNoChequeNoTrnNo_Old", RefNoChequeNoTrnNo_Old.toString().trim());
        initialValues.put("Date_Old", Date_Old.toString().trim());
        initialValues.put("Bank_Old", Bank_Old.toString().trim());
        initialValues.put("PaymentMode_New", PaymentMode_New.toString().trim());
        initialValues.put("PaymentModeID_New", PaymentModeID_New.toString().trim());
        initialValues.put("Amount_New", Amount_New.toString().trim());
        initialValues.put("RefNoChequeNoTrnNo_New", RefNoChequeNoTrnNo_New.toString().trim());
        initialValues.put("Date_New", Date_New.toString().trim());
        initialValues.put("Bank_New", Bank_New.toString().trim());
        initialValues.put("Sstat", "3");
        initialValues.put("flgDeleteModifyNew", flgDeleteModifyNew);
        return db.insert(DATABASE_TABLE_tblCollectionReportChequeChange, null, initialValues);
    }

    public static ArrayList<LinkedHashMap<String,LinkedHashMap<String,String>>>  fnRetrievetblCollectionReportChequeChange(String StoreID)
    {
        ArrayList<LinkedHashMap<String,LinkedHashMap<String,String>>> arrStoreChequeDetails=new ArrayList<LinkedHashMap<String,LinkedHashMap<String,String>>>();
        Cursor cursor=null;
        LinkedHashMap<String,LinkedHashMap<String,String>> hmapStoreAllChequeDetails=new LinkedHashMap<String,LinkedHashMap<String,String>>();
        try {
            cursor = db.rawQuery("SELECT ifnull(PaymentMode_Old,'NA')PaymentMode_Old,ifnull(PaymentModeID_Old,0) PaymentMode_Old,ifnull(Amount_Old,0.0)Amount_Old,ifnull(RefNoChequeNoTrnNo_Old,'NA') RefNoChequeNoTrnNo_Old,ifnull(Date_Old,'NA') Date_Old,ifnull(Bank_Old,0) Bank_Old,PaymentMode_New,PaymentModeID_New,Amount_New,RefNoChequeNoTrnNo_New,Date_New,Bank_New,flgDeleteModifyNew from tblCollectionReportChequeChange where StoreID='"+StoreID+"'", null);
            if(cursor.getCount()>0){
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        LinkedHashMap<String, String> hmapChequeRecords = new LinkedHashMap<String, String>();

                        String PaymentMode_Old=cursor.getString(0).toString();
                        int PaymentModeID_Old=Integer.parseInt(cursor.getString(1).toString());
                        Double Amount_Old=Double.parseDouble(cursor.getString(2).toString());
                        String RefNoChequeNoTrnNo_Old=cursor.getString(3).toString();
                        String Date_Old=cursor.getString(4).toString();
                        String Bank_Old=cursor.getString(5).toString();
                        String PaymentMode_New=cursor.getString(6).toString();
                        int PaymentModeID_New=Integer.parseInt(cursor.getString(7).toString());
                        Double Amount_New=Double.parseDouble(cursor.getString(8).toString());
                        String RefNoChequeNoTrnNo_New=cursor.getString(9).toString();
                        String Date_New=cursor.getString(10).toString();
                        String Bank_New=cursor.getString(11).toString();
                        int flgDeleteModifyNew=Integer.parseInt(cursor.getString(12).toString());

                        String oldChequeRecord=PaymentMode_Old+"^"+PaymentModeID_Old+"^"+Amount_Old+"^"+RefNoChequeNoTrnNo_Old+"^"+Date_Old+"^"+Bank_Old;
                        String newChequeRecord=PaymentMode_New+"^"+PaymentModeID_New+"^"+Amount_New+"^"+RefNoChequeNoTrnNo_New+"^"+Date_New+"^"+Bank_New;

                        hmapChequeRecords.put("Old",oldChequeRecord);
                        hmapChequeRecords.put("New",newChequeRecord);

                        hmapStoreAllChequeDetails.put(""+(i+1)+"^"+flgDeleteModifyNew,hmapChequeRecords);
                        cursor.moveToNext();

                    }

                }
                arrStoreChequeDetails.add(hmapStoreAllChequeDetails);
            }
            // return arrStoreChequeDetails;
        }catch(Exception e)
        {

        }

        finally
        {
            if(cursor!=null)
            {
                cursor.close();
            }
        }
        return arrStoreChequeDetails;
    }


    public static int fnCheckflgCollectionReportChequeChangeAgainstStore(String StoreID)
    {
        Cursor cursorE2 = db.rawQuery("SELECT * FROM tblCollectionReportChequeChange WHERE StoreID='"+StoreID+"'", null);
        int chkI = 0;
        try {
            if(cursorE2.getCount()>0) {
                if (cursorE2.moveToFirst()) {
                    if (!cursorE2.isNull(0)) {
                        chkI = 1;
                    } else {
                        chkI = 0;
                    }
                }
            }
        } finally {
            if(cursorE2!=null) {
                cursorE2.close();
            }
        }
        return chkI;
    }
    public static ArrayList<LinkedHashMap<String,LinkedHashMap<String,String>>>  fnRetrievetblCollectionChequeAgainstStore(String StoreID)
    {
        ArrayList<LinkedHashMap<String,LinkedHashMap<String,String>>> arrStoreChequeDetails=new ArrayList<LinkedHashMap<String,LinkedHashMap<String,String>>>();
        Cursor cursor=null;
        LinkedHashMap<String,LinkedHashMap<String,String>> hmapStoreAllChequeDetails=new LinkedHashMap<String,LinkedHashMap<String,String>>();
        try {
            cursor = db.rawQuery("SELECT PaymentMode,PaymentModeID,Amount,RefNoChequeNoTrnNo,Date,Bank from tblAllCollectionData where StoreID='"+StoreID+"' AND PaymentModeID=2", null);
            if(cursor.getCount()>0){
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        LinkedHashMap<String, String> hmapChequeRecords = new LinkedHashMap<String, String>();

                        String PaymentMode_Old=cursor.getString(0).toString();
                        int PaymentModeID_Old=Integer.parseInt(cursor.getString(1).toString());
                        Double Amount_Old=Double.parseDouble(cursor.getString(2).toString());
                        String RefNoChequeNoTrnNo_Old=cursor.getString(3).toString();
                        String Date_Old=cursor.getString(4).toString();
                        String Bank_Old=cursor.getString(5).toString();

                        int flgDeleteModifyNew=2;

                        String oldChequeRecord=PaymentMode_Old+"^"+PaymentModeID_Old+"^"+Amount_Old+"^"+RefNoChequeNoTrnNo_Old+"^"+Date_Old+"^"+Bank_Old;
                        String newChequeRecord=PaymentMode_Old+"^"+PaymentModeID_Old+"^"+Amount_Old+"^"+RefNoChequeNoTrnNo_Old+"^"+Date_Old+"^"+Bank_Old;

                        hmapChequeRecords.put("Old",oldChequeRecord);
                        hmapChequeRecords.put("New",newChequeRecord);

                        hmapStoreAllChequeDetails.put(""+(i+1)+"^"+flgDeleteModifyNew,hmapChequeRecords);
                        cursor.moveToNext();

                    }
                }
                arrStoreChequeDetails.add(hmapStoreAllChequeDetails);
            }
            // return arrStoreChequeDetails;
        }catch(Exception e)
        {

        }

        finally
        {
            if(cursor!=null)
            {
                cursor.close();
            }
        }
        return arrStoreChequeDetails;
    }



    public static double fnGetAllCashCollectedAmountDetailsAgainstStore(String StoreID)
    {
        Double CashCollectedAmountDetailsAgainstStore=0.0;
        Cursor cursor = db.rawQuery("SELECT ifnull(SUM(Amount),'0.00') CashAmount from tblAllCollectionData WHERE PaymentModeID=1 And StoreID='"+StoreID+"'", null); //order by AutoIdOutlet Desc
        try
        {
            if(cursor.getCount()>0)
            {
                cursor.moveToFirst();
                CashCollectedAmountDetailsAgainstStore=Double.parseDouble(cursor.getString(0));

            }
            return CashCollectedAmountDetailsAgainstStore;
        }
        finally
        {
            if(cursor!=null) {
                cursor.close();
            }
            // close();
        }
    }


    public static Double fnfetchModifiedCollectionReportCashChange(String StoreID)
    {
        Cursor cursorE2 = db.rawQuery("SELECT ModifiedCashCollectionAmt FROM tblCollectionReportCashChange WHERE StoreID='"+StoreID+"'", null);
        Double chkI = 0.0;
        try {
            if (cursorE2.getCount()>0) {
                if (cursorE2.moveToFirst()) {
                    if (!cursorE2.isNull(0)) {
                        chkI = Double.parseDouble((cursorE2.getString(0)));
                    } else {
                        chkI = 0.0;
                    }
                }
            }

        } finally {
            if(cursorE2!=null) {
                cursorE2.close();
            }
        }
        return chkI;
    }
    public static LinkedHashMap<String,String> fnGetAllDistinctStoreWithInvoiceOrCollectionModified()
    {
        LinkedHashMap<String,String> hmapAllDistinctStoreWithInvoiceOrCollection=new LinkedHashMap<String,String>();
        Cursor cursor = db.rawQuery("SELECT StoreName,ifnull(SUM(tblCollectionReportCashChange.ModifiedCashCollectionAmt),'0.00') CashCollection,tblStoreList.StoreID from tblStoreList inner join tblCollectionReportCashChange ON tblStoreList.StoreID=tblCollectionReportCashChange.StoreID Group By tblStoreList.StoreID,tblStoreList.StoreName", null);
        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                      //  Double BalAmt=Double.parseDouble(cursor.getString(1))-(Double.parseDouble(cursor.getString(2))+Double.parseDouble(cursor.getString(3)));
                        hmapAllDistinctStoreWithInvoiceOrCollection.put(cursor.getString(2)+"^"+cursor.getString(0).toString(),cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }
            return hmapAllDistinctStoreWithInvoiceOrCollection;
        }
        finally
        {
            if(cursor!=null) {
                cursor.close();
            }
        }
    }

    public static LinkedHashMap<String,String> fnGetAllDistinctStoreWithInvoiceOrChequeModified()
    {
        LinkedHashMap<String,String> hmapAllDistinctStoreWithInvoiceOrCheque=new LinkedHashMap<String,String>();
        Cursor cursor = db.rawQuery("SELECT StoreName,ifnull(SUM(tblCollectionReportChequeChange.Amount_New),'0.00') AS ChequeCollection,tblStoreList.StoreID from tblStoreList inner join tblCollectionReportChequeChange ON tblStoreList.StoreID=tblCollectionReportChequeChange.StoreID Group By tblStoreList.StoreID,tblStoreList.StoreName", null);
        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        hmapAllDistinctStoreWithInvoiceOrCheque.put(cursor.getString(2)+"^"+cursor.getString(0).toString(),cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }
            return hmapAllDistinctStoreWithInvoiceOrCheque;
        }
        finally
        {
            if(cursor!=null) {
                cursor.close();
            }
        }
    }






    public long  saveAppMasterFlags(int flgShowSalesTargetValue ,int flgShowDistributorStock ,int flgShowInvoice ,int flgShowPOSM ,int flgShowPaymentStageAtLastVisitPage ,int flgShowDeliveryAddressButtonOnOrder ,int flgShowManagerOnStoreList ,int flgShowTragetVsAchived ,int flgFilterProductOnCategoryOrSearchBasis ,int flgNeedStock ,int flgCalculateStock ,int flgControlStock ,int flgManageCollection ,int flgControlCollection ,int flgManageScheme ,int flgManageSalesQuotation ,int flgManageExecution )
    {
        ContentValues initialValues = new ContentValues();

        initialValues.put("flgShowSalesTargetValue", flgShowSalesTargetValue);
        initialValues.put("flgShowDistributorStock", flgShowDistributorStock);
        initialValues.put("flgShowInvoice", flgShowInvoice);
        initialValues.put("flgShowPOSM", flgShowPOSM);
        initialValues.put("flgShowPaymentStageAtLastVisitPage", flgShowPaymentStageAtLastVisitPage);
        initialValues.put("flgShowDeliveryAddressButtonOnOrder", flgShowDeliveryAddressButtonOnOrder);   //0=Not To be mapped Again,1=Can Map Distributor
        initialValues.put("flgShowManagerOnStoreList", flgShowManagerOnStoreList);
        initialValues.put("flgShowTragetVsAchived", flgShowTragetVsAchived);
        initialValues.put("flgFilterProductOnCategoryOrSearchBasis", flgFilterProductOnCategoryOrSearchBasis);
        initialValues.put("flgNeedStock", flgNeedStock);
        initialValues.put("flgCalculateStock", flgCalculateStock);
        initialValues.put("flgControlStock", flgControlStock);
        initialValues.put("flgManageCollection", flgManageCollection);
        initialValues.put("flgControlCollection", flgControlCollection);
        initialValues.put("flgManageScheme", flgManageScheme);
        initialValues.put("flgManageSalesQuotation", flgManageSalesQuotation);
        initialValues.put("flgManageExecution", flgManageExecution);
        return db.insert(TABLE_tblAppMasterFlags, null, initialValues);
    }
    public static LinkedHashMap<String ,Integer> fnGetAppMasterFlags()
    {
        LinkedHashMap<String,Integer> hmapAppMasterFlags=new LinkedHashMap<String,Integer>();
        Cursor cursor = db.rawQuery("SELECT flgShowSalesTargetValue ,flgShowDistributorStock ,flgShowInvoice ,flgShowPOSM ,flgShowPaymentStageAtLastVisitPage ,flgShowDeliveryAddressButtonOnOrder ,flgShowManagerOnStoreList ,flgShowTragetVsAchived ,flgFilterProductOnCategoryOrSearchBasis ,flgNeedStock ,flgCalculateStock ,flgControlStock ,flgManageCollection ,flgControlCollection ,flgManageScheme ,flgManageSalesQuotation ,flgManageExecution  from tblAppMasterFlags", null);
        try
        {
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    hmapAppMasterFlags.put("flgShowSalesTargetValue", cursor.getInt(0));
                    hmapAppMasterFlags.put("flgShowDistributorStock", cursor.getInt(1));
                    hmapAppMasterFlags.put("flgShowInvoice", cursor.getInt(2));
                    hmapAppMasterFlags.put("flgShowPOSM", cursor.getInt(3));
                    hmapAppMasterFlags.put("flgShowPaymentStageAtLastVisitPage", cursor.getInt(4));
                    hmapAppMasterFlags.put("flgShowDeliveryAddressButtonOnOrder", cursor.getInt(5));   //0=Not To be mapped Again,1=Can Map Distributor
                    hmapAppMasterFlags.put("flgShowManagerOnStoreList", cursor.getInt(6));
                    hmapAppMasterFlags.put("flgShowTragetVsAchived", cursor.getInt(7));
                    hmapAppMasterFlags.put("flgFilterProductOnCategoryOrSearchBasis", cursor.getInt(8));
                    hmapAppMasterFlags.put("flgNeedStock", cursor.getInt(9));
                    hmapAppMasterFlags.put("flgCalculateStock", cursor.getInt(10));
                    hmapAppMasterFlags.put("flgControlStock", cursor.getInt(11));
                    hmapAppMasterFlags.put("flgManageCollection", cursor.getInt(12));
                    hmapAppMasterFlags.put("flgControlCollection", cursor.getInt(13));
                    hmapAppMasterFlags.put("flgManageScheme", cursor.getInt(14));
                    hmapAppMasterFlags.put("flgManageSalesQuotation", cursor.getInt(15));
                    hmapAppMasterFlags.put("flgManageExecution", cursor.getInt(16));
                }
            }
            return hmapAppMasterFlags;
        }
        finally
        {
            if(cursor!=null) {
                cursor.close();
            }
        }
    }

    public LinkedHashMap<String,ArrayList<String>> fetchtblDAGetAddedOutletSummaryReport()
    {
        LinkedHashMap<String,ArrayList<String>> hmap=new LinkedHashMap<>();
        Cursor cursor=null;
        try {
            cursor = db.rawQuery("SELECT Distinct Header from tblDAGetAddedOutletSummaryReport where FlgNormalOverall='"+0+"'", null);
            if(cursor.getCount()>0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        String abc = cursor.getString(0);
                        hmap.put(abc, fetchOutletSummaryByHeader(abc));
                        cursor.moveToNext();
                    }
                }
            }
        } finally {
            if(cursor !=null)
                cursor.close();
            return hmap;
        }

    }
    public String fetchtblDAGetAddedOutletOverAllData()
    {
        String hmap="NA";
        Cursor cursor=null;
        try {
            cursor = db.rawQuery("SELECT TotalStores,Validated,Pending from tblDAGetAddedOutletSummaryReport where FlgNormalOverall='"+1+"'", null);
            if(cursor.getCount()>0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmap = cursor.getString(0)+"^"+cursor.getString(1)+"^"+cursor.getString(2);
                        cursor.moveToNext();
                    }
                }
            }
        } finally {
            if(cursor !=null)
                cursor.close();
            return hmap;
        }
    }
    public static ArrayList<String> fetchOutletSummaryByHeader(String Header)
    {
        ArrayList<String> arrData=new ArrayList<>();
        Cursor cursor=null;

        try {
            cursor = db.rawQuery("SELECT Child,TotalStores,Validated,Pending from tblDAGetAddedOutletSummaryReport where Header='"+Header+"'", null);
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        arrData.add(cursor.getString(0)+"^"+cursor.getString(1)+"^"+cursor.getString(2)+"^"+cursor.getString(3));
                        cursor.moveToNext();
                    }
                }
            }
        } finally {
            if(cursor !=null)
                cursor.close();
            return arrData;
        }
    }

    //outlet summary
    public static long savetblDAGetAddedOutletSummaryReport(String Header,String Child,String TotalStores,String Validated,String Pending,int FlgNormalOverall)
    {

       /*create table tblDAGetAddedOutletSummaryReport (Header text null,Child text null,TotalStores text null,
       Validated text null,Pending text null);";*/
        ContentValues initialValues = new ContentValues();

        initialValues.put("Header", Header.trim());
        initialValues.put("Child", Child.trim());
        initialValues.put("TotalStores", TotalStores.trim());
        initialValues.put("Validated", Validated.trim());
        initialValues.put("Pending", Pending.trim());
        initialValues.put("FlgNormalOverall", FlgNormalOverall);

        return db.insert(DATABASE_TABLE_tblDAGetAddedOutletSummaryReport, null, initialValues);
    }
    public static void createtblDAGetAddedOutletSummaryReport()
    {
        try
        {
            db.execSQL(DATABASE_CREATE_TABLE_tblDAGetAddedOutletSummaryReport);
        }
        catch (Exception e)
        {

        }
    }
    public static void droptblDAGetAddedOutletSummaryReport()
    {
        db.execSQL("DROP TABLE IF EXISTS tblDAGetAddedOutletSummaryReport");

    }

    public static int fnGetCountStoreVisitCode(String StoreID)
    {

        int StoreVisitCodecnt=0;
        Cursor cursor=db.rawQuery("Select Count(*) from tblStoreVisitMstr Where StoreID='"+StoreID+"'",null);

        if(cursor.getCount()>0)
        {
            if(cursor.moveToFirst())
            {
                StoreVisitCodecnt=Integer.parseInt(cursor.getString(0));
            }
        }
        if(cursor!=null) {
            cursor.close();
        }
        return StoreVisitCodecnt;
    }

    public String fnGetStoreVisitCodeInCaseOfIndrectSales(String StoreID)
    {

        String StoreVisitCode="NA";
        Cursor cursor=db.rawQuery("Select StoreVisitCode from tblStoreVisitMstr Where StoreID='"+StoreID+"'",null);

        if(cursor.getCount()>0)
        {
            if(cursor.moveToFirst())
            {
                StoreVisitCode=cursor.getString(0);
            }
        }
        if(cursor!=null) {
            cursor.close();
        }

        return StoreVisitCode;
    }



    public static void fnInsertOrUpdate_tblStoreOrderVisitDayActivity(String StoreVisitCode,String StoreID,String TempStoreVisitCode,String ForDate,int Sstat,String VisitTimeStartAtStore,String VisitTimeEndStore)
    {

        //open();
        try {
            Cursor cursor = db.rawQuery("SELECT TempStoreVisitCode FROM tblStoreOrderVisitDayActivity where StoreVisitCode='"+StoreVisitCode +"' AND StoreID='"+StoreID+"' AND Sstat=1" , null);
            ContentValues initialValues = new ContentValues();
            initialValues.put("IMEINumber", CommonInfo.imei.toString());
            initialValues.put("Sstat", Sstat);

            initialValues.put("VisitTimeEndStore", VisitTimeEndStore);
            if(cursor.getCount()>0)
            {
                int affected = db.update(DATABASE_TABLE_tblStoreOrderVisitDayActivity, initialValues, "StoreID=? AND StoreVisitCode=? AND TempStoreVisitCode=?",new String[] {StoreID,StoreVisitCode,TempStoreVisitCode});
            }
            else
            {
                initialValues.put("StoreVisitCode", StoreVisitCode);
                initialValues.put("StoreID", StoreID);
                initialValues.put("TempStoreVisitCode", TempStoreVisitCode);
                initialValues.put("ForDate", ForDate);
                initialValues.put("VisitTimeStartAtStore", VisitTimeStartAtStore);
                initialValues.put("VisitTimeEndStore", VisitTimeEndStore);

                db.insert(DATABASE_TABLE_tblStoreOrderVisitDayActivity, null, initialValues);
            }
        } finally {
            // close();
        }
    }
    public static void UpdatetblStoreOrderVisitDayActivitySstat(String StoreID, int Sstat,String StoreVisitCode,String TempStoreVisitCode)
    {


        final ContentValues values = new ContentValues();
        values.put("Sstat", Sstat);

        int affected22 = db.update("tblStoreOrderVisitDayActivity", values, "StoreID=? AND StoreVisitCode=? AND TempStoreVisitCode=?",new String[] { StoreID,StoreVisitCode,TempStoreVisitCode });

    }

    public static String fnGetStoreTempStoreVisitCodeFromtblStoreOrderVisitDayActivity(String StoreID)
    {
        //open();
        String TempStoreVisitCode="NA";
        Cursor cursor=db.rawQuery("Select TempStoreVisitCode from tblStoreOrderVisitDayActivity Where StoreID='"+StoreID+"' AND Sstat=1",null);

        if(cursor.getCount()>0)
        {
            if(cursor.moveToFirst())
            {
                TempStoreVisitCode=cursor.getString(0);
            }
        }
        if(cursor!=null) {
            cursor.close();
        }
        //close();
        return TempStoreVisitCode;
    }
    public static void UpdateStoreEndVisittblStoreOrderVisitDayActivity(String StoreID, String VisitTimeEndStore,String TempStoreVisitCode) {
        final ContentValues values = new ContentValues();
        values.put("VisitTimeEndStore", VisitTimeEndStore);
        int affected = db.update("tblStoreOrderVisitDayActivity", values,"StoreID=? and TempStoreVisitCode=?",new String[] { StoreID,TempStoreVisitCode });
    }

    public static void Delete_bloodGroupMstr()
    {

        db.execSQL("DELETE FROM tblBloodGroup");
    }
    public static void Delete_tblEducationQuali()
    {

        db.execSQL("DELETE FROM tblEducationQuali");
    }
    public static void Delete_tblQuestIDForOutChannel()
    {

        db.execSQL("DELETE FROM tblQuestIDForOutChannel");
    }
    public static void Delete_tblGetPDAQuestMstr()
    {

        db.execSQL("DELETE FROM tblGetPDAQuestMstr");
    }

    public static void savetblQuestionMstrRetroFit(List<TblGetPDAQuestMstr> tblGetPDAQuestMstr)
    {

      db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for(TblGetPDAQuestMstr PDAQuestMstr:tblGetPDAQuestMstr){
            int flgQuestIDForOutChannel=0;
            initialValues.put("QuestCode", PDAQuestMstr.getQuestCode());
            initialValues.put("QuestID", PDAQuestMstr.getQuestID());
            initialValues.put("QuestDesc", PDAQuestMstr.getQuestDesc());
            initialValues.put("QuestType", PDAQuestMstr.getQuestType());
            initialValues.put("AnsControlType", PDAQuestMstr.getAnsControlType());
            initialValues.put("AnsControlInputTypeID", PDAQuestMstr.getAsnControlInputTypeID());

            initialValues.put("AnsControlInputTypeMaxLength", PDAQuestMstr.getAnsControlInputTypeMaxLength());
            initialValues.put("AnsMustRequiredFlg", PDAQuestMstr.getAnsMustRequiredFlg());
            initialValues.put("QuestBundleFlg", PDAQuestMstr.getQuestBundleFlg());
            initialValues.put("ApplicationTypeID", PDAQuestMstr.getApplicationTypeID());
            initialValues.put("Sequence", PDAQuestMstr.getSequence());//AnsControlInputTypeMinLength
            initialValues.put("AnsControlInputTypeMinLength", PDAQuestMstr.getAnsControlIntputTypeMinLength());

            initialValues.put("AnswerHint", PDAQuestMstr.getAnswerHint());
            if(gblQuestIDForOutChannel==PDAQuestMstr.getQuestID()){
                flgQuestIDForOutChannel=1;
            }
            initialValues.put("flgQuestIDForOutChannel", flgQuestIDForOutChannel);

            //initialValues.put("QuestDescHindi", );
            db.insert(TABLE_QuestionMstr, null, initialValues);
        }

        db.setTransactionSuccessful();
        db.endTransaction();
    }
    public static void Delete_tblQuestIDForName()
    {

        db.execSQL("DELETE FROM tblQuestIDForName");
    }
    public static void Delete_tblPDAQuestGrpMappingMstr()
    {

        db.execSQL("DELETE FROM tblGetPDAQuestGrpMapping");
    }
    public static void savetblPDAQuestGrpMappingMstr(List<TblGetPDAQuestGrpMapping> tblGetPDAQuestGrpMappings) {
        ContentValues initialValues = new ContentValues();
        for (TblGetPDAQuestGrpMapping GetPDAQuestGrpMapping : tblGetPDAQuestGrpMappings) {
            initialValues.put("GrpQuestID", GetPDAQuestGrpMapping.getGrpQuestID());
            initialValues.put("QuestID", GetPDAQuestGrpMapping.getQuestID());
            initialValues.put("GrpID", GetPDAQuestGrpMapping.getGrpID());
            initialValues.put("GrpNodeID", GetPDAQuestGrpMapping.getGrpNodeID());
            initialValues.put("GrpDesc", GetPDAQuestGrpMapping.getGrpDesc());
            initialValues.put("SectionNo", GetPDAQuestGrpMapping.getSectionNo());
            initialValues.put("GrpCopyID", GetPDAQuestGrpMapping.getGrpCopyID());
            initialValues.put("QuestCopyID", GetPDAQuestGrpMapping.getQuestCopyID());
            initialValues.put("Sequence", GetPDAQuestGrpMapping.getSequence());
            long inserted = db.insert(TABLE_QuestGrpMappingMstr, null, initialValues);
        }
    }
    public static void Delete_tblOptionMstr()
    {

        db.execSQL("DELETE FROM tblGetPDAQuestOptionMstr");
    }
    public static void savetblOptionMstrRetrofit(List<TblGetPDAQuestOptionMstr> tblGetPDAQuestOptionMstr )
    {
        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for(TblGetPDAQuestOptionMstr GetPDAQuestOptionMstr:tblGetPDAQuestOptionMstr){
            initialValues.put("OptID", GetPDAQuestOptionMstr.getOptID());
            initialValues.put("QuestID", GetPDAQuestOptionMstr.getQuestID());

            initialValues.put("OptionDescr", GetPDAQuestOptionMstr.getOptionDescr());
            initialValues.put("Sequence", GetPDAQuestOptionMstr.getSequence());

            db.insert(TABLE_OptionMstr, null, initialValues);

        }
        db.setTransactionSuccessful();
        db.endTransaction();

    }
    public static void Delete_tblQuestionDependentMstr()
    {

        db.execSQL("DELETE FROM tblGetPDAQuestionDependentMstr");
    }
    //Add New Store Section wise Code starts Here
    public static long savetblQuestionDependentMstr(int QuestionID,String OptionID,int DependentQuestionID,int GrpID,int GrpDepQuestID)
    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("QuestionID", QuestionID);
        initialValues.put("OptionID", OptionID);
        initialValues.put("DependentQuestionID", DependentQuestionID);
        initialValues.put("GrpID", GrpID);
        initialValues.put("GrpDepQuestID", GrpDepQuestID);

        System.out.println("QuestionID2:" + QuestionID + "OptionID2:" + OptionID + "DependentQuestionID2:" + DependentQuestionID);
        return db.insert(TABLE_QuestionDependentMstr, null, initialValues);
    }
    public static void Delete_tblPDAQuestOptionDependentMstr()
    {

        db.execSQL("DELETE FROM tblPDAQuestOptionDependentMstr");
    }

    public static void savetblPDAQuestOptionDependentMstr(int QstID,int DepQstId,int GrpQuestID,int GrpDepQuestID)
    {

        ContentValues values=new ContentValues();
        values.put("QstID", QstID);
        values.put("DepQstId", DepQstId);
        values.put("GrpQuestID", GrpQuestID);
        values.put("GrpDepQuestID", GrpDepQuestID);
        db.insert(TABLE_QuestOptionDependentMstr, null, values);

    }
    public static void Delete_tblPDAQuestOptionValuesDependentMstr()
    {

        db.execSQL("DELETE FROM tblPDAQuestOptionValuesDependentMstr");
    }
    public static void Delete_tblNotificationMstr()
    {
        db.execSQL("DELETE FROM tblPDANotificationMaster");


    }
    public static long inserttblNotificationMstr(int SerialNo,String IMEI,String Noti_text,String Noti_DateTime,
                                                 int Noti_ReadStatus,int Noti_NewOld,
                                                 String Noti_ReadDateTime,int Sstat,int MsgServerID)
    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("SerialNo", SerialNo);
        initialValues.put("IMEI", IMEI.trim());
        initialValues.put("Noti_text", Noti_text.trim());
        initialValues.put("Noti_DateTime", Noti_DateTime.trim());
        initialValues.put("Noti_ReadStatus", Noti_ReadStatus);
        initialValues.put("Noti_NewOld", Noti_NewOld);
        initialValues.put("Noti_ReadDateTime", Noti_ReadDateTime.trim());
        initialValues.put("Sstat", Sstat);
        initialValues.put("MsgServerID", MsgServerID);


        return db.insert(TABLE_tblPDANotificationMaster_Define , null, initialValues);
    }
    public static void saveTblPreAddedStoresRetrofit(List<TblPreAddedStores> tblPreAddedStores, HashMap<String, String> hmapPreAddedStoreIdSstat)
    {
        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for(TblPreAddedStores preAddedStores:tblPreAddedStores){

            if (hmapPreAddedStoreIdSstat.containsKey(preAddedStores.getStoreID())) {
                initialValues.put("StoreID", preAddedStores.getStoreID().toString());
            }
            else
            {
                initialValues.put("StoreID", preAddedStores.getStoreIDDB().toString());
            }

           // initialValues.put("StoreID", preAddedStores.getStoreIDDB());
            initialValues.put("StoreName", preAddedStores.getStoreName());
            initialValues.put("LatCode", preAddedStores.getLatCode());
            initialValues.put("LongCode", preAddedStores.getLongCode());
            initialValues.put("DateAdded", preAddedStores.getDateAdded());
            initialValues.put("DistanceNear", 1000);
            initialValues.put("flgOldNewStore", 0);
            initialValues.put("flgReMap", preAddedStores.getFlgRemap());
            initialValues.put("Sstat", 0);
            initialValues.put("RouteID", preAddedStores.getRouteNodeID());
            initialValues.put("RouteNodeType", preAddedStores.getRouteNodeType());


            db.insert(DATABASE_TABLE_tblPreAddedStores, null, initialValues);
        }
        db.setTransactionSuccessful();
        db.endTransaction();


    }
    public static void saveTblPreAddedStoresDataDetailsRetrofit(List<TblPreAddedStoresDataDetails> tblPreAddedStoresDataDetails)
    {
       db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for(TblPreAddedStoresDataDetails preAddedStoresDataDetails:tblPreAddedStoresDataDetails){
            initialValues.put("StoreIDDB", preAddedStoresDataDetails.getStoreIDDB());
            initialValues.put("GrpQuestID", preAddedStoresDataDetails.getGrpQuestID());
            initialValues.put("QstId", preAddedStoresDataDetails.getQstId());
            initialValues.put("AnsControlTypeID", preAddedStoresDataDetails.getAnsControlTypeID());
            initialValues.put("AnsTextVal", preAddedStoresDataDetails.getAns());
            initialValues.put("flgPrvVal", 2);
            db.insert(DATABASE_TABLE_tblPreAddedStoresDataDetails, null, initialValues);
        }
        db.setTransactionSuccessful();
        db.endTransaction();

    }
    public static void saveSOAPdataProductListRetrofit(List<TblProductListMaster> tblProductListMaster)
    {
        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for(TblProductListMaster ProductListMaster:tblProductListMaster){
            initialValues.put("CategoryID", ProductListMaster.getCatID());
            initialValues.put("ProductID", ProductListMaster.getProductID());
            initialValues.put("ProductShortName", ProductListMaster.getProductShortName());
            initialValues.put("DisplayUnit", ProductListMaster.getDisplayUnit());
            initialValues.put("CalculateKilo", ProductListMaster.getCalculateKilo());
            initialValues.put("KGLiter", ProductListMaster.getKGLiter());
            initialValues.put("CatOrdr", 0);//as per abhinav sir not present in table
            initialValues.put("PrdOrdr", ProductListMaster.getPrdOrdr());
            initialValues.put("StoreCatNodeId", ProductListMaster.getCatID());
            initialValues.put("SearchField", ProductListMaster.getSearchField());
            initialValues.put("ManufacturerID", ProductListMaster.getManufacturerID());
            initialValues.put("RptUnitName", ProductListMaster.getRptUnitName());
            initialValues.put("PerbaseUnit", ProductListMaster.getPerbaseUnit());
            initialValues.put("HSNCode", ProductListMaster.getHSNCode());

            db.insert(DATABASE_TABLE_MAIN14, null, initialValues);
        }
        db.setTransactionSuccessful();
        db.endTransaction();

    }
    public static void saveProductSegementMapRetrofit(List<TblProductSegementMap> tblProductSegementMap)
    {
        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for(TblProductSegementMap ProductSegementMap: tblProductSegementMap){

            initialValues.put("ProductID", ProductSegementMap.getProductId());
            initialValues.put("ProductMRP", ProductSegementMap.getProductMRP());
            initialValues.put("ProductRLP", ProductSegementMap.getProductRLP());
            initialValues.put("ProductTaxAmount", ProductSegementMap.getProductTaxAmount());
            initialValues.put("RetMarginPer", ProductSegementMap.getRetMarginPer());
            initialValues.put("VatTax", ProductSegementMap.getTax());//need to be changed
            initialValues.put("StandardRate", ProductSegementMap.getStandardRate());
            initialValues.put("StandardRateBeforeTax", ProductSegementMap.getStandardRateBeforeTax());
            initialValues.put("StandardTax", ProductSegementMap.getStandardTax());
            initialValues.put("flgPriceAva", ProductSegementMap.getFlgPriceAva());

            //flgPriceAva
            initialValues.put("BusinessSegmentId", ProductSegementMap.getBusinessSegmentId());
            initialValues.put("flgWholeSellApplicable", ProductSegementMap.getFlgPrdBulkPriceapplicable());
            initialValues.put("PriceRangeWholeSellApplicable", ProductSegementMap.getCutoffvalue());
            initialValues.put("StandardRateWholeSale", ProductSegementMap.getStandardRateWholeSale());
            initialValues.put("StandardRateBeforeTaxWholeSell", ProductSegementMap.getStandardRateBeforeTaxWholeSale());
            initialValues.put("StandardTaxWholeSale", ProductSegementMap.getStandardRateWholeSale());
            db.insert(DATABASE_TABLE_MAINProductSegementMap, null, initialValues);
        }
        db.setTransactionSuccessful();
        db.endTransaction();


    }
    public static void delete_tblManagerMstr()
    {
        db.execSQL("DELETE FROM tblManagerMstr");

    }
    public static long saveCategory(Integer CategoryID, String CategoryDescr,int CatOrdr)
    {

        ContentValues initialValues = new ContentValues();
        initialValues.put("CategoryID", CategoryID);
        initialValues.put("CategoryDescr", CategoryDescr);
        initialValues.put("CatOrdr", CatOrdr);

        ////// System.out.println("inserting records in table 3..");

        return db.insert(DATABASE_TABLE_MAIN15, null, initialValues);
    }
    public static void deletetblBankMaster()
    {

        db.execSQL("DELETE FROM tblBankMaster");
        db.execSQL("DELETE FROM tblInstrumentMaster");

    }
    public static void savetblBankMaster(List<TblBankMaster> tblBankMaster)
    {
       db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for(TblBankMaster BankMaster:tblBankMaster){

            initialValues.put("BankId", BankMaster.getBankId());
            initialValues.put("BankName", BankMaster.getBankName());
            /*initialValues.put("LoginIdIns", BankMaster.getLoginIdIns());
            initialValues.put("TimeStampIns", BankMaster.getTimeStampIns());
            initialValues.put("LoginIdUpd", BankMaster.getLoginIdUpd());
            initialValues.put("TimeStampUpd", BankMaster.getTimeStampUpd());*/
            db.insert(DATABASE_TABLE_tblBankMaster, null, initialValues);
        }
        db.setTransactionSuccessful();
        db.endTransaction();


    }
    public static long savetblInstrumentMaster(Integer InstrumentModeId, String InstrumentMode, Integer InstrumentType)
    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("InstrumentModeId", InstrumentModeId);
        initialValues.put("InstrumentMode", InstrumentMode.toString().trim());
        initialValues.put("InstrumentType", InstrumentType);

        return db.insert(DATABASE_TABLE_tblInstrumentMaster, null, initialValues);
    }
    public static void insertCycleId(Integer cycleId,String CycStartTime,BigInteger CycleTime)
    {
        ////open();

        ContentValues values=new ContentValues();

//tblDistributorProductLeft(DistributorNodeIdNodeType text null,OrderId text null,ProductId text null,OrderQntty text null);";
        values.put("CycleID",cycleId);
        values.put("CycStartTime",CycStartTime);
        values.put("CycleTime",""+CycleTime);

        values.put("Sstat",3);
        db.insert(DATABASE_TABLE_CYCLEID,null,values);


        //close();
    }
    public static void Delete_tblGetReturnsReasonForPDAMstr()
    {
        db.execSQL("DELETE FROM tblGetReturnsReasonForPDAMstr");

    }

    public static void fnInsertTBLReturnRsn(Integer stockStatusId,String stockStatus)
    {
        //tblGetReturnsReasonForPDAMstr(StockStatusId text not null,StockStatus text not null);";
        ContentValues content=new ContentValues();
        content.put("StockStatusId", stockStatusId);
        content.put("StockStatus", stockStatus);
        db.insertOrThrow(TABLE_RETURN_REASON, null, content);
    }
    public static void Delete_tblSupplierMstrList()
    {
        db.execSQL("DELETE FROM tblSupplierMstrList");

    }
    public static void savetblLastOutstanding(List<TblLastOutstanding> tblLastOutstanding)
    {
       db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for(TblLastOutstanding tblLastOutstandingData:tblLastOutstanding)
        {
            initialValues.put("StoreID", ""+tblLastOutstandingData.getStoreid());
            initialValues.put("Outstanding", tblLastOutstandingData.getOutStanding());
            initialValues.put("AmtOverdue", 0.0);
            db.insert(DATABASE_TABLE_tblLastOutstanding, null, initialValues);
        }
        db.setTransactionSuccessful();
        db.endTransaction();
        System.out.println("DATAENSERTEDEnd");


    }
    public static void savetblInvoiceLastVisitDetails( List<TblInvoiceLastVisitDetails> tblInvoiceLastVisitDetails)
    {
       db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for(TblInvoiceLastVisitDetails tblInvoiceLastVisitDetailsData:tblInvoiceLastVisitDetails)
        {
            initialValues.put("StoreID", ""+tblInvoiceLastVisitDetailsData.getStoreid());
            initialValues.put("InvCode", ""+tblInvoiceLastVisitDetailsData.getInvCode());
            initialValues.put("InvDate", ""+tblInvoiceLastVisitDetailsData.getInvDate());
            initialValues.put("OutstandingAmt", ""+tblInvoiceLastVisitDetailsData.getOutStandingAmt());
            // initialValues.put("AmtOverdue", ""));
            db.insert(DATABASE_TABLE_tblInvoiceLastVisitDetails, null, initialValues);
        }
        db.setTransactionSuccessful();
        db.endTransaction();


    }
    public static void deltblPDAGetExecutionSummary()
    {
        db.execSQL("DELETE FROM tblPDAGetExecutionSummary");
    }
    public static void inserttblForPDAGetExecutionSummary(List<TblPDAGetExecutionSummary> tblPDAGetExecutionSummary)
    {

        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for(TblPDAGetExecutionSummary tblPDAGetExecutionSummaryData:tblPDAGetExecutionSummary)
        {
            initialValues.put("StoreID", tblPDAGetExecutionSummaryData.getStoreID());
            initialValues.put("OrderDate", tblPDAGetExecutionSummaryData.getOrderDate());
            initialValues.put("ProductID", tblPDAGetExecutionSummaryData.getProductID());
            initialValues.put("OrderQty",tblPDAGetExecutionSummaryData.getOrderQty());
            initialValues.put("flgInvStatus",tblPDAGetExecutionSummaryData.getFlgInvStatus());
            initialValues.put("ProductQty", tblPDAGetExecutionSummaryData.getProductQty());
            initialValues.put("PrdName", tblPDAGetExecutionSummaryData.getPrdName());


            db.insert(DATABASE_TABLE_MAIN146 , null, initialValues);
        }
        db.setTransactionSuccessful();
        db.endTransaction();


    }
    public void deletetblPDAGetLastOrderDetailsTotalValues()
    {
        db.execSQL("DELETE from tblPDAGetLastOrderDetailsTotalValues");
    }
    public static void inserttblspForPDAGetLastOrderDetails_TotalValues(List<TblPDAGetLastOrderDetailsTotalValues> tblPDAGetLastOrderDetailsTotalValues)
    {
       db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for(TblPDAGetLastOrderDetailsTotalValues tblPDAGetLastOrderDetailsTotalValuesData:tblPDAGetLastOrderDetailsTotalValues)
        {


            initialValues.put("StoreID", tblPDAGetLastOrderDetailsTotalValuesData.getStoreID());
            initialValues.put("OrderValue", tblPDAGetLastOrderDetailsTotalValuesData.getOrderValue());
            initialValues.put("ExecutionValue", tblPDAGetLastOrderDetailsTotalValuesData.getExecutionValue());

            db.insert(DATABASE_TABLE_MAIN145 , null, initialValues);
        }
        db.setTransactionSuccessful();
        db.endTransaction();


    }
    public static void deltblPDAGetLastOrderDetailsData()
    {
        db.execSQL("Delete from tblPDAGetLastOrderDetails");
    }
    public static void inserttblForPDAGetLastOrderDetails(List<TblPDAGetLastOrderDetails> tblPDAGetLastOrderDetails)
    {
        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for(TblPDAGetLastOrderDetails tblPDAGetLastOrderDetailsData:tblPDAGetLastOrderDetails)
        {
            initialValues.put("StoreID", tblPDAGetLastOrderDetailsData.getStoreID());
            initialValues.put("OrderDate", tblPDAGetLastOrderDetailsData.getOrderDate());
            initialValues.put("ProductID", tblPDAGetLastOrderDetailsData.getProductID());
            initialValues.put("OrderQty", tblPDAGetLastOrderDetailsData.getOrderQty());
            initialValues.put("FreeQty", tblPDAGetLastOrderDetailsData.getFreeQty());
            initialValues.put("PrdName", tblPDAGetLastOrderDetailsData.getPrdName());
            initialValues.put("ExecutionQty", tblPDAGetLastOrderDetailsData.getExecutionQty());

            db.insert(DATABASE_TABLE_MAIN144 , null, initialValues);
        }
        db.setTransactionSuccessful();
        db.endTransaction();


    }
    public static void deletetblPDAGetLastVisitDetails()
    {
        db.execSQL("DELETE FROM tblPDAGetLastVisitDetails");

    }
    public static void insertDistributorLeftOrderId(String distributorNodeIdNodeType,Integer orderId,Integer flgProcessedInvoice)
    {
        ////open();

        ContentValues values=new ContentValues();

//tblDistributorProductLeft(DistributorNodeIdNodeType text null,OrderId text null,ProductId text null,OrderQntty text null);";
        values.put("DistributorNodeIdNodeType",distributorNodeIdNodeType);
        values.put("OrderId",orderId);
        values.put("flgProcessedInvoice",flgProcessedInvoice);

        db.insert(DATABASE_TABLE_DISTRIBUTOR_LEFTPRODUCT,null,values);


        //close();
    }
    public static void inserttblForPDAGetLastVisitDetails(List<TblPDAGetLastVisitDetails> tblPDAGetLastVisitDetails)
    {

       db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for(TblPDAGetLastVisitDetails tblPDAGetLastVisitDetailsData:tblPDAGetLastVisitDetails)
        {
            initialValues.put("StoreID", tblPDAGetLastVisitDetailsData.getStoreID());
            initialValues.put("Date123", tblPDAGetLastVisitDetailsData.getDate());
            initialValues.put("Order123", tblPDAGetLastVisitDetailsData.getOrder());
            initialValues.put("Stock", tblPDAGetLastVisitDetailsData.getStock());
            initialValues.put("SKUName", tblPDAGetLastVisitDetailsData.getSKUName());
            initialValues.put("ExecutionQty",tblPDAGetLastVisitDetailsData.getExecutionQty());
            initialValues.put("ProductID", tblPDAGetLastVisitDetailsData.getProductID());
            // // System.out.println("Tbl creation string for Sunil Data Print Data insert in  DATABASE_TABLE_MAIN143");
            db.insert(DATABASE_TABLE_MAIN143, null, initialValues);

        }
        db.setTransactionSuccessful();
        db.endTransaction();

    }
    public static void deletetblPDAGetLastOrderDateData()
    {
        db.execSQL("Delete from tblPDAGetLastOrderDate");
    }
    public static void inserttblForPDAGetLastOrderDate( List<TblPDAGetLastOrderDate> tblPDAGetLastOrderDate)
    {

       db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for(TblPDAGetLastOrderDate tblPDAGetLastOrderDateData:tblPDAGetLastOrderDate)
        {
            initialValues.put("StoreID", tblPDAGetLastOrderDateData.getStoreID());
            initialValues.put("OrderDate", tblPDAGetLastOrderDateData.getOrderDate());
            initialValues.put("flgExecutionSummary", tblPDAGetLastOrderDateData.getFlgExecutionSummary());


            db.insert(DATABASE_TABLE_MAIN142 , null, initialValues);
        }
        db.setTransactionSuccessful();
        db.endTransaction();


    }
    public void deletetblPDAGetLastVisitDate()
    {
        db.execSQL("Delete from tblPDAGetLastVisitDate");
    }
    public static void inserttblForPDAGetLastVisitDate(List<TblPDAGetLastVisitDate> tblPDAGetLastVisitDate)
    {
       db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for(TblPDAGetLastVisitDate tblPDAGetLastVisitDateData:tblPDAGetLastVisitDate)
        {
            initialValues.put("StoreID", tblPDAGetLastVisitDateData.getStoreID());
            initialValues.put("VisitDate", tblPDAGetLastVisitDateData.getVIsitDate());
            initialValues.put("flgOrder", tblPDAGetLastVisitDateData.getFlgOrder());
            db.insert(DATABASE_TABLE_MAIN141 , null, initialValues);
        }

        db.setTransactionSuccessful();
        db.endTransaction();




    }
    public void deletetblPDAGetLODQty()
    {
        db.execSQL("Delete from tblPDAGetLODQty");
    }
    public static void inserttblLODOnLastSalesSummary(List<TblPDAGetLODQty> tblPDAGetLODQty)
    {
      db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for(TblPDAGetLODQty tblPDAGetLODQtyData:tblPDAGetLODQty)
        {
            initialValues.put("StoreID", tblPDAGetLODQtyData.getStoreID());
            initialValues.put("Date", tblPDAGetLODQtyData.getDate());
            initialValues.put("SKUID", tblPDAGetLODQtyData.getSKUID());
            initialValues.put("Qty", tblPDAGetLODQtyData.getQty());
            initialValues.put("SKUName", tblPDAGetLODQtyData.getSKUName());

            //// // System.out.println("Aaaj insert  value table 103");

            db.insert(DATABASE_TABLE_MAIN103 , null, initialValues);
        }
        db.setTransactionSuccessful();
        db.endTransaction();

    }
    public static void savetblProductListLastVisitStockOrOrderMstr( List<TblProductListLastVisitStockOrOrderMstr> tblProductListLastVisitStockOrOrderMstr)
    {
//(tblActualVisitStock (storeID text null,ProductID text null,Stock text null,Sstat integer null);";
        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for(TblProductListLastVisitStockOrOrderMstr tblProductListLastVisitStockOrOrderMstrData:tblProductListLastVisitStockOrOrderMstr)
        {

            initialValues.put("StoreID",tblProductListLastVisitStockOrOrderMstrData.getStoreID());
            initialValues.put("PrdID", tblProductListLastVisitStockOrOrderMstrData.getPrdID());



            db.insert(DATABASE_TABLE_tblProductListLastVisitStockOrOrderMstr, null, initialValues);

        }
        db.endTransaction();
    }
    public static void saveSOAPdataStoreList(List<TblStoreListMaster> tblStoreListMaster,HashMap<String,String>hmapStoreIdSstat,HashMap<String,String> hmapflgOrderType)
    {

       db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for(TblStoreListMaster tblStoreListMasterData:tblStoreListMaster)
        {
            int Sstat=0;
            int flgOrderType=0;
            initialValues.put("IMEINumber", CommonInfo.imei.toString());

            if(hmapStoreIdSstat!=null && hmapStoreIdSstat.size()>0) {
                if (hmapStoreIdSstat.containsKey(tblStoreListMasterData.getStoreIDPDA())) {
                    initialValues.put("StoreID", tblStoreListMasterData.getStoreIDPDA().toString());
                }
                else
                {
                    initialValues.put("StoreID", tblStoreListMasterData.getStoreID().toString());
                }
                if (hmapStoreIdSstat.containsKey(""+tblStoreListMasterData.getStoreID())) {
                    Sstat = Integer.parseInt(hmapStoreIdSstat.get(""+tblStoreListMasterData.getStoreID()));
                    flgOrderType= Integer.parseInt(hmapflgOrderType.get(""+tblStoreListMasterData.getStoreID()));
                } else {
                            Sstat = Integer.parseInt(tblStoreListMasterData.getSstat());

                        if (Sstat == 4) {
                            Sstat = 5;
                        }
                }
            }
            else
            {
                initialValues.put("StoreID", tblStoreListMasterData.getStoreID().toString());
            }

           // initialValues.put("StoreID", tblStoreListMasterData.getStoreID());
            initialValues.put("OwnerName", tblStoreListMasterData.getOwnerName());
            initialValues.put("StoreContactNo", tblStoreListMasterData.getStoreContactNo());
            initialValues.put("StoreType", tblStoreListMasterData.getStoreType());
            initialValues.put("StoreCatType", tblStoreListMasterData.getStoreCatType());
            initialValues.put("StoreName", tblStoreListMasterData.getStoreName());
            initialValues.put("StoreAddress", tblStoreListMasterData.getStoreAddress());
            initialValues.put("chainID", 1);
            initialValues.put("IsNewStoreDataCompleteSaved", 0);

            initialValues.put("SalesPersonName", tblStoreListMasterData.getSalesPersonName());
            initialValues.put("SalesPersonContact", tblStoreListMasterData.getSalesPersonContact());


            initialValues.put("StoreLatitude", tblStoreListMasterData.getStoreLatitude());
            initialValues.put("StoreLongitude", tblStoreListMasterData.getStoreLongitude());
            initialValues.put("LastVisitDate", tblStoreListMasterData.getLastVisitDate());
            initialValues.put("LastTransactionDate", tblStoreListMasterData.getLastTransactionDate());
           // initialValues.put("Sstat", tblStoreListMasterData.getSstat());
            initialValues.put("Sstat",Sstat);
            initialValues.put("ISNewStore", 0);
            initialValues.put("PaymentStage", tblStoreListMasterData.getPaymentStage());
            initialValues.put("StoreRouteID", tblStoreListMasterData.getRouteID());
            initialValues.put("RouteNodeType", tblStoreListMasterData.getRouteNodeType());


            initialValues.put("flgHasQuote", tblStoreListMasterData.getFlgHasQuote());
            initialValues.put("flgAllowQuotation", tblStoreListMasterData.getFlgAllowQuotation());

            initialValues.put("StoreCatNodeId", "0");
            initialValues.put("flgGSTCapture", "0");
            initialValues.put("flgGSTCompliance", "0");
            initialValues.put("GSTNumber", "0");
            initialValues.put("flgGSTRecordFromServer","0");
            initialValues.put("flgStoreOrder", "0");

            initialValues.put("OutStanding", tblStoreListMasterData.getOutStanding());
            initialValues.put("OverDue", tblStoreListMasterData.getOverDue());
            initialValues.put("flgRuleTaxVal", tblStoreListMasterData.getFlgRuleTaxVal());





            initialValues.put("StoreCity", tblStoreListMasterData.getStoreCity());
            initialValues.put("StorePinCode", tblStoreListMasterData.getStorePinCode());
            initialValues.put("StoreState", tblStoreListMasterData.getStoreState());

            initialValues.put("DBR", tblStoreListMasterData.getDBR());
            initialValues.put("flgTransType", tblStoreListMasterData.getFlgTransType());

            initialValues.put("StoreClose", tblStoreListMasterData.getIsClose());
            initialValues.put("IsComposite", tblStoreListMasterData.getIsComposite());
            initialValues.put("StoreStateID", tblStoreListMasterData.getStateID());
            initialValues.put("StoreCityID", tblStoreListMasterData.getCityID());
            initialValues.put("flgOrderType", flgOrderType);
            db.insert(DATABASE_TABLE_MAIN13, null, initialValues);
        }
        db.setTransactionSuccessful();
        db.endTransaction();

       /* int flgIfStoreHasRecords=0;
        try {
            flgIfStoreHasRecords=CheckTotalStoreCount();
        }
        catch (Exception ex)
        {

        }

        if(flgGSTCapture.equals(""))
        {
            flgGSTCapture="1";
        }
        if(flgGSTCompliance.equals(""))
        {
            flgGSTCompliance="0";
        }
        if(GSTNumber.equals(""))
        {
            GSTNumber="0";
        }*/


    }
    public static void saveSOAPdataStoreListAddressMap(List<TblStoreListWithPaymentAddress> tblStoreListWithPaymentAddress)
    {
       db.beginTransaction();
        for(TblStoreListWithPaymentAddress tblStoreListWithPaymentAddressData:tblStoreListWithPaymentAddress)
        {
            ContentValues initialValues = new ContentValues();

            initialValues.put("StoreID", tblStoreListWithPaymentAddressData.getStoreID());
            initialValues.put("OutAddTypeID", tblStoreListWithPaymentAddressData.getOutAddTypeID());
            initialValues.put("Address",tblStoreListWithPaymentAddressData.getAddress());
            initialValues.put("AddressDet", tblStoreListWithPaymentAddressData.getAddressDet());
            initialValues.put("OutAddID", tblStoreListWithPaymentAddressData.getOutAddID());

            db.insert(DATABASE_TABLE_StoreAddressMapDetailsMstr, null, initialValues);
        }
        db.setTransactionSuccessful();
        db.endTransaction();


    }
    public static void insertMinDelQty(List<TblStoreSomeProdQuotePriceMstr> tblStoreSomeProdQuotePriceMstr)
    {

        // "create table tblMinDeliverQntty (PrdId text null,StoreID text null,QPBT text null,QPTaxAmount text null,MinDlvrQty int null,UOMID text null,Sstat text null);";
       db.beginTransaction();
        ContentValues values=new ContentValues();
        for(TblStoreSomeProdQuotePriceMstr tblStoreSomeProdQuotePriceMstrData:tblStoreSomeProdQuotePriceMstr)
        {
            values.put("PrdId", tblStoreSomeProdQuotePriceMstrData.getPrdId());
            values.put("StoreID", tblStoreSomeProdQuotePriceMstrData.getStoreId());
            values.put("QPBT", tblStoreSomeProdQuotePriceMstrData.getQPBT());
            values.put("QPAT", tblStoreSomeProdQuotePriceMstrData.getQPAT());
            values.put("QPTaxAmount", tblStoreSomeProdQuotePriceMstrData.getQPTaxAmt());
            values.put("MinDlvrQty", tblStoreSomeProdQuotePriceMstrData.getMinDlvryQty());
            values.put("UOMID", tblStoreSomeProdQuotePriceMstrData.getUOMID());

            db.insert(TABLE_StoreSomeProdQuotePriceMstr, null, values);
        }
        db.setTransactionSuccessful();
        db.endTransaction();

    }


    //map distributor
 /*   public static long  saveSuplierMstrData(int NodeID, int NodeType, String Descr, Double latCode,Double LongCode, int flgMapped,String Address,String State,String City,Integer PinCode,String ContactNumber,String TaxNumber,String EmailID,int flgStockManage,int flgDefault)
    {
        ContentValues initialValues = new ContentValues();

        initialValues.put("NodeID", NodeID);
        initialValues.put("NodeType", NodeType);
        initialValues.put("Descr", Descr);
        initialValues.put("latCode", latCode);
        initialValues.put("LongCode", LongCode);
        initialValues.put("flgMapped", flgMapped);
        initialValues.put("Address", Address);
        initialValues.put("State", State);
        initialValues.put("City", City);
        initialValues.put("PinCode", PinCode);
        initialValues.put("ContactNumber", ContactNumber);
        initialValues.put("TaxNumber", TaxNumber);
        initialValues.put("flgStockManage", flgStockManage);
        initialValues.put("EmailID", EmailID);
        initialValues.put("flgDefault", flgDefault);
        //0=Not To be mapped Again,1=Can Map Distributor

        return db.insert(TABLE_tblSupplierMstrList, null, initialValues);
    }*/

    public static long  saveSuplierMstrData(int NodeID, int NodeType, String Descr, Double latCode,Double LongCode, int flgMapped,String Address,String State,String City,String PinCode,String ContactNumber,String TaxNumber,String EmailID,int flgStockManage,int flgDefault)
    {
        ContentValues initialValues = new ContentValues();

        initialValues.put("NodeID", NodeID);
        initialValues.put("NodeType", NodeType);
        initialValues.put("Descr", Descr);
        initialValues.put("latCode", latCode);
        initialValues.put("LongCode", LongCode);
        initialValues.put("flgMapped", flgMapped);
        initialValues.put("Address", Address);
        initialValues.put("State", State);
        initialValues.put("City", City);
        initialValues.put("PinCode", PinCode);
        initialValues.put("ContactNumber", ContactNumber);
        initialValues.put("TaxNumber", TaxNumber);
        initialValues.put("flgStockManage", flgStockManage);
        initialValues.put("EmailID", EmailID);
        initialValues.put("flgDefault", flgDefault);
        //0=Not To be mapped Again,1=Can Map Distributor

        return db.insert(TABLE_tblSupplierMstrList, null, initialValues);
    }
public static long saveTblPreAddedStoresAddStoreDynamic(String StoreID,String StoreName,String LatCode,String LongCode,String DateAdded,int flgOldNewStore,int flgReMap,int Sstat)
	{
		ContentValues initialValues = new ContentValues();

		initialValues.put("StoreID", StoreID);
		initialValues.put("StoreName", StoreName);
		initialValues.put("LatCode", LatCode);
		initialValues.put("LongCode", LongCode);
		initialValues.put("DateAdded", DateAdded);
		initialValues.put("DistanceNear", 1000);
		initialValues.put("flgOldNewStore", flgOldNewStore);
		initialValues.put("flgReMap", flgReMap);
		initialValues.put("Sstat", Sstat);


		return db.insert(DATABASE_TABLE_tblPreAddedStores, null, initialValues);
	}

    public static void insertDistributorStock(List<TblDistributorProductStock> tblDistributorProductStock)
    {
        db.beginTransaction();
        ContentValues values=new ContentValues();
        for(TblDistributorProductStock tblDistributorProductStockData:tblDistributorProductStock)
        {
            values.put("PrdctId",tblDistributorProductStockData.getProductNodeID());

            values.put("DistributorNodeIdNodeType",tblDistributorProductStockData.getCustomer());
            values.put("SKUName",tblDistributorProductStockData.getSKUName());

            values.put("OpeningStock",tblDistributorProductStockData.getDayOpeningStock());
            values.put("TodaysAddedStock",tblDistributorProductStockData.getTodaysAddedStock());
            values.put("CycleAddedStock",tblDistributorProductStockData.getCycleAddedStock());

            values.put("StockQntty",tblDistributorProductStockData.getFinalStockQty());
            values.put("NetSalesQty",tblDistributorProductStockData.getNetSalesQty());
            values.put("TodaysUnloadStk",tblDistributorProductStockData.getTodaysUnloadStock());
            values.put("CycleUnloadStk",tblDistributorProductStockData.getCycleAddedStock());

            values.put("CategoryID",tblDistributorProductStockData.getCategoryID());

            db.insert(DATABASE_TABLE_TMP_DISTRIBUTOR_STOCK, null, values);
        }
        db.setTransactionSuccessful();
        db.endTransaction();

    }

    public static void insertDistributorStockPermanetTableDirectly(List<TblDistributorProductStock> tblDistributorProductStock)
    {
        db.beginTransaction();
        ContentValues values=new ContentValues();
        for(TblDistributorProductStock tblDistributorProductStockData:tblDistributorProductStock)
        {
            values.put("PrdctId",tblDistributorProductStockData.getProductNodeID());

            values.put("DistributorNodeIdNodeType",tblDistributorProductStockData.getCustomer());
            values.put("SKUName",tblDistributorProductStockData.getSKUName());

            values.put("OpeningStock",tblDistributorProductStockData.getDayOpeningStock());
            values.put("TodaysAddedStock",tblDistributorProductStockData.getTodaysAddedStock());
            values.put("CycleAddedStock",tblDistributorProductStockData.getCycleAddedStock());

            values.put("StockQntty",tblDistributorProductStockData.getFinalStockQty());
            values.put("NetSalesQty",tblDistributorProductStockData.getNetSalesQty());
            values.put("TodaysUnloadStk",tblDistributorProductStockData.getTodaysUnloadStock());
            values.put("CycleUnloadStk",tblDistributorProductStockData.getCycleAddedStock());

            values.put("CategoryID",tblDistributorProductStockData.getCategoryID());

            db.insert(DATABASE_TABLE_DISTRIBUTOR_STOCK, null, values);
        }
        db.setTransactionSuccessful();
        db.endTransaction();

    }
    public static void updateflgOrderTypeIntblStoreList(String StoreID, int flgOrderType) {

        try {
            final ContentValues values = new ContentValues();
            values.put("flgOrderType", flgOrderType);

            int affected = db.update("tblStoreList", values, "StoreID=?",
                    new String[] { StoreID });



        } catch (Exception ex)
        {
            Log.e(TAG, ex.toString());
        }
        finally {
        }

    }


    public static int fnGetflgOrderTypeAgainstStore(String StoreID)
    {

        int flgOrderType=0;
        Cursor cursor = db.rawQuery("SELECT flgOrderType FROM tblStoreList WHERE StoreID='"+StoreID+"'", null);

        try {
            if (cursor.getCount() > 0)
            {
                if (cursor.moveToFirst())
                {
                    flgOrderType=Integer.parseInt(cursor.getString(0));
                }

            }
            return flgOrderType;

        } finally {
            if(cursor!=null) {
                cursor.close();
            }
        }

    }

    public static void fnInsertOrUpdate_tblAllServicesCalledSuccessfull(int flgAllServicesCalledOrNot)
    {
        try {
            Cursor cursor = db.rawQuery("SELECT * FROM "+ TABLE_tblAllServicesCalledSuccessfull+"" , null);
            ContentValues initialValues = new ContentValues();
            initialValues.put("flgAllServicesCalledOrNot", flgAllServicesCalledOrNot);
            if(cursor.getCount()>0)
            {
                if(cursor!=null)
                {
                    cursor.close();
                }
                db.execSQL("UPDATE tblAllServicesCalledSuccessfull SET flgAllServicesCalledOrNot="+flgAllServicesCalledOrNot);

            }
            else
            {
                if(cursor!=null)
                {
                    cursor.close();
                }
                db.insert(TABLE_tblAllServicesCalledSuccessfull, null, initialValues);
            }
        }
        catch(Exception ex)
        {
            String ex1=ex.getMessage();
        }
        finally {

        }
    }


    public static int fnCheckRetrofitApiCalledSucessfullyOrNot()
    {
        Cursor cursorE2 = db.rawQuery("SELECT ifnull(flgAllServicesCalledOrNot,0) FROM tblAllServicesCalledSuccessfull", null);
        int chkI = 0;
        try {
            if(cursorE2.getCount()>0)
            {
                cursorE2.moveToFirst();
                chkI=Integer.parseInt(cursorE2.getString(0).toString());
            }

        } finally {
            if(cursorE2!=null) {
                cursorE2.close();
            }
        }
        return chkI;
    }


    public static void inserttblInvoiceExecutionProductList(List<TblInvoiceExecutionProductList> tblInvoiceExecutionProductList)
    {

        db.beginTransaction();
        ContentValues values=new ContentValues();
        for(TblInvoiceExecutionProductList tblInvoiceExecutionProductListData:tblInvoiceExecutionProductList)
        {
            values.put("ProductId",tblInvoiceExecutionProductListData.getProductId());

            values.put("ProductName",tblInvoiceExecutionProductListData.getProductName());
            System.out.println("Abhinav Raj and Mona:"+tblInvoiceExecutionProductListData.getProductId()+"^"+tblInvoiceExecutionProductListData.getProductName());

            db.insert(DATABASE_TABLE_MAIN112, null, values);
        }
        db.setTransactionSuccessful();
        db.endTransaction();
    }

    public static void inserttblProductWiseInvoice(List<TblProductWiseInvoice> tblProductWiseInvoice,HashMap<String,String>hmapInvoiceOrderIDandStatus)
    {


        db.beginTransaction();
        ContentValues initialValues=new ContentValues();
        for(TblProductWiseInvoice tblProductWiseInvoiceData:tblProductWiseInvoice)
        {
            int flgToInsrtOrNot=0;
            if(hmapInvoiceOrderIDandStatus.containsKey(tblProductWiseInvoiceData.getOrderID()))
            {
                if(hmapInvoiceOrderIDandStatus.get(tblProductWiseInvoiceData.getOrderID()).equals("4"))
                {

                }
                else
                {
                    flgToInsrtOrNot=1;

                }
            }
            else
            {
                flgToInsrtOrNot=1;
            }
            if(flgToInsrtOrNot==1)
            {
                initialValues.put("StoreID", tblProductWiseInvoiceData.getStoreID());
                initialValues.put("ProductID", tblProductWiseInvoiceData.getProductId());
                initialValues.put("OrderQty", tblProductWiseInvoiceData.getOrderQty());
                initialValues.put("ProductPrice", tblProductWiseInvoiceData.getProductPrice());
                initialValues.put("InvoiceForDate",tblProductWiseInvoiceData.getInVoiceForDate());
                initialValues.put("OrderID", tblProductWiseInvoiceData.getOrderID());
                initialValues.put("CatID", tblProductWiseInvoiceData.getCatID());
                initialValues.put("Freeqty", tblProductWiseInvoiceData.getFreeQty());
                initialValues.put("TotLineDiscVal", tblProductWiseInvoiceData.getTotLineDiscVal());

                db.insert(DATABASE_TABLE_MAIN113, null, initialValues);
            }

        }
        db.setTransactionSuccessful();
        db.endTransaction();
    }
}




